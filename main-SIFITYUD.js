import{A as lT,B as hn,C as Zr,D as Pd,E as Au,F as Lm,G as dT,H as hT,I as q,J as zt,K as at,L as jm,M as fT,N as xu,O as ce,P as Xt,Q as kd,R as Um,S as fn,T as Xr,U as Zi,V as Od,W as pT,X as Mn,Y as _t,a as x,b as ue,c as Om,d as v,e as tT,f as Ad,g as nT,h as rT,i as S,j as yo,k as xd,l as iT,m as sT,n as lt,o as Md,p as Su,q as Fm,r as oT,s as Kn,t as Vm,u as Rd,v as aT,w as uT,x as Nd,y as Qe,z as cT}from"./chunk-EMU53QTL.js";var gT=null;var Bm=1,mT=Symbol("SIGNAL");function Jt(t){let e=gT;return gT=t,e}var yT={version:0,lastCleanEpoch:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{}};function dV(t){if(!(qm(t)&&!t.dirty)&&!(!t.dirty&&t.lastCleanEpoch===Bm)){if(!t.producerMustRecompute(t)&&!$m(t)){t.dirty=!1,t.lastCleanEpoch=Bm;return}t.producerRecomputeValue(t),t.dirty=!1,t.lastCleanEpoch=Bm}}function _T(t){return t&&(t.nextProducerIndex=0),Jt(t)}function vT(t,e){if(Jt(e),!(!t||t.producerNode===void 0||t.producerIndexOfThis===void 0||t.producerLastReadVersion===void 0)){if(qm(t))for(let n=t.nextProducerIndex;n<t.producerNode.length;n++)Hm(t.producerNode[n],t.producerIndexOfThis[n]);for(;t.producerNode.length>t.nextProducerIndex;)t.producerNode.pop(),t.producerLastReadVersion.pop(),t.producerIndexOfThis.pop()}}function $m(t){Fd(t);for(let e=0;e<t.producerNode.length;e++){let n=t.producerNode[e],r=t.producerLastReadVersion[e];if(r!==n.version||(dV(n),r!==n.version))return!0}return!1}function wT(t){if(Fd(t),qm(t))for(let e=0;e<t.producerNode.length;e++)Hm(t.producerNode[e],t.producerIndexOfThis[e]);t.producerNode.length=t.producerLastReadVersion.length=t.producerIndexOfThis.length=0,t.liveConsumerNode&&(t.liveConsumerNode.length=t.liveConsumerIndexOfThis.length=0)}function Hm(t,e){if(hV(t),Fd(t),t.liveConsumerNode.length===1)for(let r=0;r<t.producerNode.length;r++)Hm(t.producerNode[r],t.producerIndexOfThis[r]);let n=t.liveConsumerNode.length-1;if(t.liveConsumerNode[e]=t.liveConsumerNode[n],t.liveConsumerIndexOfThis[e]=t.liveConsumerIndexOfThis[n],t.liveConsumerNode.length--,t.liveConsumerIndexOfThis.length--,e<t.liveConsumerNode.length){let r=t.liveConsumerIndexOfThis[e],i=t.liveConsumerNode[e];Fd(i),i.producerIndexOfThis[r]=e}}function qm(t){return t.consumerIsAlwaysLive||(t?.liveConsumerNode?.length??0)>0}function Fd(t){t.producerNode??=[],t.producerIndexOfThis??=[],t.producerLastReadVersion??=[]}function hV(t){t.liveConsumerNode??=[],t.liveConsumerIndexOfThis??=[]}function fV(){throw new Error}var pV=fV;function ET(t){pV=t}function W(t){return typeof t=="function"}function _o(t){let n=t(r=>{Error.call(r),r.stack=new Error().stack});return n.prototype=Object.create(Error.prototype),n.prototype.constructor=n,n}var Vd=_o(t=>function(n){t(this),this.message=n?`${n.length} errors occurred during unsubscription:
${n.map((r,i)=>`${i+1}) ${r.toString()}`).join(`
  `)}`:"",this.name="UnsubscriptionError",this.errors=n});function Xi(t,e){if(t){let n=t.indexOf(e);0<=n&&t.splice(n,1)}}var He=class t{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;let{_parentage:n}=this;if(n)if(this._parentage=null,Array.isArray(n))for(let s of n)s.remove(this);else n.remove(this);let{initialTeardown:r}=this;if(W(r))try{r()}catch(s){e=s instanceof Vd?s.errors:[s]}let{_finalizers:i}=this;if(i){this._finalizers=null;for(let s of i)try{IT(s)}catch(o){e=e??[],o instanceof Vd?e=[...e,...o.errors]:e.push(o)}}if(e)throw new Vd(e)}}add(e){var n;if(e&&e!==this)if(this.closed)IT(e);else{if(e instanceof t){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(n=this._finalizers)!==null&&n!==void 0?n:[]).push(e)}}_hasParent(e){let{_parentage:n}=this;return n===e||Array.isArray(n)&&n.includes(e)}_addParent(e){let{_parentage:n}=this;this._parentage=Array.isArray(n)?(n.push(e),n):n?[n,e]:e}_removeParent(e){let{_parentage:n}=this;n===e?this._parentage=null:Array.isArray(n)&&Xi(n,e)}remove(e){let{_finalizers:n}=this;n&&Xi(n,e),e instanceof t&&e._removeParent(this)}};He.EMPTY=(()=>{let t=new He;return t.closed=!0,t})();var Gm=He.EMPTY;function Ld(t){return t instanceof He||t&&"closed"in t&&W(t.remove)&&W(t.add)&&W(t.unsubscribe)}function IT(t){W(t)?t():t.unsubscribe()}var Rn={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1};var vo={setTimeout(t,e,...n){let{delegate:r}=vo;return r?.setTimeout?r.setTimeout(t,e,...n):setTimeout(t,e,...n)},clearTimeout(t){let{delegate:e}=vo;return(e?.clearTimeout||clearTimeout)(t)},delegate:void 0};function jd(t){vo.setTimeout(()=>{let{onUnhandledError:e}=Rn;if(e)e(t);else throw t})}function Ji(){}var CT=zm("C",void 0,void 0);function DT(t){return zm("E",void 0,t)}function TT(t){return zm("N",t,void 0)}function zm(t,e,n){return{kind:t,value:e,error:n}}var es=null;function wo(t){if(Rn.useDeprecatedSynchronousErrorHandling){let e=!es;if(e&&(es={errorThrown:!1,error:null}),t(),e){let{errorThrown:n,error:r}=es;if(es=null,n)throw r}}else t()}function bT(t){Rn.useDeprecatedSynchronousErrorHandling&&es&&(es.errorThrown=!0,es.error=t)}var ts=class extends He{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,Ld(e)&&e.add(this)):this.destination=yV}static create(e,n,r){return new br(e,n,r)}next(e){this.isStopped?Km(TT(e),this):this._next(e)}error(e){this.isStopped?Km(DT(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?Km(CT,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}},gV=Function.prototype.bind;function Wm(t,e){return gV.call(t,e)}var Qm=class{constructor(e){this.partialObserver=e}next(e){let{partialObserver:n}=this;if(n.next)try{n.next(e)}catch(r){Ud(r)}}error(e){let{partialObserver:n}=this;if(n.error)try{n.error(e)}catch(r){Ud(r)}else Ud(e)}complete(){let{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(n){Ud(n)}}},br=class extends ts{constructor(e,n,r){super();let i;if(W(e)||!e)i={next:e??void 0,error:n??void 0,complete:r??void 0};else{let s;this&&Rn.useDeprecatedNextContext?(s=Object.create(e),s.unsubscribe=()=>this.unsubscribe(),i={next:e.next&&Wm(e.next,s),error:e.error&&Wm(e.error,s),complete:e.complete&&Wm(e.complete,s)}):i=e}this.destination=new Qm(i)}};function Ud(t){Rn.useDeprecatedSynchronousErrorHandling?bT(t):jd(t)}function mV(t){throw t}function Km(t,e){let{onStoppedNotification:n}=Rn;n&&vo.setTimeout(()=>n(t,e))}var yV={closed:!0,next:Ji,error:mV,complete:Ji};var Eo=typeof Symbol=="function"&&Symbol.observable||"@@observable";function vt(t){return t}function Ym(...t){return Zm(t)}function Zm(t){return t.length===0?vt:t.length===1?t[0]:function(n){return t.reduce((r,i)=>i(r),n)}}var ne=(()=>{class t{constructor(n){n&&(this._subscribe=n)}lift(n){let r=new t;return r.source=this,r.operator=n,r}subscribe(n,r,i){let s=vV(n)?n:new br(n,r,i);return wo(()=>{let{operator:o,source:a}=this;s.add(o?o.call(s,a):a?this._subscribe(s):this._trySubscribe(s))}),s}_trySubscribe(n){try{return this._subscribe(n)}catch(r){n.error(r)}}forEach(n,r){return r=ST(r),new r((i,s)=>{let o=new br({next:a=>{try{n(a)}catch(u){s(u),o.unsubscribe()}},error:s,complete:i});this.subscribe(o)})}_subscribe(n){var r;return(r=this.source)===null||r===void 0?void 0:r.subscribe(n)}[Eo](){return this}pipe(...n){return Zm(n)(this)}toPromise(n){return n=ST(n),new n((r,i)=>{let s;this.subscribe(o=>s=o,o=>i(o),()=>r(s))})}}return t.create=e=>new t(e),t})();function ST(t){var e;return(e=t??Rn.Promise)!==null&&e!==void 0?e:Promise}function _V(t){return t&&W(t.next)&&W(t.error)&&W(t.complete)}function vV(t){return t&&t instanceof ts||_V(t)&&Ld(t)}function Xm(t){return W(t?.lift)}function Y(t){return e=>{if(Xm(e))return e.lift(function(n){try{return t(n,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function K(t,e,n,r,i){return new Jm(t,e,n,r,i)}var Jm=class extends ts{constructor(e,n,r,i,s,o){super(e),this.onFinalize=s,this.shouldUnsubscribe=o,this._next=n?function(a){try{n(a)}catch(u){e.error(u)}}:super._next,this._error=i?function(a){try{i(a)}catch(u){e.error(u)}finally{this.unsubscribe()}}:super._error,this._complete=r?function(){try{r()}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){let{closed:n}=this;super.unsubscribe(),!n&&((e=this.onFinalize)===null||e===void 0||e.call(this))}}};function Io(){return Y((t,e)=>{let n=null;t._refCount++;let r=K(e,void 0,void 0,void 0,()=>{if(!t||t._refCount<=0||0<--t._refCount){n=null;return}let i=t._connection,s=n;n=null,i&&(!s||i===s)&&i.unsubscribe(),e.unsubscribe()});t.subscribe(r),r.closed||(n=t.connect())})}var Co=class extends ne{constructor(e,n){super(),this.source=e,this.subjectFactory=n,this._subject=null,this._refCount=0,this._connection=null,Xm(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){let e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;let{_connection:e}=this;this._subject=this._connection=null,e?.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new He;let n=this.getSubject();e.add(this.source.subscribe(K(n,void 0,()=>{this._teardown(),n.complete()},r=>{this._teardown(),n.error(r)},()=>this._teardown()))),e.closed&&(this._connection=null,e=He.EMPTY)}return e}refCount(){return Io()(this)}};var AT=_o(t=>function(){t(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var Ye=(()=>{class t extends ne{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(n){let r=new Bd(this,this);return r.operator=n,r}_throwIfClosed(){if(this.closed)throw new AT}next(n){wo(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(let r of this.currentObservers)r.next(n)}})}error(n){wo(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=n;let{observers:r}=this;for(;r.length;)r.shift().error(n)}})}complete(){wo(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;let{observers:n}=this;for(;n.length;)n.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var n;return((n=this.observers)===null||n===void 0?void 0:n.length)>0}_trySubscribe(n){return this._throwIfClosed(),super._trySubscribe(n)}_subscribe(n){return this._throwIfClosed(),this._checkFinalizedStatuses(n),this._innerSubscribe(n)}_innerSubscribe(n){let{hasError:r,isStopped:i,observers:s}=this;return r||i?Gm:(this.currentObservers=null,s.push(n),new He(()=>{this.currentObservers=null,Xi(s,n)}))}_checkFinalizedStatuses(n){let{hasError:r,thrownError:i,isStopped:s}=this;r?n.error(i):s&&n.complete()}asObservable(){let n=new ne;return n.source=this,n}}return t.create=(e,n)=>new Bd(e,n),t})(),Bd=class extends Ye{constructor(e,n){super(),this.destination=e,this.source=n}next(e){var n,r;(r=(n=this.destination)===null||n===void 0?void 0:n.next)===null||r===void 0||r.call(n,e)}error(e){var n,r;(r=(n=this.destination)===null||n===void 0?void 0:n.error)===null||r===void 0||r.call(n,e)}complete(){var e,n;(n=(e=this.destination)===null||e===void 0?void 0:e.complete)===null||n===void 0||n.call(e)}_subscribe(e){var n,r;return(r=(n=this.source)===null||n===void 0?void 0:n.subscribe(e))!==null&&r!==void 0?r:Gm}};var wt=class extends Ye{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){let n=super._subscribe(e);return!n.closed&&e.next(this._value),n}getValue(){let{hasError:e,thrownError:n,_value:r}=this;if(e)throw n;return this._throwIfClosed(),r}next(e){super.next(this._value=e)}};var Mu={now(){return(Mu.delegate||Date).now()},delegate:void 0};var $d=class extends Ye{constructor(e=1/0,n=1/0,r=Mu){super(),this._bufferSize=e,this._windowTime=n,this._timestampProvider=r,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=n===1/0,this._bufferSize=Math.max(1,e),this._windowTime=Math.max(1,n)}next(e){let{isStopped:n,_buffer:r,_infiniteTimeWindow:i,_timestampProvider:s,_windowTime:o}=this;n||(r.push(e),!i&&r.push(s.now()+o)),this._trimBuffer(),super.next(e)}_subscribe(e){this._throwIfClosed(),this._trimBuffer();let n=this._innerSubscribe(e),{_infiniteTimeWindow:r,_buffer:i}=this,s=i.slice();for(let o=0;o<s.length&&!e.closed;o+=r?1:2)e.next(s[o]);return this._checkFinalizedStatuses(e),n}_trimBuffer(){let{_bufferSize:e,_timestampProvider:n,_buffer:r,_infiniteTimeWindow:i}=this,s=(i?1:2)*e;if(e<1/0&&s<r.length&&r.splice(0,r.length-s),!i){let o=n.now(),a=0;for(let u=1;u<r.length&&r[u]<=o;u+=2)a=u;a&&r.splice(0,a+1)}}};var Hd=class extends He{constructor(e,n){super()}schedule(e,n=0){return this}};var Ru={setInterval(t,e,...n){let{delegate:r}=Ru;return r?.setInterval?r.setInterval(t,e,...n):setInterval(t,e,...n)},clearInterval(t){let{delegate:e}=Ru;return(e?.clearInterval||clearInterval)(t)},delegate:void 0};var Do=class extends Hd{constructor(e,n){super(e,n),this.scheduler=e,this.work=n,this.pending=!1}schedule(e,n=0){var r;if(this.closed)return this;this.state=e;let i=this.id,s=this.scheduler;return i!=null&&(this.id=this.recycleAsyncId(s,i,n)),this.pending=!0,this.delay=n,this.id=(r=this.id)!==null&&r!==void 0?r:this.requestAsyncId(s,this.id,n),this}requestAsyncId(e,n,r=0){return Ru.setInterval(e.flush.bind(e,this),r)}recycleAsyncId(e,n,r=0){if(r!=null&&this.delay===r&&this.pending===!1)return n;n!=null&&Ru.clearInterval(n)}execute(e,n){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;let r=this._execute(e,n);if(r)return r;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,n){let r=!1,i;try{this.work(e)}catch(s){r=!0,i=s||new Error("Scheduled action threw falsy error")}if(r)return this.unsubscribe(),i}unsubscribe(){if(!this.closed){let{id:e,scheduler:n}=this,{actions:r}=n;this.work=this.state=this.scheduler=null,this.pending=!1,Xi(r,this),e!=null&&(this.id=this.recycleAsyncId(n,e,null)),this.delay=null,super.unsubscribe()}}};var To=class t{constructor(e,n=t.now){this.schedulerActionCtor=e,this.now=n}schedule(e,n=0,r){return new this.schedulerActionCtor(this,e).schedule(r,n)}};To.now=Mu.now;var bo=class extends To{constructor(e,n=To.now){super(e,n),this.actions=[],this._active=!1}flush(e){let{actions:n}=this;if(this._active){n.push(e);return}let r;this._active=!0;do if(r=e.execute(e.state,e.delay))break;while(e=n.shift());if(this._active=!1,r){for(;e=n.shift();)e.unsubscribe();throw r}}};var ns=new bo(Do);var qd=class extends Do{constructor(e,n){super(e,n),this.scheduler=e,this.work=n}schedule(e,n=0){return n>0?super.schedule(e,n):(this.delay=n,this.state=e,this.scheduler.flush(this),this)}execute(e,n){return n>0||this.closed?super.execute(e,n):this._execute(e,n)}requestAsyncId(e,n,r=0){return r!=null&&r>0||r==null&&this.delay>0?super.requestAsyncId(e,n,r):(e.flush(this),0)}};var Gd=class extends bo{};var ey=new Gd(qd);var Wt=new ne(t=>t.complete());function xT(t){return t&&W(t.schedule)}function ty(t){return t[t.length-1]}function So(t){return W(ty(t))?t.pop():void 0}function Qn(t){return xT(ty(t))?t.pop():void 0}function MT(t,e){return typeof ty(t)=="number"?t.pop():e}var zd=t=>t&&typeof t.length=="number"&&typeof t!="function";function Wd(t){return W(t?.then)}function Kd(t){return W(t[Eo])}function Qd(t){return Symbol.asyncIterator&&W(t?.[Symbol.asyncIterator])}function Yd(t){return new TypeError(`You provided ${t!==null&&typeof t=="object"?"an invalid object":`'${t}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}function wV(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var Zd=wV();function Xd(t){return W(t?.[Zd])}function Jd(t){return nT(this,arguments,function*(){let n=t.getReader();try{for(;;){let{value:r,done:i}=yield Ad(n.read());if(i)return yield Ad(void 0);yield yield Ad(r)}}finally{n.releaseLock()}})}function eh(t){return W(t?.getReader)}function Te(t){if(t instanceof ne)return t;if(t!=null){if(Kd(t))return EV(t);if(zd(t))return IV(t);if(Wd(t))return CV(t);if(Qd(t))return RT(t);if(Xd(t))return DV(t);if(eh(t))return TV(t)}throw Yd(t)}function EV(t){return new ne(e=>{let n=t[Eo]();if(W(n.subscribe))return n.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function IV(t){return new ne(e=>{for(let n=0;n<t.length&&!e.closed;n++)e.next(t[n]);e.complete()})}function CV(t){return new ne(e=>{t.then(n=>{e.closed||(e.next(n),e.complete())},n=>e.error(n)).then(null,jd)})}function DV(t){return new ne(e=>{for(let n of t)if(e.next(n),e.closed)return;e.complete()})}function RT(t){return new ne(e=>{bV(t,e).catch(n=>e.error(n))})}function TV(t){return RT(Jd(t))}function bV(t,e){var n,r,i,s;return tT(this,void 0,void 0,function*(){try{for(n=rT(t);r=yield n.next(),!r.done;){let o=r.value;if(e.next(o),e.closed)return}}catch(o){i={error:o}}finally{try{r&&!r.done&&(s=n.return)&&(yield s.call(n))}finally{if(i)throw i.error}}e.complete()})}function Kt(t,e,n,r=0,i=!1){let s=e.schedule(function(){n(),i?t.add(this.schedule(null,r)):this.unsubscribe()},r);if(t.add(s),!i)return s}function pn(t,e=0){return Y((n,r)=>{n.subscribe(K(r,i=>Kt(r,t,()=>r.next(i),e),()=>Kt(r,t,()=>r.complete(),e),i=>Kt(r,t,()=>r.error(i),e)))})}function Nn(t,e=0){return Y((n,r)=>{r.add(t.schedule(()=>n.subscribe(r),e))})}function NT(t,e){return Te(t).pipe(Nn(e),pn(e))}function PT(t,e){return Te(t).pipe(Nn(e),pn(e))}function kT(t,e){return new ne(n=>{let r=0;return e.schedule(function(){r===t.length?n.complete():(n.next(t[r++]),n.closed||this.schedule())})})}function OT(t,e){return new ne(n=>{let r;return Kt(n,e,()=>{r=t[Zd](),Kt(n,e,()=>{let i,s;try{({value:i,done:s}=r.next())}catch(o){n.error(o);return}s?n.complete():n.next(i)},0,!0)}),()=>W(r?.return)&&r.return()})}function th(t,e){if(!t)throw new Error("Iterable cannot be null");return new ne(n=>{Kt(n,e,()=>{let r=t[Symbol.asyncIterator]();Kt(n,e,()=>{r.next().then(i=>{i.done?n.complete():n.next(i.value)})},0,!0)})})}function FT(t,e){return th(Jd(t),e)}function VT(t,e){if(t!=null){if(Kd(t))return NT(t,e);if(zd(t))return kT(t,e);if(Wd(t))return PT(t,e);if(Qd(t))return th(t,e);if(Xd(t))return OT(t,e);if(eh(t))return FT(t,e)}throw Yd(t)}function _e(t,e){return e?VT(t,e):Te(t)}function U(...t){let e=Qn(t);return _e(t,e)}function Ao(t,e){let n=W(t)?t:()=>t,r=i=>i.error(n());return new ne(e?i=>e.schedule(r,0,i):r)}function ny(t){return!!t&&(t instanceof ne||W(t.lift)&&W(t.subscribe))}var Sr=_o(t=>function(){t(this),this.name="EmptyError",this.message="no elements in sequence"});function j(t,e){return Y((n,r)=>{let i=0;n.subscribe(K(r,s=>{r.next(t.call(e,s,i++))}))})}var{isArray:SV}=Array;function AV(t,e){return SV(e)?t(...e):t(e)}function nh(t){return j(e=>AV(t,e))}var{isArray:xV}=Array,{getPrototypeOf:MV,prototype:RV,keys:NV}=Object;function rh(t){if(t.length===1){let e=t[0];if(xV(e))return{args:e,keys:null};if(PV(e)){let n=NV(e);return{args:n.map(r=>e[r]),keys:n}}}return{args:t,keys:null}}function PV(t){return t&&typeof t=="object"&&MV(t)===RV}function ih(t,e){return t.reduce((n,r,i)=>(n[r]=e[i],n),{})}function Nu(...t){let e=Qn(t),n=So(t),{args:r,keys:i}=rh(t);if(r.length===0)return _e([],e);let s=new ne(kV(r,e,i?o=>ih(i,o):vt));return n?s.pipe(nh(n)):s}function kV(t,e,n=vt){return r=>{LT(e,()=>{let{length:i}=t,s=new Array(i),o=i,a=i;for(let u=0;u<i;u++)LT(e,()=>{let c=_e(t[u],e),l=!1;c.subscribe(K(r,d=>{s[u]=d,l||(l=!0,a--),a||r.next(n(s.slice()))},()=>{--o||r.complete()}))},r)},r)}}function LT(t,e,n){t?Kt(n,t,e):e()}function jT(t,e,n,r,i,s,o,a){let u=[],c=0,l=0,d=!1,h=()=>{d&&!u.length&&!c&&e.complete()},f=g=>c<r?p(g):u.push(g),p=g=>{s&&e.next(g),c++;let _=!1;Te(n(g,l++)).subscribe(K(e,b=>{i?.(b),s?f(b):e.next(b)},()=>{_=!0},void 0,()=>{if(_)try{for(c--;u.length&&c<r;){let b=u.shift();o?Kt(e,o,()=>p(b)):p(b)}h()}catch(b){e.error(b)}}))};return t.subscribe(K(e,f,()=>{d=!0,h()})),()=>{a?.()}}function Ze(t,e,n=1/0){return W(e)?Ze((r,i)=>j((s,o)=>e(r,s,i,o))(Te(t(r,i))),n):(typeof e=="number"&&(n=e),Y((r,i)=>jT(r,i,t,n)))}function Jr(t=1/0){return Ze(vt,t)}function UT(){return Jr(1)}function xo(...t){return UT()(_e(t,Qn(t)))}function sh(t){return new ne(e=>{Te(t()).subscribe(e)})}function ry(...t){let e=So(t),{args:n,keys:r}=rh(t),i=new ne(s=>{let{length:o}=n;if(!o){s.complete();return}let a=new Array(o),u=o,c=o;for(let l=0;l<o;l++){let d=!1;Te(n[l]).subscribe(K(s,h=>{d||(d=!0,c--),a[l]=h},()=>u--,void 0,()=>{(!u||!d)&&(c||s.next(r?ih(r,a):a),s.complete())}))}});return e?i.pipe(nh(e)):i}function Mo(...t){let e=Qn(t),n=MT(t,1/0),r=t;return r.length?r.length===1?Te(r[0]):Jr(n)(_e(r,e)):Wt}function Et(t,e){return Y((n,r)=>{let i=0;n.subscribe(K(r,s=>t.call(e,s,i++)&&r.next(s)))})}function ei(t){return Y((e,n)=>{let r=null,i=!1,s;r=e.subscribe(K(n,void 0,void 0,o=>{s=Te(t(o,ei(t)(e))),r?(r.unsubscribe(),r=null,s.subscribe(n)):i=!0})),i&&(r.unsubscribe(),r=null,s.subscribe(n))})}function BT(t,e,n,r,i){return(s,o)=>{let a=n,u=e,c=0;s.subscribe(K(o,l=>{let d=c++;u=a?t(u,l,d):(a=!0,l),r&&o.next(u)},i&&(()=>{a&&o.next(u),o.complete()})))}}function rs(t,e){return W(e)?Ze(t,e,1):Ze(t,1)}function ti(t){return Y((e,n)=>{let r=!1;e.subscribe(K(n,i=>{r=!0,n.next(i)},()=>{r||n.next(t),n.complete()}))})}function Ar(t){return t<=0?()=>Wt:Y((e,n)=>{let r=0;e.subscribe(K(n,i=>{++r<=t&&(n.next(i),t<=r&&n.complete())}))})}function iy(t){return j(()=>t)}function Pu(t,e=vt){return t=t??OV,Y((n,r)=>{let i,s=!0;n.subscribe(K(r,o=>{let a=e(o);(s||!t(i,a))&&(s=!1,i=a,r.next(o))}))})}function OV(t,e){return t===e}function oh(t=FV){return Y((e,n)=>{let r=!1;e.subscribe(K(n,i=>{r=!0,n.next(i)},()=>r?n.complete():n.error(t())))})}function FV(){return new Sr}function ku(t){return Y((e,n)=>{try{e.subscribe(n)}finally{n.add(t)}})}function gn(t,e){let n=arguments.length>=2;return r=>r.pipe(t?Et((i,s)=>t(i,s,r)):vt,Ar(1),n?ti(e):oh(()=>new Sr))}function Ro(t){return t<=0?()=>Wt:Y((e,n)=>{let r=[];e.subscribe(K(n,i=>{r.push(i),t<r.length&&r.shift()},()=>{for(let i of r)n.next(i);n.complete()},void 0,()=>{r=null}))})}function sy(t,e){let n=arguments.length>=2;return r=>r.pipe(t?Et((i,s)=>t(i,s,r)):vt,Ro(1),n?ti(e):oh(()=>new Sr))}function Ou(){return Y((t,e)=>{let n,r=!1;t.subscribe(K(e,i=>{let s=n;n=i,r&&e.next([s,i]),r=!0}))})}function Yn(t,e){return Y(BT(t,e,arguments.length>=2,!0))}function Fu(t={}){let{connector:e=()=>new Ye,resetOnError:n=!0,resetOnComplete:r=!0,resetOnRefCountZero:i=!0}=t;return s=>{let o,a,u,c=0,l=!1,d=!1,h=()=>{a?.unsubscribe(),a=void 0},f=()=>{h(),o=u=void 0,l=d=!1},p=()=>{let g=o;f(),g?.unsubscribe()};return Y((g,_)=>{c++,!d&&!l&&h();let b=u=u??e();_.add(()=>{c--,c===0&&!d&&!l&&(a=oy(p,i))}),b.subscribe(_),!o&&c>0&&(o=new br({next:P=>b.next(P),error:P=>{d=!0,h(),a=oy(f,n,P),b.error(P)},complete:()=>{l=!0,h(),a=oy(f,r),b.complete()}}),Te(g).subscribe(o))})(s)}}function oy(t,e,...n){if(e===!0){t();return}if(e===!1)return;let r=new br({next:()=>{r.unsubscribe(),t()}});return Te(e(...n)).subscribe(r)}function ah(t,e,n){let r,i=!1;return t&&typeof t=="object"?{bufferSize:r=1/0,windowTime:e=1/0,refCount:i=!1,scheduler:n}=t:r=t??1/0,Fu({connector:()=>new $d(r,e,n),resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:i})}function ay(t){return Y((e,n)=>{let r=!1,i=0;e.subscribe(K(n,s=>(r||(r=!t(s,i++)))&&n.next(s)))})}function is(...t){let e=Qn(t);return Y((n,r)=>{(e?xo(t,n,e):xo(t,n)).subscribe(r)})}function ke(t,e){return Y((n,r)=>{let i=null,s=0,o=!1,a=()=>o&&!i&&r.complete();n.subscribe(K(r,u=>{i?.unsubscribe();let c=0,l=s++;Te(t(u,l)).subscribe(i=K(r,d=>r.next(e?e(u,d,l,c++):d),()=>{i=null,a()}))},()=>{o=!0,a()}))})}function uh(t,e){return W(e)?ke(()=>t,e):ke(()=>t)}function uy(t){return Y((e,n)=>{Te(t).subscribe(K(n,()=>n.complete(),Ji)),!n.closed&&e.subscribe(n)})}function Xe(t,e,n){let r=W(t)||e||n?{next:t,error:e,complete:n}:t;return r?Y((i,s)=>{var o;(o=r.subscribe)===null||o===void 0||o.call(r);let a=!0;i.subscribe(K(s,u=>{var c;(c=r.next)===null||c===void 0||c.call(r,u),s.next(u)},()=>{var u;a=!1,(u=r.complete)===null||u===void 0||u.call(r),s.complete()},u=>{var c;a=!1,(c=r.error)===null||c===void 0||c.call(r,u),s.error(u)},()=>{var u,c;a&&((u=r.unsubscribe)===null||u===void 0||u.call(r)),(c=r.finalize)===null||c===void 0||c.call(r)}))}):vt}function cy(...t){let e=So(t);return Y((n,r)=>{let i=t.length,s=new Array(i),o=t.map(()=>!1),a=!1;for(let u=0;u<i;u++)Te(t[u]).subscribe(K(r,c=>{s[u]=c,!a&&!o[u]&&(o[u]=!0,(a=o.every(vt))&&(o=null))},Ji));n.subscribe(K(r,u=>{if(a){let c=[u,...s];r.next(e?e(...c):c)}}))})}var Ab="https://g.co/ng/security#xss",$=class extends Error{constructor(e,n){super(d_(e,n)),this.code=e}};function d_(t,e){return`${`NG0${Math.abs(t)}`}${e?": "+e:""}`}function be(t){for(let e in t)if(t[e]===be)return e;throw Error("Could not find renamed property on target object.")}function VV(t,e){for(let n in e)e.hasOwnProperty(n)&&!t.hasOwnProperty(n)&&(t[n]=e[n])}function Qt(t){if(typeof t=="string")return t;if(Array.isArray(t))return"["+t.map(Qt).join(", ")+"]";if(t==null)return""+t;if(t.overriddenName)return`${t.overriddenName}`;if(t.name)return`${t.name}`;let e=t.toString();if(e==null)return""+e;let n=e.indexOf(`
`);return n===-1?e:e.substring(0,n)}function $T(t,e){return t==null||t===""?e===null?"":e:e==null||e===""?t:t+" "+e}var LV=be({__forward_ref__:be});function ps(t){return t.__forward_ref__=ps,t.toString=function(){return Qt(this())},t}function Ot(t){return xb(t)?t():t}function xb(t){return typeof t=="function"&&t.hasOwnProperty(LV)&&t.__forward_ref__===ps}function Mb(t){return t&&!!t.\u0275providers}var jV=be({\u0275cmp:be}),UV=be({\u0275dir:be}),BV=be({\u0275pipe:be}),$V=be({\u0275mod:be}),vh=be({\u0275fac:be}),Vu=be({__NG_ELEMENT_ID__:be}),HT=be({__NG_ENV_ID__:be});function Bh(t){return typeof t=="string"?t:t==null?"":String(t)}function HV(t){return typeof t=="function"?t.name||t.toString():typeof t=="object"&&t!=null&&typeof t.type=="function"?t.type.name||t.type.toString():Bh(t)}function qV(t,e){let n=e?`. Dependency path: ${e.join(" > ")} > ${t}`:"";throw new $(-200,t)}function h_(t,e){throw new $(-201,!1)}function V(t){return{token:t.token,providedIn:t.providedIn||null,factory:t.factory,value:void 0}}function Je(t){return{providers:t.providers||[],imports:t.imports||[]}}function $h(t){return qT(t,Nb)||qT(t,Pb)}function Rb(t){return $h(t)!==null}function qT(t,e){return t.hasOwnProperty(e)?t[e]:null}function GV(t){let e=t&&(t[Nb]||t[Pb]);return e||null}function GT(t){return t&&(t.hasOwnProperty(zT)||t.hasOwnProperty(zV))?t[zT]:null}var Nb=be({\u0275prov:be}),zT=be({\u0275inj:be}),Pb=be({ngInjectableDef:be}),zV=be({ngInjectorDef:be}),se=function(t){return t[t.Default=0]="Default",t[t.Host=1]="Host",t[t.Self=2]="Self",t[t.SkipSelf=4]="SkipSelf",t[t.Optional=8]="Optional",t}(se||{}),Dy;function kb(){return Dy}function mn(t){let e=Dy;return Dy=t,e}function Ob(t,e,n){let r=$h(t);if(r&&r.providedIn=="root")return r.value===void 0?r.value=r.factory():r.value;if(n&se.Optional)return null;if(e!==void 0)return e;h_(t,"Injector")}var Ft=globalThis;var F=class{constructor(e,n){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,typeof n=="number"?this.__NG_ELEMENT_ID__=n:n!==void 0&&(this.\u0275prov=V({token:this,providedIn:n.providedIn||"root",factory:n.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}};var WV={},ju=WV,Ty="__NG_DI_FLAG__",wh="ngTempTokenPath",KV="ngTokenPath",QV=/\n/gm,YV="\u0275",WT="__source",Fo;function ZV(){return Fo}function ni(t){let e=Fo;return Fo=t,e}function XV(t,e=se.Default){if(Fo===void 0)throw new $(-203,!1);return Fo===null?Ob(t,void 0,e):Fo.get(t,e&se.Optional?null:void 0,e)}function C(t,e=se.Default){return(kb()||XV)(Ot(t),e)}function k(t,e=se.Default){return C(t,Hh(e))}function Hh(t){return typeof t>"u"||typeof t=="number"?t:0|(t.optional&&8)|(t.host&&1)|(t.self&&2)|(t.skipSelf&&4)}function by(t){let e=[];for(let n=0;n<t.length;n++){let r=Ot(t[n]);if(Array.isArray(r)){if(r.length===0)throw new $(900,!1);let i,s=se.Default;for(let o=0;o<r.length;o++){let a=r[o],u=JV(a);typeof u=="number"?u===-1?i=a.token:s|=u:i=a}e.push(C(i,s))}else e.push(C(r))}return e}function Fb(t,e){return t[Ty]=e,t.prototype[Ty]=e,t}function JV(t){return t[Ty]}function eL(t,e,n,r){let i=t[wh];throw e[WT]&&i.unshift(e[WT]),t.message=tL(`
`+t.message,i,n,r),t[KV]=i,t[wh]=null,t}function tL(t,e,n,r=null){t=t&&t.charAt(0)===`
`&&t.charAt(1)==YV?t.slice(2):t;let i=Qt(e);if(Array.isArray(e))i=e.map(Qt).join(" -> ");else if(typeof e=="object"){let s=[];for(let o in e)if(e.hasOwnProperty(o)){let a=e[o];s.push(o+":"+(typeof a=="string"?JSON.stringify(a):Qt(a)))}i=`{${s.join(", ")}}`}return`${n}${r?"("+r+")":""}[${i}]: ${t.replace(QV,`
  `)}`}function Yu(t){return{toString:t}.toString()}var Vb=function(t){return t[t.OnPush=0]="OnPush",t[t.Default=1]="Default",t}(Vb||{}),Jn=function(t){return t[t.Emulated=0]="Emulated",t[t.None=2]="None",t[t.ShadowDom=3]="ShadowDom",t}(Jn||{}),Lo={},yn=[],Vt=function(t){return t[t.None=0]="None",t[t.SignalBased=1]="SignalBased",t[t.HasDecoratorInputTransform=2]="HasDecoratorInputTransform",t}(Vt||{});function Lb(t,e,n){let r=t.length;for(;;){let i=t.indexOf(e,n);if(i===-1)return i;if(i===0||t.charCodeAt(i-1)<=32){let s=e.length;if(i+s===r||t.charCodeAt(i+s)<=32)return i}n=i+1}}function Sy(t,e,n){let r=0;for(;r<n.length;){let i=n[r];if(typeof i=="number"){if(i!==0)break;r++;let s=n[r++],o=n[r++],a=n[r++];t.setAttribute(e,o,a,s)}else{let s=i,o=n[++r];nL(s)?t.setProperty(e,s,o):t.setAttribute(e,s,o),r++}}return r}function jb(t){return t===3||t===4||t===6}function nL(t){return t.charCodeAt(0)===64}function Uu(t,e){if(!(e===null||e.length===0))if(t===null||t.length===0)t=e.slice();else{let n=-1;for(let r=0;r<e.length;r++){let i=e[r];typeof i=="number"?n=i:n===0||(n===-1||n===2?KT(t,n,i,null,e[++r]):KT(t,n,i,null,null))}}return t}function KT(t,e,n,r,i){let s=0,o=t.length;if(e===-1)o=-1;else for(;s<t.length;){let a=t[s++];if(typeof a=="number"){if(a===e){o=-1;break}else if(a>e){o=s-1;break}}}for(;s<t.length;){let a=t[s];if(typeof a=="number")break;if(a===n){if(r===null){i!==null&&(t[s+1]=i);return}else if(r===t[s+1]){t[s+2]=i;return}}s++,r!==null&&s++,i!==null&&s++}o!==-1&&(t.splice(o,0,e),s=o+1),t.splice(s++,0,n),r!==null&&t.splice(s++,0,r),i!==null&&t.splice(s++,0,i)}var Ub="ng-template";function rL(t,e,n){let r=0,i=!0;for(;r<t.length;){let s=t[r++];if(typeof s=="string"&&i){let o=t[r++];if(n&&s==="class"&&Lb(o.toLowerCase(),e,0)!==-1)return!0}else if(s===1){for(;r<t.length&&typeof(s=t[r++])=="string";)if(s.toLowerCase()===e)return!0;return!1}else typeof s=="number"&&(i=!1)}return!1}function Bb(t){return t.type===4&&t.value!==Ub}function iL(t,e,n){let r=t.type===4&&!n?Ub:t.value;return e===r}function sL(t,e,n){let r=4,i=t.attrs||[],s=uL(i),o=!1;for(let a=0;a<e.length;a++){let u=e[a];if(typeof u=="number"){if(!o&&!Pn(r)&&!Pn(u))return!1;if(o&&Pn(u))continue;o=!1,r=u|r&1;continue}if(!o)if(r&4){if(r=2|r&1,u!==""&&!iL(t,u,n)||u===""&&e.length===1){if(Pn(r))return!1;o=!0}}else{let c=r&8?u:e[++a];if(r&8&&t.attrs!==null){if(!rL(t.attrs,c,n)){if(Pn(r))return!1;o=!0}continue}let l=r&8?"class":u,d=oL(l,i,Bb(t),n);if(d===-1){if(Pn(r))return!1;o=!0;continue}if(c!==""){let h;d>s?h="":h=i[d+1].toLowerCase();let f=r&8?h:null;if(f&&Lb(f,c,0)!==-1||r&2&&c!==h){if(Pn(r))return!1;o=!0}}}}return Pn(r)||o}function Pn(t){return(t&1)===0}function oL(t,e,n,r){if(e===null)return-1;let i=0;if(r||!n){let s=!1;for(;i<e.length;){let o=e[i];if(o===t)return i;if(o===3||o===6)s=!0;else if(o===1||o===2){let a=e[++i];for(;typeof a=="string";)a=e[++i];continue}else{if(o===4)break;if(o===0){i+=4;continue}}i+=s?1:2}return-1}else return cL(e,t)}function aL(t,e,n=!1){for(let r=0;r<e.length;r++)if(sL(t,e[r],n))return!0;return!1}function uL(t){for(let e=0;e<t.length;e++){let n=t[e];if(jb(n))return e}return t.length}function cL(t,e){let n=t.indexOf(4);if(n>-1)for(n++;n<t.length;){let r=t[n];if(typeof r=="number")return-1;if(r===e)return n;n++}return-1}function QT(t,e){return t?":not("+e.trim()+")":e}function lL(t){let e=t[0],n=1,r=2,i="",s=!1;for(;n<t.length;){let o=t[n];if(typeof o=="string")if(r&2){let a=t[++n];i+="["+o+(a.length>0?'="'+a+'"':"")+"]"}else r&8?i+="."+o:r&4&&(i+=" "+o);else i!==""&&!Pn(o)&&(e+=QT(s,i),i=""),r=o,s=s||!Pn(r);n++}return i!==""&&(e+=QT(s,i)),e}function dL(t){return t.map(lL).join(",")}function hL(t){let e=[],n=[],r=1,i=2;for(;r<t.length;){let s=t[r];if(typeof s=="string")i===2?s!==""&&e.push(s,t[++r]):i===8&&n.push(s);else{if(!Pn(i))break;i=s}r++}return{attrs:e,classes:n}}function At(t){return Yu(()=>{let e=zb(t),n=ue(x({},e),{decls:t.decls,vars:t.vars,template:t.template,consts:t.consts||null,ngContentSelectors:t.ngContentSelectors,onPush:t.changeDetection===Vb.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&t.dependencies||null,getStandaloneInjector:null,signals:t.signals??!1,data:t.data||{},encapsulation:t.encapsulation||Jn.Emulated,styles:t.styles||yn,_:null,schemas:t.schemas||null,tView:null,id:""});Wb(n);let r=t.dependencies;return n.directiveDefs=ZT(r,!1),n.pipeDefs=ZT(r,!0),n.id=gL(n),n})}function fL(t){return ii(t)||$b(t)}function pL(t){return t!==null}function et(t){return Yu(()=>({type:t.type,bootstrap:t.bootstrap||yn,declarations:t.declarations||yn,imports:t.imports||yn,exports:t.exports||yn,transitiveCompileScopes:null,schemas:t.schemas||null,id:t.id||null}))}function YT(t,e){if(t==null)return Lo;let n={};for(let r in t)if(t.hasOwnProperty(r)){let i=t[r],s,o,a=Vt.None;Array.isArray(i)?(a=i[0],s=i[1],o=i[2]??s):(s=i,o=i),e?(n[s]=a!==Vt.None?[r,a]:r,e[s]=o):n[s]=r}return n}function Lt(t){return Yu(()=>{let e=zb(t);return Wb(e),e})}function ii(t){return t[jV]||null}function $b(t){return t[UV]||null}function Hb(t){return t[BV]||null}function qb(t){let e=ii(t)||$b(t)||Hb(t);return e!==null?e.standalone:!1}function Gb(t,e){let n=t[$V]||null;if(!n&&e===!0)throw new Error(`Type ${Qt(t)} does not have '\u0275mod' property.`);return n}function zb(t){let e={};return{type:t.type,providersResolver:null,factory:null,hostBindings:t.hostBindings||null,hostVars:t.hostVars||0,hostAttrs:t.hostAttrs||null,contentQueries:t.contentQueries||null,declaredInputs:e,inputTransforms:null,inputConfig:t.inputs||Lo,exportAs:t.exportAs||null,standalone:t.standalone===!0,signals:t.signals===!0,selectors:t.selectors||yn,viewQuery:t.viewQuery||null,features:t.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:YT(t.inputs,e),outputs:YT(t.outputs),debugInfo:null}}function Wb(t){t.features?.forEach(e=>e(t))}function ZT(t,e){if(!t)return null;let n=e?Hb:fL;return()=>(typeof t=="function"?t():t).map(r=>n(r)).filter(pL)}function gL(t){let e=0,n=[t.selectors,t.ngContentSelectors,t.hostVars,t.hostAttrs,t.consts,t.vars,t.decls,t.encapsulation,t.standalone,t.signals,t.exportAs,JSON.stringify(t.inputs),JSON.stringify(t.outputs),Object.getOwnPropertyNames(t.type.prototype),!!t.contentQueries,!!t.viewQuery].join("|");for(let i of n)e=Math.imul(31,e)+i.charCodeAt(0)<<0;return e+=2147483648,"c"+e}var Nr=0,fe=1,z=2,St=3,kn=4,Fn=5,Eh=6,Bu=7,On=8,jo=9,xr=10,It=11,$u=12,XT=13,zo=14,er=15,qh=16,No=17,Hu=18,Gh=19,Kb=20,ri=21,ly=22,as=23,si=25,Qb=1;var us=7,Ih=8,Ch=9,_n=10,f_=function(t){return t[t.None=0]="None",t[t.HasTransplantedViews=2]="HasTransplantedViews",t}(f_||{});function ss(t){return Array.isArray(t)&&typeof t[Qb]=="object"}function Pr(t){return Array.isArray(t)&&t[Qb]===!0}function Yb(t){return(t.flags&4)!==0}function zh(t){return t.componentOffset>-1}function p_(t){return(t.flags&1)===1}function oi(t){return!!t.template}function mL(t){return(t[z]&512)!==0}function Uo(t,e){let n=t.hasOwnProperty(vh);return n?t[vh]:null}var Ay=class{constructor(e,n,r){this.previousValue=e,this.currentValue=n,this.firstChange=r}isFirstChange(){return this.firstChange}};function Zb(t,e,n,r){e!==null?e.applyValueToInputSignal(e,r):t[n]=r}function gs(){return Xb}function Xb(t){return t.type.prototype.ngOnChanges&&(t.setInput=_L),yL}gs.ngInherit=!0;function yL(){let t=eS(this),e=t?.current;if(e){let n=t.previous;if(n===Lo)t.previous=e;else for(let r in e)n[r]=e[r];t.current=null,this.ngOnChanges(e)}}function _L(t,e,n,r,i){let s=this.declaredInputs[r],o=eS(t)||vL(t,{previous:Lo,current:null}),a=o.current||(o.current={}),u=o.previous,c=u[s];a[s]=new Ay(c&&c.currentValue,n,u===Lo),Zb(t,e,i,n)}var Jb="__ngSimpleChanges__";function eS(t){return t[Jb]||null}function vL(t,e){return t[Jb]=e}var JT=null;var Zn=function(t,e,n){JT?.(t,e,n)},wL="svg",EL="math",IL=!1;function CL(){return IL}function tr(t){for(;Array.isArray(t);)t=t[Nr];return t}function tS(t,e){return tr(e[t])}function vn(t,e){return tr(e[t.index])}function nS(t,e){return t.data[e]}function ui(t,e){let n=e[t];return ss(n)?n:n[Nr]}function g_(t){return(t[z]&128)===128}function DL(t){return Pr(t[St])}function Dh(t,e){return e==null?null:t[e]}function rS(t){t[No]=0}function TL(t){t[z]&1024||(t[z]|=1024,g_(t)&&qu(t))}function bL(t,e){for(;t>0;)e=e[zo],t--;return e}function m_(t){return!!(t[z]&9216||t[as]?.dirty)}function xy(t){m_(t)?qu(t):t[z]&64&&(CL()?(t[z]|=1024,qu(t)):t[xr].changeDetectionScheduler?.notify())}function qu(t){t[xr].changeDetectionScheduler?.notify();let e=Gu(t);for(;e!==null&&!(e[z]&8192||(e[z]|=8192,!g_(e)));)e=Gu(e)}function iS(t,e){if((t[z]&256)===256)throw new $(911,!1);t[ri]===null&&(t[ri]=[]),t[ri].push(e)}function SL(t,e){if(t[ri]===null)return;let n=t[ri].indexOf(e);n!==-1&&t[ri].splice(n,1)}function Gu(t){let e=t[St];return Pr(e)?e[St]:e}var de={lFrame:dS(null),bindingsEnabled:!0,skipHydrationRootTNode:null};function AL(){return de.lFrame.elementDepthCount}function xL(){de.lFrame.elementDepthCount++}function ML(){de.lFrame.elementDepthCount--}function sS(){return de.bindingsEnabled}function RL(){return de.skipHydrationRootTNode!==null}function NL(t){return de.skipHydrationRootTNode===t}function PL(){de.skipHydrationRootTNode=null}function Ve(){return de.lFrame.lView}function Vn(){return de.lFrame.tView}function Wo(t){return de.lFrame.contextLView=t,t[On]}function Ko(t){return de.lFrame.contextLView=null,t}function tn(){let t=oS();for(;t!==null&&t.type===64;)t=t.parent;return t}function oS(){return de.lFrame.currentTNode}function kL(){let t=de.lFrame,e=t.currentTNode;return t.isParent?e:e.parent}function Zu(t,e){let n=de.lFrame;n.currentTNode=t,n.isParent=e}function aS(){return de.lFrame.isParent}function OL(){de.lFrame.isParent=!1}function FL(t){return de.lFrame.bindingIndex=t}function y_(){return de.lFrame.bindingIndex++}function VL(t){let e=de.lFrame,n=e.bindingIndex;return e.bindingIndex=e.bindingIndex+t,n}function LL(){return de.lFrame.inI18n}function jL(t,e){let n=de.lFrame;n.bindingIndex=n.bindingRootIndex=t,My(e)}function UL(){return de.lFrame.currentDirectiveIndex}function My(t){de.lFrame.currentDirectiveIndex=t}function BL(t){let e=de.lFrame.currentDirectiveIndex;return e===-1?null:t[e]}function uS(t){de.lFrame.currentQueryIndex=t}function $L(t){let e=t[fe];return e.type===2?e.declTNode:e.type===1?t[Fn]:null}function cS(t,e,n){if(n&se.SkipSelf){let i=e,s=t;for(;i=i.parent,i===null&&!(n&se.Host);)if(i=$L(s),i===null||(s=s[zo],i.type&10))break;if(i===null)return!1;e=i,t=s}let r=de.lFrame=lS();return r.currentTNode=e,r.lView=t,!0}function __(t){let e=lS(),n=t[fe];de.lFrame=e,e.currentTNode=n.firstChild,e.lView=t,e.tView=n,e.contextLView=t,e.bindingIndex=n.bindingStartIndex,e.inI18n=!1}function lS(){let t=de.lFrame,e=t===null?null:t.child;return e===null?dS(t):e}function dS(t){let e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:t,child:null,inI18n:!1};return t!==null&&(t.child=e),e}function hS(){let t=de.lFrame;return de.lFrame=t.parent,t.currentTNode=null,t.lView=null,t}var fS=hS;function v_(){let t=hS();t.isParent=!0,t.tView=null,t.selectedIndex=-1,t.contextLView=null,t.elementDepthCount=0,t.currentDirectiveIndex=-1,t.currentNamespace=null,t.bindingRootIndex=-1,t.bindingIndex=-1,t.currentQueryIndex=0}function HL(t){return(de.lFrame.contextLView=bL(t,de.lFrame.contextLView))[On]}function Qo(){return de.lFrame.selectedIndex}function cs(t){de.lFrame.selectedIndex=t}function pS(){let t=de.lFrame;return nS(t.tView,t.selectedIndex)}function qL(){return de.lFrame.currentNamespace}var gS=!0;function w_(){return gS}function E_(t){gS=t}function GL(t,e,n){let{ngOnChanges:r,ngOnInit:i,ngDoCheck:s}=e.type.prototype;if(r){let o=Xb(e);(n.preOrderHooks??=[]).push(t,o),(n.preOrderCheckHooks??=[]).push(t,o)}i&&(n.preOrderHooks??=[]).push(0-t,i),s&&((n.preOrderHooks??=[]).push(t,s),(n.preOrderCheckHooks??=[]).push(t,s))}function I_(t,e){for(let n=e.directiveStart,r=e.directiveEnd;n<r;n++){let s=t.data[n].type.prototype,{ngAfterContentInit:o,ngAfterContentChecked:a,ngAfterViewInit:u,ngAfterViewChecked:c,ngOnDestroy:l}=s;o&&(t.contentHooks??=[]).push(-n,o),a&&((t.contentHooks??=[]).push(n,a),(t.contentCheckHooks??=[]).push(n,a)),u&&(t.viewHooks??=[]).push(-n,u),c&&((t.viewHooks??=[]).push(n,c),(t.viewCheckHooks??=[]).push(n,c)),l!=null&&(t.destroyHooks??=[]).push(n,l)}}function ph(t,e,n){mS(t,e,3,n)}function gh(t,e,n,r){(t[z]&3)===n&&mS(t,e,n,r)}function dy(t,e){let n=t[z];(n&3)===e&&(n&=16383,n+=1,t[z]=n)}function mS(t,e,n,r){let i=r!==void 0?t[No]&65535:0,s=r??-1,o=e.length-1,a=0;for(let u=i;u<o;u++)if(typeof e[u+1]=="number"){if(a=e[u],r!=null&&a>=r)break}else e[u]<0&&(t[No]+=65536),(a<s||s==-1)&&(zL(t,n,e,u),t[No]=(t[No]&4294901760)+u+2),u++}function eb(t,e){Zn(4,t,e);let n=Jt(null);try{e.call(t)}finally{Jt(n),Zn(5,t,e)}}function zL(t,e,n,r){let i=n[r]<0,s=n[r+1],o=i?-n[r]:n[r],a=t[o];i?t[z]>>14<t[No]>>16&&(t[z]&3)===e&&(t[z]+=16384,eb(a,s)):eb(a,s)}var Vo=-1,ls=class{constructor(e,n,r){this.factory=e,this.resolving=!1,this.canSeeViewProviders=n,this.injectImpl=r}};function WL(t){return t instanceof ls}function KL(t){return(t.flags&8)!==0}function QL(t){return(t.flags&16)!==0}function yS(t){return t!==Vo}function Th(t){return t&32767}function YL(t){return t>>16}function bh(t,e){let n=YL(t),r=e;for(;n>0;)r=r[zo],n--;return r}var Ry=!0;function tb(t){let e=Ry;return Ry=t,e}var ZL=256,_S=ZL-1,vS=5,XL=0,Xn={};function JL(t,e,n){let r;typeof n=="string"?r=n.charCodeAt(0)||0:n.hasOwnProperty(Vu)&&(r=n[Vu]),r==null&&(r=n[Vu]=XL++);let i=r&_S,s=1<<i;e.data[t+(i>>vS)]|=s}function Sh(t,e){let n=wS(t,e);if(n!==-1)return n;let r=e[fe];r.firstCreatePass&&(t.injectorIndex=e.length,hy(r.data,t),hy(e,null),hy(r.blueprint,null));let i=C_(t,e),s=t.injectorIndex;if(yS(i)){let o=Th(i),a=bh(i,e),u=a[fe].data;for(let c=0;c<8;c++)e[s+c]=a[o+c]|u[o+c]}return e[s+8]=i,s}function hy(t,e){t.push(0,0,0,0,0,0,0,0,e)}function wS(t,e){return t.injectorIndex===-1||t.parent&&t.parent.injectorIndex===t.injectorIndex||e[t.injectorIndex+8]===null?-1:t.injectorIndex}function C_(t,e){if(t.parent&&t.parent.injectorIndex!==-1)return t.parent.injectorIndex;let n=0,r=null,i=e;for(;i!==null;){if(r=TS(i),r===null)return Vo;if(n++,i=i[zo],r.injectorIndex!==-1)return r.injectorIndex|n<<16}return Vo}function Ny(t,e,n){JL(t,e,n)}function e2(t,e){if(e==="class")return t.classes;if(e==="style")return t.styles;let n=t.attrs;if(n){let r=n.length,i=0;for(;i<r;){let s=n[i];if(jb(s))break;if(s===0)i=i+2;else if(typeof s=="number")for(i++;i<r&&typeof n[i]=="string";)i++;else{if(s===e)return n[i+1];i=i+2}}}return null}function ES(t,e,n){if(n&se.Optional||t!==void 0)return t;h_(e,"NodeInjector")}function IS(t,e,n,r){if(n&se.Optional&&r===void 0&&(r=null),!(n&(se.Self|se.Host))){let i=t[jo],s=mn(void 0);try{return i?i.get(e,r,n&se.Optional):Ob(e,r,n&se.Optional)}finally{mn(s)}}return ES(r,e,n)}function CS(t,e,n,r=se.Default,i){if(t!==null){if(e[z]&2048&&!(r&se.Self)){let o=s2(t,e,n,r,Xn);if(o!==Xn)return o}let s=DS(t,e,n,r,Xn);if(s!==Xn)return s}return IS(e,n,r,i)}function DS(t,e,n,r,i){let s=r2(n);if(typeof s=="function"){if(!cS(e,t,r))return r&se.Host?ES(i,n,r):IS(e,n,r,i);try{let o;if(o=s(r),o==null&&!(r&se.Optional))h_(n);else return o}finally{fS()}}else if(typeof s=="number"){let o=null,a=wS(t,e),u=Vo,c=r&se.Host?e[er][Fn]:null;for((a===-1||r&se.SkipSelf)&&(u=a===-1?C_(t,e):e[a+8],u===Vo||!rb(r,!1)?a=-1:(o=e[fe],a=Th(u),e=bh(u,e)));a!==-1;){let l=e[fe];if(nb(s,a,l.data)){let d=t2(a,e,n,o,r,c);if(d!==Xn)return d}u=e[a+8],u!==Vo&&rb(r,e[fe].data[a+8]===c)&&nb(s,a,e)?(o=l,a=Th(u),e=bh(u,e)):a=-1}}return i}function t2(t,e,n,r,i,s){let o=e[fe],a=o.data[t+8],u=r==null?zh(a)&&Ry:r!=o&&(a.type&3)!==0,c=i&se.Host&&s===a,l=n2(a,o,n,u,c);return l!==null?Bo(e,o,l,a):Xn}function n2(t,e,n,r,i){let s=t.providerIndexes,o=e.data,a=s&1048575,u=t.directiveStart,c=t.directiveEnd,l=s>>20,d=r?a:a+l,h=i?a+l:c;for(let f=d;f<h;f++){let p=o[f];if(f<u&&n===p||f>=u&&p.type===n)return f}if(i){let f=o[u];if(f&&oi(f)&&f.type===n)return u}return null}function Bo(t,e,n,r){let i=t[n],s=e.data;if(WL(i)){let o=i;o.resolving&&qV(HV(s[n]));let a=tb(o.canSeeViewProviders);o.resolving=!0;let u,c=o.injectImpl?mn(o.injectImpl):null,l=cS(t,r,se.Default);try{i=t[n]=o.factory(void 0,s,t,r),e.firstCreatePass&&n>=r.directiveStart&&GL(n,s[n],e)}finally{c!==null&&mn(c),tb(a),o.resolving=!1,fS()}}return i}function r2(t){if(typeof t=="string")return t.charCodeAt(0)||0;let e=t.hasOwnProperty(Vu)?t[Vu]:void 0;return typeof e=="number"?e>=0?e&_S:i2:e}function nb(t,e,n){let r=1<<t;return!!(n[e+(t>>vS)]&r)}function rb(t,e){return!(t&se.Self)&&!(t&se.Host&&e)}var os=class{constructor(e,n){this._tNode=e,this._lView=n}get(e,n,r){return CS(this._tNode,this._lView,e,Hh(r),n)}};function i2(){return new os(tn(),Ve())}function ms(t){return Yu(()=>{let e=t.prototype.constructor,n=e[vh]||Py(e),r=Object.prototype,i=Object.getPrototypeOf(t.prototype).constructor;for(;i&&i!==r;){let s=i[vh]||Py(i);if(s&&s!==n)return s;i=Object.getPrototypeOf(i)}return s=>new s})}function Py(t){return xb(t)?()=>{let e=Py(Ot(t));return e&&e()}:Uo(t)}function s2(t,e,n,r,i){let s=t,o=e;for(;s!==null&&o!==null&&o[z]&2048&&!(o[z]&512);){let a=DS(s,o,n,r|se.Self,Xn);if(a!==Xn)return a;let u=s.parent;if(!u){let c=o[Kb];if(c){let l=c.get(n,Xn,r);if(l!==Xn)return l}u=TS(o),o=o[zo]}s=u}return i}function TS(t){let e=t[fe],n=e.type;return n===2?e.declTNode:n===1?t[Fn]:null}function D_(t){return e2(tn(),t)}var ch="__parameters__";function o2(t){return function(...n){if(t){let r=t(...n);for(let i in r)this[i]=r[i]}}}function bS(t,e,n){return Yu(()=>{let r=o2(e);function i(...s){if(this instanceof i)return r.apply(this,s),this;let o=new i(...s);return a.annotation=o,a;function a(u,c,l){let d=u.hasOwnProperty(ch)?u[ch]:Object.defineProperty(u,ch,{value:[]})[ch];for(;d.length<=l;)d.push(null);return(d[l]=d[l]||[]).push(o),u}}return n&&(i.prototype=Object.create(n.prototype)),i.prototype.ngMetadataName=t,i.annotationCls=i,i})}function a2(t){let e=Ft.ng;if(e&&e.\u0275compilerFacade)return e.\u0275compilerFacade;throw new Error("JIT compiler unavailable")}function u2(t){return typeof t=="function"}function T_(t,e){t.forEach(n=>Array.isArray(n)?T_(n,e):e(n))}function SS(t,e,n){e>=t.length?t.push(n):t.splice(e,0,n)}function Ah(t,e){return e>=t.length-1?t.pop():t.splice(e,1)[0]}function c2(t,e,n,r){let i=t.length;if(i==e)t.push(n,r);else if(i===1)t.push(r,t[0]),t[0]=n;else{for(i--,t.push(t[i-1],t[i]);i>e;){let s=i-2;t[i]=t[s],i--}t[e]=n,t[e+1]=r}}function l2(t,e,n){let r=Xu(t,e);return r>=0?t[r|1]=n:(r=~r,c2(t,r,e,n)),r}function fy(t,e){let n=Xu(t,e);if(n>=0)return t[n|1]}function Xu(t,e){return d2(t,e,1)}function d2(t,e,n){let r=0,i=t.length>>n;for(;i!==r;){let s=r+(i-r>>1),o=t[s<<n];if(e===o)return s<<n;o>e?i=s:r=s+1}return~(i<<n)}var Yo=Fb(bS("Optional"),8);var b_=Fb(bS("SkipSelf"),4);function h2(t){let e=[],n=new Map;function r(i){let s=n.get(i);if(!s){let o=t(i);n.set(i,s=o.then(m2))}return s}return xh.forEach((i,s)=>{let o=[];i.templateUrl&&o.push(r(i.templateUrl).then(c=>{i.template=c}));let a=typeof i.styles=="string"?[i.styles]:i.styles||[];if(i.styles=a,i.styleUrl&&i.styleUrls?.length)throw new Error("@Component cannot define both `styleUrl` and `styleUrls`. Use `styleUrl` if the component has one stylesheet, or `styleUrls` if it has multiple");if(i.styleUrls?.length){let c=i.styles.length,l=i.styleUrls;i.styleUrls.forEach((d,h)=>{a.push(""),o.push(r(d).then(f=>{a[c+h]=f,l.splice(l.indexOf(d),1),l.length==0&&(i.styleUrls=void 0)}))})}else i.styleUrl&&o.push(r(i.styleUrl).then(c=>{a.push(c),i.styleUrl=void 0}));let u=Promise.all(o).then(()=>y2(s));e.push(u)}),p2(),Promise.all(e).then(()=>{})}var xh=new Map,f2=new Set;function p2(){let t=xh;return xh=new Map,t}function g2(){return xh.size===0}function m2(t){return typeof t=="string"?t:t.text()}function y2(t){f2.delete(t)}var $o=new F(""),AS=new F("",-1),xS=new F(""),Mh=class{get(e,n=ju){if(n===ju){let r=new Error(`NullInjectorError: No provider for ${Qt(e)}!`);throw r.name="NullInjectorError",r}return n}};function _2(...t){return{\u0275providers:MS(!0,t),\u0275fromNgModule:!0}}function MS(t,...e){let n=[],r=new Set,i,s=o=>{n.push(o)};return T_(e,o=>{let a=o;ky(a,s,[],r)&&(i||=[],i.push(a))}),i!==void 0&&RS(i,s),n}function RS(t,e){for(let n=0;n<t.length;n++){let{ngModule:r,providers:i}=t[n];S_(i,s=>{e(s,r)})}}function ky(t,e,n,r){if(t=Ot(t),!t)return!1;let i=null,s=GT(t),o=!s&&ii(t);if(!s&&!o){let u=t.ngModule;if(s=GT(u),s)i=u;else return!1}else{if(o&&!o.standalone)return!1;i=t}let a=r.has(i);if(o){if(a)return!1;if(r.add(i),o.dependencies){let u=typeof o.dependencies=="function"?o.dependencies():o.dependencies;for(let c of u)ky(c,e,n,r)}}else if(s){if(s.imports!=null&&!a){r.add(i);let c;try{T_(s.imports,l=>{ky(l,e,n,r)&&(c||=[],c.push(l))})}finally{}c!==void 0&&RS(c,e)}if(!a){let c=Uo(i)||(()=>new i);e({provide:i,useFactory:c,deps:yn},i),e({provide:xS,useValue:i,multi:!0},i),e({provide:$o,useValue:()=>C(i),multi:!0},i)}let u=s.providers;if(u!=null&&!a){let c=t;S_(u,l=>{e(l,c)})}}else return!1;return i!==t&&t.providers!==void 0}function S_(t,e){for(let n of t)Mb(n)&&(n=n.\u0275providers),Array.isArray(n)?S_(n,e):e(n)}var v2=be({provide:String,useValue:be});function NS(t){return t!==null&&typeof t=="object"&&v2 in t}function w2(t){return!!(t&&t.useExisting)}function E2(t){return!!(t&&t.useFactory)}function Ho(t){return typeof t=="function"}function I2(t){return!!t.useClass}var Wh=new F(""),mh={},C2={},py;function A_(){return py===void 0&&(py=new Mh),py}var en=class{},zu=class extends en{get destroyed(){return this._destroyed}constructor(e,n,r,i){super(),this.parent=n,this.source=r,this.scopes=i,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,Fy(e,o=>this.processProvider(o)),this.records.set(AS,Po(void 0,this)),i.has("environment")&&this.records.set(en,Po(void 0,this));let s=this.records.get(Wh);s!=null&&typeof s.value=="string"&&this.scopes.add(s.value),this.injectorDefTypes=new Set(this.get(xS,yn,se.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(let n of this._ngOnDestroyHooks)n.ngOnDestroy();let e=this._onDestroyHooks;this._onDestroyHooks=[];for(let n of e)n()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear()}}onDestroy(e){return this.assertNotDestroyed(),this._onDestroyHooks.push(e),()=>this.removeOnDestroy(e)}runInContext(e){this.assertNotDestroyed();let n=ni(this),r=mn(void 0),i;try{return e()}finally{ni(n),mn(r)}}get(e,n=ju,r=se.Default){if(this.assertNotDestroyed(),e.hasOwnProperty(HT))return e[HT](this);r=Hh(r);let i,s=ni(this),o=mn(void 0);try{if(!(r&se.SkipSelf)){let u=this.records.get(e);if(u===void 0){let c=A2(e)&&$h(e);c&&this.injectableDefInScope(c)?u=Po(Oy(e),mh):u=null,this.records.set(e,u)}if(u!=null)return this.hydrate(e,u)}let a=r&se.Self?A_():this.parent;return n=r&se.Optional&&n===ju?null:n,a.get(e,n)}catch(a){if(a.name==="NullInjectorError"){if((a[wh]=a[wh]||[]).unshift(Qt(e)),s)throw a;return eL(a,e,"R3InjectorError",this.source)}else throw a}finally{mn(o),ni(s)}}resolveInjectorInitializers(){let e=ni(this),n=mn(void 0),r;try{let i=this.get($o,yn,se.Self);for(let s of i)s()}finally{ni(e),mn(n)}}toString(){let e=[],n=this.records;for(let r of n.keys())e.push(Qt(r));return`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new $(205,!1)}processProvider(e){e=Ot(e);let n=Ho(e)?e:Ot(e&&e.provide),r=T2(e);if(!Ho(e)&&e.multi===!0){let i=this.records.get(n);i||(i=Po(void 0,mh,!0),i.factory=()=>by(i.multi),this.records.set(n,i)),n=e,i.multi.push(e)}this.records.set(n,r)}hydrate(e,n){return n.value===mh&&(n.value=C2,n.value=n.factory()),typeof n.value=="object"&&n.value&&S2(n.value)&&this._ngOnDestroyHooks.add(n.value),n.value}injectableDefInScope(e){if(!e.providedIn)return!1;let n=Ot(e.providedIn);return typeof n=="string"?n==="any"||this.scopes.has(n):this.injectorDefTypes.has(n)}removeOnDestroy(e){let n=this._onDestroyHooks.indexOf(e);n!==-1&&this._onDestroyHooks.splice(n,1)}};function Oy(t){let e=$h(t),n=e!==null?e.factory:Uo(t);if(n!==null)return n;if(t instanceof F)throw new $(204,!1);if(t instanceof Function)return D2(t);throw new $(204,!1)}function D2(t){if(t.length>0)throw new $(204,!1);let n=GV(t);return n!==null?()=>n.factory(t):()=>new t}function T2(t){if(NS(t))return Po(void 0,t.useValue);{let e=PS(t);return Po(e,mh)}}function PS(t,e,n){let r;if(Ho(t)){let i=Ot(t);return Uo(i)||Oy(i)}else if(NS(t))r=()=>Ot(t.useValue);else if(E2(t))r=()=>t.useFactory(...by(t.deps||[]));else if(w2(t))r=()=>C(Ot(t.useExisting));else{let i=Ot(t&&(t.useClass||t.provide));if(b2(t))r=()=>new i(...by(t.deps));else return Uo(i)||Oy(i)}return r}function Po(t,e,n=!1){return{factory:t,value:e,multi:n?[]:void 0}}function b2(t){return!!t.deps}function S2(t){return t!==null&&typeof t=="object"&&typeof t.ngOnDestroy=="function"}function A2(t){return typeof t=="function"||typeof t=="object"&&t instanceof F}function Fy(t,e){for(let n of t)Array.isArray(n)?Fy(n,e):n&&Mb(n)?Fy(n.\u0275providers,e):e(n)}function ci(t,e){t instanceof zu&&t.assertNotDestroyed();let n,r=ni(t),i=mn(void 0);try{return e()}finally{ni(r),mn(i)}}function x2(t){if(!kb()&&!ZV())throw new $(-203,!1)}function ib(t,e=null,n=null,r){let i=kS(t,e,n,r);return i.resolveInjectorInitializers(),i}function kS(t,e=null,n=null,r,i=new Set){let s=[n||yn,_2(t)];return r=r||(typeof t=="object"?void 0:Qt(t)),new zu(s,e||A_(),r||null,i)}var Ln=(()=>{let e=class e{static create(r,i){if(Array.isArray(r))return ib({name:""},i,r,"");{let s=r.name??"";return ib({name:s},r.parent,r.providers,s)}}};e.THROW_IF_NOT_FOUND=ju,e.NULL=new Mh,e.\u0275prov=V({token:e,providedIn:"any",factory:()=>C(AS)}),e.__NG_ELEMENT_ID__=-1;let t=e;return t})();var Vy;function OS(t){Vy=t}function M2(){if(Vy!==void 0)return Vy;if(typeof document<"u")return document;throw new $(210,!1)}var Kh=new F("",{providedIn:"root",factory:()=>R2}),R2="ng",x_=new F(""),xt=new F("",{providedIn:"platform",factory:()=>"unknown"});var M_=new F("",{providedIn:"root",factory:()=>M2().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});function FS(t){return t instanceof Function?t():t}function N2(t){return(t??k(Ln)).get(xt)==="browser"}function VS(t){return(t.flags&128)===128}var Mr=function(t){return t[t.Important=1]="Important",t[t.DashCase=2]="DashCase",t}(Mr||{});var LS=new Map,P2=0;function k2(){return P2++}function O2(t){LS.set(t[Gh],t)}function F2(t){LS.delete(t[Gh])}var sb="__ngContext__";function ds(t,e){ss(e)?(t[sb]=e[Gh],O2(e)):t[sb]=e}var V2;function R_(t,e){return V2(t,e)}function ko(t,e,n,r,i){if(r!=null){let s,o=!1;Pr(r)?s=r:ss(r)&&(o=!0,r=r[Nr]);let a=tr(r);t===0&&n!==null?i==null?HS(e,n,a):Rh(e,n,a,i||null,!0):t===1&&n!==null?Rh(e,n,a,i||null,!0):t===2?ej(e,a,o):t===3&&e.destroyNode(a),s!=null&&nj(e,t,s,n,i)}}function L2(t,e){return t.createText(e)}function j2(t,e,n){t.setValue(e,n)}function jS(t,e,n){return t.createElement(e,n)}function U2(t,e){US(t,e),e[Nr]=null,e[Fn]=null}function B2(t,e,n,r,i,s){r[Nr]=i,r[Fn]=e,Qh(t,r,n,1,i,s)}function US(t,e){Qh(t,e,e[It],2,null,null)}function $2(t){let e=t[$u];if(!e)return gy(t[fe],t);for(;e;){let n=null;if(ss(e))n=e[$u];else{let r=e[_n];r&&(n=r)}if(!n){for(;e&&!e[kn]&&e!==t;)ss(e)&&gy(e[fe],e),e=e[St];e===null&&(e=t),ss(e)&&gy(e[fe],e),n=e&&e[kn]}e=n}}function H2(t,e,n,r){let i=_n+r,s=n.length;r>0&&(n[i-1][kn]=e),r<s-_n?(e[kn]=n[i],SS(n,_n+r,e)):(n.push(e),e[kn]=null),e[St]=n;let o=e[qh];o!==null&&n!==o&&q2(o,e);let a=e[Hu];a!==null&&a.insertView(t),xy(e),e[z]|=128}function q2(t,e){let n=t[Ch],i=e[St][St][er];e[er]!==i&&(t[z]|=f_.HasTransplantedViews),n===null?t[Ch]=[e]:n.push(e)}function BS(t,e){let n=t[Ch],r=n.indexOf(e);n.splice(r,1)}function Ly(t,e){if(t.length<=_n)return;let n=_n+e,r=t[n];if(r){let i=r[qh];i!==null&&i!==t&&BS(i,r),e>0&&(t[n-1][kn]=r[kn]);let s=Ah(t,_n+e);U2(r[fe],r);let o=s[Hu];o!==null&&o.detachView(s[fe]),r[St]=null,r[kn]=null,r[z]&=-129}return r}function $S(t,e){if(!(e[z]&256)){let n=e[It];n.destroyNode&&Qh(t,e,n,3,null,null),$2(e)}}function gy(t,e){if(!(e[z]&256)){e[z]&=-129,e[z]|=256,e[as]&&wT(e[as]),z2(t,e),G2(t,e),e[fe].type===1&&e[It].destroy();let n=e[qh];if(n!==null&&Pr(e[St])){n!==e[St]&&BS(n,e);let r=e[Hu];r!==null&&r.detachView(t)}F2(e)}}function G2(t,e){let n=t.cleanup,r=e[Bu];if(n!==null)for(let s=0;s<n.length-1;s+=2)if(typeof n[s]=="string"){let o=n[s+3];o>=0?r[o]():r[-o].unsubscribe(),s+=2}else{let o=r[n[s+1]];n[s].call(o)}r!==null&&(e[Bu]=null);let i=e[ri];if(i!==null){e[ri]=null;for(let s=0;s<i.length;s++){let o=i[s];o()}}}function z2(t,e){let n;if(t!=null&&(n=t.destroyHooks)!=null)for(let r=0;r<n.length;r+=2){let i=e[n[r]];if(!(i instanceof ls)){let s=n[r+1];if(Array.isArray(s))for(let o=0;o<s.length;o+=2){let a=i[s[o]],u=s[o+1];Zn(4,a,u);try{u.call(a)}finally{Zn(5,a,u)}}else{Zn(4,i,s);try{s.call(i)}finally{Zn(5,i,s)}}}}}function W2(t,e,n){return K2(t,e.parent,n)}function K2(t,e,n){let r=e;for(;r!==null&&r.type&40;)e=r,r=e.parent;if(r===null)return n[Nr];{let{componentOffset:i}=r;if(i>-1){let{encapsulation:s}=t.data[r.directiveStart+i];if(s===Jn.None||s===Jn.Emulated)return null}return vn(r,n)}}function Rh(t,e,n,r,i){t.insertBefore(e,n,r,i)}function HS(t,e,n){t.appendChild(e,n)}function ob(t,e,n,r,i){r!==null?Rh(t,e,n,r,i):HS(t,e,n)}function Q2(t,e,n,r){t.removeChild(e,n,r)}function N_(t,e){return t.parentNode(e)}function Y2(t,e){return t.nextSibling(e)}function Z2(t,e,n){return J2(t,e,n)}function X2(t,e,n){return t.type&40?vn(t,n):null}var J2=X2,ab;function P_(t,e,n,r){let i=W2(t,r,e),s=e[It],o=r.parent||e[Fn],a=Z2(o,r,e);if(i!=null)if(Array.isArray(n))for(let u=0;u<n.length;u++)ob(s,i,n[u],a,!1);else ob(s,i,n,a,!1);ab!==void 0&&ab(s,r,e,n,i)}function yh(t,e){if(e!==null){let n=e.type;if(n&3)return vn(e,t);if(n&4)return jy(-1,t[e.index]);if(n&8){let r=e.child;if(r!==null)return yh(t,r);{let i=t[e.index];return Pr(i)?jy(-1,i):tr(i)}}else{if(n&32)return R_(e,t)()||tr(t[e.index]);{let r=qS(t,e);if(r!==null){if(Array.isArray(r))return r[0];let i=Gu(t[er]);return yh(i,r)}else return yh(t,e.next)}}}return null}function qS(t,e){if(e!==null){let r=t[er][Fn],i=e.projection;return r.projection[i]}return null}function jy(t,e){let n=_n+t+1;if(n<e.length){let r=e[n],i=r[fe].firstChild;if(i!==null)return yh(r,i)}return e[us]}function ej(t,e,n){let r=N_(t,e);r&&Q2(t,r,e,n)}function k_(t,e,n,r,i,s,o){for(;n!=null;){let a=r[n.index],u=n.type;if(o&&e===0&&(a&&ds(tr(a),r),n.flags|=2),(n.flags&32)!==32)if(u&8)k_(t,e,n.child,r,i,s,!1),ko(e,t,i,a,s);else if(u&32){let c=R_(n,r),l;for(;l=c();)ko(e,t,i,l,s);ko(e,t,i,a,s)}else u&16?tj(t,e,r,n,i,s):ko(e,t,i,a,s);n=o?n.projectionNext:n.next}}function Qh(t,e,n,r,i,s){k_(n,r,t.firstChild,e,i,s,!1)}function tj(t,e,n,r,i,s){let o=n[er],u=o[Fn].projection[r.projection];if(Array.isArray(u))for(let c=0;c<u.length;c++){let l=u[c];ko(e,t,i,l,s)}else{let c=u,l=o[St];VS(r)&&(c.flags|=128),k_(t,e,c,l,i,s,!0)}}function nj(t,e,n,r,i){let s=n[us],o=tr(n);s!==o&&ko(e,t,r,s,i);for(let a=_n;a<n.length;a++){let u=n[a];Qh(u[fe],u,t,e,r,s)}}function rj(t,e,n,r,i){if(e)i?t.addClass(n,r):t.removeClass(n,r);else{let s=r.indexOf("-")===-1?void 0:Mr.DashCase;i==null?t.removeStyle(n,r,s):(typeof i=="string"&&i.endsWith("!important")&&(i=i.slice(0,-10),s|=Mr.Important),t.setStyle(n,r,i,s))}}function ij(t,e,n){t.setAttribute(e,"style",n)}function GS(t,e,n){n===""?t.removeAttribute(e,"class"):t.setAttribute(e,"class",n)}function zS(t,e,n){let{mergedAttrs:r,classes:i,styles:s}=n;r!==null&&Sy(t,e,r),i!==null&&GS(t,e,i),s!==null&&ij(t,e,s)}var lh;function sj(){if(lh===void 0&&(lh=null,Ft.trustedTypes))try{lh=Ft.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:t=>t,createScript:t=>t,createScriptURL:t=>t})}catch{}return lh}function ub(t){return sj()?.createScriptURL(t)||t}var Nh=class{constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${Ab})`}};function Ju(t){return t instanceof Nh?t.changingThisBreaksApplicationSecurity:t}function O_(t,e){let n=oj(t);if(n!=null&&n!==e){if(n==="ResourceURL"&&e==="URL")return!0;throw new Error(`Required a safe ${e}, got a ${n} (see ${Ab})`)}return n===e}function oj(t){return t instanceof Nh&&t.getTypeName()||null}var aj=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;function WS(t){return t=String(t),t.match(aj)?t:"unsafe:"+t}var Yh=function(t){return t[t.NONE=0]="NONE",t[t.HTML=1]="HTML",t[t.STYLE=2]="STYLE",t[t.SCRIPT=3]="SCRIPT",t[t.URL=4]="URL",t[t.RESOURCE_URL=5]="RESOURCE_URL",t}(Yh||{});function uj(t){let e=QS();return e?e.sanitize(Yh.URL,t)||"":O_(t,"URL")?Ju(t):WS(Bh(t))}function cj(t){let e=QS();if(e)return ub(e.sanitize(Yh.RESOURCE_URL,t)||"");if(O_(t,"ResourceURL"))return ub(Ju(t));throw new $(904,!1)}function lj(t,e){return e==="src"&&(t==="embed"||t==="frame"||t==="iframe"||t==="media"||t==="script")||e==="href"&&(t==="base"||t==="link")?cj:uj}function KS(t,e,n){return lj(e,n)(t)}function QS(){let t=Ve();return t&&t[xr].sanitizer}var Uy=class{};var dj="h",hj="b";var fj=()=>null;function F_(t,e,n=!1){return fj(t,e,n)}var By=class{},Ph=class{};function pj(t){let e=Error(`No component factory found for ${Qt(t)}.`);return e[gj]=t,e}var gj="ngComponent";var $y=class{resolveComponentFactory(e){throw pj(e)}},Zh=(()=>{let e=class e{};e.NULL=new $y;let t=e;return t})();function mj(){return Xh(tn(),Ve())}function Xh(t,e){return new rr(vn(t,e))}var rr=(()=>{let e=class e{constructor(r){this.nativeElement=r}};e.__NG_ELEMENT_ID__=mj;let t=e;return t})();var Wu=class{},kr=(()=>{let e=class e{constructor(){this.destroyNode=null}};e.__NG_ELEMENT_ID__=()=>yj();let t=e;return t})();function yj(){let t=Ve(),e=tn(),n=ui(e.index,t);return(ss(n)?n:t)[It]}var _j=(()=>{let e=class e{};e.\u0275prov=V({token:e,providedIn:"root",factory:()=>null});let t=e;return t})(),my={};function YS(t){return wj(t)?Array.isArray(t)||!(t instanceof Map)&&Symbol.iterator in t:!1}function vj(t,e){if(Array.isArray(t))for(let n=0;n<t.length;n++)e(t[n]);else{let n=t[Symbol.iterator](),r;for(;!(r=n.next()).done;)e(r.value)}}function wj(t){return t!==null&&(typeof t=="function"||typeof t=="object")}var Hy=class{constructor(){}supports(e){return YS(e)}create(e){return new qy(e)}},Ej=(t,e)=>e,qy=class{constructor(e){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=e||Ej}forEachItem(e){let n;for(n=this._itHead;n!==null;n=n._next)e(n)}forEachOperation(e){let n=this._itHead,r=this._removalsHead,i=0,s=null;for(;n||r;){let o=!r||n&&n.currentIndex<cb(r,i,s)?n:r,a=cb(o,i,s),u=o.currentIndex;if(o===r)i--,r=r._nextRemoved;else if(n=n._next,o.previousIndex==null)i++;else{s||(s=[]);let c=a-i,l=u-i;if(c!=l){for(let h=0;h<c;h++){let f=h<s.length?s[h]:s[h]=0,p=f+h;l<=p&&p<c&&(s[h]=f+1)}let d=o.previousIndex;s[d]=l-c}}a!==u&&e(o,a,u)}}forEachPreviousItem(e){let n;for(n=this._previousItHead;n!==null;n=n._nextPrevious)e(n)}forEachAddedItem(e){let n;for(n=this._additionsHead;n!==null;n=n._nextAdded)e(n)}forEachMovedItem(e){let n;for(n=this._movesHead;n!==null;n=n._nextMoved)e(n)}forEachRemovedItem(e){let n;for(n=this._removalsHead;n!==null;n=n._nextRemoved)e(n)}forEachIdentityChange(e){let n;for(n=this._identityChangesHead;n!==null;n=n._nextIdentityChange)e(n)}diff(e){if(e==null&&(e=[]),!YS(e))throw new $(900,!1);return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let n=this._itHead,r=!1,i,s,o;if(Array.isArray(e)){this.length=e.length;for(let a=0;a<this.length;a++)s=e[a],o=this._trackByFn(a,s),n===null||!Object.is(n.trackById,o)?(n=this._mismatch(n,s,o,a),r=!0):(r&&(n=this._verifyReinsertion(n,s,o,a)),Object.is(n.item,s)||this._addIdentityChange(n,s)),n=n._next}else i=0,vj(e,a=>{o=this._trackByFn(i,a),n===null||!Object.is(n.trackById,o)?(n=this._mismatch(n,a,o,i),r=!0):(r&&(n=this._verifyReinsertion(n,a,o,i)),Object.is(n.item,a)||this._addIdentityChange(n,a)),n=n._next,i++}),this.length=i;return this._truncate(n),this.collection=e,this.isDirty}get isDirty(){return this._additionsHead!==null||this._movesHead!==null||this._removalsHead!==null||this._identityChangesHead!==null}_reset(){if(this.isDirty){let e;for(e=this._previousItHead=this._itHead;e!==null;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;e!==null;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;e!==null;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(e,n,r,i){let s;return e===null?s=this._itTail:(s=e._prev,this._remove(e)),e=this._unlinkedRecords===null?null:this._unlinkedRecords.get(r,null),e!==null?(Object.is(e.item,n)||this._addIdentityChange(e,n),this._reinsertAfter(e,s,i)):(e=this._linkedRecords===null?null:this._linkedRecords.get(r,i),e!==null?(Object.is(e.item,n)||this._addIdentityChange(e,n),this._moveAfter(e,s,i)):e=this._addAfter(new Gy(n,r),s,i)),e}_verifyReinsertion(e,n,r,i){let s=this._unlinkedRecords===null?null:this._unlinkedRecords.get(r,null);return s!==null?e=this._reinsertAfter(s,e._prev,i):e.currentIndex!=i&&(e.currentIndex=i,this._addToMoves(e,i)),e}_truncate(e){for(;e!==null;){let n=e._next;this._addToRemovals(this._unlink(e)),e=n}this._unlinkedRecords!==null&&this._unlinkedRecords.clear(),this._additionsTail!==null&&(this._additionsTail._nextAdded=null),this._movesTail!==null&&(this._movesTail._nextMoved=null),this._itTail!==null&&(this._itTail._next=null),this._removalsTail!==null&&(this._removalsTail._nextRemoved=null),this._identityChangesTail!==null&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(e,n,r){this._unlinkedRecords!==null&&this._unlinkedRecords.remove(e);let i=e._prevRemoved,s=e._nextRemoved;return i===null?this._removalsHead=s:i._nextRemoved=s,s===null?this._removalsTail=i:s._prevRemoved=i,this._insertAfter(e,n,r),this._addToMoves(e,r),e}_moveAfter(e,n,r){return this._unlink(e),this._insertAfter(e,n,r),this._addToMoves(e,r),e}_addAfter(e,n,r){return this._insertAfter(e,n,r),this._additionsTail===null?this._additionsTail=this._additionsHead=e:this._additionsTail=this._additionsTail._nextAdded=e,e}_insertAfter(e,n,r){let i=n===null?this._itHead:n._next;return e._next=i,e._prev=n,i===null?this._itTail=e:i._prev=e,n===null?this._itHead=e:n._next=e,this._linkedRecords===null&&(this._linkedRecords=new kh),this._linkedRecords.put(e),e.currentIndex=r,e}_remove(e){return this._addToRemovals(this._unlink(e))}_unlink(e){this._linkedRecords!==null&&this._linkedRecords.remove(e);let n=e._prev,r=e._next;return n===null?this._itHead=r:n._next=r,r===null?this._itTail=n:r._prev=n,e}_addToMoves(e,n){return e.previousIndex===n||(this._movesTail===null?this._movesTail=this._movesHead=e:this._movesTail=this._movesTail._nextMoved=e),e}_addToRemovals(e){return this._unlinkedRecords===null&&(this._unlinkedRecords=new kh),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,this._removalsTail===null?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}_addIdentityChange(e,n){return e.item=n,this._identityChangesTail===null?this._identityChangesTail=this._identityChangesHead=e:this._identityChangesTail=this._identityChangesTail._nextIdentityChange=e,e}},Gy=class{constructor(e,n){this.item=e,this.trackById=n,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}},zy=class{constructor(){this._head=null,this._tail=null}add(e){this._head===null?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}get(e,n){let r;for(r=this._head;r!==null;r=r._nextDup)if((n===null||n<=r.currentIndex)&&Object.is(r.trackById,e))return r;return null}remove(e){let n=e._prevDup,r=e._nextDup;return n===null?this._head=r:n._nextDup=r,r===null?this._tail=n:r._prevDup=n,this._head===null}},kh=class{constructor(){this.map=new Map}put(e){let n=e.trackById,r=this.map.get(n);r||(r=new zy,this.map.set(n,r)),r.add(e)}get(e,n){let r=e,i=this.map.get(r);return i?i.get(e,n):null}remove(e){let n=e.trackById;return this.map.get(n).remove(e)&&this.map.delete(n),e}get isEmpty(){return this.map.size===0}clear(){this.map.clear()}};function cb(t,e,n){let r=t.previousIndex;if(r===null)return r;let i=0;return n&&r<n.length&&(i=n[r]),r+e+i}function lb(){return new V_([new Hy])}var V_=(()=>{let e=class e{constructor(r){this.factories=r}static create(r,i){if(i!=null){let s=i.factories.slice();r=r.concat(s)}return new e(r)}static extend(r){return{provide:e,useFactory:i=>e.create(r,i||lb()),deps:[[e,new b_,new Yo]]}}find(r){let i=this.factories.find(s=>s.supports(r));if(i!=null)return i;throw new $(901,!1)}};e.\u0275prov=V({token:e,providedIn:"root",factory:lb});let t=e;return t})();function Oh(t,e,n,r,i=!1){for(;n!==null;){let s=e[n.index];s!==null&&r.push(tr(s)),Pr(s)&&Ij(s,r);let o=n.type;if(o&8)Oh(t,e,n.child,r);else if(o&32){let a=R_(n,e),u;for(;u=a();)r.push(u)}else if(o&16){let a=qS(e,n);if(Array.isArray(a))r.push(...a);else{let u=Gu(e[er]);Oh(u[fe],u,a,r,!0)}}n=i?n.projectionNext:n.next}return r}function Ij(t,e){for(let n=_n;n<t.length;n++){let r=t[n],i=r[fe].firstChild;i!==null&&Oh(r[fe],r,i,e)}t[us]!==t[Nr]&&e.push(t[us])}var ZS=[];function Cj(t){return t[as]??Dj(t)}function Dj(t){let e=ZS.pop()??Object.create(bj);return e.lView=t,e}function Tj(t){t.lView[as]!==t&&(t.lView=null,ZS.push(t))}var bj=ue(x({},yT),{consumerIsAlwaysLive:!0,consumerMarkedDirty:t=>{qu(t.lView)},consumerOnSignalRead(){this.lView[as]=this}});function XS(t){return eA(t[$u])}function JS(t){return eA(t[kn])}function eA(t){for(;t!==null&&!Pr(t);)t=t[kn];return t}var Sj="ngOriginalError";function yy(t){return t[Sj]}var nr=class{constructor(){this._console=console}handleError(e){let n=this._findOriginalError(e);this._console.error("ERROR",e),n&&this._console.error("ORIGINAL ERROR",n)}_findOriginalError(e){let n=e&&yy(e);for(;n&&yy(n);)n=yy(n);return n||null}},tA=new F("",{providedIn:"root",factory:()=>k(nr).handleError.bind(void 0)});var nA=!1,Aj=new F("",{providedIn:"root",factory:()=>nA});var Zo={};function ve(t=1){rA(Vn(),Ve(),Qo()+t,!1)}function rA(t,e,n,r){if(!r)if((e[z]&3)===3){let s=t.preOrderCheckHooks;s!==null&&ph(e,s,n)}else{let s=t.preOrderHooks;s!==null&&gh(e,s,0,n)}cs(n)}function oe(t,e=se.Default){let n=Ve();if(n===null)return C(t,e);let r=tn();return CS(r,n,Ot(t),e)}function iA(){let t="invalid";throw new Error(t)}function sA(t,e,n,r,i,s){let o=Jt(null);try{let a=null;i&Vt.SignalBased&&(a=e[r][mT]),a!==null&&a.transformFn!==void 0&&(s=a.transformFn(s)),i&Vt.HasDecoratorInputTransform&&(s=t.inputTransforms[r].call(e,s)),t.setInput!==null?t.setInput(e,a,s,n,r):Zb(e,a,r,s)}finally{Jt(o)}}function xj(t,e){let n=t.hostBindingOpCodes;if(n!==null)try{for(let r=0;r<n.length;r++){let i=n[r];if(i<0)cs(~i);else{let s=i,o=n[++r],a=n[++r];jL(o,s);let u=e[s];a(2,u)}}}finally{cs(-1)}}function Jh(t,e,n,r,i,s,o,a,u,c,l){let d=e.blueprint.slice();return d[Nr]=i,d[z]=r|4|128|8|64,(c!==null||t&&t[z]&2048)&&(d[z]|=2048),rS(d),d[St]=d[zo]=t,d[On]=n,d[xr]=o||t&&t[xr],d[It]=a||t&&t[It],d[jo]=u||t&&t[jo]||null,d[Fn]=s,d[Gh]=k2(),d[Eh]=l,d[Kb]=c,d[er]=e.type==2?t[er]:d,d}function ef(t,e,n,r,i){let s=t.data[e];if(s===null)s=Mj(t,e,n,r,i),LL()&&(s.flags|=32);else if(s.type&64){s.type=n,s.value=r,s.attrs=i;let o=kL();s.injectorIndex=o===null?-1:o.injectorIndex}return Zu(s,!0),s}function Mj(t,e,n,r,i){let s=oS(),o=aS(),a=o?s:s&&s.parent,u=t.data[e]=Oj(t,a,n,e,r,i);return t.firstChild===null&&(t.firstChild=u),s!==null&&(o?s.child==null&&u.parent!==null&&(s.child=u):s.next===null&&(s.next=u,u.prev=s)),u}function oA(t,e,n,r){if(n===0)return-1;let i=e.length;for(let s=0;s<n;s++)e.push(r),t.blueprint.push(r),t.data.push(null);return i}function aA(t,e,n,r,i){let s=Qo(),o=r&2;try{cs(-1),o&&e.length>si&&rA(t,e,si,!1),Zn(o?2:0,i),n(r,i)}finally{cs(s),Zn(o?3:1,i)}}function uA(t,e,n){if(Yb(e)){let r=Jt(null);try{let i=e.directiveStart,s=e.directiveEnd;for(let o=i;o<s;o++){let a=t.data[o];a.contentQueries&&a.contentQueries(1,n[o],o)}}finally{Jt(r)}}}function cA(t,e,n){sS()&&($j(t,e,n,vn(n,e)),(n.flags&64)===64&&pA(t,e,n))}function lA(t,e,n=vn){let r=e.localNames;if(r!==null){let i=e.index+1;for(let s=0;s<r.length;s+=2){let o=r[s+1],a=o===-1?n(e,t):t[o];t[i++]=a}}}function dA(t){let e=t.tView;return e===null||e.incompleteFirstPass?t.tView=L_(1,null,t.template,t.decls,t.vars,t.directiveDefs,t.pipeDefs,t.viewQuery,t.schemas,t.consts,t.id):e}function L_(t,e,n,r,i,s,o,a,u,c,l){let d=si+r,h=d+i,f=Rj(d,h),p=typeof c=="function"?c():c;return f[fe]={type:t,blueprint:f,template:n,queries:null,viewQuery:a,declTNode:e,data:f.slice().fill(null,d),bindingStartIndex:d,expandoStartIndex:h,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:typeof s=="function"?s():s,pipeRegistry:typeof o=="function"?o():o,firstChild:null,schemas:u,consts:p,incompleteFirstPass:!1,ssrId:l}}function Rj(t,e){let n=[];for(let r=0;r<e;r++)n.push(r<t?null:Zo);return n}function Nj(t,e,n,r){let s=r.get(Aj,nA)||n===Jn.ShadowDom,o=t.selectRootElement(e,s);return Pj(o),o}function Pj(t){kj(t)}var kj=()=>null;function Oj(t,e,n,r,i,s){let o=e?e.injectorIndex:-1,a=0;return RL()&&(a|=128),{type:n,index:r,insertBeforeIndex:null,injectorIndex:o,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:a,providerIndexes:0,value:i,attrs:s,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}function db(t,e,n,r,i){for(let s in e){if(!e.hasOwnProperty(s))continue;let o=e[s];if(o===void 0)continue;r??={};let a,u=Vt.None;Array.isArray(o)?(a=o[0],u=o[1]):a=o;let c=s;if(i!==null){if(!i.hasOwnProperty(s))continue;c=i[s]}t===0?hb(r,n,c,a,u):hb(r,n,c,a)}return r}function hb(t,e,n,r,i){let s;t.hasOwnProperty(n)?(s=t[n]).push(e,r):s=t[n]=[e,r],i!==void 0&&s.push(i)}function Fj(t,e,n){let r=e.directiveStart,i=e.directiveEnd,s=t.data,o=e.attrs,a=[],u=null,c=null;for(let l=r;l<i;l++){let d=s[l],h=n?n.get(d):null,f=h?h.inputs:null,p=h?h.outputs:null;u=db(0,d.inputs,l,u,f),c=db(1,d.outputs,l,c,p);let g=u!==null&&o!==null&&!Bb(e)?Jj(u,l,o):null;a.push(g)}u!==null&&(u.hasOwnProperty("class")&&(e.flags|=8),u.hasOwnProperty("style")&&(e.flags|=16)),e.initialInputs=a,e.inputs=u,e.outputs=c}function Vj(t){return t==="class"?"className":t==="for"?"htmlFor":t==="formaction"?"formAction":t==="innerHtml"?"innerHTML":t==="readonly"?"readOnly":t==="tabindex"?"tabIndex":t}function Lj(t,e,n,r,i,s,o,a){let u=vn(e,n),c=e.inputs,l;!a&&c!=null&&(l=c[r])?(j_(t,n,l,r,i),zh(e)&&jj(n,e.index)):e.type&3?(r=Vj(r),i=o!=null?o(i,e.value||"",r):i,s.setProperty(u,r,i)):e.type&12}function jj(t,e){let n=ui(e,t);n[z]&16||(n[z]|=64)}function hA(t,e,n,r){if(sS()){let i=r===null?null:{"":-1},s=qj(t,n),o,a;s===null?o=a=null:[o,a]=s,o!==null&&fA(t,e,n,o,i,a),i&&Gj(n,r,i)}n.mergedAttrs=Uu(n.mergedAttrs,n.attrs)}function fA(t,e,n,r,i,s){for(let c=0;c<r.length;c++)Ny(Sh(n,e),t,r[c].type);Wj(n,t.data.length,r.length);for(let c=0;c<r.length;c++){let l=r[c];l.providersResolver&&l.providersResolver(l)}let o=!1,a=!1,u=oA(t,e,r.length,null);for(let c=0;c<r.length;c++){let l=r[c];n.mergedAttrs=Uu(n.mergedAttrs,l.hostAttrs),Kj(t,n,e,u,l),zj(u,l,i),l.contentQueries!==null&&(n.flags|=4),(l.hostBindings!==null||l.hostAttrs!==null||l.hostVars!==0)&&(n.flags|=64);let d=l.type.prototype;!o&&(d.ngOnChanges||d.ngOnInit||d.ngDoCheck)&&((t.preOrderHooks??=[]).push(n.index),o=!0),!a&&(d.ngOnChanges||d.ngDoCheck)&&((t.preOrderCheckHooks??=[]).push(n.index),a=!0),u++}Fj(t,n,s)}function Uj(t,e,n,r,i){let s=i.hostBindings;if(s){let o=t.hostBindingOpCodes;o===null&&(o=t.hostBindingOpCodes=[]);let a=~e.index;Bj(o)!=a&&o.push(a),o.push(n,r,s)}}function Bj(t){let e=t.length;for(;e>0;){let n=t[--e];if(typeof n=="number"&&n<0)return n}return 0}function $j(t,e,n,r){let i=n.directiveStart,s=n.directiveEnd;zh(n)&&Qj(e,n,t.data[i+n.componentOffset]),t.firstCreatePass||Sh(n,e),ds(r,e);let o=n.initialInputs;for(let a=i;a<s;a++){let u=t.data[a],c=Bo(e,t,a,n);if(ds(c,e),o!==null&&Xj(e,a-i,c,u,n,o),oi(u)){let l=ui(n.index,e);l[On]=Bo(e,t,a,n)}}}function pA(t,e,n){let r=n.directiveStart,i=n.directiveEnd,s=n.index,o=UL();try{cs(s);for(let a=r;a<i;a++){let u=t.data[a],c=e[a];My(a),(u.hostBindings!==null||u.hostVars!==0||u.hostAttrs!==null)&&Hj(u,c)}}finally{cs(-1),My(o)}}function Hj(t,e){t.hostBindings!==null&&t.hostBindings(1,e)}function qj(t,e){let n=t.directiveRegistry,r=null,i=null;if(n)for(let s=0;s<n.length;s++){let o=n[s];if(aL(e,o.selectors,!1))if(r||(r=[]),oi(o))if(o.findHostDirectiveDefs!==null){let a=[];i=i||new Map,o.findHostDirectiveDefs(o,a,i),r.unshift(...a,o);let u=a.length;Wy(t,e,u)}else r.unshift(o),Wy(t,e,0);else i=i||new Map,o.findHostDirectiveDefs?.(o,r,i),r.push(o)}return r===null?null:[r,i]}function Wy(t,e,n){e.componentOffset=n,(t.components??=[]).push(e.index)}function Gj(t,e,n){if(e){let r=t.localNames=[];for(let i=0;i<e.length;i+=2){let s=n[e[i+1]];if(s==null)throw new $(-301,!1);r.push(e[i],s)}}}function zj(t,e,n){if(n){if(e.exportAs)for(let r=0;r<e.exportAs.length;r++)n[e.exportAs[r]]=t;oi(e)&&(n[""]=t)}}function Wj(t,e,n){t.flags|=1,t.directiveStart=e,t.directiveEnd=e+n,t.providerIndexes=e}function Kj(t,e,n,r,i){t.data[r]=i;let s=i.factory||(i.factory=Uo(i.type,!0)),o=new ls(s,oi(i),oe);t.blueprint[r]=o,n[r]=o,Uj(t,e,r,oA(t,n,i.hostVars,Zo),i)}function Qj(t,e,n){let r=vn(e,t),i=dA(n),s=t[xr].rendererFactory,o=16;n.signals?o=4096:n.onPush&&(o=64);let a=tf(t,Jh(t,i,null,o,r,e,null,s.createRenderer(r,n),null,null,null));t[e.index]=a}function Yj(t,e,n,r,i,s){let o=vn(t,e);Zj(e[It],o,s,t.value,n,r,i)}function Zj(t,e,n,r,i,s,o){if(s==null)t.removeAttribute(e,i,n);else{let a=o==null?Bh(s):o(s,r||"",i);t.setAttribute(e,i,a,n)}}function Xj(t,e,n,r,i,s){let o=s[e];if(o!==null)for(let a=0;a<o.length;){let u=o[a++],c=o[a++],l=o[a++],d=o[a++];sA(r,n,u,c,l,d)}}function Jj(t,e,n){let r=null,i=0;for(;i<n.length;){let s=n[i];if(s===0){i+=4;continue}else if(s===5){i+=2;continue}if(typeof s=="number")break;if(t.hasOwnProperty(s)){r===null&&(r=[]);let o=t[s];for(let a=0;a<o.length;a+=3)if(o[a]===e){r.push(s,o[a+1],o[a+2],n[i+1]);break}}i+=2}return r}function gA(t,e,n,r){return[t,!0,0,e,null,r,null,n,null,null]}function mA(t,e){let n=t.contentQueries;if(n!==null){let r=Jt(null);try{for(let i=0;i<n.length;i+=2){let s=n[i],o=n[i+1];if(o!==-1){let a=t.data[o];uS(s),a.contentQueries(2,e[o],o)}}}finally{Jt(r)}}}function tf(t,e){return t[$u]?t[XT][kn]=e:t[$u]=e,t[XT]=e,e}function Ky(t,e,n){uS(0);let r=Jt(null);try{e(t,n)}finally{Jt(r)}}function eU(t){return t[Bu]||(t[Bu]=[])}function tU(t){return t.cleanup||(t.cleanup=[])}function yA(t,e){let n=t[jo],r=n?n.get(nr,null):null;r&&r.handleError(e)}function j_(t,e,n,r,i){for(let s=0;s<n.length;){let o=n[s++],a=n[s++],u=n[s++],c=e[o],l=t.data[o];sA(l,c,r,a,u,i)}}function nU(t,e,n){let r=tS(e,t);j2(t[It],r,n)}var _A=100;function vA(t,e=!0,n=0){let r=t[xr],i=r.rendererFactory,s=!1;s||i.begin?.();try{rU(t,n)}catch(o){throw e&&yA(t,o),o}finally{s||(i.end?.(),r.inlineEffectRunner?.flush())}}function rU(t,e){Qy(t,e);let n=0;for(;m_(t);){if(n===_A)throw new $(103,!1);n++,Qy(t,1)}}function iU(t,e,n,r){let i=e[z];if((i&256)===256)return;let s=!1;!s&&e[xr].inlineEffectRunner?.flush(),__(e);let o=null,a=null;!s&&sU(t)&&(a=Cj(e),o=_T(a));try{rS(e),FL(t.bindingStartIndex),n!==null&&aA(t,e,n,2,r);let u=(i&3)===3;if(!s)if(u){let d=t.preOrderCheckHooks;d!==null&&ph(e,d,null)}else{let d=t.preOrderHooks;d!==null&&gh(e,d,0,null),dy(e,0)}if(oU(e),wA(e,0),t.contentQueries!==null&&mA(t,e),!s)if(u){let d=t.contentCheckHooks;d!==null&&ph(e,d)}else{let d=t.contentHooks;d!==null&&gh(e,d,1),dy(e,1)}xj(t,e);let c=t.components;c!==null&&IA(e,c,0);let l=t.viewQuery;if(l!==null&&Ky(2,l,r),!s)if(u){let d=t.viewCheckHooks;d!==null&&ph(e,d)}else{let d=t.viewHooks;d!==null&&gh(e,d,2),dy(e,2)}if(t.firstUpdatePass===!0&&(t.firstUpdatePass=!1),e[ly]){for(let d of e[ly])d();e[ly]=null}s||(e[z]&=-73)}catch(u){throw qu(e),u}finally{a!==null&&(vT(a,o),Tj(a)),v_()}}function sU(t){return t.type!==2}function wA(t,e){for(let n=XS(t);n!==null;n=JS(n))for(let r=_n;r<n.length;r++){let i=n[r];EA(i,e)}}function oU(t){for(let e=XS(t);e!==null;e=JS(e)){if(!(e[z]&f_.HasTransplantedViews))continue;let n=e[Ch];for(let r=0;r<n.length;r++){let i=n[r],s=i[St];TL(i)}}}function aU(t,e,n){let r=ui(e,t);EA(r,n)}function EA(t,e){g_(t)&&Qy(t,e)}function Qy(t,e){let r=t[fe],i=t[z],s=t[as],o=!!(e===0&&i&16);if(o||=!!(i&64&&e===0),o||=!!(i&1024),o||=!!(s?.dirty&&$m(s)),s&&(s.dirty=!1),t[z]&=-9217,o)iU(r,t,r.template,t[On]);else if(i&8192){wA(t,1);let a=r.components;a!==null&&IA(t,a,1)}}function IA(t,e,n){for(let r=0;r<e.length;r++)aU(t,e[r],n)}function U_(t){for(t[xr].changeDetectionScheduler?.notify();t;){t[z]|=64;let e=Gu(t);if(mL(t)&&!e)return t;t=e}return null}var hs=class{get rootNodes(){let e=this._lView,n=e[fe];return Oh(n,e,n.firstChild,[])}constructor(e,n,r=!0){this._lView=e,this._cdRefInjectingView=n,this.notifyErrorHandler=r,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[On]}set context(e){this._lView[On]=e}get destroyed(){return(this._lView[z]&256)===256}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){let e=this._lView[St];if(Pr(e)){let n=e[Ih],r=n?n.indexOf(this):-1;r>-1&&(Ly(e,r),Ah(n,r))}this._attachedToViewContainer=!1}$S(this._lView[fe],this._lView)}onDestroy(e){iS(this._lView,e)}markForCheck(){U_(this._cdRefInjectingView||this._lView)}detach(){this._lView[z]&=-129}reattach(){xy(this._lView),this._lView[z]|=128}detectChanges(){this._lView[z]|=1024,vA(this._lView,this.notifyErrorHandler)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new $(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,US(this._lView[fe],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new $(902,!1);this._appRef=e,xy(this._lView)}},Xo=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=uU;let t=e;return t})();function uU(t){return cU(tn(),Ve(),(t&16)===16)}function cU(t,e,n){if(zh(t)&&!n){let r=ui(t.index,e);return new hs(r,r)}else if(t.type&47){let r=e[er];return new hs(r,e)}return null}var CA=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=lU,e.__NG_ENV_ID__=r=>r;let t=e;return t})(),Yy=class extends CA{constructor(e){super(),this._lView=e}onDestroy(e){return iS(this._lView,e),()=>SL(this._lView,e)}};function lU(){return new Yy(Ve())}var fb=new Set;function B_(t){fb.has(t)||(fb.add(t),performance?.mark?.("mark_feature_usage",{detail:{feature:t}}))}var Zy=class extends Ye{constructor(e=!1){super(),this.__isAsync=e}emit(e){super.next(e)}subscribe(e,n,r){let i=e,s=n||(()=>null),o=r;if(e&&typeof e=="object"){let u=e;i=u.next?.bind(u),s=u.error?.bind(u),o=u.complete?.bind(u)}this.__isAsync&&(s=_y(s),i&&(i=_y(i)),o&&(o=_y(o)));let a=super.subscribe({next:i,error:s,complete:o});return e instanceof He&&e.add(a),a}};function _y(t){return e=>{setTimeout(t,void 0,e)}}var ut=Zy;function pb(...t){}function dU(){let t=typeof Ft.requestAnimationFrame=="function",e=Ft[t?"requestAnimationFrame":"setTimeout"],n=Ft[t?"cancelAnimationFrame":"clearTimeout"];if(typeof Zone<"u"&&e&&n){let r=e[Zone.__symbol__("OriginalDelegate")];r&&(e=r);let i=n[Zone.__symbol__("OriginalDelegate")];i&&(n=i)}return{nativeRequestAnimationFrame:e,nativeCancelAnimationFrame:n}}var le=class t{constructor({enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:n=!1,shouldCoalesceRunChangeDetection:r=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new ut(!1),this.onMicrotaskEmpty=new ut(!1),this.onStable=new ut(!1),this.onError=new ut(!1),typeof Zone>"u")throw new $(908,!1);Zone.assertZonePatched();let i=this;i._nesting=0,i._outer=i._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(i._inner=i._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(i._inner=i._inner.fork(Zone.longStackTraceZoneSpec)),i.shouldCoalesceEventChangeDetection=!r&&n,i.shouldCoalesceRunChangeDetection=r,i.lastRequestAnimationFrameId=-1,i.nativeRequestAnimationFrame=dU().nativeRequestAnimationFrame,pU(i)}static isInAngularZone(){return typeof Zone<"u"&&Zone.current.get("isAngularZone")===!0}static assertInAngularZone(){if(!t.isInAngularZone())throw new $(909,!1)}static assertNotInAngularZone(){if(t.isInAngularZone())throw new $(909,!1)}run(e,n,r){return this._inner.run(e,n,r)}runTask(e,n,r,i){let s=this._inner,o=s.scheduleEventTask("NgZoneEvent: "+i,e,hU,pb,pb);try{return s.runTask(o,n,r)}finally{s.cancelTask(o)}}runGuarded(e,n,r){return this._inner.runGuarded(e,n,r)}runOutsideAngular(e){return this._outer.run(e)}},hU={};function $_(t){if(t._nesting==0&&!t.hasPendingMicrotasks&&!t.isStable)try{t._nesting++,t.onMicrotaskEmpty.emit(null)}finally{if(t._nesting--,!t.hasPendingMicrotasks)try{t.runOutsideAngular(()=>t.onStable.emit(null))}finally{t.isStable=!0}}}function fU(t){t.isCheckStableRunning||t.lastRequestAnimationFrameId!==-1||(t.lastRequestAnimationFrameId=t.nativeRequestAnimationFrame.call(Ft,()=>{t.fakeTopEventTask||(t.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{t.lastRequestAnimationFrameId=-1,Xy(t),t.isCheckStableRunning=!0,$_(t),t.isCheckStableRunning=!1},void 0,()=>{},()=>{})),t.fakeTopEventTask.invoke()}),Xy(t))}function pU(t){let e=()=>{fU(t)};t._inner=t._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(n,r,i,s,o,a)=>{if(gU(a))return n.invokeTask(i,s,o,a);try{return gb(t),n.invokeTask(i,s,o,a)}finally{(t.shouldCoalesceEventChangeDetection&&s.type==="eventTask"||t.shouldCoalesceRunChangeDetection)&&e(),mb(t)}},onInvoke:(n,r,i,s,o,a,u)=>{try{return gb(t),n.invoke(i,s,o,a,u)}finally{t.shouldCoalesceRunChangeDetection&&e(),mb(t)}},onHasTask:(n,r,i,s)=>{n.hasTask(i,s),r===i&&(s.change=="microTask"?(t._hasPendingMicrotasks=s.microTask,Xy(t),$_(t)):s.change=="macroTask"&&(t.hasPendingMacrotasks=s.macroTask))},onHandleError:(n,r,i,s)=>(n.handleError(i,s),t.runOutsideAngular(()=>t.onError.emit(s)),!1)})}function Xy(t){t._hasPendingMicrotasks||(t.shouldCoalesceEventChangeDetection||t.shouldCoalesceRunChangeDetection)&&t.lastRequestAnimationFrameId!==-1?t.hasPendingMicrotasks=!0:t.hasPendingMicrotasks=!1}function gb(t){t._nesting++,t.isStable&&(t.isStable=!1,t.onUnstable.emit(null))}function mb(t){t._nesting--,$_(t)}var Jy=class{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new ut,this.onMicrotaskEmpty=new ut,this.onStable=new ut,this.onError=new ut}run(e,n,r){return e.apply(n,r)}runGuarded(e,n,r){return e.apply(n,r)}runOutsideAngular(e){return e()}runTask(e,n,r,i){return e.apply(n,r)}};function gU(t){return!Array.isArray(t)||t.length!==1?!1:t[0].data?.__ignore_ng_zone__===!0}function mU(t="zone.js",e){return t==="noop"?new Jy:t==="zone.js"?new le(e):t}var Oo=function(t){return t[t.EarlyRead=0]="EarlyRead",t[t.Write=1]="Write",t[t.MixedReadWrite=2]="MixedReadWrite",t[t.Read=3]="Read",t}(Oo||{}),yU={destroy(){}};function H_(t,e){!e&&x2(H_);let n=e?.injector??k(Ln);if(!N2(n))return yU;B_("NgAfterNextRender");let r=n.get(q_),i=r.handler??=new t_,s=e?.phase??Oo.MixedReadWrite,o=()=>{i.unregister(u),a()},a=n.get(CA).onDestroy(o),u=new e_(n,s,()=>{o(),t()});return i.register(u),{destroy:o}}var e_=class{constructor(e,n,r){this.phase=n,this.callbackFn=r,this.zone=e.get(le),this.errorHandler=e.get(nr,null,{optional:!0})}invoke(){try{this.zone.runOutsideAngular(this.callbackFn)}catch(e){this.errorHandler?.handleError(e)}}},t_=class{constructor(){this.executingCallbacks=!1,this.buckets={[Oo.EarlyRead]:new Set,[Oo.Write]:new Set,[Oo.MixedReadWrite]:new Set,[Oo.Read]:new Set},this.deferredCallbacks=new Set}register(e){(this.executingCallbacks?this.deferredCallbacks:this.buckets[e.phase]).add(e)}unregister(e){this.buckets[e.phase].delete(e),this.deferredCallbacks.delete(e)}execute(){this.executingCallbacks=!0;for(let e of Object.values(this.buckets))for(let n of e)n.invoke();this.executingCallbacks=!1;for(let e of this.deferredCallbacks)this.buckets[e.phase].add(e);this.deferredCallbacks.clear()}destroy(){for(let e of Object.values(this.buckets))e.clear();this.deferredCallbacks.clear()}},q_=(()=>{let e=class e{constructor(){this.handler=null,this.internalCallbacks=[]}execute(){let r=[...this.internalCallbacks];this.internalCallbacks.length=0;for(let i of r)i();this.handler?.execute()}ngOnDestroy(){this.handler?.destroy(),this.handler=null,this.internalCallbacks.length=0}};e.\u0275prov=V({token:e,providedIn:"root",factory:()=>new e});let t=e;return t})();function _U(t,e){let n=ui(e,t),r=n[fe];vU(r,n);let i=n[Nr];i!==null&&n[Eh]===null&&(n[Eh]=F_(i,n[jo])),G_(r,n,n[On])}function vU(t,e){for(let n=e.length;n<t.blueprint.length;n++)e.push(t.blueprint[n])}function G_(t,e,n){__(e);try{let r=t.viewQuery;r!==null&&Ky(1,r,n);let i=t.template;i!==null&&aA(t,e,i,1,n),t.firstCreatePass&&(t.firstCreatePass=!1),t.staticContentQueries&&mA(t,e),t.staticViewQueries&&Ky(2,t.viewQuery,n);let s=t.components;s!==null&&wU(e,s)}catch(r){throw t.firstCreatePass&&(t.incompleteFirstPass=!0,t.firstCreatePass=!1),r}finally{e[z]&=-5,v_()}}function wU(t,e){for(let n=0;n<e.length;n++)_U(t,e[n])}function n_(t,e,n){let r=n?t.styles:null,i=n?t.classes:null,s=0;if(e!==null)for(let o=0;o<e.length;o++){let a=e[o];if(typeof a=="number")s=a;else if(s==1)i=$T(i,a);else if(s==2){let u=a,c=e[++o];r=$T(r,u+": "+c+";")}}n?t.styles=r:t.stylesWithoutHost=r,n?t.classes=i:t.classesWithoutHost=i}var Fh=class extends Zh{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){let n=ii(e);return new qo(n,this.ngModule)}};function yb(t){let e=[];for(let n in t){if(!t.hasOwnProperty(n))continue;let r=t[n];r!==void 0&&e.push({propName:Array.isArray(r)?r[0]:r,templateName:n})}return e}function EU(t){let e=t.toLowerCase();return e==="svg"?wL:e==="math"?EL:null}var r_=class{constructor(e,n){this.injector=e,this.parentInjector=n}get(e,n,r){r=Hh(r);let i=this.injector.get(e,my,r);return i!==my||n===my?i:this.parentInjector.get(e,n,r)}},qo=class extends Ph{get inputs(){let e=this.componentDef,n=e.inputTransforms,r=yb(e.inputs);if(n!==null)for(let i of r)n.hasOwnProperty(i.propName)&&(i.transform=n[i.propName]);return r}get outputs(){return yb(this.componentDef.outputs)}constructor(e,n){super(),this.componentDef=e,this.ngModule=n,this.componentType=e.type,this.selector=dL(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!n}create(e,n,r,i){i=i||this.ngModule;let s=i instanceof en?i:i?.injector;s&&this.componentDef.getStandaloneInjector!==null&&(s=this.componentDef.getStandaloneInjector(s)||s);let o=s?new r_(e,s):e,a=o.get(Wu,null);if(a===null)throw new $(407,!1);let u=o.get(_j,null),c=o.get(q_,null),l=o.get(Uy,null),d={rendererFactory:a,sanitizer:u,inlineEffectRunner:null,afterRenderEventManager:c,changeDetectionScheduler:l},h=a.createRenderer(null,this.componentDef),f=this.componentDef.selectors[0][0]||"div",p=r?Nj(h,r,this.componentDef.encapsulation,o):jS(h,f,EU(f)),g=512;this.componentDef.signals?g|=4096:this.componentDef.onPush||(g|=16);let _=null;p!==null&&(_=F_(p,o,!0));let b=L_(0,null,null,1,0,null,null,null,null,null,null),P=Jh(null,b,null,g,null,null,d,h,o,null,_);__(P);let A,H;try{let G=this.componentDef,J,Pe=null;G.findHostDirectiveDefs?(J=[],Pe=new Map,G.findHostDirectiveDefs(G,J,Pe),J.push(G)):J=[G];let dn=IU(P,p),km=CU(dn,p,G,J,P,d,h);H=nS(b,si),p&&bU(h,G,p,r),n!==void 0&&SU(H,this.ngContentSelectors,n),A=TU(km,G,J,Pe,P,[AU]),G_(b,P,null)}finally{v_()}return new i_(this.componentType,A,Xh(H,P),P,H)}},i_=class extends By{constructor(e,n,r,i,s){super(),this.location=r,this._rootLView=i,this._tNode=s,this.previousInputValues=null,this.instance=n,this.hostView=this.changeDetectorRef=new hs(i,void 0,!1),this.componentType=e}setInput(e,n){let r=this._tNode.inputs,i;if(r!==null&&(i=r[e])){if(this.previousInputValues??=new Map,this.previousInputValues.has(e)&&Object.is(this.previousInputValues.get(e),n))return;let s=this._rootLView;j_(s[fe],s,i,e,n),this.previousInputValues.set(e,n);let o=ui(this._tNode.index,s);U_(o)}}get injector(){return new os(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}};function IU(t,e){let n=t[fe],r=si;return t[r]=e,ef(n,r,2,"#host",null)}function CU(t,e,n,r,i,s,o){let a=i[fe];DU(r,t,e,o);let u=null;e!==null&&(u=F_(e,i[jo]));let c=s.rendererFactory.createRenderer(e,n),l=16;n.signals?l=4096:n.onPush&&(l=64);let d=Jh(i,dA(n),null,l,i[t.index],t,s,c,null,null,u);return a.firstCreatePass&&Wy(a,t,r.length-1),tf(i,d),i[t.index]=d}function DU(t,e,n,r){for(let i of t)e.mergedAttrs=Uu(e.mergedAttrs,i.hostAttrs);e.mergedAttrs!==null&&(n_(e,e.mergedAttrs,!0),n!==null&&zS(r,n,e))}function TU(t,e,n,r,i,s){let o=tn(),a=i[fe],u=vn(o,i);fA(a,i,o,n,null,r);for(let l=0;l<n.length;l++){let d=o.directiveStart+l,h=Bo(i,a,d,o);ds(h,i)}pA(a,i,o),u&&ds(u,i);let c=Bo(i,a,o.directiveStart+o.componentOffset,o);if(t[On]=i[On]=c,s!==null)for(let l of s)l(c,e);return uA(a,o,t),c}function bU(t,e,n,r){if(r)Sy(t,n,["ng-version","17.1.3"]);else{let{attrs:i,classes:s}=hL(e.selectors[0]);i&&Sy(t,n,i),s&&s.length>0&&GS(t,n,s.join(" "))}}function SU(t,e,n){let r=t.projection=[];for(let i=0;i<e.length;i++){let s=n[i];r.push(s!=null?Array.from(s):null)}}function AU(){let t=tn();I_(Ve()[fe],t)}function xU(t){return Object.getPrototypeOf(t.prototype).constructor}function li(t){let e=xU(t.type),n=!0,r=[t];for(;e;){let i;if(oi(t))i=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new $(903,!1);i=e.\u0275dir}if(i){if(n){r.push(i);let o=t;o.inputs=dh(t.inputs),o.inputTransforms=dh(t.inputTransforms),o.declaredInputs=dh(t.declaredInputs),o.outputs=dh(t.outputs);let a=i.hostBindings;a&&kU(t,a);let u=i.viewQuery,c=i.contentQueries;if(u&&NU(t,u),c&&PU(t,c),MU(t,i),VV(t.outputs,i.outputs),oi(i)&&i.data.animation){let l=t.data;l.animation=(l.animation||[]).concat(i.data.animation)}}let s=i.features;if(s)for(let o=0;o<s.length;o++){let a=s[o];a&&a.ngInherit&&a(t),a===li&&(n=!1)}}e=Object.getPrototypeOf(e)}RU(r)}function MU(t,e){for(let n in e.inputs){if(!e.inputs.hasOwnProperty(n)||t.inputs.hasOwnProperty(n))continue;let r=e.inputs[n];if(r!==void 0&&(t.inputs[n]=r,t.declaredInputs[n]=e.declaredInputs[n],e.inputTransforms!==null)){let i=Array.isArray(r)?r[0]:r;if(!e.inputTransforms.hasOwnProperty(i))continue;t.inputTransforms??={},t.inputTransforms[i]=e.inputTransforms[i]}}}function RU(t){let e=0,n=null;for(let r=t.length-1;r>=0;r--){let i=t[r];i.hostVars=e+=i.hostVars,i.hostAttrs=Uu(i.hostAttrs,n=Uu(n,i.hostAttrs))}}function dh(t){return t===Lo?{}:t===yn?[]:t}function NU(t,e){let n=t.viewQuery;n?t.viewQuery=(r,i)=>{e(r,i),n(r,i)}:t.viewQuery=e}function PU(t,e){let n=t.contentQueries;n?t.contentQueries=(r,i,s)=>{e(r,i,s),n(r,i,s)}:t.contentQueries=e}function kU(t,e){let n=t.hostBindings;n?t.hostBindings=(r,i)=>{e(r,i),n(r,i)}:t.hostBindings=e}function z_(t){let e=t.inputConfig,n={};for(let r in e)if(e.hasOwnProperty(r)){let i=e[r];Array.isArray(i)&&i[3]&&(n[r]=i[3])}t.inputTransforms=n}var uX=new RegExp(`^(\\d+)*(${hj}|${dj})*(.*)`);var OU=()=>null;function _b(t,e){return OU(t,e)}function FU(t,e,n,r){let i=e.tView,o=t[z]&4096?4096:16,a=Jh(t,i,n,o,null,e,null,null,null,r?.injector??null,r?.dehydratedView??null),u=t[e.index];a[qh]=u;let c=t[Hu];return c!==null&&(a[Hu]=c.createEmbeddedView(i)),G_(i,a,n),a}function vb(t,e){return!e||e.firstChild===null||VS(t)}function VU(t,e,n,r=!0){let i=e[fe];if(H2(i,e,t,n),r){let o=jy(n,t),a=e[It],u=N_(a,t[us]);u!==null&&B2(i,t[Fn],a,e,u,o)}let s=e[Eh];s!==null&&s.firstChild!==null&&(s.firstChild=null)}var ec=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=LU;let t=e;return t})();function LU(){let t=tn();return UU(t,Ve())}var jU=ec,DA=class extends jU{constructor(e,n,r){super(),this._lContainer=e,this._hostTNode=n,this._hostLView=r}get element(){return Xh(this._hostTNode,this._hostLView)}get injector(){return new os(this._hostTNode,this._hostLView)}get parentInjector(){let e=C_(this._hostTNode,this._hostLView);if(yS(e)){let n=bh(e,this._hostLView),r=Th(e),i=n[fe].data[r+8];return new os(i,n)}else return new os(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){let n=wb(this._lContainer);return n!==null&&n[e]||null}get length(){return this._lContainer.length-_n}createEmbeddedView(e,n,r){let i,s;typeof r=="number"?i=r:r!=null&&(i=r.index,s=r.injector);let o=_b(this._lContainer,e.ssrId),a=e.createEmbeddedViewImpl(n||{},s,o);return this.insertImpl(a,i,vb(this._hostTNode,o)),a}createComponent(e,n,r,i,s){let o=e&&!u2(e),a;if(o)a=n;else{let p=n||{};a=p.index,r=p.injector,i=p.projectableNodes,s=p.environmentInjector||p.ngModuleRef}let u=o?e:new qo(ii(e)),c=r||this.parentInjector;if(!s&&u.ngModule==null){let g=(o?c:this.parentInjector).get(en,null);g&&(s=g)}let l=ii(u.componentType??{}),d=_b(this._lContainer,l?.id??null),h=d?.firstChild??null,f=u.create(c,i,h,s);return this.insertImpl(f.hostView,a,vb(this._hostTNode,d)),f}insert(e,n){return this.insertImpl(e,n,!0)}insertImpl(e,n,r){let i=e._lView;if(DL(i)){let a=this.indexOf(e);if(a!==-1)this.detach(a);else{let u=i[St],c=new DA(u,u[Fn],u[St]);c.detach(c.indexOf(e))}}let s=this._adjustIndex(n),o=this._lContainer;return VU(o,i,s,r),e.attachToViewContainerRef(),SS(vy(o),s,e),e}move(e,n){return this.insert(e,n)}indexOf(e){let n=wb(this._lContainer);return n!==null?n.indexOf(e):-1}remove(e){let n=this._adjustIndex(e,-1),r=Ly(this._lContainer,n);r&&(Ah(vy(this._lContainer),n),$S(r[fe],r))}detach(e){let n=this._adjustIndex(e,-1),r=Ly(this._lContainer,n);return r&&Ah(vy(this._lContainer),n)!=null?new hs(r):null}_adjustIndex(e,n=0){return e??this.length+n}};function wb(t){return t[Ih]}function vy(t){return t[Ih]||(t[Ih]=[])}function UU(t,e){let n,r=e[t.index];return Pr(r)?n=r:(n=gA(r,e,null,t),e[t.index]=n,tf(e,n)),$U(n,e,t,r),new DA(n,t,e)}function BU(t,e){let n=t[It],r=n.createComment(""),i=vn(e,t),s=N_(n,i);return Rh(n,s,r,Y2(n,i),!1),r}var $U=GU,HU=()=>!1;function qU(t,e,n){return HU(t,e,n)}function GU(t,e,n,r){if(t[us])return;let i;n.type&8?i=tr(r):i=BU(e,n),t[us]=i}var ai=class{},Ku=class{};var Vh=class extends ai{constructor(e,n,r){super(),this._parent=n,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new Fh(this);let i=Gb(e);this._bootstrapComponents=FS(i.bootstrap),this._r3Injector=kS(e,n,[{provide:ai,useValue:this},{provide:Zh,useValue:this.componentFactoryResolver},...r],Qt(e),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(e)}get injector(){return this._r3Injector}destroy(){let e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(n=>n()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}},Lh=class extends Ku{constructor(e){super(),this.moduleType=e}create(e){return new Vh(this.moduleType,e,[])}};function zU(t,e,n){return new Vh(t,e,n)}var s_=class extends ai{constructor(e){super(),this.componentFactoryResolver=new Fh(this),this.instance=null;let n=new zu([...e.providers,{provide:ai,useValue:this},{provide:Zh,useValue:this.componentFactoryResolver}],e.parent||A_(),e.debugName,new Set(["environment"]));this.injector=n,e.runEnvironmentInitializers&&n.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}};function nf(t,e,n=null){return new s_({providers:t,parent:e,debugName:n,runEnvironmentInitializers:!0}).injector}var rf=(()=>{let e=class e{constructor(){this.taskId=0,this.pendingTasks=new Set,this.hasPendingTasks=new wt(!1)}get _hasPendingTasks(){return this.hasPendingTasks.value}add(){this._hasPendingTasks||this.hasPendingTasks.next(!0);let r=this.taskId++;return this.pendingTasks.add(r),r}remove(r){this.pendingTasks.delete(r),this.pendingTasks.size===0&&this._hasPendingTasks&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this._hasPendingTasks&&this.hasPendingTasks.next(!1)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function sf(t,e,n){let r=t[e];return Object.is(r,n)?!1:(t[e]=n,!0)}function WU(t,e,n,r,i,s,o,a,u){let c=e.consts,l=ef(e,t,4,o||null,Dh(c,a));hA(e,n,l,Dh(c,u)),I_(e,l);let d=l.tView=L_(2,l,r,i,s,e.directiveRegistry,e.pipeRegistry,null,e.schemas,c,null);return e.queries!==null&&(e.queries.template(e,l),d.queries=e.queries.embeddedTView(l)),l}function ys(t,e,n,r,i,s,o,a){let u=Ve(),c=Vn(),l=t+si,d=c.firstCreatePass?WU(l,c,u,e,n,r,i,s,o):c.data[l];Zu(d,!1);let h=KU(c,u,d,t);w_()&&P_(c,u,h,d),ds(h,u);let f=gA(h,u,h,d);return u[l]=f,tf(u,f),qU(f,d,u),p_(d)&&cA(c,u,d),o!=null&&lA(u,d,a),ys}var KU=QU;function QU(t,e,n,r){return E_(!0),e[It].createComment("")}function of(t,e,n,r){let i=Ve(),s=y_();if(sf(i,s,e)){let o=Vn(),a=pS();Yj(a,i,t,e,n,r)}return of}function YU(t,e,n,r){return sf(t,y_(),n)?e+Bh(n)+r:Zo}function hh(t,e){return t<<17|e<<2}function fs(t){return t>>17&32767}function ZU(t){return(t&2)==2}function XU(t,e){return t&131071|e<<17}function o_(t){return t|2}function Go(t){return(t&131068)>>2}function wy(t,e){return t&-131069|e<<2}function JU(t){return(t&1)===1}function a_(t){return t|1}function eB(t,e,n,r,i,s){let o=s?e.classBindings:e.styleBindings,a=fs(o),u=Go(o);t[r]=n;let c=!1,l;if(Array.isArray(n)){let d=n;l=d[1],(l===null||Xu(d,l)>0)&&(c=!0)}else l=n;if(i)if(u!==0){let h=fs(t[a+1]);t[r+1]=hh(h,a),h!==0&&(t[h+1]=wy(t[h+1],r)),t[a+1]=XU(t[a+1],r)}else t[r+1]=hh(a,0),a!==0&&(t[a+1]=wy(t[a+1],r)),a=r;else t[r+1]=hh(u,0),a===0?a=r:t[u+1]=wy(t[u+1],r),u=r;c&&(t[r+1]=o_(t[r+1])),Eb(t,l,r,!0),Eb(t,l,r,!1),tB(e,l,t,r,s),o=hh(a,u),s?e.classBindings=o:e.styleBindings=o}function tB(t,e,n,r,i){let s=i?t.residualClasses:t.residualStyles;s!=null&&typeof e=="string"&&Xu(s,e)>=0&&(n[r+1]=a_(n[r+1]))}function Eb(t,e,n,r){let i=t[n+1],s=e===null,o=r?fs(i):Go(i),a=!1;for(;o!==0&&(a===!1||s);){let u=t[o],c=t[o+1];nB(u,e)&&(a=!0,t[o+1]=r?a_(c):o_(c)),o=r?fs(c):Go(c)}a&&(t[n+1]=r?o_(i):a_(i))}function nB(t,e){return t===null||e==null||(Array.isArray(t)?t[1]:t)===e?!0:Array.isArray(t)&&typeof e=="string"?Xu(t,e)>=0:!1}function tt(t,e,n){let r=Ve(),i=y_();if(sf(r,i,e)){let s=Vn(),o=pS();Lj(s,o,r,t,e,r[It],n,!1)}return tt}function Ib(t,e,n,r,i){let s=e.inputs,o=i?"class":"style";j_(t,n,s[o],o,r)}function W_(t,e){return rB(t,e,null,!0),W_}function rB(t,e,n,r){let i=Ve(),s=Vn(),o=VL(2);if(s.firstUpdatePass&&sB(s,t,o,r),e!==Zo&&sf(i,o,e)){let a=s.data[Qo()];lB(s,a,i,i[It],t,i[o+1]=dB(e,n),r,o)}}function iB(t,e){return e>=t.expandoStartIndex}function sB(t,e,n,r){let i=t.data;if(i[n+1]===null){let s=i[Qo()],o=iB(t,n);hB(s,r)&&e===null&&!o&&(e=!1),e=oB(i,s,e,r),eB(i,s,e,n,o,r)}}function oB(t,e,n,r){let i=BL(t),s=r?e.residualClasses:e.residualStyles;if(i===null)(r?e.classBindings:e.styleBindings)===0&&(n=Ey(null,t,e,n,r),n=Qu(n,e.attrs,r),s=null);else{let o=e.directiveStylingLast;if(o===-1||t[o]!==i)if(n=Ey(i,t,e,n,r),s===null){let u=aB(t,e,r);u!==void 0&&Array.isArray(u)&&(u=Ey(null,t,e,u[1],r),u=Qu(u,e.attrs,r),uB(t,e,r,u))}else s=cB(t,e,r)}return s!==void 0&&(r?e.residualClasses=s:e.residualStyles=s),n}function aB(t,e,n){let r=n?e.classBindings:e.styleBindings;if(Go(r)!==0)return t[fs(r)]}function uB(t,e,n,r){let i=n?e.classBindings:e.styleBindings;t[fs(i)]=r}function cB(t,e,n){let r,i=e.directiveEnd;for(let s=1+e.directiveStylingLast;s<i;s++){let o=t[s].hostAttrs;r=Qu(r,o,n)}return Qu(r,e.attrs,n)}function Ey(t,e,n,r,i){let s=null,o=n.directiveEnd,a=n.directiveStylingLast;for(a===-1?a=n.directiveStart:a++;a<o&&(s=e[a],r=Qu(r,s.hostAttrs,i),s!==t);)a++;return t!==null&&(n.directiveStylingLast=a),r}function Qu(t,e,n){let r=n?1:2,i=-1;if(e!==null)for(let s=0;s<e.length;s++){let o=e[s];typeof o=="number"?i=o:i===r&&(Array.isArray(t)||(t=t===void 0?[]:["",t]),l2(t,o,n?!0:e[++s]))}return t===void 0?null:t}function lB(t,e,n,r,i,s,o,a){if(!(e.type&3))return;let u=t.data,c=u[a+1],l=JU(c)?Cb(u,e,n,i,Go(c),o):void 0;if(!jh(l)){jh(s)||ZU(c)&&(s=Cb(u,null,n,i,a,o));let d=tS(Qo(),n);rj(r,o,d,i,s)}}function Cb(t,e,n,r,i,s){let o=e===null,a;for(;i>0;){let u=t[i],c=Array.isArray(u),l=c?u[1]:u,d=l===null,h=n[i+1];h===Zo&&(h=d?yn:void 0);let f=d?fy(h,r):l===r?h:void 0;if(c&&!jh(f)&&(f=fy(u,r)),jh(f)&&(a=f,o))return a;let p=t[i+1];i=o?fs(p):Go(p)}if(e!==null){let u=s?e.residualClasses:e.residualStyles;u!=null&&(a=fy(u,r))}return a}function jh(t){return t!==void 0}function dB(t,e){return t==null||t===""||(typeof e=="string"?t=t+e:typeof t=="object"&&(t=Qt(Ju(t)))),t}function hB(t,e){return(t.flags&(e?8:16))!==0}function fB(t,e,n,r,i,s){let o=e.consts,a=Dh(o,i),u=ef(e,t,2,r,a);return hA(e,n,u,Dh(o,s)),u.attrs!==null&&n_(u,u.attrs,!1),u.mergedAttrs!==null&&n_(u,u.mergedAttrs,!0),e.queries!==null&&e.queries.elementStart(e,u),u}function w(t,e,n,r){let i=Ve(),s=Vn(),o=si+t,a=i[It],u=s.firstCreatePass?fB(o,s,i,e,n,r):s.data[o],c=pB(s,i,u,a,e,t);i[o]=c;let l=p_(u);return Zu(u,!0),zS(a,c,u),(u.flags&32)!==32&&w_()&&P_(s,i,c,u),AL()===0&&ds(c,i),xL(),l&&(cA(s,i,u),uA(s,u,i)),r!==null&&lA(i,u),w}function E(){let t=tn();aS()?OL():(t=t.parent,Zu(t,!1));let e=t;NL(e)&&PL(),ML();let n=Vn();return n.firstCreatePass&&(I_(n,t),Yb(t)&&n.queries.elementEnd(t)),e.classesWithoutHost!=null&&KL(e)&&Ib(n,e,Ve(),e.classesWithoutHost,!0),e.stylesWithoutHost!=null&&QL(e)&&Ib(n,e,Ve(),e.stylesWithoutHost,!1),E}function _s(t,e,n,r){return w(t,e,n,r),E(),_s}var pB=(t,e,n,r,i,s)=>(E_(!0),jS(r,i,qL()));function Jo(){return Ve()}var Uh="en-US";var gB=Uh;function mB(t){typeof t=="string"&&(gB=t.toLowerCase().replace(/_/g,"-"))}function vs(t){return!!t&&typeof t.then=="function"}function TA(t){return!!t&&typeof t.subscribe=="function"}function pe(t,e,n,r){let i=Ve(),s=Vn(),o=tn();return _B(s,i,i[It],o,t,e,r),pe}function yB(t,e,n,r){let i=t.cleanup;if(i!=null)for(let s=0;s<i.length-1;s+=2){let o=i[s];if(o===n&&i[s+1]===r){let a=e[Bu],u=i[s+2];return a.length>u?a[u]:null}typeof o=="string"&&(s+=2)}return null}function _B(t,e,n,r,i,s,o){let a=p_(r),c=t.firstCreatePass&&tU(t),l=e[On],d=eU(e),h=!0;if(r.type&3||o){let g=vn(r,e),_=o?o(g):g,b=d.length,P=o?H=>o(tr(H[r.index])):r.index,A=null;if(!o&&a&&(A=yB(t,e,i,r.index)),A!==null){let H=A.__ngLastListenerFn__||A;H.__ngNextListenerFn__=s,A.__ngLastListenerFn__=s,h=!1}else{s=Tb(r,e,l,s,!1);let H=n.listen(_,i,s);d.push(s,H),c&&c.push(i,P,b,b+1)}}else s=Tb(r,e,l,s,!1);let f=r.outputs,p;if(h&&f!==null&&(p=f[i])){let g=p.length;if(g)for(let _=0;_<g;_+=2){let b=p[_],P=p[_+1],G=e[b][P].subscribe(s),J=d.length;d.push(s,G),c&&c.push(i,r.index,J,-(J+1))}}}function Db(t,e,n,r){try{return Zn(6,e,n),n(r)!==!1}catch(i){return yA(t,i),!1}finally{Zn(7,e,n)}}function Tb(t,e,n,r,i){return function s(o){if(o===Function)return r;let a=t.componentOffset>-1?ui(t.index,e):e;U_(a);let u=Db(e,n,r,o),c=s.__ngNextListenerFn__;for(;c;)u=Db(e,n,c,o)&&u,c=c.__ngNextListenerFn__;return i&&u===!1&&o.preventDefault(),u}}function ea(t=1){return HL(t)}var K_=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=EB;let t=e;return t})(),vB=K_,wB=class extends vB{constructor(e,n,r){super(),this._declarationLView=e,this._declarationTContainer=n,this.elementRef=r}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(e,n){return this.createEmbeddedViewImpl(e,n)}createEmbeddedViewImpl(e,n,r){let i=FU(this._declarationLView,this._declarationTContainer,e,{injector:n,dehydratedView:r});return new hs(i)}};function EB(){return IB(tn(),Ve())}function IB(t,e){return t.type&4?new wB(e,t,Xh(t,e)):null}function T(t,e=""){let n=Ve(),r=Vn(),i=t+si,s=r.firstCreatePass?ef(r,i,1,e,null):r.data[i],o=CB(r,n,s,e,t);n[i]=o,w_()&&P_(r,n,o,s),Zu(s,!1)}var CB=(t,e,n,r,i)=>(E_(!0),L2(e[It],r));function Ct(t){return bA("",t,""),Ct}function bA(t,e,n){let r=Ve(),i=YU(r,t,e,n);return i!==Zo&&nU(r,Qo(),i),bA}function DB(t,e,n){let r=Vn();if(r.firstCreatePass){let i=oi(t);u_(n,r.data,r.blueprint,i,!0),u_(e,r.data,r.blueprint,i,!1)}}function u_(t,e,n,r,i){if(t=Ot(t),Array.isArray(t))for(let s=0;s<t.length;s++)u_(t[s],e,n,r,i);else{let s=Vn(),o=Ve(),a=tn(),u=Ho(t)?t:Ot(t.provide),c=PS(t),l=a.providerIndexes&1048575,d=a.directiveStart,h=a.providerIndexes>>20;if(Ho(t)||!t.multi){let f=new ls(c,i,oe),p=Cy(u,e,i?l:l+h,d);p===-1?(Ny(Sh(a,o),s,u),Iy(s,t,e.length),e.push(u),a.directiveStart++,a.directiveEnd++,i&&(a.providerIndexes+=1048576),n.push(f),o.push(f)):(n[p]=f,o[p]=f)}else{let f=Cy(u,e,l+h,d),p=Cy(u,e,l,l+h),g=f>=0&&n[f],_=p>=0&&n[p];if(i&&!_||!i&&!g){Ny(Sh(a,o),s,u);let b=SB(i?bB:TB,n.length,i,r,c);!i&&_&&(n[p].providerFactory=b),Iy(s,t,e.length,0),e.push(u),a.directiveStart++,a.directiveEnd++,i&&(a.providerIndexes+=1048576),n.push(b),o.push(b)}else{let b=SA(n[i?p:f],c,!i&&r);Iy(s,t,f>-1?f:p,b)}!i&&r&&_&&n[p].componentProviders++}}}function Iy(t,e,n,r){let i=Ho(e),s=I2(e);if(i||s){let u=(s?Ot(e.useClass):e).prototype.ngOnDestroy;if(u){let c=t.destroyHooks||(t.destroyHooks=[]);if(!i&&e.multi){let l=c.indexOf(n);l===-1?c.push(n,[r,u]):c[l+1].push(r,u)}else c.push(n,u)}}}function SA(t,e,n){return n&&t.componentProviders++,t.multi.push(e)-1}function Cy(t,e,n,r){for(let i=n;i<r;i++)if(e[i]===t)return i;return-1}function TB(t,e,n,r){return c_(this.multi,[])}function bB(t,e,n,r){let i=this.multi,s;if(this.providerFactory){let o=this.providerFactory.componentProviders,a=Bo(n,n[fe],this.providerFactory.index,r);s=a.slice(0,o),c_(i,s);for(let u=o;u<a.length;u++)s.push(a[u])}else s=[],c_(i,s);return s}function c_(t,e){for(let n=0;n<t.length;n++){let r=t[n];e.push(r())}return e}function SB(t,e,n,r,i){let s=new ls(t,n,oe);return s.multi=[],s.index=e,s.componentProviders=0,SA(s,i,r&&!n),s}function tc(t,e=[]){return n=>{n.providersResolver=(r,i)=>DB(r,i?i(t):t,e)}}var AB=(()=>{let e=class e{constructor(r){this._injector=r,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(r){if(!r.standalone)return null;if(!this.cachedInjectors.has(r)){let i=MS(!1,r.type),s=i.length>0?nf([i],this._injector,`Standalone[${r.type.name}]`):null;this.cachedInjectors.set(r,s)}return this.cachedInjectors.get(r)}ngOnDestroy(){try{for(let r of this.cachedInjectors.values())r!==null&&r.destroy()}finally{this.cachedInjectors.clear()}}};e.\u0275prov=V({token:e,providedIn:"environment",factory:()=>new e(C(en))});let t=e;return t})();function AA(t){B_("NgStandalone"),t.getStandaloneInjector=e=>e.get(AB).getOrCreateStandaloneInjector(t)}var fh=null;function xB(t){fh!==null&&(t.defaultEncapsulation!==fh.defaultEncapsulation||t.preserveWhitespaces!==fh.preserveWhitespaces)||(fh=t)}var Rr=class{constructor(e){this.full=e;let n=e.split(".");this.major=n[0],this.minor=n[1],this.patch=n.slice(2).join(".")}},xA=new Rr("17.1.3"),af=(()=>{let e=class e{log(r){console.log(r)}warn(r){console.warn(r)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"platform"});let t=e;return t})(),l_=class{constructor(e,n){this.ngModuleFactory=e,this.componentFactories=n}},uf=(()=>{let e=class e{compileModuleSync(r){return new Lh(r)}compileModuleAsync(r){return Promise.resolve(this.compileModuleSync(r))}compileModuleAndAllComponentsSync(r){let i=this.compileModuleSync(r),s=Gb(r),o=FS(s.declarations).reduce((a,u)=>{let c=ii(u);return c&&a.push(new qo(c)),a},[]);return new l_(i,o)}compileModuleAndAllComponentsAsync(r){return Promise.resolve(this.compileModuleAndAllComponentsSync(r))}clearCache(){}clearCacheFor(r){}getModuleId(r){}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),MB=new F("");var Q_=new F(""),nc=new F(""),cf=(()=>{let e=class e{constructor(r,i,s){this._ngZone=r,this.registry=i,this._pendingCount=0,this._isZoneStable=!0,this._callbacks=[],this.taskTrackingZone=null,Y_||(RB(s),s.addToWindow(i)),this._watchAngularEvents(),r.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{le.assertNotInAngularZone(),queueMicrotask(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&this._pendingCount===0&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())queueMicrotask(()=>{for(;this._callbacks.length!==0;){let r=this._callbacks.pop();clearTimeout(r.timeoutId),r.doneCb()}});else{let r=this.getPendingTasks();this._callbacks=this._callbacks.filter(i=>i.updateCb&&i.updateCb(r)?(clearTimeout(i.timeoutId),!1):!0)}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(r=>({source:r.source,creationLocation:r.creationLocation,data:r.data})):[]}addCallback(r,i,s){let o=-1;i&&i>0&&(o=setTimeout(()=>{this._callbacks=this._callbacks.filter(a=>a.timeoutId!==o),r()},i)),this._callbacks.push({doneCb:r,timeoutId:o,updateCb:s})}whenStable(r,i,s){if(s&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(r,i,s),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(r){this.registry.registerApplication(r,this)}unregisterApplication(r){this.registry.unregisterApplication(r)}findProviders(r,i,s){return[]}};e.\u0275fac=function(i){return new(i||e)(C(le),C(lf),C(nc))},e.\u0275prov=V({token:e,factory:e.\u0275fac});let t=e;return t})(),lf=(()=>{let e=class e{constructor(){this._applications=new Map}registerApplication(r,i){this._applications.set(r,i)}unregisterApplication(r){this._applications.delete(r)}unregisterAllApplications(){this._applications.clear()}getTestability(r){return this._applications.get(r)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(r,i=!0){return Y_?.findTestabilityInTree(this,r,i)??null}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"platform"});let t=e;return t})();function RB(t){Y_=t}var Y_,df=new F(""),MA=(()=>{let e=class e{constructor(){this.initialized=!1,this.done=!1,this.donePromise=new Promise((r,i)=>{this.resolve=r,this.reject=i}),this.appInits=k(df,{optional:!0})??[]}runInitializers(){if(this.initialized)return;let r=[];for(let s of this.appInits){let o=s();if(vs(o))r.push(o);else if(TA(o)){let a=new Promise((u,c)=>{o.subscribe({complete:u,error:c})});r.push(a)}}let i=()=>{this.done=!0,this.resolve()};Promise.all(r).then(()=>{i()}).catch(s=>{this.reject(s)}),r.length===0&&i(),this.initialized=!0}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),Z_=new F("");function NB(t,e,n){let r=new Lh(n);return Promise.resolve(r)}function PB(){ET(()=>{throw new $(600,!1)})}function kB(t){return t.isBoundToModule}function OB(t,e,n){try{let r=n();return vs(r)?r.catch(i=>{throw e.runOutsideAngular(()=>t.handleError(i)),i}):r}catch(r){throw e.runOutsideAngular(()=>t.handleError(r)),r}}function RA(t,e){return Array.isArray(e)?e.reduce(RA,t):x(x({},t),e)}var ta=(()=>{let e=class e{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=k(tA),this.afterRenderEffectManager=k(q_),this.componentTypes=[],this.components=[],this.isStable=k(rf).hasPendingTasks.pipe(j(r=>!r)),this._injector=k(en)}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(r,i){let s=r instanceof Ph;if(!this._injector.get(MA).done){let f=!s&&qb(r),p=!1;throw new $(405,p)}let a;s?a=r:a=this._injector.get(Zh).resolveComponentFactory(r),this.componentTypes.push(a.componentType);let u=kB(a)?void 0:this._injector.get(ai),c=i||a.selector,l=a.create(Ln.NULL,[],c,u),d=l.location.nativeElement,h=l.injector.get(Q_,null);return h?.registerApplication(d),l.onDestroy(()=>{this.detachView(l.hostView),_h(this.components,l),h?.unregisterApplication(d)}),this._loadComponent(l),l}tick(){if(this._runningTick)throw new $(101,!1);try{this._runningTick=!0,this.detectChangesInAttachedViews()}catch(r){this.internalErrorHandler(r)}finally{this._runningTick=!1}}detectChangesInAttachedViews(){let r=0;do{if(r===_A)throw new $(103,!1);let i=r===0;for(let{_lView:s,notifyErrorHandler:o}of this._views)!i&&!Sb(s)||this.detectChangesInView(s,o,i);this.afterRenderEffectManager.execute(),r++}while(this._views.some(({_lView:i})=>Sb(i)))}detectChangesInView(r,i,s){let o;s?(o=0,r[z]|=1024):r[z]&64?o=0:o=1,vA(r,i,o)}attachView(r){let i=r;this._views.push(i),i.attachToAppRef(this)}detachView(r){let i=r;_h(this._views,i),i.detachFromAppRef()}_loadComponent(r){this.attachView(r.hostView),this.tick(),this.components.push(r);let i=this._injector.get(Z_,[]);[...this._bootstrapListeners,...i].forEach(s=>s(r))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(r=>r()),this._views.slice().forEach(r=>r.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(r){return this._destroyListeners.push(r),()=>_h(this._destroyListeners,r)}destroy(){if(this._destroyed)throw new $(406,!1);let r=this._injector;r.destroy&&!r.destroyed&&r.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function _h(t,e){let n=t.indexOf(e);n>-1&&t.splice(n,1)}function bb(t){for(let e=t.length-1;e>=0;e--)if(t[e]!==void 0)return t[e]}function Sb(t){return m_(t)}var FB=(()=>{let e=class e{constructor(){this.zone=k(le),this.applicationRef=k(ta)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function VB(t){return[{provide:le,useFactory:t},{provide:$o,multi:!0,useFactory:()=>{let e=k(FB,{optional:!0});return()=>e.initialize()}},{provide:$o,multi:!0,useFactory:()=>{let e=k(UB);return()=>{e.initialize()}}},{provide:tA,useFactory:LB}]}function LB(){let t=k(le),e=k(nr);return n=>t.runOutsideAngular(()=>e.handleError(n))}function jB(t){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:t?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:t?.runCoalescing??!1}}var UB=(()=>{let e=class e{constructor(){this.subscription=new He,this.initialized=!1,this.zone=k(le),this.pendingTasks=k(rf)}initialize(){if(this.initialized)return;this.initialized=!0;let r=null;!this.zone.isStable&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(r=this.pendingTasks.add()),this.zone.runOutsideAngular(()=>{this.subscription.add(this.zone.onStable.subscribe(()=>{le.assertNotInAngularZone(),queueMicrotask(()=>{r!==null&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(this.pendingTasks.remove(r),r=null)})}))}),this.subscription.add(this.zone.onUnstable.subscribe(()=>{le.assertInAngularZone(),r??=this.pendingTasks.add()}))}ngOnDestroy(){this.subscription.unsubscribe()}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function BB(){return typeof $localize<"u"&&$localize.locale||Uh}var X_=new F("",{providedIn:"root",factory:()=>k(X_,se.Optional|se.SkipSelf)||BB()});var NA=new F(""),PA=(()=>{let e=class e{constructor(r){this._injector=r,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(r,i){let s=mU(i?.ngZone,jB({eventCoalescing:i?.ngZoneEventCoalescing,runCoalescing:i?.ngZoneRunCoalescing}));return s.run(()=>{let o=zU(r.moduleType,this.injector,VB(()=>s)),a=o.injector.get(nr,null);return s.runOutsideAngular(()=>{let u=s.onError.subscribe({next:c=>{a.handleError(c)}});o.onDestroy(()=>{_h(this._modules,o),u.unsubscribe()})}),OB(a,s,()=>{let u=o.injector.get(MA);return u.runInitializers(),u.donePromise.then(()=>{let c=o.injector.get(X_,Uh);return mB(c||Uh),this._moduleDoBootstrap(o),o})})})}bootstrapModule(r,i=[]){let s=RA({},i);return NB(this.injector,s,r).then(o=>this.bootstrapModuleFactory(o,s))}_moduleDoBootstrap(r){let i=r.injector.get(ta);if(r._bootstrapComponents.length>0)r._bootstrapComponents.forEach(s=>i.bootstrap(s));else if(r.instance.ngDoBootstrap)r.instance.ngDoBootstrap(i);else throw new $(-403,!1);this._modules.push(r)}onDestroy(r){this._destroyListeners.push(r)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new $(404,!1);this._modules.slice().forEach(i=>i.destroy()),this._destroyListeners.forEach(i=>i());let r=this._injector.get(NA,null);r&&(r.forEach(i=>i()),r.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}};e.\u0275fac=function(i){return new(i||e)(C(Ln))},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"platform"});let t=e;return t})(),Lu=null,kA=new F("");function $B(t){if(Lu&&!Lu.get(kA,!1))throw new $(400,!1);PB(),Lu=t;let e=t.get(PA);return GB(t),e}function J_(t,e,n=[]){let r=`Platform: ${e}`,i=new F(r);return(s=[])=>{let o=OA();if(!o||o.injector.get(kA,!1)){let a=[...n,...s,{provide:i,useValue:!0}];t?t(a):$B(HB(a,r))}return qB(i)}}function HB(t=[],e){return Ln.create({name:e,providers:[{provide:Wh,useValue:"platform"},{provide:NA,useValue:new Set([()=>Lu=null])},...t]})}function qB(t){let e=OA();if(!e)throw new $(401,!1);return e}function OA(){return Lu?.get(PA)??null}function GB(t){t.get(x_,null)?.forEach(n=>n())}function ev(){return!1}var FA=J_(null,"core",[]),VA=(()=>{let e=class e{constructor(r){}};e.\u0275fac=function(i){return new(i||e)(C(ta))},e.\u0275mod=et({type:e}),e.\u0275inj=Je({});let t=e;return t})();function ws(t){return typeof t=="boolean"?t:t!=null&&t!=="false"}function LA(t){let e=ii(t);if(!e)return null;let n=new qo(e);return{get selector(){return n.selector},get type(){return n.componentType},get inputs(){return n.inputs},get outputs(){return n.outputs},get ngContentSelectors(){return n.ngContentSelectors},get isStandalone(){return e.standalone},get isSignal(){return e.signals}}}var $A=null;function ir(){return $A}function HA(t){$A??=t}var hf=class{},Yt=new F(""),iv=(()=>{let e=class e{historyGo(r){throw new Error("")}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:()=>k(zB),providedIn:"platform"});let t=e;return t})(),qA=new F(""),zB=(()=>{let e=class e extends iv{constructor(){super(),this._doc=k(Yt),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return ir().getBaseHref(this._doc)}onPopState(r){let i=ir().getGlobalEventTarget(this._doc,"window");return i.addEventListener("popstate",r,!1),()=>i.removeEventListener("popstate",r)}onHashChange(r){let i=ir().getGlobalEventTarget(this._doc,"window");return i.addEventListener("hashchange",r,!1),()=>i.removeEventListener("hashchange",r)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(r){this._location.pathname=r}pushState(r,i,s){this._history.pushState(r,i,s)}replaceState(r,i,s){this._history.replaceState(r,i,s)}forward(){this._history.forward()}back(){this._history.back()}historyGo(r=0){this._history.go(r)}getState(){return this._history.state}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:()=>new e,providedIn:"platform"});let t=e;return t})();function sv(t,e){if(t.length==0)return e;if(e.length==0)return t;let n=0;return t.endsWith("/")&&n++,e.startsWith("/")&&n++,n==2?t+e.substring(1):n==1?t+e:t+"/"+e}function jA(t){let e=t.match(/#|\?|$/),n=e&&e.index||t.length,r=n-(t[n-1]==="/"?1:0);return t.slice(0,r)+t.slice(n)}function Or(t){return t&&t[0]!=="?"?"?"+t:t}var Fr=(()=>{let e=class e{historyGo(r){throw new Error("")}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:()=>k(ov),providedIn:"root"});let t=e;return t})(),GA=new F(""),ov=(()=>{let e=class e extends Fr{constructor(r,i){super(),this._platformLocation=r,this._removeListenerFns=[],this._baseHref=i??this._platformLocation.getBaseHrefFromDOM()??k(Yt).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(r){this._removeListenerFns.push(this._platformLocation.onPopState(r),this._platformLocation.onHashChange(r))}getBaseHref(){return this._baseHref}prepareExternalUrl(r){return sv(this._baseHref,r)}path(r=!1){let i=this._platformLocation.pathname+Or(this._platformLocation.search),s=this._platformLocation.hash;return s&&r?`${i}${s}`:i}pushState(r,i,s,o){let a=this.prepareExternalUrl(s+Or(o));this._platformLocation.pushState(r,i,a)}replaceState(r,i,s,o){let a=this.prepareExternalUrl(s+Or(o));this._platformLocation.replaceState(r,i,a)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(r=0){this._platformLocation.historyGo?.(r)}};e.\u0275fac=function(i){return new(i||e)(C(iv),C(GA,8))},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),zA=(()=>{let e=class e extends Fr{constructor(r,i){super(),this._platformLocation=r,this._baseHref="",this._removeListenerFns=[],i!=null&&(this._baseHref=i)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(r){this._removeListenerFns.push(this._platformLocation.onPopState(r),this._platformLocation.onHashChange(r))}getBaseHref(){return this._baseHref}path(r=!1){let i=this._platformLocation.hash??"#";return i.length>0?i.substring(1):i}prepareExternalUrl(r){let i=sv(this._baseHref,r);return i.length>0?"#"+i:i}pushState(r,i,s,o){let a=this.prepareExternalUrl(s+Or(o));a.length==0&&(a=this._platformLocation.pathname),this._platformLocation.pushState(r,i,a)}replaceState(r,i,s,o){let a=this.prepareExternalUrl(s+Or(o));a.length==0&&(a=this._platformLocation.pathname),this._platformLocation.replaceState(r,i,a)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(r=0){this._platformLocation.historyGo?.(r)}};e.\u0275fac=function(i){return new(i||e)(C(iv),C(GA,8))},e.\u0275prov=V({token:e,factory:e.\u0275fac});let t=e;return t})(),na=(()=>{let e=class e{constructor(r){this._subject=new ut,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=r;let i=this._locationStrategy.getBaseHref();this._basePath=QB(jA(UA(i))),this._locationStrategy.onPopState(s=>{this._subject.emit({url:this.path(!0),pop:!0,state:s.state,type:s.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(r=!1){return this.normalize(this._locationStrategy.path(r))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(r,i=""){return this.path()==this.normalize(r+Or(i))}normalize(r){return e.stripTrailingSlash(KB(this._basePath,UA(r)))}prepareExternalUrl(r){return r&&r[0]!=="/"&&(r="/"+r),this._locationStrategy.prepareExternalUrl(r)}go(r,i="",s=null){this._locationStrategy.pushState(s,"",r,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(r+Or(i)),s)}replaceState(r,i="",s=null){this._locationStrategy.replaceState(s,"",r,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(r+Or(i)),s)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(r=0){this._locationStrategy.historyGo?.(r)}onUrlChange(r){return this._urlChangeListeners.push(r),this._urlChangeSubscription??=this.subscribe(i=>{this._notifyUrlChangeListeners(i.url,i.state)}),()=>{let i=this._urlChangeListeners.indexOf(r);this._urlChangeListeners.splice(i,1),this._urlChangeListeners.length===0&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(r="",i){this._urlChangeListeners.forEach(s=>s(r,i))}subscribe(r,i,s){return this._subject.subscribe({next:r,error:i,complete:s})}};e.normalizeQueryParams=Or,e.joinWithSlash=sv,e.stripTrailingSlash=jA,e.\u0275fac=function(i){return new(i||e)(C(Fr))},e.\u0275prov=V({token:e,factory:()=>WB(),providedIn:"root"});let t=e;return t})();function WB(){return new na(C(Fr))}function KB(t,e){if(!t||!e.startsWith(t))return e;let n=e.substring(t.length);return n===""||["/",";","?","#"].includes(n[0])?n:e}function UA(t){return t.replace(/\/index.html$/,"")}function QB(t){if(new RegExp("^(https?:)?//").test(t)){let[,n]=t.split(/\/\/[^\/]+/);return n}return t}function WA(t,e){e=encodeURIComponent(e);for(let n of t.split(";")){let r=n.indexOf("="),[i,s]=r==-1?[n,""]:[n.slice(0,r),n.slice(r+1)];if(i.trim()===e)return decodeURIComponent(s)}return null}var tv=class{constructor(e,n,r,i){this.$implicit=e,this.ngForOf=n,this.index=r,this.count=i}get first(){return this.index===0}get last(){return this.index===this.count-1}get even(){return this.index%2===0}get odd(){return!this.even}},ra=(()=>{let e=class e{set ngForOf(r){this._ngForOf=r,this._ngForOfDirty=!0}set ngForTrackBy(r){this._trackByFn=r}get ngForTrackBy(){return this._trackByFn}constructor(r,i,s){this._viewContainer=r,this._template=i,this._differs=s,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForTemplate(r){r&&(this._template=r)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;let r=this._ngForOf;if(!this._differ&&r)if(0)try{}catch{}else this._differ=this._differs.find(r).create(this.ngForTrackBy)}if(this._differ){let r=this._differ.diff(this._ngForOf);r&&this._applyChanges(r)}}_applyChanges(r){let i=this._viewContainer;r.forEachOperation((s,o,a)=>{if(s.previousIndex==null)i.createEmbeddedView(this._template,new tv(s.item,this._ngForOf,-1,-1),a===null?void 0:a);else if(a==null)i.remove(o===null?void 0:o);else if(o!==null){let u=i.get(o);i.move(u,a),BA(u,s)}});for(let s=0,o=i.length;s<o;s++){let u=i.get(s).context;u.index=s,u.count=o,u.ngForOf=this._ngForOf}r.forEachIdentityChange(s=>{let o=i.get(s.currentIndex);BA(o,s)})}static ngTemplateContextGuard(r,i){return!0}};e.\u0275fac=function(i){return new(i||e)(oe(ec),oe(K_),oe(V_))},e.\u0275dir=Lt({type:e,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0});let t=e;return t})();function BA(t,e){t.context.$implicit=e.item}var KA=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=et({type:e}),e.\u0275inj=Je({});let t=e;return t})(),av="browser",YB="server";function ZB(t){return t===av}function Es(t){return t===YB}var QA=(()=>{let e=class e{};e.\u0275prov=V({token:e,providedIn:"root",factory:()=>ZB(k(xt))?new nv(k(Yt),window):new rv});let t=e;return t})(),nv=class{constructor(e,n){this.document=e,this.window=n,this.offset=()=>[0,0]}setOffset(e){Array.isArray(e)?this.offset=()=>e:this.offset=e}getScrollPosition(){return[this.window.scrollX,this.window.scrollY]}scrollToPosition(e){this.window.scrollTo(e[0],e[1])}scrollToAnchor(e){let n=XB(this.document,e);n&&(this.scrollToElement(n),n.focus())}setHistoryScrollRestoration(e){this.window.history.scrollRestoration=e}scrollToElement(e){let n=e.getBoundingClientRect(),r=n.left+this.window.pageXOffset,i=n.top+this.window.pageYOffset,s=this.offset();this.window.scrollTo(r-s[0],i-s[1])}};function XB(t,e){let n=t.getElementById(e)||t.getElementsByName(e)[0];if(n)return n;if(typeof t.createTreeWalker=="function"&&t.body&&typeof t.body.attachShadow=="function"){let r=t.createTreeWalker(t.body,NodeFilter.SHOW_ELEMENT),i=r.currentNode;for(;i;){let s=i.shadowRoot;if(s){let o=s.getElementById(e)||s.querySelector(`[name="${e}"]`);if(o)return o}i=r.nextNode()}}return null}var rv=class{setOffset(e){}getScrollPosition(){return[0,0]}scrollToPosition(e){}scrollToAnchor(e){}setHistoryScrollRestoration(e){}},ff=class{};var lv=class extends hf{constructor(){super(...arguments),this.supportsDOMEvents=!0}},dv=class t extends lv{static makeCurrent(){HA(new t)}onAndCancel(e,n,r){return e.addEventListener(n,r),()=>{e.removeEventListener(n,r)}}dispatchEvent(e,n){e.dispatchEvent(n)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,n){return n=n||this.getDefaultDocument(),n.createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,n){return n==="window"?window:n==="document"?e:n==="body"?e.body:null}getBaseHref(e){let n=e$();return n==null?null:t$(n)}resetBaseElement(){rc=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return WA(document.cookie,e)}},rc=null;function e$(){return rc=rc||document.querySelector("base"),rc?rc.getAttribute("href"):null}function t$(t){return new URL(t,document.baseURI).pathname}var hv=class{addToWindow(e){Ft.getAngularTestability=(r,i=!0)=>{let s=e.findTestabilityInTree(r,i);if(s==null)throw new $(5103,!1);return s},Ft.getAllAngularTestabilities=()=>e.getAllTestabilities(),Ft.getAllAngularRootElements=()=>e.getAllRootElements();let n=r=>{let i=Ft.getAllAngularTestabilities(),s=i.length,o=function(){s--,s==0&&r()};i.forEach(a=>{a.whenStable(o)})};Ft.frameworkStabilizers||(Ft.frameworkStabilizers=[]),Ft.frameworkStabilizers.push(n)}findTestabilityInTree(e,n,r){if(n==null)return null;let i=e.getTestability(n);return i??(r?ir().isShadowRoot(n)?this.findTestabilityInTree(e,n.host,!0):this.findTestabilityInTree(e,n.parentElement,!0):null)}},n$=(()=>{let e=class e{build(){return new XMLHttpRequest}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:e.\u0275fac});let t=e;return t})(),fv=new F(""),JA=(()=>{let e=class e{constructor(r,i){this._zone=i,this._eventNameToPlugin=new Map,r.forEach(s=>{s.manager=this}),this._plugins=r.slice().reverse()}addEventListener(r,i,s){return this._findPluginFor(i).addEventListener(r,i,s)}getZone(){return this._zone}_findPluginFor(r){let i=this._eventNameToPlugin.get(r);if(i)return i;if(i=this._plugins.find(o=>o.supports(r)),!i)throw new $(5101,!1);return this._eventNameToPlugin.set(r,i),i}};e.\u0275fac=function(i){return new(i||e)(C(fv),C(le))},e.\u0275prov=V({token:e,factory:e.\u0275fac});let t=e;return t})(),gf=class{constructor(e){this._doc=e}},uv="ng-app-id",ex=(()=>{let e=class e{constructor(r,i,s,o={}){this.doc=r,this.appId=i,this.nonce=s,this.platformId=o,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=Es(o),this.resetHostNodes()}addStyles(r){for(let i of r)this.changeUsageCount(i,1)===1&&this.onStyleAdded(i)}removeStyles(r){for(let i of r)this.changeUsageCount(i,-1)<=0&&this.onStyleRemoved(i)}ngOnDestroy(){let r=this.styleNodesInDOM;r&&(r.forEach(i=>i.remove()),r.clear());for(let i of this.getAllStyles())this.onStyleRemoved(i);this.resetHostNodes()}addHost(r){this.hostNodes.add(r);for(let i of this.getAllStyles())this.addStyleToHost(r,i)}removeHost(r){this.hostNodes.delete(r)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(r){for(let i of this.hostNodes)this.addStyleToHost(i,r)}onStyleRemoved(r){let i=this.styleRef;i.get(r)?.elements?.forEach(s=>s.remove()),i.delete(r)}collectServerRenderedStyles(){let r=this.doc.head?.querySelectorAll(`style[${uv}="${this.appId}"]`);if(r?.length){let i=new Map;return r.forEach(s=>{s.textContent!=null&&i.set(s.textContent,s)}),i}return null}changeUsageCount(r,i){let s=this.styleRef;if(s.has(r)){let o=s.get(r);return o.usage+=i,o.usage}return s.set(r,{usage:i,elements:[]}),i}getStyleElement(r,i){let s=this.styleNodesInDOM,o=s?.get(i);if(o?.parentNode===r)return s.delete(i),o.removeAttribute(uv),o;{let a=this.doc.createElement("style");return this.nonce&&a.setAttribute("nonce",this.nonce),a.textContent=i,this.platformIsServer&&a.setAttribute(uv,this.appId),r.appendChild(a),a}}addStyleToHost(r,i){let s=this.getStyleElement(r,i),o=this.styleRef,a=o.get(i)?.elements;a?a.push(s):o.set(i,{elements:[s],usage:1})}resetHostNodes(){let r=this.hostNodes;r.clear(),r.add(this.doc.head)}};e.\u0275fac=function(i){return new(i||e)(C(Yt),C(Kh),C(M_,8),C(xt))},e.\u0275prov=V({token:e,factory:e.\u0275fac});let t=e;return t})(),cv={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},gv=/%COMP%/g,tx="%COMP%",r$=`_nghost-${tx}`,i$=`_ngcontent-${tx}`,s$=!0,o$=new F("",{providedIn:"root",factory:()=>s$});function a$(t){return i$.replace(gv,t)}function u$(t){return r$.replace(gv,t)}function nx(t,e){return e.map(n=>n.replace(gv,t))}var YA=(()=>{let e=class e{constructor(r,i,s,o,a,u,c,l=null){this.eventManager=r,this.sharedStylesHost=i,this.appId=s,this.removeStylesOnCompDestroy=o,this.doc=a,this.platformId=u,this.ngZone=c,this.nonce=l,this.rendererByCompId=new Map,this.platformIsServer=Es(u),this.defaultRenderer=new ic(r,a,c,this.platformIsServer)}createRenderer(r,i){if(!r||!i)return this.defaultRenderer;this.platformIsServer&&i.encapsulation===Jn.ShadowDom&&(i=ue(x({},i),{encapsulation:Jn.Emulated}));let s=this.getOrCreateRenderer(r,i);return s instanceof mf?s.applyToHost(r):s instanceof sc&&s.applyStyles(),s}getOrCreateRenderer(r,i){let s=this.rendererByCompId,o=s.get(i.id);if(!o){let a=this.doc,u=this.ngZone,c=this.eventManager,l=this.sharedStylesHost,d=this.removeStylesOnCompDestroy,h=this.platformIsServer;switch(i.encapsulation){case Jn.Emulated:o=new mf(c,l,i,this.appId,d,a,u,h);break;case Jn.ShadowDom:return new pv(c,l,r,i,a,u,this.nonce,h);default:o=new sc(c,l,i,d,a,u,h);break}s.set(i.id,o)}return o}ngOnDestroy(){this.rendererByCompId.clear()}};e.\u0275fac=function(i){return new(i||e)(C(JA),C(ex),C(Kh),C(o$),C(Yt),C(xt),C(le),C(M_))},e.\u0275prov=V({token:e,factory:e.\u0275fac});let t=e;return t})(),ic=class{constructor(e,n,r,i){this.eventManager=e,this.doc=n,this.ngZone=r,this.platformIsServer=i,this.data=Object.create(null),this.throwOnSyntheticProps=!0,this.destroyNode=null}destroy(){}createElement(e,n){return n?this.doc.createElementNS(cv[n]||n,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,n){(ZA(e)?e.content:e).appendChild(n)}insertBefore(e,n,r){e&&(ZA(e)?e.content:e).insertBefore(n,r)}removeChild(e,n){e&&e.removeChild(n)}selectRootElement(e,n){let r=typeof e=="string"?this.doc.querySelector(e):e;if(!r)throw new $(-5104,!1);return n||(r.textContent=""),r}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,n,r,i){if(i){n=i+":"+n;let s=cv[i];s?e.setAttributeNS(s,n,r):e.setAttribute(n,r)}else e.setAttribute(n,r)}removeAttribute(e,n,r){if(r){let i=cv[r];i?e.removeAttributeNS(i,n):e.removeAttribute(`${r}:${n}`)}else e.removeAttribute(n)}addClass(e,n){e.classList.add(n)}removeClass(e,n){e.classList.remove(n)}setStyle(e,n,r,i){i&(Mr.DashCase|Mr.Important)?e.style.setProperty(n,r,i&Mr.Important?"important":""):e.style[n]=r}removeStyle(e,n,r){r&Mr.DashCase?e.style.removeProperty(n):e.style[n]=""}setProperty(e,n,r){e!=null&&(e[n]=r)}setValue(e,n){e.nodeValue=n}listen(e,n,r){if(typeof e=="string"&&(e=ir().getGlobalEventTarget(this.doc,e),!e))throw new Error(`Unsupported event target ${e} for event ${n}`);return this.eventManager.addEventListener(e,n,this.decoratePreventDefault(r))}decoratePreventDefault(e){return n=>{if(n==="__ngUnwrap__")return e;(this.platformIsServer?this.ngZone.runGuarded(()=>e(n)):e(n))===!1&&n.preventDefault()}}};function ZA(t){return t.tagName==="TEMPLATE"&&t.content!==void 0}var pv=class extends ic{constructor(e,n,r,i,s,o,a,u){super(e,s,o,u),this.sharedStylesHost=n,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);let c=nx(i.id,i.styles);for(let l of c){let d=document.createElement("style");a&&d.setAttribute("nonce",a),d.textContent=l,this.shadowRoot.appendChild(d)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,n){return super.appendChild(this.nodeOrShadowRoot(e),n)}insertBefore(e,n,r){return super.insertBefore(this.nodeOrShadowRoot(e),n,r)}removeChild(e,n){return super.removeChild(this.nodeOrShadowRoot(e),n)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}},sc=class extends ic{constructor(e,n,r,i,s,o,a,u){super(e,s,o,a),this.sharedStylesHost=n,this.removeStylesOnCompDestroy=i,this.styles=u?nx(u,r.styles):r.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}},mf=class extends sc{constructor(e,n,r,i,s,o,a,u){let c=i+"-"+r.id;super(e,n,r,s,o,a,u,c),this.contentAttr=a$(c),this.hostAttr=u$(c)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,n){let r=super.createElement(e,n);return super.setAttribute(r,this.contentAttr,""),r}},c$=(()=>{let e=class e extends gf{constructor(r){super(r)}supports(r){return!0}addEventListener(r,i,s){return r.addEventListener(i,s,!1),()=>this.removeEventListener(r,i,s)}removeEventListener(r,i,s){return r.removeEventListener(i,s)}};e.\u0275fac=function(i){return new(i||e)(C(Yt))},e.\u0275prov=V({token:e,factory:e.\u0275fac});let t=e;return t})(),XA=["alt","control","meta","shift"],l$={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},d$={alt:t=>t.altKey,control:t=>t.ctrlKey,meta:t=>t.metaKey,shift:t=>t.shiftKey},h$=(()=>{let e=class e extends gf{constructor(r){super(r)}supports(r){return e.parseEventName(r)!=null}addEventListener(r,i,s){let o=e.parseEventName(i),a=e.eventCallback(o.fullKey,s,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>ir().onAndCancel(r,o.domEventName,a))}static parseEventName(r){let i=r.toLowerCase().split("."),s=i.shift();if(i.length===0||!(s==="keydown"||s==="keyup"))return null;let o=e._normalizeKey(i.pop()),a="",u=i.indexOf("code");if(u>-1&&(i.splice(u,1),a="code."),XA.forEach(l=>{let d=i.indexOf(l);d>-1&&(i.splice(d,1),a+=l+".")}),a+=o,i.length!=0||o.length===0)return null;let c={};return c.domEventName=s,c.fullKey=a,c}static matchEventFullKeyCode(r,i){let s=l$[r.key]||r.key,o="";return i.indexOf("code.")>-1&&(s=r.code,o="code."),s==null||!s?!1:(s=s.toLowerCase(),s===" "?s="space":s==="."&&(s="dot"),XA.forEach(a=>{if(a!==s){let u=d$[a];u(r)&&(o+=a+".")}}),o+=s,o===i)}static eventCallback(r,i,s){return o=>{e.matchEventFullKeyCode(o,r)&&s.runGuarded(()=>i(o))}}static _normalizeKey(r){return r==="esc"?"escape":r}};e.\u0275fac=function(i){return new(i||e)(C(Yt))},e.\u0275prov=V({token:e,factory:e.\u0275fac});let t=e;return t})();function f$(){dv.makeCurrent()}function p$(){return new nr}function g$(){return OS(document),document}var m$=[{provide:xt,useValue:av},{provide:x_,useValue:f$,multi:!0},{provide:Yt,useFactory:g$,deps:[]}],rx=J_(FA,"browser",m$),y$=new F(""),_$=[{provide:nc,useClass:hv,deps:[]},{provide:Q_,useClass:cf,deps:[le,lf,nc]},{provide:cf,useClass:cf,deps:[le,lf,nc]}],v$=[{provide:Wh,useValue:"root"},{provide:nr,useFactory:p$,deps:[]},{provide:fv,useClass:c$,multi:!0,deps:[Yt,le,xt]},{provide:fv,useClass:h$,multi:!0,deps:[Yt]},YA,ex,JA,{provide:Wu,useExisting:YA},{provide:ff,useClass:n$,deps:[]},[]],ix=(()=>{let e=class e{constructor(r){}static withServerTransition(r){return{ngModule:e,providers:[{provide:Kh,useValue:r.appId}]}}};e.\u0275fac=function(i){return new(i||e)(C(y$,12))},e.\u0275mod=et({type:e}),e.\u0275inj=Je({providers:[...v$,..._$],imports:[KA,VA]});let t=e;return t})();var sx=(()=>{let e=class e{constructor(r){this._doc=r}getTitle(){return this._doc.title}setTitle(r){this._doc.title=r||""}};e.\u0275fac=function(i){return new(i||e)(C(Yt))},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var te="primary",wc=Symbol("RouteTitle"),wv=class{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){let n=this.params[e];return Array.isArray(n)?n[0]:n}return null}getAll(e){if(this.has(e)){let n=this.params[e];return Array.isArray(n)?n:[n]}return[]}get keys(){return Object.keys(this.params)}};function ua(t){return new wv(t)}function w$(t,e,n){let r=n.path.split("/");if(r.length>t.length||n.pathMatch==="full"&&(e.hasChildren()||r.length<t.length))return null;let i={};for(let s=0;s<r.length;s++){let o=r[s],a=t[s];if(o.startsWith(":"))i[o.substring(1)]=a;else if(o!==a.path)return null}return{consumed:t.slice(0,r.length),posParams:i}}function E$(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;++n)if(!sr(t[n],e[n]))return!1;return!0}function sr(t,e){let n=t?Ev(t):void 0,r=e?Ev(e):void 0;if(!n||!r||n.length!=r.length)return!1;let i;for(let s=0;s<n.length;s++)if(i=n[s],!gx(t[i],e[i]))return!1;return!0}function Ev(t){return[...Object.keys(t),...Object.getOwnPropertySymbols(t)]}function gx(t,e){if(Array.isArray(t)&&Array.isArray(e)){if(t.length!==e.length)return!1;let n=[...t].sort(),r=[...e].sort();return n.every((i,s)=>r[s]===i)}else return t===e}function mx(t){return t.length>0?t[t.length-1]:null}function gi(t){return ny(t)?t:vs(t)?_e(Promise.resolve(t)):U(t)}var I$={exact:_x,subset:vx},yx={exact:C$,subset:D$,ignored:()=>!0};function ax(t,e,n){return I$[n.paths](t.root,e.root,n.matrixParams)&&yx[n.queryParams](t.queryParams,e.queryParams)&&!(n.fragment==="exact"&&t.fragment!==e.fragment)}function C$(t,e){return sr(t,e)}function _x(t,e,n){if(!Cs(t.segments,e.segments)||!vf(t.segments,e.segments,n)||t.numberOfChildren!==e.numberOfChildren)return!1;for(let r in e.children)if(!t.children[r]||!_x(t.children[r],e.children[r],n))return!1;return!0}function D$(t,e){return Object.keys(e).length<=Object.keys(t).length&&Object.keys(e).every(n=>gx(t[n],e[n]))}function vx(t,e,n){return wx(t,e,e.segments,n)}function wx(t,e,n,r){if(t.segments.length>n.length){let i=t.segments.slice(0,n.length);return!(!Cs(i,n)||e.hasChildren()||!vf(i,n,r))}else if(t.segments.length===n.length){if(!Cs(t.segments,n)||!vf(t.segments,n,r))return!1;for(let i in e.children)if(!t.children[i]||!vx(t.children[i],e.children[i],r))return!1;return!0}else{let i=n.slice(0,t.segments.length),s=n.slice(t.segments.length);return!Cs(t.segments,i)||!vf(t.segments,i,r)||!t.children[te]?!1:wx(t.children[te],e,s,r)}}function vf(t,e,n){return e.every((r,i)=>yx[n](t[i].parameters,r.parameters))}var di=class{constructor(e=new Ie([],{}),n={},r=null){this.root=e,this.queryParams=n,this.fragment=r}get queryParamMap(){return this._queryParamMap??=ua(this.queryParams),this._queryParamMap}toString(){return S$.serialize(this)}},Ie=class{constructor(e,n){this.segments=e,this.children=n,this.parent=null,Object.values(n).forEach(r=>r.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return wf(this)}},Is=class{constructor(e,n){this.path=e,this.parameters=n}get parameterMap(){return this._parameterMap??=ua(this.parameters),this._parameterMap}toString(){return Ix(this)}};function T$(t,e){return Cs(t,e)&&t.every((n,r)=>sr(n.parameters,e[r].parameters))}function Cs(t,e){return t.length!==e.length?!1:t.every((n,r)=>n.path===e[r].path)}function b$(t,e){let n=[];return Object.entries(t.children).forEach(([r,i])=>{r===te&&(n=n.concat(e(i,r)))}),Object.entries(t.children).forEach(([r,i])=>{r!==te&&(n=n.concat(e(i,r)))}),n}var Ec=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:()=>new hc,providedIn:"root"});let t=e;return t})(),hc=class{parse(e){let n=new Cv(e);return new di(n.parseRootSegment(),n.parseQueryParams(),n.parseFragment())}serialize(e){let n=`/${oc(e.root,!0)}`,r=M$(e.queryParams),i=typeof e.fragment=="string"?`#${A$(e.fragment)}`:"";return`${n}${r}${i}`}},S$=new hc;function wf(t){return t.segments.map(e=>Ix(e)).join("/")}function oc(t,e){if(!t.hasChildren())return wf(t);if(e){let n=t.children[te]?oc(t.children[te],!1):"",r=[];return Object.entries(t.children).forEach(([i,s])=>{i!==te&&r.push(`${i}:${oc(s,!1)}`)}),r.length>0?`${n}(${r.join("//")})`:n}else{let n=b$(t,(r,i)=>i===te?[oc(t.children[te],!1)]:[`${i}:${oc(r,!1)}`]);return Object.keys(t.children).length===1&&t.children[te]!=null?`${wf(t)}/${n[0]}`:`${wf(t)}/(${n.join("//")})`}}function Ex(t){return encodeURIComponent(t).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function yf(t){return Ex(t).replace(/%3B/gi,";")}function A$(t){return encodeURI(t)}function Iv(t){return Ex(t).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Ef(t){return decodeURIComponent(t)}function ux(t){return Ef(t.replace(/\+/g,"%20"))}function Ix(t){return`${Iv(t.path)}${x$(t.parameters)}`}function x$(t){return Object.entries(t).map(([e,n])=>`;${Iv(e)}=${Iv(n)}`).join("")}function M$(t){let e=Object.entries(t).map(([n,r])=>Array.isArray(r)?r.map(i=>`${yf(n)}=${yf(i)}`).join("&"):`${yf(n)}=${yf(r)}`).filter(n=>n);return e.length?`?${e.join("&")}`:""}var R$=/^[^\/()?;#]+/;function mv(t){let e=t.match(R$);return e?e[0]:""}var N$=/^[^\/()?;=#]+/;function P$(t){let e=t.match(N$);return e?e[0]:""}var k$=/^[^=?&#]+/;function O$(t){let e=t.match(k$);return e?e[0]:""}var F$=/^[^&#]+/;function V$(t){let e=t.match(F$);return e?e[0]:""}var Cv=class{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new Ie([],{}):new Ie([],this.parseChildren())}parseQueryParams(){let e={};if(this.consumeOptional("?"))do this.parseQueryParam(e);while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let n={};this.peekStartsWith("/(")&&(this.capture("/"),n=this.parseParens(!0));let r={};return this.peekStartsWith("(")&&(r=this.parseParens(!1)),(e.length>0||Object.keys(n).length>0)&&(r[te]=new Ie(e,n)),r}parseSegment(){let e=mv(this.remaining);if(e===""&&this.peekStartsWith(";"))throw new $(4009,!1);return this.capture(e),new Is(Ef(e),this.parseMatrixParams())}parseMatrixParams(){let e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){let n=P$(this.remaining);if(!n)return;this.capture(n);let r="";if(this.consumeOptional("=")){let i=mv(this.remaining);i&&(r=i,this.capture(r))}e[Ef(n)]=Ef(r)}parseQueryParam(e){let n=O$(this.remaining);if(!n)return;this.capture(n);let r="";if(this.consumeOptional("=")){let o=V$(this.remaining);o&&(r=o,this.capture(r))}let i=ux(n),s=ux(r);if(e.hasOwnProperty(i)){let o=e[i];Array.isArray(o)||(o=[o],e[i]=o),o.push(s)}else e[i]=s}parseParens(e){let n={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let r=mv(this.remaining),i=this.remaining[r.length];if(i!=="/"&&i!==")"&&i!==";")throw new $(4010,!1);let s;r.indexOf(":")>-1?(s=r.slice(0,r.indexOf(":")),this.capture(s),this.capture(":")):e&&(s=te);let o=this.parseChildren();n[s]=Object.keys(o).length===1?o[te]:new Ie([],o),this.consumeOptional("//")}return n}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return this.peekStartsWith(e)?(this.remaining=this.remaining.substring(e.length),!0):!1}capture(e){if(!this.consumeOptional(e))throw new $(4011,!1)}};function Cx(t){return t.segments.length>0?new Ie([],{[te]:t}):t}function Dx(t){let e={};for(let[r,i]of Object.entries(t.children)){let s=Dx(i);if(r===te&&s.segments.length===0&&s.hasChildren())for(let[o,a]of Object.entries(s.children))e[o]=a;else(s.segments.length>0||s.hasChildren())&&(e[r]=s)}let n=new Ie(t.segments,e);return L$(n)}function L$(t){if(t.numberOfChildren===1&&t.children[te]){let e=t.children[te];return new Ie(t.segments.concat(e.segments),e.children)}return t}function ca(t){return t instanceof di}function j$(t,e,n=null,r=null){let i=Tx(t);return bx(i,e,n,r)}function Tx(t){let e;function n(s){let o={};for(let u of s.children){let c=n(u);o[u.outlet]=c}let a=new Ie(s.url,o);return s===t&&(e=a),a}let r=n(t.root),i=Cx(r);return e??i}function bx(t,e,n,r){let i=t;for(;i.parent;)i=i.parent;if(e.length===0)return yv(i,i,i,n,r);let s=U$(e);if(s.toRoot())return yv(i,i,new Ie([],{}),n,r);let o=B$(s,i,t),a=o.processChildren?cc(o.segmentGroup,o.index,s.commands):Ax(o.segmentGroup,o.index,s.commands);return yv(i,o.segmentGroup,a,n,r)}function If(t){return typeof t=="object"&&t!=null&&!t.outlets&&!t.segmentPath}function fc(t){return typeof t=="object"&&t!=null&&t.outlets}function yv(t,e,n,r,i){let s={};r&&Object.entries(r).forEach(([u,c])=>{s[u]=Array.isArray(c)?c.map(l=>`${l}`):`${c}`});let o;t===e?o=n:o=Sx(t,e,n);let a=Cx(Dx(o));return new di(a,s,i)}function Sx(t,e,n){let r={};return Object.entries(t.children).forEach(([i,s])=>{s===e?r[i]=n:r[i]=Sx(s,e,n)}),new Ie(t.segments,r)}var Cf=class{constructor(e,n,r){if(this.isAbsolute=e,this.numberOfDoubleDots=n,this.commands=r,e&&r.length>0&&If(r[0]))throw new $(4003,!1);let i=r.find(fc);if(i&&i!==mx(r))throw new $(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function U$(t){if(typeof t[0]=="string"&&t.length===1&&t[0]==="/")return new Cf(!0,0,t);let e=0,n=!1,r=t.reduce((i,s,o)=>{if(typeof s=="object"&&s!=null){if(s.outlets){let a={};return Object.entries(s.outlets).forEach(([u,c])=>{a[u]=typeof c=="string"?c.split("/"):c}),[...i,{outlets:a}]}if(s.segmentPath)return[...i,s.segmentPath]}return typeof s!="string"?[...i,s]:o===0?(s.split("/").forEach((a,u)=>{u==0&&a==="."||(u==0&&a===""?n=!0:a===".."?e++:a!=""&&i.push(a))}),i):[...i,s]},[]);return new Cf(n,e,r)}var oa=class{constructor(e,n,r){this.segmentGroup=e,this.processChildren=n,this.index=r}};function B$(t,e,n){if(t.isAbsolute)return new oa(e,!0,0);if(!n)return new oa(e,!1,NaN);if(n.parent===null)return new oa(n,!0,0);let r=If(t.commands[0])?0:1,i=n.segments.length-1+r;return $$(n,i,t.numberOfDoubleDots)}function $$(t,e,n){let r=t,i=e,s=n;for(;s>i;){if(s-=i,r=r.parent,!r)throw new $(4005,!1);i=r.segments.length}return new oa(r,!1,i-s)}function H$(t){return fc(t[0])?t[0].outlets:{[te]:t}}function Ax(t,e,n){if(t??=new Ie([],{}),t.segments.length===0&&t.hasChildren())return cc(t,e,n);let r=q$(t,e,n),i=n.slice(r.commandIndex);if(r.match&&r.pathIndex<t.segments.length){let s=new Ie(t.segments.slice(0,r.pathIndex),{});return s.children[te]=new Ie(t.segments.slice(r.pathIndex),t.children),cc(s,0,i)}else return r.match&&i.length===0?new Ie(t.segments,{}):r.match&&!t.hasChildren()?Dv(t,e,n):r.match?cc(t,0,i):Dv(t,e,n)}function cc(t,e,n){if(n.length===0)return new Ie(t.segments,{});{let r=H$(n),i={};if(Object.keys(r).some(s=>s!==te)&&t.children[te]&&t.numberOfChildren===1&&t.children[te].segments.length===0){let s=cc(t.children[te],e,n);return new Ie(t.segments,s.children)}return Object.entries(r).forEach(([s,o])=>{typeof o=="string"&&(o=[o]),o!==null&&(i[s]=Ax(t.children[s],e,o))}),Object.entries(t.children).forEach(([s,o])=>{r[s]===void 0&&(i[s]=o)}),new Ie(t.segments,i)}}function q$(t,e,n){let r=0,i=e,s={match:!1,pathIndex:0,commandIndex:0};for(;i<t.segments.length;){if(r>=n.length)return s;let o=t.segments[i],a=n[r];if(fc(a))break;let u=`${a}`,c=r<n.length-1?n[r+1]:null;if(i>0&&u===void 0)break;if(u&&c&&typeof c=="object"&&c.outlets===void 0){if(!lx(u,c,o))return s;r+=2}else{if(!lx(u,{},o))return s;r++}i++}return{match:!0,pathIndex:i,commandIndex:r}}function Dv(t,e,n){let r=t.segments.slice(0,e),i=0;for(;i<n.length;){let s=n[i];if(fc(s)){let u=G$(s.outlets);return new Ie(r,u)}if(i===0&&If(n[0])){let u=t.segments[e];r.push(new Is(u.path,cx(n[0]))),i++;continue}let o=fc(s)?s.outlets[te]:`${s}`,a=i<n.length-1?n[i+1]:null;o&&a&&If(a)?(r.push(new Is(o,cx(a))),i+=2):(r.push(new Is(o,{})),i++)}return new Ie(r,{})}function G$(t){let e={};return Object.entries(t).forEach(([n,r])=>{typeof r=="string"&&(r=[r]),r!==null&&(e[n]=Dv(new Ie([],{}),0,r))}),e}function cx(t){let e={};return Object.entries(t).forEach(([n,r])=>e[n]=`${r}`),e}function lx(t,e,n){return t==n.path&&sr(e,n.parameters)}var lc="imperative",dt=function(t){return t[t.NavigationStart=0]="NavigationStart",t[t.NavigationEnd=1]="NavigationEnd",t[t.NavigationCancel=2]="NavigationCancel",t[t.NavigationError=3]="NavigationError",t[t.RoutesRecognized=4]="RoutesRecognized",t[t.ResolveStart=5]="ResolveStart",t[t.ResolveEnd=6]="ResolveEnd",t[t.GuardsCheckStart=7]="GuardsCheckStart",t[t.GuardsCheckEnd=8]="GuardsCheckEnd",t[t.RouteConfigLoadStart=9]="RouteConfigLoadStart",t[t.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",t[t.ChildActivationStart=11]="ChildActivationStart",t[t.ChildActivationEnd=12]="ChildActivationEnd",t[t.ActivationStart=13]="ActivationStart",t[t.ActivationEnd=14]="ActivationEnd",t[t.Scroll=15]="Scroll",t[t.NavigationSkipped=16]="NavigationSkipped",t}(dt||{}),En=class{constructor(e,n){this.id=e,this.url=n}},la=class extends En{constructor(e,n,r="imperative",i=null){super(e,n),this.type=dt.NavigationStart,this.navigationTrigger=r,this.restoredState=i}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},or=class extends En{constructor(e,n,r){super(e,n),this.urlAfterRedirects=r,this.type=dt.NavigationEnd}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},wn=function(t){return t[t.Redirect=0]="Redirect",t[t.SupersededByNewNavigation=1]="SupersededByNewNavigation",t[t.NoDataFromResolver=2]="NoDataFromResolver",t[t.GuardRejected=3]="GuardRejected",t}(wn||{}),Df=function(t){return t[t.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",t[t.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",t}(Df||{}),hi=class extends En{constructor(e,n,r,i){super(e,n),this.reason=r,this.code=i,this.type=dt.NavigationCancel}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}},fi=class extends En{constructor(e,n,r,i){super(e,n),this.reason=r,this.code=i,this.type=dt.NavigationSkipped}},pc=class extends En{constructor(e,n,r,i){super(e,n),this.error=r,this.target=i,this.type=dt.NavigationError}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},Tf=class extends En{constructor(e,n,r,i){super(e,n),this.urlAfterRedirects=r,this.state=i,this.type=dt.RoutesRecognized}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Tv=class extends En{constructor(e,n,r,i){super(e,n),this.urlAfterRedirects=r,this.state=i,this.type=dt.GuardsCheckStart}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},bv=class extends En{constructor(e,n,r,i,s){super(e,n),this.urlAfterRedirects=r,this.state=i,this.shouldActivate=s,this.type=dt.GuardsCheckEnd}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},Sv=class extends En{constructor(e,n,r,i){super(e,n),this.urlAfterRedirects=r,this.state=i,this.type=dt.ResolveStart}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Av=class extends En{constructor(e,n,r,i){super(e,n),this.urlAfterRedirects=r,this.state=i,this.type=dt.ResolveEnd}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},xv=class{constructor(e){this.route=e,this.type=dt.RouteConfigLoadStart}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},Mv=class{constructor(e){this.route=e,this.type=dt.RouteConfigLoadEnd}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},Rv=class{constructor(e){this.snapshot=e,this.type=dt.ChildActivationStart}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Nv=class{constructor(e){this.snapshot=e,this.type=dt.ChildActivationEnd}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Pv=class{constructor(e){this.snapshot=e,this.type=dt.ActivationStart}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},kv=class{constructor(e){this.snapshot=e,this.type=dt.ActivationEnd}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},bf=class{constructor(e,n,r){this.routerEvent=e,this.position=n,this.anchor=r,this.type=dt.Scroll}toString(){let e=this.position?`${this.position[0]}, ${this.position[1]}`:null;return`Scroll(anchor: '${this.anchor}', position: '${e}')`}},gc=class{},mc=class{constructor(e){this.url=e}};var Ov=class{constructor(){this.outlet=null,this.route=null,this.injector=null,this.children=new Ic,this.attachRef=null}},Ic=(()=>{let e=class e{constructor(){this.contexts=new Map}onChildOutletCreated(r,i){let s=this.getOrCreateContext(r);s.outlet=i,this.contexts.set(r,s)}onChildOutletDestroyed(r){let i=this.getContext(r);i&&(i.outlet=null,i.attachRef=null)}onOutletDeactivated(){let r=this.contexts;return this.contexts=new Map,r}onOutletReAttached(r){this.contexts=r}getOrCreateContext(r){let i=this.getContext(r);return i||(i=new Ov,this.contexts.set(r,i)),i}getContext(r){return this.contexts.get(r)||null}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),Sf=class{constructor(e){this._root=e}get root(){return this._root.value}parent(e){let n=this.pathFromRoot(e);return n.length>1?n[n.length-2]:null}children(e){let n=Fv(e,this._root);return n?n.children.map(r=>r.value):[]}firstChild(e){let n=Fv(e,this._root);return n&&n.children.length>0?n.children[0].value:null}siblings(e){let n=Vv(e,this._root);return n.length<2?[]:n[n.length-2].children.map(i=>i.value).filter(i=>i!==e)}pathFromRoot(e){return Vv(e,this._root).map(n=>n.value)}};function Fv(t,e){if(t===e.value)return e;for(let n of e.children){let r=Fv(t,n);if(r)return r}return null}function Vv(t,e){if(t===e.value)return[e];for(let n of e.children){let r=Vv(t,n);if(r.length)return r.unshift(e),r}return[]}var nn=class{constructor(e,n){this.value=e,this.children=n}toString(){return`TreeNode(${this.value})`}};function sa(t){let e={};return t&&t.children.forEach(n=>e[n.value.outlet]=n),e}var Af=class extends Sf{constructor(e,n){super(e),this.snapshot=n,Wv(this,e)}toString(){return this.snapshot.toString()}};function xx(t){let e=z$(t),n=new wt([new Is("",{})]),r=new wt({}),i=new wt({}),s=new wt({}),o=new wt(""),a=new Ds(n,r,s,o,i,te,t,e.root);return a.snapshot=e.root,new Af(new nn(a,[]),e)}function z$(t){let e={},n={},r={},i="",s=new yc([],e,r,i,n,te,t,null,{});return new xf("",new nn(s,[]))}var Ds=class{constructor(e,n,r,i,s,o,a,u){this.urlSubject=e,this.paramsSubject=n,this.queryParamsSubject=r,this.fragmentSubject=i,this.dataSubject=s,this.outlet=o,this.component=a,this._futureSnapshot=u,this.title=this.dataSubject?.pipe(j(c=>c[wc]))??U(void 0),this.url=e,this.params=n,this.queryParams=r,this.fragment=i,this.data=s}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(j(e=>ua(e))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(j(e=>ua(e))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function zv(t,e,n="emptyOnly"){let r,{routeConfig:i}=t;return e!==null&&(n==="always"||i?.path===""||!e.component&&!e.routeConfig?.loadComponent)?r={params:x(x({},e.params),t.params),data:x(x({},e.data),t.data),resolve:x(x(x(x({},t.data),e.data),i?.data),t._resolvedData)}:r={params:x({},t.params),data:x({},t.data),resolve:x(x({},t.data),t._resolvedData??{})},i&&Rx(i)&&(r.resolve[wc]=i.title),r}var yc=class{get title(){return this.data?.[wc]}constructor(e,n,r,i,s,o,a,u,c){this.url=e,this.params=n,this.queryParams=r,this.fragment=i,this.data=s,this.outlet=o,this.component=a,this.routeConfig=u,this._resolve=c}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=ua(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=ua(this.queryParams),this._queryParamMap}toString(){let e=this.url.map(r=>r.toString()).join("/"),n=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${e}', path:'${n}')`}},xf=class extends Sf{constructor(e,n){super(n),this.url=e,Wv(this,n)}toString(){return Mx(this._root)}};function Wv(t,e){e.value._routerState=t,e.children.forEach(n=>Wv(t,n))}function Mx(t){let e=t.children.length>0?` { ${t.children.map(Mx).join(", ")} } `:"";return`${t.value}${e}`}function _v(t){if(t.snapshot){let e=t.snapshot,n=t._futureSnapshot;t.snapshot=n,sr(e.queryParams,n.queryParams)||t.queryParamsSubject.next(n.queryParams),e.fragment!==n.fragment&&t.fragmentSubject.next(n.fragment),sr(e.params,n.params)||t.paramsSubject.next(n.params),E$(e.url,n.url)||t.urlSubject.next(n.url),sr(e.data,n.data)||t.dataSubject.next(n.data)}else t.snapshot=t._futureSnapshot,t.dataSubject.next(t._futureSnapshot.data)}function Lv(t,e){let n=sr(t.params,e.params)&&T$(t.url,e.url),r=!t.parent!=!e.parent;return n&&!r&&(!t.parent||Lv(t.parent,e.parent))}function Rx(t){return typeof t.title=="string"||t.title===null}var Kv=(()=>{let e=class e{constructor(){this.activated=null,this._activatedRoute=null,this.name=te,this.activateEvents=new ut,this.deactivateEvents=new ut,this.attachEvents=new ut,this.detachEvents=new ut,this.parentContexts=k(Ic),this.location=k(ec),this.changeDetector=k(Xo),this.environmentInjector=k(en),this.inputBinder=k(kf,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(r){if(r.name){let{firstChange:i,previousValue:s}=r.name;if(i)return;this.isTrackedInParentContexts(s)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(s)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(r){return this.parentContexts.getContext(r)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let r=this.parentContexts.getContext(this.name);r?.route&&(r.attachRef?this.attach(r.attachRef,r.route):this.activateWith(r.route,r.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new $(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new $(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new $(4012,!1);this.location.detach();let r=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(r.instance),r}attach(r,i){this.activated=r,this._activatedRoute=i,this.location.insert(r.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(r.instance)}deactivate(){if(this.activated){let r=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(r)}}activateWith(r,i){if(this.isActivated)throw new $(4013,!1);this._activatedRoute=r;let s=this.location,a=r.snapshot.component,u=this.parentContexts.getOrCreateContext(this.name).children,c=new jv(r,u,s.injector);this.activated=s.createComponent(a,{index:s.length,injector:c,environmentInjector:i??this.environmentInjector}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275dir=Lt({type:e,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[gs]});let t=e;return t})(),jv=class{constructor(e,n,r){this.route=e,this.childContexts=n,this.parent=r}get(e,n){return e===Ds?this.route:e===Ic?this.childContexts:this.parent.get(e,n)}},kf=new F(""),dx=(()=>{let e=class e{constructor(){this.outletDataSubscriptions=new Map}bindActivatedRouteToOutletComponent(r){this.unsubscribeFromRouteData(r),this.subscribeToRouteData(r)}unsubscribeFromRouteData(r){this.outletDataSubscriptions.get(r)?.unsubscribe(),this.outletDataSubscriptions.delete(r)}subscribeToRouteData(r){let{activatedRoute:i}=r,s=Nu([i.queryParams,i.params,i.data]).pipe(ke(([o,a,u],c)=>(u=x(x(x({},o),a),u),c===0?U(u):Promise.resolve(u)))).subscribe(o=>{if(!r.isActivated||!r.activatedComponentRef||r.activatedRoute!==i||i.component===null){this.unsubscribeFromRouteData(r);return}let a=LA(i.component);if(!a){this.unsubscribeFromRouteData(r);return}for(let{templateName:u}of a.inputs)r.activatedComponentRef.setInput(u,o[u])});this.outletDataSubscriptions.set(r,s)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:e.\u0275fac});let t=e;return t})();function W$(t,e,n){let r=_c(t,e._root,n?n._root:void 0);return new Af(r,e)}function _c(t,e,n){if(n&&t.shouldReuseRoute(e.value,n.value.snapshot)){let r=n.value;r._futureSnapshot=e.value;let i=K$(t,e,n);return new nn(r,i)}else{if(t.shouldAttach(e.value)){let s=t.retrieve(e.value);if(s!==null){let o=s.route;return o.value._futureSnapshot=e.value,o.children=e.children.map(a=>_c(t,a)),o}}let r=Q$(e.value),i=e.children.map(s=>_c(t,s));return new nn(r,i)}}function K$(t,e,n){return e.children.map(r=>{for(let i of n.children)if(t.shouldReuseRoute(r.value,i.value.snapshot))return _c(t,r,i);return _c(t,r)})}function Q$(t){return new Ds(new wt(t.url),new wt(t.params),new wt(t.queryParams),new wt(t.fragment),new wt(t.data),t.outlet,t.component,t)}var Nx="ngNavigationCancelingError";function Px(t,e){let{redirectTo:n,navigationBehaviorOptions:r}=ca(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,i=kx(!1,wn.Redirect);return i.url=n,i.navigationBehaviorOptions=r,i}function kx(t,e){let n=new Error(`NavigationCancelingError: ${t||""}`);return n[Nx]=!0,n.cancellationCode=e,n}function Y$(t){return Ox(t)&&ca(t.url)}function Ox(t){return!!t&&t[Nx]}var Z$=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=At({type:e,selectors:[["ng-component"]],standalone:!0,features:[AA],decls:1,vars:0,template:function(i,s){i&1&&_s(0,"router-outlet")},dependencies:[Kv],encapsulation:2});let t=e;return t})();function X$(t,e){return t.providers&&!t._injector&&(t._injector=nf(t.providers,e,`Route: ${t.path}`)),t._injector??e}function Qv(t){let e=t.children&&t.children.map(Qv),n=e?ue(x({},t),{children:e}):x({},t);return!n.component&&!n.loadComponent&&(e||n.loadChildren)&&n.outlet&&n.outlet!==te&&(n.component=Z$),n}function ar(t){return t.outlet||te}function J$(t,e){let n=t.filter(r=>ar(r)===e);return n.push(...t.filter(r=>ar(r)!==e)),n}function Cc(t){if(!t)return null;if(t.routeConfig?._injector)return t.routeConfig._injector;for(let e=t.parent;e;e=e.parent){let n=e.routeConfig;if(n?._loadedInjector)return n._loadedInjector;if(n?._injector)return n._injector}return null}var eH=(t,e,n,r)=>j(i=>(new Uv(e,i.targetRouterState,i.currentRouterState,n,r).activate(t),i)),Uv=class{constructor(e,n,r,i,s){this.routeReuseStrategy=e,this.futureState=n,this.currState=r,this.forwardEvent=i,this.inputBindingEnabled=s}activate(e){let n=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(n,r,e),_v(this.futureState.root),this.activateChildRoutes(n,r,e)}deactivateChildRoutes(e,n,r){let i=sa(n);e.children.forEach(s=>{let o=s.value.outlet;this.deactivateRoutes(s,i[o],r),delete i[o]}),Object.values(i).forEach(s=>{this.deactivateRouteAndItsChildren(s,r)})}deactivateRoutes(e,n,r){let i=e.value,s=n?n.value:null;if(i===s)if(i.component){let o=r.getContext(i.outlet);o&&this.deactivateChildRoutes(e,n,o.children)}else this.deactivateChildRoutes(e,n,r);else s&&this.deactivateRouteAndItsChildren(n,r)}deactivateRouteAndItsChildren(e,n){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,n):this.deactivateRouteAndOutlet(e,n)}detachAndStoreRouteSubtree(e,n){let r=n.getContext(e.value.outlet),i=r&&e.value.component?r.children:n,s=sa(e);for(let o of Object.values(s))this.deactivateRouteAndItsChildren(o,i);if(r&&r.outlet){let o=r.outlet.detach(),a=r.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:o,route:e,contexts:a})}}deactivateRouteAndOutlet(e,n){let r=n.getContext(e.value.outlet),i=r&&e.value.component?r.children:n,s=sa(e);for(let o of Object.values(s))this.deactivateRouteAndItsChildren(o,i);r&&(r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated()),r.attachRef=null,r.route=null)}activateChildRoutes(e,n,r){let i=sa(n);e.children.forEach(s=>{this.activateRoutes(s,i[s.value.outlet],r),this.forwardEvent(new kv(s.value.snapshot))}),e.children.length&&this.forwardEvent(new Nv(e.value.snapshot))}activateRoutes(e,n,r){let i=e.value,s=n?n.value:null;if(_v(i),i===s)if(i.component){let o=r.getOrCreateContext(i.outlet);this.activateChildRoutes(e,n,o.children)}else this.activateChildRoutes(e,n,r);else if(i.component){let o=r.getOrCreateContext(i.outlet);if(this.routeReuseStrategy.shouldAttach(i.snapshot)){let a=this.routeReuseStrategy.retrieve(i.snapshot);this.routeReuseStrategy.store(i.snapshot,null),o.children.onOutletReAttached(a.contexts),o.attachRef=a.componentRef,o.route=a.route.value,o.outlet&&o.outlet.attach(a.componentRef,a.route.value),_v(a.route.value),this.activateChildRoutes(e,null,o.children)}else{let a=Cc(i.snapshot);o.attachRef=null,o.route=i,o.injector=a,o.outlet&&o.outlet.activateWith(i,o.injector),this.activateChildRoutes(e,null,o.children)}}else this.activateChildRoutes(e,null,r)}},Mf=class{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}},aa=class{constructor(e,n){this.component=e,this.route=n}};function tH(t,e,n){let r=t._root,i=e?e._root:null;return ac(r,i,n,[r.value])}function nH(t){let e=t.routeConfig?t.routeConfig.canActivateChild:null;return!e||e.length===0?null:{node:t,guards:e}}function ha(t,e){let n=Symbol(),r=e.get(t,n);return r===n?typeof t=="function"&&!Rb(t)?t:e.get(t):r}function ac(t,e,n,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let s=sa(e);return t.children.forEach(o=>{rH(o,s[o.value.outlet],n,r.concat([o.value]),i),delete s[o.value.outlet]}),Object.entries(s).forEach(([o,a])=>dc(a,n.getContext(o),i)),i}function rH(t,e,n,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let s=t.value,o=e?e.value:null,a=n?n.getContext(t.value.outlet):null;if(o&&s.routeConfig===o.routeConfig){let u=iH(o,s,s.routeConfig.runGuardsAndResolvers);u?i.canActivateChecks.push(new Mf(r)):(s.data=o.data,s._resolvedData=o._resolvedData),s.component?ac(t,e,a?a.children:null,r,i):ac(t,e,n,r,i),u&&a&&a.outlet&&a.outlet.isActivated&&i.canDeactivateChecks.push(new aa(a.outlet.component,o))}else o&&dc(e,a,i),i.canActivateChecks.push(new Mf(r)),s.component?ac(t,null,a?a.children:null,r,i):ac(t,null,n,r,i);return i}function iH(t,e,n){if(typeof n=="function")return n(t,e);switch(n){case"pathParamsChange":return!Cs(t.url,e.url);case"pathParamsOrQueryParamsChange":return!Cs(t.url,e.url)||!sr(t.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!Lv(t,e)||!sr(t.queryParams,e.queryParams);case"paramsChange":default:return!Lv(t,e)}}function dc(t,e,n){let r=sa(t),i=t.value;Object.entries(r).forEach(([s,o])=>{i.component?e?dc(o,e.children.getContext(s),n):dc(o,null,n):dc(o,e,n)}),i.component?e&&e.outlet&&e.outlet.isActivated?n.canDeactivateChecks.push(new aa(e.outlet.component,i)):n.canDeactivateChecks.push(new aa(null,i)):n.canDeactivateChecks.push(new aa(null,i))}function Dc(t){return typeof t=="function"}function sH(t){return typeof t=="boolean"}function oH(t){return t&&Dc(t.canLoad)}function aH(t){return t&&Dc(t.canActivate)}function uH(t){return t&&Dc(t.canActivateChild)}function cH(t){return t&&Dc(t.canDeactivate)}function lH(t){return t&&Dc(t.canMatch)}function Fx(t){return t instanceof Sr||t?.name==="EmptyError"}var _f=Symbol("INITIAL_VALUE");function da(){return ke(t=>Nu(t.map(e=>e.pipe(Ar(1),is(_f)))).pipe(j(e=>{for(let n of e)if(n!==!0){if(n===_f)return _f;if(n===!1||n instanceof di)return n}return!0}),Et(e=>e!==_f),Ar(1)))}function dH(t,e){return Ze(n=>{let{targetSnapshot:r,currentSnapshot:i,guards:{canActivateChecks:s,canDeactivateChecks:o}}=n;return o.length===0&&s.length===0?U(ue(x({},n),{guardsResult:!0})):hH(o,r,i,t).pipe(Ze(a=>a&&sH(a)?fH(r,s,t,e):U(a)),j(a=>ue(x({},n),{guardsResult:a})))})}function hH(t,e,n,r){return _e(t).pipe(Ze(i=>_H(i.component,i.route,n,e,r)),gn(i=>i!==!0,!0))}function fH(t,e,n,r){return _e(e).pipe(rs(i=>xo(gH(i.route.parent,r),pH(i.route,r),yH(t,i.path,n),mH(t,i.route,n))),gn(i=>i!==!0,!0))}function pH(t,e){return t!==null&&e&&e(new Pv(t)),U(!0)}function gH(t,e){return t!==null&&e&&e(new Rv(t)),U(!0)}function mH(t,e,n){let r=e.routeConfig?e.routeConfig.canActivate:null;if(!r||r.length===0)return U(!0);let i=r.map(s=>sh(()=>{let o=Cc(e)??n,a=ha(s,o),u=aH(a)?a.canActivate(e,t):ci(o,()=>a(e,t));return gi(u).pipe(gn())}));return U(i).pipe(da())}function yH(t,e,n){let r=e[e.length-1],s=e.slice(0,e.length-1).reverse().map(o=>nH(o)).filter(o=>o!==null).map(o=>sh(()=>{let a=o.guards.map(u=>{let c=Cc(o.node)??n,l=ha(u,c),d=uH(l)?l.canActivateChild(r,t):ci(c,()=>l(r,t));return gi(d).pipe(gn())});return U(a).pipe(da())}));return U(s).pipe(da())}function _H(t,e,n,r,i){let s=e&&e.routeConfig?e.routeConfig.canDeactivate:null;if(!s||s.length===0)return U(!0);let o=s.map(a=>{let u=Cc(e)??i,c=ha(a,u),l=cH(c)?c.canDeactivate(t,e,n,r):ci(u,()=>c(t,e,n,r));return gi(l).pipe(gn())});return U(o).pipe(da())}function vH(t,e,n,r){let i=e.canLoad;if(i===void 0||i.length===0)return U(!0);let s=i.map(o=>{let a=ha(o,t),u=oH(a)?a.canLoad(e,n):ci(t,()=>a(e,n));return gi(u)});return U(s).pipe(da(),Vx(r))}function Vx(t){return Ym(Xe(e=>{if(ca(e))throw Px(t,e)}),j(e=>e===!0))}function wH(t,e,n,r){let i=e.canMatch;if(!i||i.length===0)return U(!0);let s=i.map(o=>{let a=ha(o,t),u=lH(a)?a.canMatch(e,n):ci(t,()=>a(e,n));return gi(u)});return U(s).pipe(da(),Vx(r))}var vc=class{constructor(e){this.segmentGroup=e||null}},Rf=class extends Error{constructor(e){super(),this.urlTree=e}};function ia(t){return Ao(new vc(t))}function EH(t){return Ao(new $(4e3,!1))}function IH(t){return Ao(kx(!1,wn.GuardRejected))}var Bv=class{constructor(e,n){this.urlSerializer=e,this.urlTree=n}lineralizeSegments(e,n){let r=[],i=n.root;for(;;){if(r=r.concat(i.segments),i.numberOfChildren===0)return U(r);if(i.numberOfChildren>1||!i.children[te])return EH(e.redirectTo);i=i.children[te]}}applyRedirectCommands(e,n,r){let i=this.applyRedirectCreateUrlTree(n,this.urlSerializer.parse(n),e,r);if(n.startsWith("/"))throw new Rf(i);return i}applyRedirectCreateUrlTree(e,n,r,i){let s=this.createSegmentGroup(e,n.root,r,i);return new di(s,this.createQueryParams(n.queryParams,this.urlTree.queryParams),n.fragment)}createQueryParams(e,n){let r={};return Object.entries(e).forEach(([i,s])=>{if(typeof s=="string"&&s.startsWith(":")){let a=s.substring(1);r[i]=n[a]}else r[i]=s}),r}createSegmentGroup(e,n,r,i){let s=this.createSegments(e,n.segments,r,i),o={};return Object.entries(n.children).forEach(([a,u])=>{o[a]=this.createSegmentGroup(e,u,r,i)}),new Ie(s,o)}createSegments(e,n,r,i){return n.map(s=>s.path.startsWith(":")?this.findPosParam(e,s,i):this.findOrReturn(s,r))}findPosParam(e,n,r){let i=r[n.path.substring(1)];if(!i)throw new $(4001,!1);return i}findOrReturn(e,n){let r=0;for(let i of n){if(i.path===e.path)return n.splice(r),i;r++}return e}},$v={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function CH(t,e,n,r,i){let s=Yv(t,e,n);return s.matched?(r=X$(e,r),wH(r,e,n,i).pipe(j(o=>o===!0?s:x({},$v)))):U(s)}function Yv(t,e,n){if(e.path==="**")return DH(n);if(e.path==="")return e.pathMatch==="full"&&(t.hasChildren()||n.length>0)?x({},$v):{matched:!0,consumedSegments:[],remainingSegments:n,parameters:{},positionalParamSegments:{}};let i=(e.matcher||w$)(n,t,e);if(!i)return x({},$v);let s={};Object.entries(i.posParams??{}).forEach(([a,u])=>{s[a]=u.path});let o=i.consumed.length>0?x(x({},s),i.consumed[i.consumed.length-1].parameters):s;return{matched:!0,consumedSegments:i.consumed,remainingSegments:n.slice(i.consumed.length),parameters:o,positionalParamSegments:i.posParams??{}}}function DH(t){return{matched:!0,parameters:t.length>0?mx(t).parameters:{},consumedSegments:t,remainingSegments:[],positionalParamSegments:{}}}function hx(t,e,n,r){return n.length>0&&SH(t,n,r)?{segmentGroup:new Ie(e,bH(r,new Ie(n,t.children))),slicedSegments:[]}:n.length===0&&AH(t,n,r)?{segmentGroup:new Ie(t.segments,TH(t,n,r,t.children)),slicedSegments:n}:{segmentGroup:new Ie(t.segments,t.children),slicedSegments:n}}function TH(t,e,n,r){let i={};for(let s of n)if(Of(t,e,s)&&!r[ar(s)]){let o=new Ie([],{});i[ar(s)]=o}return x(x({},r),i)}function bH(t,e){let n={};n[te]=e;for(let r of t)if(r.path===""&&ar(r)!==te){let i=new Ie([],{});n[ar(r)]=i}return n}function SH(t,e,n){return n.some(r=>Of(t,e,r)&&ar(r)!==te)}function AH(t,e,n){return n.some(r=>Of(t,e,r))}function Of(t,e,n){return(t.hasChildren()||e.length>0)&&n.pathMatch==="full"?!1:n.path===""}function xH(t,e,n,r){return ar(t)!==r&&(r===te||!Of(e,n,t))?!1:Yv(e,t,n).matched}function MH(t,e,n){return e.length===0&&!t.children[n]}var Hv=class{};function RH(t,e,n,r,i,s,o="emptyOnly"){return new qv(t,e,n,r,i,o,s).recognize()}var NH=31,qv=class{constructor(e,n,r,i,s,o,a){this.injector=e,this.configLoader=n,this.rootComponentType=r,this.config=i,this.urlTree=s,this.paramsInheritanceStrategy=o,this.urlSerializer=a,this.applyRedirects=new Bv(this.urlSerializer,this.urlTree),this.absoluteRedirectCount=0,this.allowRedirects=!0}noMatchError(e){return new $(4002,`'${e.segmentGroup}'`)}recognize(){let e=hx(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(e).pipe(j(n=>{let r=new yc([],Object.freeze({}),Object.freeze(x({},this.urlTree.queryParams)),this.urlTree.fragment,{},te,this.rootComponentType,null,{}),i=new nn(r,n),s=new xf("",i),o=j$(r,[],this.urlTree.queryParams,this.urlTree.fragment);return o.queryParams=this.urlTree.queryParams,s.url=this.urlSerializer.serialize(o),this.inheritParamsAndData(s._root,null),{state:s,tree:o}}))}match(e){return this.processSegmentGroup(this.injector,this.config,e,te).pipe(ei(r=>{if(r instanceof Rf)return this.urlTree=r.urlTree,this.match(r.urlTree.root);throw r instanceof vc?this.noMatchError(r):r}))}inheritParamsAndData(e,n){let r=e.value,i=zv(r,n,this.paramsInheritanceStrategy);r.params=Object.freeze(i.params),r.data=Object.freeze(i.data),e.children.forEach(s=>this.inheritParamsAndData(s,r))}processSegmentGroup(e,n,r,i){return r.segments.length===0&&r.hasChildren()?this.processChildren(e,n,r):this.processSegment(e,n,r,r.segments,i,!0).pipe(j(s=>s instanceof nn?[s]:[]))}processChildren(e,n,r){let i=[];for(let s of Object.keys(r.children))s==="primary"?i.unshift(s):i.push(s);return _e(i).pipe(rs(s=>{let o=r.children[s],a=J$(n,s);return this.processSegmentGroup(e,a,o,s)}),Yn((s,o)=>(s.push(...o),s)),ti(null),sy(),Ze(s=>{if(s===null)return ia(r);let o=Lx(s);return PH(o),U(o)}))}processSegment(e,n,r,i,s,o){return _e(n).pipe(rs(a=>this.processSegmentAgainstRoute(a._injector??e,n,a,r,i,s,o).pipe(ei(u=>{if(u instanceof vc)return U(null);throw u}))),gn(a=>!!a),ei(a=>{if(Fx(a))return MH(r,i,s)?U(new Hv):ia(r);throw a}))}processSegmentAgainstRoute(e,n,r,i,s,o,a){return xH(r,i,s,o)?r.redirectTo===void 0?this.matchSegmentAgainstRoute(e,i,r,s,o):this.allowRedirects&&a?this.expandSegmentAgainstRouteUsingRedirect(e,i,n,r,s,o):ia(i):ia(i)}expandSegmentAgainstRouteUsingRedirect(e,n,r,i,s,o){let{matched:a,consumedSegments:u,positionalParamSegments:c,remainingSegments:l}=Yv(n,i,s);if(!a)return ia(n);i.redirectTo.startsWith("/")&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>NH&&(this.allowRedirects=!1));let d=this.applyRedirects.applyRedirectCommands(u,i.redirectTo,c);return this.applyRedirects.lineralizeSegments(i,d).pipe(Ze(h=>this.processSegment(e,r,n,h.concat(l),o,!1)))}matchSegmentAgainstRoute(e,n,r,i,s){let o=CH(n,r,i,e,this.urlSerializer);return r.path==="**"&&(n.children={}),o.pipe(ke(a=>a.matched?(e=r._injector??e,this.getChildConfig(e,r,i).pipe(ke(({routes:u})=>{let c=r._loadedInjector??e,{consumedSegments:l,remainingSegments:d,parameters:h}=a,f=new yc(l,h,Object.freeze(x({},this.urlTree.queryParams)),this.urlTree.fragment,OH(r),ar(r),r.component??r._loadedComponent??null,r,FH(r)),{segmentGroup:p,slicedSegments:g}=hx(n,l,d,u);if(g.length===0&&p.hasChildren())return this.processChildren(c,u,p).pipe(j(b=>b===null?null:new nn(f,b)));if(u.length===0&&g.length===0)return U(new nn(f,[]));let _=ar(r)===s;return this.processSegment(c,u,p,g,_?te:s,!0).pipe(j(b=>new nn(f,b instanceof nn?[b]:[])))}))):ia(n)))}getChildConfig(e,n,r){return n.children?U({routes:n.children,injector:e}):n.loadChildren?n._loadedRoutes!==void 0?U({routes:n._loadedRoutes,injector:n._loadedInjector}):vH(e,n,r,this.urlSerializer).pipe(Ze(i=>i?this.configLoader.loadChildren(e,n).pipe(Xe(s=>{n._loadedRoutes=s.routes,n._loadedInjector=s.injector})):IH(n))):U({routes:[],injector:e})}};function PH(t){t.sort((e,n)=>e.value.outlet===te?-1:n.value.outlet===te?1:e.value.outlet.localeCompare(n.value.outlet))}function kH(t){let e=t.value.routeConfig;return e&&e.path===""}function Lx(t){let e=[],n=new Set;for(let r of t){if(!kH(r)){e.push(r);continue}let i=e.find(s=>r.value.routeConfig===s.value.routeConfig);i!==void 0?(i.children.push(...r.children),n.add(i)):e.push(r)}for(let r of n){let i=Lx(r.children);e.push(new nn(r.value,i))}return e.filter(r=>!n.has(r))}function OH(t){return t.data||{}}function FH(t){return t.resolve||{}}function VH(t,e,n,r,i,s){return Ze(o=>RH(t,e,n,r,o.extractedUrl,i,s).pipe(j(({state:a,tree:u})=>ue(x({},o),{targetSnapshot:a,urlAfterRedirects:u}))))}function LH(t,e){return Ze(n=>{let{targetSnapshot:r,guards:{canActivateChecks:i}}=n;if(!i.length)return U(n);let s=new Set(i.map(u=>u.route)),o=new Set;for(let u of s)if(!o.has(u))for(let c of jx(u))o.add(c);let a=0;return _e(o).pipe(rs(u=>s.has(u)?jH(u,r,t,e):(u.data=zv(u,u.parent,t).resolve,U(void 0))),Xe(()=>a++),Ro(1),Ze(u=>a===o.size?U(n):Wt))})}function jx(t){let e=t.children.map(n=>jx(n)).flat();return[t,...e]}function jH(t,e,n,r){let i=t.routeConfig,s=t._resolve;return i?.title!==void 0&&!Rx(i)&&(s[wc]=i.title),UH(s,t,e,r).pipe(j(o=>(t._resolvedData=o,t.data=zv(t,t.parent,n).resolve,null)))}function UH(t,e,n,r){let i=Ev(t);if(i.length===0)return U({});let s={};return _e(i).pipe(Ze(o=>BH(t[o],e,n,r).pipe(gn(),Xe(a=>{s[o]=a}))),Ro(1),iy(s),ei(o=>Fx(o)?Wt:Ao(o)))}function BH(t,e,n,r){let i=Cc(e)??r,s=ha(t,i),o=s.resolve?s.resolve(e,n):ci(i,()=>s(e,n));return gi(o)}function vv(t){return ke(e=>{let n=t(e);return n?_e(n).pipe(j(()=>e)):U(e)})}var Ux=(()=>{let e=class e{buildTitle(r){let i,s=r.root;for(;s!==void 0;)i=this.getResolvedTitleForRoute(s)??i,s=s.children.find(o=>o.outlet===te);return i}getResolvedTitleForRoute(r){return r.data[wc]}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:()=>k($H),providedIn:"root"});let t=e;return t})(),$H=(()=>{let e=class e extends Ux{constructor(r){super(),this.title=r}updateTitle(r){let i=this.buildTitle(r);i!==void 0&&this.title.setTitle(i)}};e.\u0275fac=function(i){return new(i||e)(C(sx))},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),Tc=new F("",{providedIn:"root",factory:()=>({})}),Nf=new F(""),Zv=(()=>{let e=class e{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=k(uf)}loadComponent(r){if(this.componentLoaders.get(r))return this.componentLoaders.get(r);if(r._loadedComponent)return U(r._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(r);let i=gi(r.loadComponent()).pipe(j(Bx),Xe(o=>{this.onLoadEndListener&&this.onLoadEndListener(r),r._loadedComponent=o}),ku(()=>{this.componentLoaders.delete(r)})),s=new Co(i,()=>new Ye).pipe(Io());return this.componentLoaders.set(r,s),s}loadChildren(r,i){if(this.childrenLoaders.get(i))return this.childrenLoaders.get(i);if(i._loadedRoutes)return U({routes:i._loadedRoutes,injector:i._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(i);let o=HH(i,this.compiler,r,this.onLoadEndListener).pipe(ku(()=>{this.childrenLoaders.delete(i)})),a=new Co(o,()=>new Ye).pipe(Io());return this.childrenLoaders.set(i,a),a}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function HH(t,e,n,r){return gi(t.loadChildren()).pipe(j(Bx),Ze(i=>i instanceof Ku||Array.isArray(i)?U(i):_e(e.compileModuleAsync(i))),j(i=>{r&&r(t);let s,o,a=!1;return Array.isArray(i)?(o=i,a=!0):(s=i.create(n).injector,o=s.get(Nf,[],{optional:!0,self:!0}).flat()),{routes:o.map(Qv),injector:s}}))}function qH(t){return t&&typeof t=="object"&&"default"in t}function Bx(t){return qH(t)?t.default:t}var Xv=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:()=>k(GH),providedIn:"root"});let t=e;return t})(),GH=(()=>{let e=class e{shouldProcessUrl(r){return!0}extract(r){return r}merge(r,i){return r}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),$x=new F(""),Hx=new F("");function zH(t,e,n){let r=t.get(Hx),i=t.get(Yt);return t.get(le).runOutsideAngular(()=>{if(!i.startViewTransition||r.skipNextTransition)return r.skipNextTransition=!1,Promise.resolve();let s,o=new Promise(c=>{s=c}),a=i.startViewTransition(()=>(s(),WH(t))),{onViewTransitionCreated:u}=r;return u&&ci(t,()=>u({transition:a,from:e,to:n})),o})}function WH(t){return new Promise(e=>{H_(e,{injector:t})})}var Jv=(()=>{let e=class e{get hasRequestedNavigation(){return this.navigationId!==0}constructor(){this.currentNavigation=null,this.currentTransition=null,this.lastSuccessfulNavigation=null,this.events=new Ye,this.transitionAbortSubject=new Ye,this.configLoader=k(Zv),this.environmentInjector=k(en),this.urlSerializer=k(Ec),this.rootContexts=k(Ic),this.location=k(na),this.inputBindingEnabled=k(kf,{optional:!0})!==null,this.titleStrategy=k(Ux),this.options=k(Tc,{optional:!0})||{},this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlHandlingStrategy=k(Xv),this.createViewTransition=k($x,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>U(void 0),this.rootComponentType=null;let r=s=>this.events.next(new xv(s)),i=s=>this.events.next(new Mv(s));this.configLoader.onLoadEndListener=i,this.configLoader.onLoadStartListener=r}complete(){this.transitions?.complete()}handleNavigationRequest(r){let i=++this.navigationId;this.transitions?.next(ue(x(x({},this.transitions.value),r),{id:i}))}setupNavigations(r,i,s){return this.transitions=new wt({id:0,currentUrlTree:i,currentRawUrl:i,extractedUrl:this.urlHandlingStrategy.extract(i),urlAfterRedirects:this.urlHandlingStrategy.extract(i),rawUrl:i,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:lc,restoredState:null,currentSnapshot:s.snapshot,targetSnapshot:null,currentRouterState:s,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(Et(o=>o.id!==0),j(o=>ue(x({},o),{extractedUrl:this.urlHandlingStrategy.extract(o.rawUrl)})),ke(o=>{this.currentTransition=o;let a=!1,u=!1;return U(o).pipe(Xe(c=>{this.currentNavigation={id:c.id,initialUrl:c.rawUrl,extractedUrl:c.extractedUrl,trigger:c.source,extras:c.extras,previousNavigation:this.lastSuccessfulNavigation?ue(x({},this.lastSuccessfulNavigation),{previousNavigation:null}):null}}),ke(c=>{let l=!r.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),d=c.extras.onSameUrlNavigation??r.onSameUrlNavigation;if(!l&&d!=="reload"){let h="";return this.events.next(new fi(c.id,this.urlSerializer.serialize(c.rawUrl),h,Df.IgnoredSameUrlNavigation)),c.resolve(null),Wt}if(this.urlHandlingStrategy.shouldProcessUrl(c.rawUrl))return U(c).pipe(ke(h=>{let f=this.transitions?.getValue();return this.events.next(new la(h.id,this.urlSerializer.serialize(h.extractedUrl),h.source,h.restoredState)),f!==this.transitions?.getValue()?Wt:Promise.resolve(h)}),VH(this.environmentInjector,this.configLoader,this.rootComponentType,r.config,this.urlSerializer,this.paramsInheritanceStrategy),Xe(h=>{o.targetSnapshot=h.targetSnapshot,o.urlAfterRedirects=h.urlAfterRedirects,this.currentNavigation=ue(x({},this.currentNavigation),{finalUrl:h.urlAfterRedirects});let f=new Tf(h.id,this.urlSerializer.serialize(h.extractedUrl),this.urlSerializer.serialize(h.urlAfterRedirects),h.targetSnapshot);this.events.next(f)}));if(l&&this.urlHandlingStrategy.shouldProcessUrl(c.currentRawUrl)){let{id:h,extractedUrl:f,source:p,restoredState:g,extras:_}=c,b=new la(h,this.urlSerializer.serialize(f),p,g);this.events.next(b);let P=xx(this.rootComponentType).snapshot;return this.currentTransition=o=ue(x({},c),{targetSnapshot:P,urlAfterRedirects:f,extras:ue(x({},_),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.finalUrl=f,U(o)}else{let h="";return this.events.next(new fi(c.id,this.urlSerializer.serialize(c.extractedUrl),h,Df.IgnoredByUrlHandlingStrategy)),c.resolve(null),Wt}}),Xe(c=>{let l=new Tv(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot);this.events.next(l)}),j(c=>(this.currentTransition=o=ue(x({},c),{guards:tH(c.targetSnapshot,c.currentSnapshot,this.rootContexts)}),o)),dH(this.environmentInjector,c=>this.events.next(c)),Xe(c=>{if(o.guardsResult=c.guardsResult,ca(c.guardsResult))throw Px(this.urlSerializer,c.guardsResult);let l=new bv(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot,!!c.guardsResult);this.events.next(l)}),Et(c=>c.guardsResult?!0:(this.cancelNavigationTransition(c,"",wn.GuardRejected),!1)),vv(c=>{if(c.guards.canActivateChecks.length)return U(c).pipe(Xe(l=>{let d=new Sv(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);this.events.next(d)}),ke(l=>{let d=!1;return U(l).pipe(LH(this.paramsInheritanceStrategy,this.environmentInjector),Xe({next:()=>d=!0,complete:()=>{d||this.cancelNavigationTransition(l,"",wn.NoDataFromResolver)}}))}),Xe(l=>{let d=new Av(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);this.events.next(d)}))}),vv(c=>{let l=d=>{let h=[];d.routeConfig?.loadComponent&&!d.routeConfig._loadedComponent&&h.push(this.configLoader.loadComponent(d.routeConfig).pipe(Xe(f=>{d.component=f}),j(()=>{})));for(let f of d.children)h.push(...l(f));return h};return Nu(l(c.targetSnapshot.root)).pipe(ti(null),Ar(1))}),vv(()=>this.afterPreactivation()),ke(()=>{let{currentSnapshot:c,targetSnapshot:l}=o,d=this.createViewTransition?.(this.environmentInjector,c.root,l.root);return d?_e(d).pipe(j(()=>o)):U(o)}),j(c=>{let l=W$(r.routeReuseStrategy,c.targetSnapshot,c.currentRouterState);return this.currentTransition=o=ue(x({},c),{targetRouterState:l}),this.currentNavigation.targetRouterState=l,o}),Xe(()=>{this.events.next(new gc)}),eH(this.rootContexts,r.routeReuseStrategy,c=>this.events.next(c),this.inputBindingEnabled),Ar(1),Xe({next:c=>{a=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new or(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects))),this.titleStrategy?.updateTitle(c.targetRouterState.snapshot),c.resolve(!0)},complete:()=>{a=!0}}),uy(this.transitionAbortSubject.pipe(Xe(c=>{throw c}))),ku(()=>{!a&&!u&&this.cancelNavigationTransition(o,"",wn.SupersededByNewNavigation),this.currentNavigation?.id===o.id&&(this.currentNavigation=null)}),ei(c=>{if(u=!0,Ox(c))this.events.next(new hi(o.id,this.urlSerializer.serialize(o.extractedUrl),c.message,c.cancellationCode)),Y$(c)?this.events.next(new mc(c.url)):o.resolve(!1);else{this.events.next(new pc(o.id,this.urlSerializer.serialize(o.extractedUrl),c,o.targetSnapshot??void 0));try{o.resolve(r.errorHandler(c))}catch(l){this.options.resolveNavigationPromiseOnError?o.resolve(!1):o.reject(l)}}return Wt}))}))}cancelNavigationTransition(r,i,s){let o=new hi(r.id,this.urlSerializer.serialize(r.extractedUrl),i,s);this.events.next(o),r.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){return this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))).toString()!==this.currentTransition?.extractedUrl.toString()&&!this.currentTransition?.extras.skipLocationChange}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function KH(t){return t!==lc}var QH=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:()=>k(YH),providedIn:"root"});let t=e;return t})(),Gv=class{shouldDetach(e){return!1}store(e,n){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,n){return e.routeConfig===n.routeConfig}},YH=(()=>{let e=class e extends Gv{};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=ms(e)))(s||e)}})(),e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),qx=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:()=>k(ZH),providedIn:"root"});let t=e;return t})(),ZH=(()=>{let e=class e extends qx{constructor(){super(...arguments),this.location=k(na),this.urlSerializer=k(Ec),this.options=k(Tc,{optional:!0})||{},this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.urlHandlingStrategy=k(Xv),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.currentUrlTree=new di,this.rawUrlTree=this.currentUrlTree,this.currentPageId=0,this.lastSuccessfulId=-1,this.routerState=xx(null),this.stateMemento=this.createStateMemento()}getCurrentUrlTree(){return this.currentUrlTree}getRawUrlTree(){return this.rawUrlTree}restoredState(){return this.location.getState()}get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}getRouterState(){return this.routerState}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}registerNonRouterCurrentEntryChangeListener(r){return this.location.subscribe(i=>{i.type==="popstate"&&r(i.url,i.state)})}handleRouterEvent(r,i){if(r instanceof la)this.stateMemento=this.createStateMemento();else if(r instanceof fi)this.rawUrlTree=i.initialUrl;else if(r instanceof Tf){if(this.urlUpdateStrategy==="eager"&&!i.extras.skipLocationChange){let s=this.urlHandlingStrategy.merge(i.finalUrl,i.initialUrl);this.setBrowserUrl(s,i)}}else r instanceof gc?(this.currentUrlTree=i.finalUrl,this.rawUrlTree=this.urlHandlingStrategy.merge(i.finalUrl,i.initialUrl),this.routerState=i.targetRouterState,this.urlUpdateStrategy==="deferred"&&(i.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,i))):r instanceof hi&&(r.code===wn.GuardRejected||r.code===wn.NoDataFromResolver)?this.restoreHistory(i):r instanceof pc?this.restoreHistory(i,!0):r instanceof or&&(this.lastSuccessfulId=r.id,this.currentPageId=this.browserPageId)}setBrowserUrl(r,i){let s=this.urlSerializer.serialize(r);if(this.location.isCurrentPathEqualTo(s)||i.extras.replaceUrl){let o=this.browserPageId,a=x(x({},i.extras.state),this.generateNgRouterState(i.id,o));this.location.replaceState(s,"",a)}else{let o=x(x({},i.extras.state),this.generateNgRouterState(i.id,this.browserPageId+1));this.location.go(s,"",o)}}restoreHistory(r,i=!1){if(this.canceledNavigationResolution==="computed"){let s=this.browserPageId,o=this.currentPageId-s;o!==0?this.location.historyGo(o):this.currentUrlTree===r.finalUrl&&o===0&&(this.resetState(r),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(i&&this.resetState(r),this.resetUrlToCurrentUrlTree())}resetState(r){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,r.finalUrl??this.rawUrlTree)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(r,i){return this.canceledNavigationResolution==="computed"?{navigationId:r,\u0275routerPageId:i}:{navigationId:r}}};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=ms(e)))(s||e)}})(),e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),uc=function(t){return t[t.COMPLETE=0]="COMPLETE",t[t.FAILED=1]="FAILED",t[t.REDIRECTING=2]="REDIRECTING",t}(uc||{});function Gx(t,e){t.events.pipe(Et(n=>n instanceof or||n instanceof hi||n instanceof pc||n instanceof fi),j(n=>n instanceof or||n instanceof fi?uc.COMPLETE:(n instanceof hi?n.code===wn.Redirect||n.code===wn.SupersededByNewNavigation:!1)?uc.REDIRECTING:uc.FAILED),Et(n=>n!==uc.REDIRECTING),Ar(1)).subscribe(()=>{e()})}function XH(t){throw t}var JH={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},e4={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},pi=(()=>{let e=class e{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}constructor(){this.disposed=!1,this.isNgZoneEnabled=!1,this.console=k(af),this.stateManager=k(qx),this.options=k(Tc,{optional:!0})||{},this.pendingTasks=k(rf),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.navigationTransitions=k(Jv),this.urlSerializer=k(Ec),this.location=k(na),this.urlHandlingStrategy=k(Xv),this._events=new Ye,this.errorHandler=this.options.errorHandler||XH,this.navigated=!1,this.routeReuseStrategy=k(QH),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.config=k(Nf,{optional:!0})?.flat()??[],this.componentInputBindingEnabled=!!k(kf,{optional:!0}),this.eventsSubscription=new He,this.isNgZoneEnabled=k(le)instanceof le&&le.isInAngularZone(),this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe({error:r=>{this.console.warn(r)}}),this.subscribeToNavigationEvents()}subscribeToNavigationEvents(){let r=this.navigationTransitions.events.subscribe(i=>{try{let s=this.navigationTransitions.currentTransition,o=this.navigationTransitions.currentNavigation;if(s!==null&&o!==null){if(this.stateManager.handleRouterEvent(i,o),i instanceof hi&&i.code!==wn.Redirect&&i.code!==wn.SupersededByNewNavigation)this.navigated=!0;else if(i instanceof or)this.navigated=!0;else if(i instanceof mc){let a=this.urlHandlingStrategy.merge(i.url,s.currentRawUrl),u={info:s.extras.info,skipLocationChange:s.extras.skipLocationChange,replaceUrl:this.urlUpdateStrategy==="eager"||KH(s.source)};this.scheduleNavigation(a,lc,null,u,{resolve:s.resolve,reject:s.reject,promise:s.promise})}}n4(i)&&this._events.next(i)}catch(s){this.navigationTransitions.transitionAbortSubject.next(s)}});this.eventsSubscription.add(r)}resetRootComponentType(r){this.routerState.root.component=r,this.navigationTransitions.rootComponentType=r}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),lc,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((r,i)=>{setTimeout(()=>{this.navigateToSyncWithBrowser(r,"popstate",i)},0)})}navigateToSyncWithBrowser(r,i,s){let o={replaceUrl:!0},a=s?.navigationId?s:null;if(s){let c=x({},s);delete c.navigationId,delete c.\u0275routerPageId,Object.keys(c).length!==0&&(o.state=c)}let u=this.parseUrl(r);this.scheduleNavigation(u,i,a,o)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(r){this.config=r.map(Qv),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(r,i={}){let{relativeTo:s,queryParams:o,fragment:a,queryParamsHandling:u,preserveFragment:c}=i,l=c?this.currentUrlTree.fragment:a,d=null;switch(u){case"merge":d=x(x({},this.currentUrlTree.queryParams),o);break;case"preserve":d=this.currentUrlTree.queryParams;break;default:d=o||null}d!==null&&(d=this.removeEmptyProps(d));let h;try{let f=s?s.snapshot:this.routerState.snapshot.root;h=Tx(f)}catch{(typeof r[0]!="string"||!r[0].startsWith("/"))&&(r=[]),h=this.currentUrlTree.root}return bx(h,r,d,l??null)}navigateByUrl(r,i={skipLocationChange:!1}){let s=ca(r)?r:this.parseUrl(r),o=this.urlHandlingStrategy.merge(s,this.rawUrlTree);return this.scheduleNavigation(o,lc,null,i)}navigate(r,i={skipLocationChange:!1}){return t4(r),this.navigateByUrl(this.createUrlTree(r,i),i)}serializeUrl(r){return this.urlSerializer.serialize(r)}parseUrl(r){try{return this.urlSerializer.parse(r)}catch{return this.urlSerializer.parse("/")}}isActive(r,i){let s;if(i===!0?s=x({},JH):i===!1?s=x({},e4):s=i,ca(r))return ax(this.currentUrlTree,r,s);let o=this.parseUrl(r);return ax(this.currentUrlTree,o,s)}removeEmptyProps(r){return Object.entries(r).reduce((i,[s,o])=>(o!=null&&(i[s]=o),i),{})}scheduleNavigation(r,i,s,o,a){if(this.disposed)return Promise.resolve(!1);let u,c,l;a?(u=a.resolve,c=a.reject,l=a.promise):l=new Promise((h,f)=>{u=h,c=f});let d=this.pendingTasks.add();return Gx(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(d))}),this.navigationTransitions.handleNavigationRequest({source:i,restoredState:s,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:r,extras:o,resolve:u,reject:c,promise:l,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),l.catch(h=>Promise.reject(h))}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function t4(t){for(let e=0;e<t.length;e++)if(t[e]==null)throw new $(4008,!1)}function n4(t){return!(t instanceof gc)&&!(t instanceof mc)}var zx=(()=>{let e=class e{constructor(r,i,s,o,a,u){this.router=r,this.route=i,this.tabIndexAttribute=s,this.renderer=o,this.el=a,this.locationStrategy=u,this.href=null,this.commands=null,this.onChanges=new Ye,this.preserveFragment=!1,this.skipLocationChange=!1,this.replaceUrl=!1;let c=a.nativeElement.tagName?.toLowerCase();this.isAnchorElement=c==="a"||c==="area",this.isAnchorElement?this.subscription=r.events.subscribe(l=>{l instanceof or&&this.updateHref()}):this.setTabIndexIfNotOnNativeEl("0")}setTabIndexIfNotOnNativeEl(r){this.tabIndexAttribute!=null||this.isAnchorElement||this.applyAttributeValue("tabindex",r)}ngOnChanges(r){this.isAnchorElement&&this.updateHref(),this.onChanges.next(this)}set routerLink(r){r!=null?(this.commands=Array.isArray(r)?r:[r],this.setTabIndexIfNotOnNativeEl("0")):(this.commands=null,this.setTabIndexIfNotOnNativeEl(null))}onClick(r,i,s,o,a){let u=this.urlTree;if(u===null||this.isAnchorElement&&(r!==0||i||s||o||a||typeof this.target=="string"&&this.target!="_self"))return!0;let c={skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state,info:this.info};return this.router.navigateByUrl(u,c),!this.isAnchorElement}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){let r=this.urlTree;this.href=r!==null&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(r)):null;let i=this.href===null?null:KS(this.href,this.el.nativeElement.tagName.toLowerCase(),"href");this.applyAttributeValue("href",i)}applyAttributeValue(r,i){let s=this.renderer,o=this.el.nativeElement;i!==null?s.setAttribute(o,r,i):s.removeAttribute(o,r)}get urlTree(){return this.commands===null?null:this.router.createUrlTree(this.commands,{relativeTo:this.relativeTo!==void 0?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}};e.\u0275fac=function(i){return new(i||e)(oe(pi),oe(Ds),D_("tabindex"),oe(kr),oe(rr),oe(Fr))},e.\u0275dir=Lt({type:e,selectors:[["","routerLink",""]],hostVars:1,hostBindings:function(i,s){i&1&&pe("click",function(a){return s.onClick(a.button,a.ctrlKey,a.shiftKey,a.altKey,a.metaKey)}),i&2&&of("target",s.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",info:"info",relativeTo:"relativeTo",preserveFragment:[Vt.HasDecoratorInputTransform,"preserveFragment","preserveFragment",ws],skipLocationChange:[Vt.HasDecoratorInputTransform,"skipLocationChange","skipLocationChange",ws],replaceUrl:[Vt.HasDecoratorInputTransform,"replaceUrl","replaceUrl",ws],routerLink:"routerLink"},standalone:!0,features:[z_,gs]});let t=e;return t})();var Pf=class{};var r4=(()=>{let e=class e{constructor(r,i,s,o,a){this.router=r,this.injector=s,this.preloadingStrategy=o,this.loader=a}setUpPreloading(){this.subscription=this.router.events.pipe(Et(r=>r instanceof or),rs(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(r,i){let s=[];for(let o of i){o.providers&&!o._injector&&(o._injector=nf(o.providers,r,`Route: ${o.path}`));let a=o._injector??r,u=o._loadedInjector??a;(o.loadChildren&&!o._loadedRoutes&&o.canLoad===void 0||o.loadComponent&&!o._loadedComponent)&&s.push(this.preloadConfig(a,o)),(o.children||o._loadedRoutes)&&s.push(this.processRoutes(u,o.children??o._loadedRoutes))}return _e(s).pipe(Jr())}preloadConfig(r,i){return this.preloadingStrategy.preload(i,()=>{let s;i.loadChildren&&i.canLoad===void 0?s=this.loader.loadChildren(r,i):s=U(null);let o=s.pipe(Ze(a=>a===null?U(void 0):(i._loadedRoutes=a.routes,i._loadedInjector=a.injector,this.processRoutes(a.injector??r,a.routes))));if(i.loadComponent&&!i._loadedComponent){let a=this.loader.loadComponent(i);return _e([o,a]).pipe(Jr())}else return o})}};e.\u0275fac=function(i){return new(i||e)(C(pi),C(uf),C(en),C(Pf),C(Zv))},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),Wx=new F(""),i4=(()=>{let e=class e{constructor(r,i,s,o,a={}){this.urlSerializer=r,this.transitions=i,this.viewportScroller=s,this.zone=o,this.options=a,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},a.scrollPositionRestoration||="disabled",a.anchorScrolling||="disabled"}init(){this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(r=>{r instanceof la?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=r.navigationTrigger,this.restoredId=r.restoredState?r.restoredState.navigationId:0):r instanceof or?(this.lastId=r.id,this.scheduleScrollEvent(r,this.urlSerializer.parse(r.urlAfterRedirects).fragment)):r instanceof fi&&r.code===Df.IgnoredSameUrlNavigation&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(r,this.urlSerializer.parse(r.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(r=>{r instanceof bf&&(r.position?this.options.scrollPositionRestoration==="top"?this.viewportScroller.scrollToPosition([0,0]):this.options.scrollPositionRestoration==="enabled"&&this.viewportScroller.scrollToPosition(r.position):r.anchor&&this.options.anchorScrolling==="enabled"?this.viewportScroller.scrollToAnchor(r.anchor):this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(r,i){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.zone.run(()=>{this.transitions.events.next(new bf(r,this.lastSource==="popstate"?this.store[this.restoredId]:null,i))})},0)})}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}};e.\u0275fac=function(i){iA()},e.\u0275prov=V({token:e,factory:e.\u0275fac});let t=e;return t})();function s4(t){return t.routerState.root}function bc(t,e){return{\u0275kind:t,\u0275providers:e}}function o4(){let t=k(Ln);return e=>{let n=t.get(ta);if(e!==n.components[0])return;let r=t.get(pi),i=t.get(Kx);t.get(ew)===1&&r.initialNavigation(),t.get(Qx,null,se.Optional)?.setUpPreloading(),t.get(Wx,null,se.Optional)?.init(),r.resetRootComponentType(n.componentTypes[0]),i.closed||(i.next(),i.complete(),i.unsubscribe())}}var Kx=new F("",{factory:()=>new Ye}),ew=new F("",{providedIn:"root",factory:()=>1});function a4(){return bc(2,[{provide:ew,useValue:0},{provide:df,multi:!0,deps:[Ln],useFactory:e=>{let n=e.get(qA,Promise.resolve());return()=>n.then(()=>new Promise(r=>{let i=e.get(pi),s=e.get(Kx);Gx(i,()=>{r(!0)}),e.get(Jv).afterPreactivation=()=>(r(!0),s.closed?U(void 0):s),i.initialNavigation()}))}}])}function u4(){return bc(3,[{provide:df,multi:!0,useFactory:()=>{let e=k(pi);return()=>{e.setUpLocationChangeListener()}}},{provide:ew,useValue:2}])}var Qx=new F("");function c4(t){return bc(0,[{provide:Qx,useExisting:r4},{provide:Pf,useExisting:t}])}function l4(){return bc(8,[dx,{provide:kf,useExisting:dx}])}function d4(t){let e=[{provide:$x,useValue:zH},{provide:Hx,useValue:x({skipNextTransition:!!t?.skipInitialTransition},t)}];return bc(9,e)}var fx=new F("ROUTER_FORROOT_GUARD"),h4=[na,{provide:Ec,useClass:hc},pi,Ic,{provide:Ds,useFactory:s4,deps:[pi]},Zv,[]],tw=(()=>{let e=class e{constructor(r){}static forRoot(r,i){return{ngModule:e,providers:[h4,[],{provide:Nf,multi:!0,useValue:r},{provide:fx,useFactory:m4,deps:[[pi,new Yo,new b_]]},{provide:Tc,useValue:i||{}},i?.useHash?p4():g4(),f4(),i?.preloadingStrategy?c4(i.preloadingStrategy).\u0275providers:[],i?.initialNavigation?y4(i):[],i?.bindToComponentInputs?l4().\u0275providers:[],i?.enableViewTransitions?d4().\u0275providers:[],_4()]}}static forChild(r){return{ngModule:e,providers:[{provide:Nf,multi:!0,useValue:r}]}}};e.\u0275fac=function(i){return new(i||e)(C(fx,8))},e.\u0275mod=et({type:e}),e.\u0275inj=Je({});let t=e;return t})();function f4(){return{provide:Wx,useFactory:()=>{let t=k(QA),e=k(le),n=k(Tc),r=k(Jv),i=k(Ec);return n.scrollOffset&&t.setOffset(n.scrollOffset),new i4(i,r,t,e,n)}}}function p4(){return{provide:Fr,useClass:zA}}function g4(){return{provide:Fr,useClass:ov}}function m4(t){return"guarded"}function y4(t){return[t.initialNavigation==="disabled"?u4().\u0275providers:[],t.initialNavigation==="enabledBlocking"?a4().\u0275providers:[]]}var px=new F("");function _4(){return[{provide:px,useFactory:o4},{provide:Z_,multi:!0,useExisting:px}]}var mi=class{};var v4="firebase",w4="10.8.0";Mn(v4,w4,"app");var Ts=new Rr("ANGULARFIRE2_VERSION");var E4=(t,e)=>{let n=e?[e]:pT(),r=[];return n.forEach(i=>{i.container.getProvider(t).instances.forEach(o=>{r.includes(o)||r.push(o)})}),r},Vr=class{constructor(){return E4(I4)}},I4="app-check";function nw(){}var Ff=class{zone;delegate;constructor(e,n=ey){this.zone=e,this.delegate=n}now(){return this.delegate.now()}schedule(e,n,r){let i=this.zone,s=function(o){i.runGuarded(()=>{e.apply(this,[o])})};return this.delegate.schedule(s,n,r)}},rw=class{zone;task=null;constructor(e){this.zone=e}call(e,n){let r=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",nw,{},nw,nw)),n.pipe(Xe({next:r,complete:r,error:r})).subscribe(e).add(r)}unscheduleTask(){setTimeout(()=>{this.task!=null&&this.task.state==="scheduled"&&(this.task.invoke(),this.task=null)},10)}},fa=(()=>{class t{ngZone;outsideAngular;insideAngular;constructor(n){this.ngZone=n,this.outsideAngular=n.runOutsideAngular(()=>new Ff(Zone.current)),this.insideAngular=n.run(()=>new Ff(Zone.current,ns)),globalThis.\u0275AngularFireScheduler||=this}static \u0275fac=function(r){return new(r||t)(C(le))};static \u0275prov=V({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function C4(){let t=globalThis.\u0275AngularFireScheduler;if(!t)throw new Error(`Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using
provideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).`);return t}function Ge(t){return D4(C4())(t)}function D4(t){return function(n){return n=n.lift(new rw(t.ngZone)),n.pipe(Nn(t.outsideAngular),pn(t.insideAngular))}}var T4=new Map,b4={activated:!1,tokenObservers:[]},S4={initialized:!1,enabled:!1};function jn(t){return T4.get(t)||Object.assign({},b4)}function rM(){return S4}var A4="https://content-firebaseappcheck.googleapis.com/v1";var x4="exchangeDebugToken",Zx={OFFSET_DURATION:5*60*1e3,RETRIAL_MIN_WAIT:30*1e3,RETRIAL_MAX_WAIT:16*60*1e3},jJ=24*60*60*1e3;var ow=class{constructor(e,n,r,i,s){if(this.operation=e,this.retryPolicy=n,this.getWaitDuration=r,this.lowerBound=i,this.upperBound=s,this.pending=null,this.nextErrorWaitInterval=i,i>s)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}process(e){return v(this,null,function*(){this.stop();try{this.pending=new lt,this.pending.promise.catch(n=>{}),yield M4(this.getNextRun(e)),this.pending.resolve(),yield this.pending.promise,this.pending=new lt,this.pending.promise.catch(n=>{}),yield this.operation(),this.pending.resolve(),yield this.pending.promise,this.process(!0).catch(()=>{})}catch(n){this.retryPolicy(n)?this.process(!1).catch(()=>{}):this.stop()}})}getNextRun(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{let n=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),n}}};function M4(t){return new Promise(e=>{setTimeout(e,t)})}var R4={"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.",throttled:"Requests throttled due to {$httpStatus} error. Attempts allowed again after {$time}"},yi=new uT("appCheck","AppCheck",R4);function iM(t){if(!jn(t).activated)throw yi.create("use-before-activation",{appName:t.name})}function sM(r,i){return v(this,arguments,function*({url:t,body:e},n){let s={"Content-Type":"application/json"},o=n.getImmediate({optional:!0});if(o){let f=yield o.getHeartbeatsHeader();f&&(s["X-Firebase-Client"]=f)}let a={method:"POST",body:JSON.stringify(e),headers:s},u;try{u=yield fetch(t,a)}catch(f){throw yi.create("fetch-network-error",{originalErrorMessage:f?.message})}if(u.status!==200)throw yi.create("fetch-status-error",{httpStatus:u.status});let c;try{c=yield u.json()}catch(f){throw yi.create("fetch-parse-error",{originalErrorMessage:f?.message})}let l=c.ttl.match(/^([\d.]+)(s)$/);if(!l||!l[2]||isNaN(Number(l[1])))throw yi.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${c.ttl}`});let d=Number(l[1])*1e3,h=Date.now();return{token:c.token,expireTimeMillis:h+d,issuedAtTimeMillis:h}})}function oM(t,e){let{projectId:n,appId:r,apiKey:i}=t.options;return{url:`${A4}/projects/${n}/apps/${r}:${x4}?key=${i}`,body:{debug_token:e}}}var N4="firebase-app-check-database",P4=1,aw="firebase-app-check-store";var Vf=null;function k4(){return Vf||(Vf=new Promise((t,e)=>{try{let n=indexedDB.open(N4,P4);n.onsuccess=r=>{t(r.target.result)},n.onerror=r=>{var i;e(yi.create("storage-open",{originalErrorMessage:(i=r.target.error)===null||i===void 0?void 0:i.message}))},n.onupgradeneeded=r=>{let i=r.target.result;switch(r.oldVersion){case 0:i.createObjectStore(aw,{keyPath:"compositeKey"})}}}catch(n){e(yi.create("storage-open",{originalErrorMessage:n?.message}))}}),Vf)}function O4(t,e){return F4(V4(t),e)}function F4(t,e){return v(this,null,function*(){let r=(yield k4()).transaction(aw,"readwrite"),s=r.objectStore(aw).put({compositeKey:t,value:e});return new Promise((o,a)=>{s.onsuccess=u=>{o()},r.onerror=u=>{var c;a(yi.create("storage-set",{originalErrorMessage:(c=u.target.error)===null||c===void 0?void 0:c.message}))}})})}function V4(t){return`${t.options.appId}-${t.name}`}var uw=new Xr("@firebase/app-check");function sw(t,e){return Rd()?O4(t,e).catch(n=>{uw.warn(`Failed to write token to IndexedDB. Error: ${n}`)}):Promise.resolve()}function aM(){return rM().enabled}function uM(){return v(this,null,function*(){let t=rM();if(t.enabled&&t.token)return t.token.promise;throw Error(`
            Can't get debug token in production mode.
        `)})}var L4={error:"UNKNOWN_ERROR"};function j4(t){return xd.encodeString(JSON.stringify(t),!1)}function cw(t,e=!1){return v(this,null,function*(){let n=t.app;iM(n);let r=jn(n),i=r.token,s;if(i&&!Sc(i)&&(r.token=void 0,i=void 0),!i){let u=yield r.cachedTokenPromise;u&&(Sc(u)?i=u:yield sw(n,void 0))}if(!e&&i&&Sc(i))return{token:i.token};let o=!1;if(aM()){r.exchangeTokenPromise||(r.exchangeTokenPromise=sM(oM(n,yield uM()),t.heartbeatServiceProvider).finally(()=>{r.exchangeTokenPromise=void 0}),o=!0);let u=yield r.exchangeTokenPromise;return yield sw(n,u),r.token=u,{token:u.token}}try{r.exchangeTokenPromise||(r.exchangeTokenPromise=r.provider.getToken().finally(()=>{r.exchangeTokenPromise=void 0}),o=!0),i=yield jn(n).exchangeTokenPromise}catch(u){u.code==="appCheck/throttled"?uw.warn(u.message):uw.error(u),s=u}let a;return i?s?Sc(i)?a={token:i.token,internalError:s}:a=Jx(s):(a={token:i.token},r.token=i,yield sw(n,i)):a=Jx(s),o&&H4(n,a),a})}function U4(t){return v(this,null,function*(){let e=t.app;iM(e);let{provider:n}=jn(e);if(aM()){let r=yield uM(),{token:i}=yield sM(oM(e,r),t.heartbeatServiceProvider);return{token:i}}else{let{token:r}=yield n.getToken();return{token:r}}})}function B4(t,e,n,r){let{app:i}=t,s=jn(i),o={next:n,error:r,type:e};if(s.tokenObservers=[...s.tokenObservers,o],s.token&&Sc(s.token)){let a=s.token;Promise.resolve().then(()=>{n({token:a.token}),Xx(t)}).catch(()=>{})}s.cachedTokenPromise.then(()=>Xx(t))}function cM(t,e){let n=jn(t),r=n.tokenObservers.filter(i=>i.next!==e);r.length===0&&n.tokenRefresher&&n.tokenRefresher.isRunning()&&n.tokenRefresher.stop(),n.tokenObservers=r}function Xx(t){let{app:e}=t,n=jn(e),r=n.tokenRefresher;r||(r=$4(t),n.tokenRefresher=r),!r.isRunning()&&n.isTokenAutoRefreshEnabled&&r.start()}function $4(t){let{app:e}=t;return new ow(()=>v(this,null,function*(){let n=jn(e),r;if(n.token?r=yield cw(t,!0):r=yield cw(t),r.error)throw r.error;if(r.internalError)throw r.internalError}),()=>!0,()=>{let n=jn(e);if(n.token){let r=n.token.issuedAtTimeMillis+(n.token.expireTimeMillis-n.token.issuedAtTimeMillis)*.5+3e5,i=n.token.expireTimeMillis-5*60*1e3;return r=Math.min(r,i),Math.max(0,r-Date.now())}else return 0},Zx.RETRIAL_MIN_WAIT,Zx.RETRIAL_MAX_WAIT)}function H4(t,e){let n=jn(t).tokenObservers;for(let r of n)try{r.type==="EXTERNAL"&&e.error!=null?r.error(e.error):r.next(e)}catch{}}function Sc(t){return t.expireTimeMillis-Date.now()>0}function Jx(t){return{token:j4(L4),error:t}}var lw=class{constructor(e,n){this.app=e,this.heartbeatServiceProvider=n}_delete(){let{tokenObservers:e}=jn(this.app);for(let n of e)cM(this.app,n.next);return Promise.resolve()}};function q4(t,e){return new lw(t,e)}function G4(t){return{getToken:e=>cw(t,e),getLimitedUseToken:()=>U4(t),addTokenListener:e=>B4(t,"INTERNAL",e),removeTokenListener:e=>cM(t.app,e)}}var z4="@firebase/app-check",W4="0.8.2";var K4="app-check",eM="app-check-internal";function Q4(){Zi(new Xt(K4,t=>{let e=t.getProvider("app").getImmediate(),n=t.getProvider("heartbeat");return q4(e,n)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((t,e,n)=>{t.getProvider(eM).initialize()})),Zi(new Xt(eM,t=>{let e=t.getProvider("app-check").getImmediate();return G4(e)},"PUBLIC").setInstantiationMode("EXPLICIT")),Mn(z4,W4)}Q4();var Y4=["localhost","0.0.0.0","127.0.0.1"],ZJ=typeof window<"u"&&Y4.includes(window.location.hostname);var Z4="firebase",X4="10.8.0";_t.registerVersion(Z4,X4,"app-compat");var J4=["ngOnDestroy"],dM=(t,e,n,r={})=>new Proxy(t,{get:(i,s)=>n.runOutsideAngular(()=>{if(t[s])return r?.spy?.get&&r.spy.get(s,t[s]),t[s];if(J4.indexOf(s)>-1)return()=>{};let o=e.toPromise().then(a=>{let u=a?.[s];return typeof u=="function"?u.bind(a):u?.then?u.then(c=>n.run(()=>c)):n.run(()=>u)});return new Proxy(()=>{},{get:(a,u)=>o[u],apply:(a,u,c)=>o.then(l=>{let d=l?.(...c);return r?.spy?.apply&&r.spy.apply(s,c,d),d})})})});var Lf=class{constructor(e){return e}},_i=new F("angularfire2.app.options"),vi=new F("angularfire2.app.name");function bs(t,e,n){let r=typeof n=="string"&&n||"[DEFAULT]",i=typeof n=="object"&&n||{};i.name=i.name||r;let o=_t.apps.filter(a=>a&&a.name===i.name)[0]||e.runOutsideAngular(()=>_t.initializeApp(t,i));try{if(JSON.stringify(t)!==JSON.stringify(o.options)){let a=!!module.hot;eq("error",`${o.name} Firebase App already initialized with different options${a?", you may need to reload as Firebase is not HMR aware.":"."}`)}}catch{}return new Lf(o)}var eq=(t,...e)=>{ev()&&typeof console<"u"&&console[t](...e)},tq={provide:Lf,useFactory:bs,deps:[_i,le,[new Yo,vi]]},hM=(()=>{class t{static initializeApp(n,r){return{ngModule:t,providers:[{provide:_i,useValue:n},{provide:vi,useValue:r}]}}constructor(n){_t.registerVersion("angularfire",Ts.full,"core"),_t.registerVersion("angularfire",Ts.full,"app-compat"),_t.registerVersion("angular",xA.full,n.toString())}static \u0275fac=function(r){return new(r||t)(C(xt))};static \u0275mod=et({type:t});static \u0275inj=Je({providers:[tq]})}return t})();function pa(t,e,n,r,i){let[,s,o]=globalThis.\u0275AngularfireInstanceCache.find(a=>a[0]===t)||[];if(s)return nq(i,o)||(lM("error",`${e} was already initialized on the ${n} Firebase App with different settings.${rq?" You may need to reload as Firebase is not HMR aware.":""}`),lM("warn",{is:i,was:o})),s;{let a=r();return globalThis.\u0275AngularfireInstanceCache.push([t,a,i]),a}}function nq(t,e){try{return t.toString()===e.toString()}catch{return t===e}}var rq=typeof module<"u"&&!!module.hot,lM=(t,...e)=>{ev()&&typeof console<"u"&&console[t](...e)};globalThis.\u0275AngularfireInstanceCache||=[];var Ac=new F("angularfire2.auth.use-emulator"),xc=new F("angularfire2.auth.settings"),Mc=new F("angularfire2.auth.tenant-id"),Rc=new F("angularfire2.auth.langugage-code"),Nc=new F("angularfire2.auth.use-device-language"),Pc=new F("angularfire.auth.persistence"),kc=(t,e,n,r,i,s,o,a)=>pa(`${t.name}.auth`,"AngularFireAuth",t.name,()=>{let u=e.runOutsideAngular(()=>t.auth());if(n&&u.useEmulator(...n),r&&(u.tenantId=r),u.languageCode=i,s&&u.useDeviceLanguage(),o)for(let[c,l]of Object.entries(o))u.settings[c]=l;return a&&u.setPersistence(a),u},[n,r,i,s,o,a]),jf=(()=>{class t{authState;idToken;user;idTokenResult;credential;constructor(n,r,i,s,o,a,u,c,l,d,h,f){let p=new Ye,g=U(void 0).pipe(pn(o.outsideAngular),ke(()=>s.runOutsideAngular(()=>import("./chunk-2UTFESB6.js"))),j(()=>bs(n,s,r)),j(_=>kc(_,s,a,c,l,d,u,h)),ah({bufferSize:1,refCount:!1}));if(Es(i))this.authState=this.user=this.idToken=this.idTokenResult=this.credential=U(null);else{g.pipe(gn()).subscribe();let _=g.pipe(ke(A=>A.getRedirectResult().then(H=>H,()=>null)),Ge,ah({bufferSize:1,refCount:!1})),b=g.pipe(ke(A=>new ne(H=>({unsubscribe:s.runOutsideAngular(()=>A.onAuthStateChanged(G=>H.next(G),G=>H.error(G),()=>H.complete()))})))),P=g.pipe(ke(A=>new ne(H=>({unsubscribe:s.runOutsideAngular(()=>A.onIdTokenChanged(G=>H.next(G),G=>H.error(G),()=>H.complete()))}))));this.authState=_.pipe(uh(b),Nn(o.outsideAngular),pn(o.insideAngular)),this.user=_.pipe(uh(P),Nn(o.outsideAngular),pn(o.insideAngular)),this.idToken=this.user.pipe(ke(A=>A?_e(A.getIdToken()):U(null))),this.idTokenResult=this.user.pipe(ke(A=>A?_e(A.getIdTokenResult()):U(null))),this.credential=Mo(_,p,this.authState.pipe(Et(A=>!A))).pipe(j(A=>A?.user?A:null),Nn(o.outsideAngular),pn(o.insideAngular))}return dM(this,g,s,{spy:{apply:(_,b,P)=>{(_.startsWith("signIn")||_.startsWith("createUser"))&&P.then(A=>p.next(A))}}})}static \u0275fac=function(r){return new(r||t)(C(_i),C(vi,8),C(xt),C(le),C(fa),C(Ac,8),C(xc,8),C(Mc,8),C(Rc,8),C(Nc,8),C(Pc,8),C(Vr,8))};static \u0275prov=V({token:t,factory:t.\u0275fac,providedIn:"any"})}return t})();var iq=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Bn={},R,Pw=Pw||{},Q=iq||self;function Jf(t){var e=typeof t;return e=e!="object"?e:t?Array.isArray(t)?"array":e:"null",e=="array"||e=="object"&&typeof t.length=="number"}function Kc(t){var e=typeof t;return e=="object"&&t!=null||e=="function"}function sq(t){return Object.prototype.hasOwnProperty.call(t,hw)&&t[hw]||(t[hw]=++oq)}var hw="closure_uid_"+(1e9*Math.random()>>>0),oq=0;function aq(t,e,n){return t.call.apply(t.bind,arguments)}function uq(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var i=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(i,r),t.apply(e,i)}}return function(){return t.apply(e,arguments)}}function Mt(t,e,n){return Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?Mt=aq:Mt=uq,Mt.apply(null,arguments)}function Uf(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var r=n.slice();return r.push.apply(r,arguments),t.apply(this,r)}}function ft(t,e){function n(){}n.prototype=e.prototype,t.$=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.ac=function(r,i,s){for(var o=Array(arguments.length-2),a=2;a<arguments.length;a++)o[a-2]=arguments[a];return e.prototype[i].apply(r,o)}}function wi(){this.s=this.s,this.o=this.o}var cq=0;wi.prototype.s=!1;wi.prototype.sa=function(){!this.s&&(this.s=!0,this.N(),cq!=0)&&sq(this)};wi.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};var bM=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if(typeof t=="string")return typeof e!="string"||e.length!=1?-1:t.indexOf(e,0);for(let n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1};function kw(t){let e=t.length;if(0<e){let n=Array(e);for(let r=0;r<e;r++)n[r]=t[r];return n}return[]}function pM(t,e){for(let n=1;n<arguments.length;n++){let r=arguments[n];if(Jf(r)){let i=t.length||0,s=r.length||0;t.length=i+s;for(let o=0;o<s;o++)t[i+o]=r[o]}else t.push(r)}}function Rt(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}Rt.prototype.h=function(){this.defaultPrevented=!0};var lq=function(){if(!Q.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{let n=()=>{};Q.addEventListener("test",n,e),Q.removeEventListener("test",n,e)}catch{}return t}();function Uc(t){return/^[\s\xa0]*$/.test(t)}function ep(){var t=Q.navigator;return t&&(t=t.userAgent)?t:""}function ur(t){return ep().indexOf(t)!=-1}function Ow(t){return Ow[" "](t),t}Ow[" "]=function(){};function dq(t,e){var n=Jq;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t)}var hq=ur("Opera"),_a=ur("Trident")||ur("MSIE"),SM=ur("Edge"),yw=SM||_a,AM=ur("Gecko")&&!(ep().toLowerCase().indexOf("webkit")!=-1&&!ur("Edge"))&&!(ur("Trident")||ur("MSIE"))&&!ur("Edge"),fq=ep().toLowerCase().indexOf("webkit")!=-1&&!ur("Edge");function xM(){var t=Q.document;return t?t.documentMode:void 0}var _w;e:{if(Bf="",$f=function(){var t=ep();if(AM)return/rv:([^\);]+)(\)|;)/.exec(t);if(SM)return/Edge\/([\d\.]+)/.exec(t);if(_a)return/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(t);if(fq)return/WebKit\/(\S+)/.exec(t);if(hq)return/(?:Version)[ \/]?(\S+)/.exec(t)}(),$f&&(Bf=$f?$f[1]:""),_a&&(Hf=xM(),Hf!=null&&Hf>parseFloat(Bf))){_w=String(Hf);break e}_w=Bf}var Bf,$f,Hf,vw;Q.document&&_a?(fw=xM(),vw=fw||parseInt(_w,10)||void 0):vw=void 0;var fw,pq=vw;function Bc(t,e){if(Rt.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(AM){e:{try{Ow(e.nodeName);var i=!0;break e}catch{}i=!1}i||(e=null)}}else n=="mouseover"?e=t.fromElement:n=="mouseout"&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=r.clientX!==void 0?r.clientX:r.pageX,this.clientY=r.clientY!==void 0?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=t.clientX!==void 0?t.clientX:t.pageX,this.clientY=t.clientY!==void 0?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType=typeof t.pointerType=="string"?t.pointerType:gq[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&Bc.$.h.call(this)}}ft(Bc,Rt);var gq={2:"touch",3:"pen",4:"mouse"};Bc.prototype.h=function(){Bc.$.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var Qc="closure_listenable_"+(1e6*Math.random()|0),mq=0;function yq(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.la=i,this.key=++mq,this.fa=this.ia=!1}function tp(t){t.fa=!0,t.listener=null,t.proxy=null,t.src=null,t.la=null}function Fw(t,e,n){for(let r in t)e.call(n,t[r],r,t)}function _q(t,e){for(let n in t)e.call(void 0,t[n],n,t)}function MM(t){let e={};for(let n in t)e[n]=t[n];return e}var gM="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function RM(t,e){let n,r;for(let i=1;i<arguments.length;i++){r=arguments[i];for(n in r)t[n]=r[n];for(let s=0;s<gM.length;s++)n=gM[s],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function np(t){this.src=t,this.g={},this.h=0}np.prototype.add=function(t,e,n,r,i){var s=t.toString();t=this.g[s],t||(t=this.g[s]=[],this.h++);var o=Ew(t,e,r,i);return-1<o?(e=t[o],n||(e.ia=!1)):(e=new yq(e,this.src,s,!!r,i),e.ia=n,t.push(e)),e};function ww(t,e){var n=e.type;if(n in t.g){var r=t.g[n],i=bM(r,e),s;(s=0<=i)&&Array.prototype.splice.call(r,i,1),s&&(tp(e),t.g[n].length==0&&(delete t.g[n],t.h--))}}function Ew(t,e,n,r){for(var i=0;i<t.length;++i){var s=t[i];if(!s.fa&&s.listener==e&&s.capture==!!n&&s.la==r)return i}return-1}var Vw="closure_lm_"+(1e6*Math.random()|0),pw={};function NM(t,e,n,r,i){if(r&&r.once)return kM(t,e,n,r,i);if(Array.isArray(e)){for(var s=0;s<e.length;s++)NM(t,e[s],n,r,i);return null}return n=Uw(n),t&&t[Qc]?t.O(e,n,Kc(r)?!!r.capture:!!r,i):PM(t,e,n,!1,r,i)}function PM(t,e,n,r,i,s){if(!e)throw Error("Invalid event type");var o=Kc(i)?!!i.capture:!!i,a=jw(t);if(a||(t[Vw]=a=new np(t)),n=a.add(e,n,r,o,s),n.proxy)return n;if(r=vq(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)lq||(i=o),i===void 0&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(FM(e.toString()),r);else if(t.addListener&&t.removeListener)t.addListener(r);else throw Error("addEventListener and attachEvent are unavailable.");return n}function vq(){function t(n){return e.call(t.src,t.listener,n)}let e=wq;return t}function kM(t,e,n,r,i){if(Array.isArray(e)){for(var s=0;s<e.length;s++)kM(t,e[s],n,r,i);return null}return n=Uw(n),t&&t[Qc]?t.P(e,n,Kc(r)?!!r.capture:!!r,i):PM(t,e,n,!0,r,i)}function OM(t,e,n,r,i){if(Array.isArray(e))for(var s=0;s<e.length;s++)OM(t,e[s],n,r,i);else r=Kc(r)?!!r.capture:!!r,n=Uw(n),t&&t[Qc]?(t=t.i,e=String(e).toString(),e in t.g&&(s=t.g[e],n=Ew(s,n,r,i),-1<n&&(tp(s[n]),Array.prototype.splice.call(s,n,1),s.length==0&&(delete t.g[e],t.h--)))):t&&(t=jw(t))&&(e=t.g[e.toString()],t=-1,e&&(t=Ew(e,n,r,i)),(n=-1<t?e[t]:null)&&Lw(n))}function Lw(t){if(typeof t!="number"&&t&&!t.fa){var e=t.src;if(e&&e[Qc])ww(e.i,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(FM(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=jw(e))?(ww(n,t),n.h==0&&(n.src=null,e[Vw]=null)):tp(t)}}}function FM(t){return t in pw?pw[t]:pw[t]="on"+t}function wq(t,e){if(t.fa)t=!0;else{e=new Bc(e,this);var n=t.listener,r=t.la||t.src;t.ia&&Lw(t),t=n.call(r,e)}return t}function jw(t){return t=t[Vw],t instanceof np?t:null}var gw="__closure_events_fn_"+(1e9*Math.random()>>>0);function Uw(t){return typeof t=="function"?t:(t[gw]||(t[gw]=function(e){return t.handleEvent(e)}),t[gw])}function ht(){wi.call(this),this.i=new np(this),this.S=this,this.J=null}ft(ht,wi);ht.prototype[Qc]=!0;ht.prototype.removeEventListener=function(t,e,n,r){OM(this,t,e,n,r)};function Tt(t,e){var n,r=t.J;if(r)for(n=[];r;r=r.J)n.push(r);if(t=t.S,r=e.type||e,typeof e=="string")e=new Rt(e,t);else if(e instanceof Rt)e.target=e.target||t;else{var i=e;e=new Rt(r,t),RM(e,i)}if(i=!0,n)for(var s=n.length-1;0<=s;s--){var o=e.g=n[s];i=qf(o,r,!0,e)&&i}if(o=e.g=t,i=qf(o,r,!0,e)&&i,i=qf(o,r,!1,e)&&i,n)for(s=0;s<n.length;s++)o=e.g=n[s],i=qf(o,r,!1,e)&&i}ht.prototype.N=function(){if(ht.$.N.call(this),this.i){var t=this.i,e;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)tp(n[r]);delete t.g[e],t.h--}}this.J=null};ht.prototype.O=function(t,e,n,r){return this.i.add(String(t),e,!1,n,r)};ht.prototype.P=function(t,e,n,r){return this.i.add(String(t),e,!0,n,r)};function qf(t,e,n,r){if(e=t.i.g[String(e)],!e)return!0;e=e.concat();for(var i=!0,s=0;s<e.length;++s){var o=e[s];if(o&&!o.fa&&o.capture==n){var a=o.listener,u=o.la||o.src;o.ia&&ww(t.i,o),i=a.call(u,r)!==!1&&i}}return i&&!r.defaultPrevented}var Bw=Q.JSON.stringify,Iw=class{constructor(e,n){this.i=e,this.j=n,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}};function Eq(){var t=$w;let e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}var Cw=class{constructor(){this.h=this.g=null}add(e,n){let r=VM.get();r.set(e,n),this.h?this.h.next=r:this.g=r,this.h=r}},VM=new Iw(()=>new Dw,t=>t.reset()),Dw=class{constructor(){this.next=this.g=this.h=null}set(e,n){this.h=e,this.g=n,this.next=null}reset(){this.next=this.g=this.h=null}};function Iq(t){var e=1;t=t.split(":");let n=[];for(;0<e&&t.length;)n.push(t.shift()),e--;return t.length&&n.push(t.join(":")),n}function Cq(t){Q.setTimeout(()=>{throw t},0)}var $c,Hc=!1,$w=new Cw,LM=()=>{let t=Q.Promise.resolve(void 0);$c=()=>{t.then(Dq)}},Dq=()=>{for(var t;t=Eq();){try{t.h.call(t.g)}catch(n){Cq(n)}var e=VM;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}Hc=!1};function rp(t,e){ht.call(this),this.h=t||1,this.g=e||Q,this.j=Mt(this.qb,this),this.l=Date.now()}ft(rp,ht);R=rp.prototype;R.ga=!1;R.T=null;R.qb=function(){if(this.ga){var t=Date.now()-this.l;0<t&&t<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-t):(this.T&&(this.g.clearTimeout(this.T),this.T=null),Tt(this,"tick"),this.ga&&(Hw(this),this.start()))}};R.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())};function Hw(t){t.ga=!1,t.T&&(t.g.clearTimeout(t.T),t.T=null)}R.N=function(){rp.$.N.call(this),Hw(this),delete this.g};function qw(t,e,n){if(typeof t=="function")n&&(t=Mt(t,n));else if(t&&typeof t.handleEvent=="function")t=Mt(t.handleEvent,t);else throw Error("Invalid listener argument");return 2147483647<Number(e)?-1:Q.setTimeout(t,e||0)}function jM(t){t.g=qw(()=>{t.g=null,t.i&&(t.i=!1,jM(t))},t.j);let e=t.h;t.h=null,t.m.apply(null,e)}var Tw=class extends wi{constructor(e,n){super(),this.m=e,this.j=n,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:jM(this)}N(){super.N(),this.g&&(Q.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}};function qc(t){wi.call(this),this.h=t,this.g={}}ft(qc,wi);var mM=[];function UM(t,e,n,r){Array.isArray(n)||(n&&(mM[0]=n.toString()),n=mM);for(var i=0;i<n.length;i++){var s=NM(e,n[i],r||t.handleEvent,!1,t.h||t);if(!s)break;t.g[s.key]=s}}function BM(t){Fw(t.g,function(e,n){this.g.hasOwnProperty(n)&&Lw(e)},t),t.g={}}qc.prototype.N=function(){qc.$.N.call(this),BM(this)};qc.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};function ip(){this.g=!0}ip.prototype.Ea=function(){this.g=!1};function Tq(t,e,n,r,i,s){t.info(function(){if(t.g)if(s)for(var o="",a=s.split("&"),u=0;u<a.length;u++){var c=a[u].split("=");if(1<c.length){var l=c[0];c=c[1];var d=l.split("_");o=2<=d.length&&d[1]=="type"?o+(l+"="+c+"&"):o+(l+"=redacted&")}}else o=null;else o=s;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+`
`+n+`
`+o})}function bq(t,e,n,r,i,s,o){t.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+`
`+n+`
`+s+" "+o})}function ma(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+Aq(t,n)+(r?" "+r:"")})}function Sq(t,e){t.info(function(){return"TIMEOUT: "+e})}ip.prototype.info=function(){};function Aq(t,e){if(!t.g)return e;if(!e)return null;try{var n=JSON.parse(e);if(n){for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var s=i[0];if(s!="noop"&&s!="stop"&&s!="close")for(var o=1;o<i.length;o++)i[o]=""}}}}return Bw(n)}catch{return e}}var Ms={},yM=null;function sp(){return yM=yM||new ht}Ms.Ta="serverreachability";function $M(t){Rt.call(this,Ms.Ta,t)}ft($M,Rt);function Gc(t){let e=sp();Tt(e,new $M(e))}Ms.STAT_EVENT="statevent";function HM(t,e){Rt.call(this,Ms.STAT_EVENT,t),this.stat=e}ft(HM,Rt);function jt(t){let e=sp();Tt(e,new HM(e,t))}Ms.Ua="timingevent";function qM(t,e){Rt.call(this,Ms.Ua,t),this.size=e}ft(qM,Rt);function Yc(t,e){if(typeof t!="function")throw Error("Fn must not be null and must be a function");return Q.setTimeout(function(){t()},e)}var op={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},GM={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function Gw(){}Gw.prototype.h=null;function _M(t){return t.h||(t.h=t.i())}function zM(){}var Zc={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function zw(){Rt.call(this,"d")}ft(zw,Rt);function Ww(){Rt.call(this,"c")}ft(Ww,Rt);var bw;function ap(){}ft(ap,Gw);ap.prototype.g=function(){return new XMLHttpRequest};ap.prototype.i=function(){return{}};bw=new ap;function Xc(t,e,n,r){this.l=t,this.j=e,this.m=n,this.W=r||1,this.U=new qc(this),this.P=xq,t=yw?125:void 0,this.V=new rp(t),this.I=null,this.i=!1,this.u=this.B=this.A=this.L=this.G=this.Y=this.C=null,this.F=[],this.g=null,this.o=0,this.s=this.v=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new WM}function WM(){this.i=null,this.g="",this.h=!1}var xq=45e3,KM={},Sw={};R=Xc.prototype;R.setTimeout=function(t){this.P=t};function Aw(t,e,n){t.L=1,t.A=cp(jr(e)),t.u=n,t.S=!0,QM(t,null)}function QM(t,e){t.G=Date.now(),Jc(t),t.B=jr(t.A);var n=t.B,r=t.W;Array.isArray(r)||(r=[String(r)]),rR(n.i,"t",r),t.o=0,n=t.l.J,t.h=new WM,t.g=DR(t.l,n?e:null,!t.u),0<t.O&&(t.M=new Tw(Mt(t.Pa,t,t.g),t.O)),UM(t.U,t.g,"readystatechange",t.nb),e=t.I?MM(t.I):{},t.u?(t.v||(t.v="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.ha(t.B,t.v,t.u,e)):(t.v="GET",t.g.ha(t.B,t.v,null,e)),Gc(),Tq(t.j,t.v,t.B,t.m,t.W,t.u)}R.nb=function(t){t=t.target;let e=this.M;e&&cr(t)==3?e.l():this.Pa(t)};R.Pa=function(t){try{if(t==this.g)e:{let l=cr(this.g);var e=this.g.Ia();let d=this.g.da();if(!(3>l)&&(l!=3||yw||this.g&&(this.h.h||this.g.ja()||IM(this.g)))){this.J||l!=4||e==7||(e==8||0>=d?Gc(3):Gc(2)),up(this);var n=this.g.da();this.ca=n;t:if(YM(this)){var r=IM(this.g);t="";var i=r.length,s=cr(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Ss(this),jc(this);var o="";break t}this.h.i=new Q.TextDecoder}for(e=0;e<i;e++)this.h.h=!0,t+=this.h.i.decode(r[e],{stream:s&&e==i-1});r.length=0,this.h.g+=t,this.o=0,o=this.h.g}else o=this.g.ja();if(this.i=n==200,bq(this.j,this.v,this.B,this.m,this.W,l,n),this.i){if(this.aa&&!this.K){t:{if(this.g){var a,u=this.g;if((a=u.g?u.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Uc(a)){var c=a;break t}}c=null}if(n=c)ma(this.j,this.m,n,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,xw(this,n);else{this.i=!1,this.s=3,jt(12),Ss(this),jc(this);break e}}this.S?(ZM(this,l,o),yw&&this.i&&l==3&&(UM(this.U,this.V,"tick",this.mb),this.V.start())):(ma(this.j,this.m,o,null),xw(this,o)),l==4&&Ss(this),this.i&&!this.J&&(l==4?wR(this.l,this):(this.i=!1,Jc(this)))}else Yq(this.g),n==400&&0<o.indexOf("Unknown SID")?(this.s=3,jt(12)):(this.s=0,jt(13)),Ss(this),jc(this)}}}catch{}finally{}};function YM(t){return t.g?t.v=="GET"&&t.L!=2&&t.l.Ha:!1}function ZM(t,e,n){let r=!0,i;for(;!t.J&&t.o<n.length;)if(i=Mq(t,n),i==Sw){e==4&&(t.s=4,jt(14),r=!1),ma(t.j,t.m,null,"[Incomplete Response]");break}else if(i==KM){t.s=4,jt(15),ma(t.j,t.m,n,"[Invalid Chunk]"),r=!1;break}else ma(t.j,t.m,i,null),xw(t,i);YM(t)&&t.o!=0&&(t.h.g=t.h.g.slice(t.o),t.o=0),e!=4||n.length!=0||t.h.h||(t.s=1,jt(16),r=!1),t.i=t.i&&r,r?0<n.length&&!t.ba&&(t.ba=!0,e=t.l,e.g==t&&e.ca&&!e.M&&(e.l.info("Great, no buffering proxy detected. Bytes received: "+n.length),Jw(e),e.M=!0,jt(11))):(ma(t.j,t.m,n,"[Invalid Chunked Response]"),Ss(t),jc(t))}R.mb=function(){if(this.g){var t=cr(this.g),e=this.g.ja();this.o<e.length&&(up(this),ZM(this,t,e),this.i&&t!=4&&Jc(this))}};function Mq(t,e){var n=t.o,r=e.indexOf(`
`,n);return r==-1?Sw:(n=Number(e.substring(n,r)),isNaN(n)?KM:(r+=1,r+n>e.length?Sw:(e=e.slice(r,r+n),t.o=r+n,e)))}R.cancel=function(){this.J=!0,Ss(this)};function Jc(t){t.Y=Date.now()+t.P,XM(t,t.P)}function XM(t,e){if(t.C!=null)throw Error("WatchDog timer not null");t.C=Yc(Mt(t.lb,t),e)}function up(t){t.C&&(Q.clearTimeout(t.C),t.C=null)}R.lb=function(){this.C=null;let t=Date.now();0<=t-this.Y?(Sq(this.j,this.B),this.L!=2&&(Gc(),jt(17)),Ss(this),this.s=2,jc(this)):XM(this,this.Y-t)};function jc(t){t.l.H==0||t.J||wR(t.l,t)}function Ss(t){up(t);var e=t.M;e&&typeof e.sa=="function"&&e.sa(),t.M=null,Hw(t.V),BM(t.U),t.g&&(e=t.g,t.g=null,e.abort(),e.sa())}function xw(t,e){try{var n=t.l;if(n.H!=0&&(n.g==t||Mw(n.i,t))){if(!t.K&&Mw(n.i,t)&&n.H==3){try{var r=n.Ja.g.parse(e)}catch{r=null}if(Array.isArray(r)&&r.length==3){var i=r;if(i[0]==0){e:if(!n.u){if(n.g)if(n.g.G+3e3<t.G)Qf(n),hp(n);else break e;Xw(n),jt(18)}}else n.Fa=i[1],0<n.Fa-n.V&&37500>i[2]&&n.G&&n.A==0&&!n.v&&(n.v=Yc(Mt(n.ib,n),6e3));if(1>=oR(n.i)&&n.oa){try{n.oa()}catch{}n.oa=void 0}}else As(n,11)}else if((t.K||n.g==t)&&Qf(n),!Uc(e))for(i=n.Ja.g.parse(e),e=0;e<i.length;e++){let c=i[e];if(n.V=c[0],c=c[1],n.H==2)if(c[0]=="c"){n.K=c[1],n.pa=c[2];let l=c[3];l!=null&&(n.ra=l,n.l.info("VER="+n.ra));let d=c[4];d!=null&&(n.Ga=d,n.l.info("SVER="+n.Ga));let h=c[5];h!=null&&typeof h=="number"&&0<h&&(r=1.5*h,n.L=r,n.l.info("backChannelRequestTimeoutMs_="+r)),r=n;let f=t.g;if(f){let p=f.g?f.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(p){var s=r.i;s.g||p.indexOf("spdy")==-1&&p.indexOf("quic")==-1&&p.indexOf("h2")==-1||(s.j=s.l,s.g=new Set,s.h&&(Kw(s,s.h),s.h=null))}if(r.F){let g=f.g?f.g.getResponseHeader("X-HTTP-Session-Id"):null;g&&(r.Da=g,Re(r.I,r.F,g))}}n.H=3,n.h&&n.h.Ba(),n.ca&&(n.S=Date.now()-t.G,n.l.info("Handshake RTT: "+n.S+"ms")),r=n;var o=t;if(r.wa=CR(r,r.J?r.pa:null,r.Y),o.K){aR(r.i,o);var a=o,u=r.L;u&&a.setTimeout(u),a.C&&(up(a),Jc(a)),r.g=o}else _R(r);0<n.j.length&&fp(n)}else c[0]!="stop"&&c[0]!="close"||As(n,7);else n.H==3&&(c[0]=="stop"||c[0]=="close"?c[0]=="stop"?As(n,7):Zw(n):c[0]!="noop"&&n.h&&n.h.Aa(c),n.A=0)}}Gc(4)}catch{}}function Rq(t){if(t.Z&&typeof t.Z=="function")return t.Z();if(typeof Map<"u"&&t instanceof Map||typeof Set<"u"&&t instanceof Set)return Array.from(t.values());if(typeof t=="string")return t.split("");if(Jf(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}e=[],n=0;for(r in t)e[n++]=t[r];return e}function Nq(t){if(t.ta&&typeof t.ta=="function")return t.ta();if(!t.Z||typeof t.Z!="function"){if(typeof Map<"u"&&t instanceof Map)return Array.from(t.keys());if(!(typeof Set<"u"&&t instanceof Set)){if(Jf(t)||typeof t=="string"){var e=[];t=t.length;for(var n=0;n<t;n++)e.push(n);return e}e=[],n=0;for(let r in t)e[n++]=r;return e}}}function JM(t,e){if(t.forEach&&typeof t.forEach=="function")t.forEach(e,void 0);else if(Jf(t)||typeof t=="string")Array.prototype.forEach.call(t,e,void 0);else for(var n=Nq(t),r=Rq(t),i=r.length,s=0;s<i;s++)e.call(void 0,r[s],n&&n[s],t)}var eR=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Pq(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var s=t[n].substring(0,r);i=t[n].substring(r+1)}else s=t[n];e(s,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}function xs(t){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,t instanceof xs){this.h=t.h,Wf(this,t.j),this.s=t.s,this.g=t.g,Kf(this,t.m),this.l=t.l;var e=t.i,n=new zc;n.i=e.i,e.g&&(n.g=new Map(e.g),n.h=e.h),vM(this,n),this.o=t.o}else t&&(e=String(t).match(eR))?(this.h=!1,Wf(this,e[1]||"",!0),this.s=Vc(e[2]||""),this.g=Vc(e[3]||"",!0),Kf(this,e[4]),this.l=Vc(e[5]||"",!0),vM(this,e[6]||"",!0),this.o=Vc(e[7]||"")):(this.h=!1,this.i=new zc(null,this.h))}xs.prototype.toString=function(){var t=[],e=this.j;e&&t.push(Lc(e,wM,!0),":");var n=this.g;return(n||e=="file")&&(t.push("//"),(e=this.s)&&t.push(Lc(e,wM,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n=this.m,n!=null&&t.push(":",String(n))),(n=this.l)&&(this.g&&n.charAt(0)!="/"&&t.push("/"),t.push(Lc(n,n.charAt(0)=="/"?Fq:Oq,!0))),(n=this.i.toString())&&t.push("?",n),(n=this.o)&&t.push("#",Lc(n,Lq)),t.join("")};function jr(t){return new xs(t)}function Wf(t,e,n){t.j=n?Vc(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function Kf(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.m=e}else t.m=null}function vM(t,e,n){e instanceof zc?(t.i=e,jq(t.i,t.h)):(n||(e=Lc(e,Vq)),t.i=new zc(e,t.h))}function Re(t,e,n){t.i.set(e,n)}function cp(t){return Re(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function Vc(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function Lc(t,e,n){return typeof t=="string"?(t=encodeURI(t).replace(e,kq),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function kq(t){return t=t.charCodeAt(0),"%"+(t>>4&15).toString(16)+(t&15).toString(16)}var wM=/[#\/\?@]/g,Oq=/[#\?:]/g,Fq=/[#\?]/g,Vq=/[#\?@]/g,Lq=/#/g;function zc(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function Ei(t){t.g||(t.g=new Map,t.h=0,t.i&&Pq(t.i,function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)}))}R=zc.prototype;R.add=function(t,e){Ei(this),this.i=null,t=va(this,t);var n=this.g.get(t);return n||this.g.set(t,n=[]),n.push(e),this.h+=1,this};function tR(t,e){Ei(t),e=va(t,e),t.g.has(e)&&(t.i=null,t.h-=t.g.get(e).length,t.g.delete(e))}function nR(t,e){return Ei(t),e=va(t,e),t.g.has(e)}R.forEach=function(t,e){Ei(this),this.g.forEach(function(n,r){n.forEach(function(i){t.call(e,i,r,this)},this)},this)};R.ta=function(){Ei(this);let t=Array.from(this.g.values()),e=Array.from(this.g.keys()),n=[];for(let r=0;r<e.length;r++){let i=t[r];for(let s=0;s<i.length;s++)n.push(e[r])}return n};R.Z=function(t){Ei(this);let e=[];if(typeof t=="string")nR(this,t)&&(e=e.concat(this.g.get(va(this,t))));else{t=Array.from(this.g.values());for(let n=0;n<t.length;n++)e=e.concat(t[n])}return e};R.set=function(t,e){return Ei(this),this.i=null,t=va(this,t),nR(this,t)&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this};R.get=function(t,e){return t?(t=this.Z(t),0<t.length?String(t[0]):e):e};function rR(t,e,n){tR(t,e),0<n.length&&(t.i=null,t.g.set(va(t,e),kw(n)),t.h+=n.length)}R.toString=function(){if(this.i)return this.i;if(!this.g)return"";let t=[],e=Array.from(this.g.keys());for(var n=0;n<e.length;n++){var r=e[n];let s=encodeURIComponent(String(r)),o=this.Z(r);for(r=0;r<o.length;r++){var i=s;o[r]!==""&&(i+="="+encodeURIComponent(String(o[r]))),t.push(i)}}return this.i=t.join("&")};function va(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}function jq(t,e){e&&!t.j&&(Ei(t),t.i=null,t.g.forEach(function(n,r){var i=r.toLowerCase();r!=i&&(tR(this,r),rR(this,i,n))},t)),t.j=e}var Uq=class{constructor(t,e){this.g=t,this.map=e}};function iR(t){this.l=t||Bq,Q.PerformanceNavigationTiming?(t=Q.performance.getEntriesByType("navigation"),t=0<t.length&&(t[0].nextHopProtocol=="hq"||t[0].nextHopProtocol=="h2")):t=!!(Q.g&&Q.g.Ka&&Q.g.Ka()&&Q.g.Ka().dc),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var Bq=10;function sR(t){return t.h?!0:t.g?t.g.size>=t.j:!1}function oR(t){return t.h?1:t.g?t.g.size:0}function Mw(t,e){return t.h?t.h==e:t.g?t.g.has(e):!1}function Kw(t,e){t.g?t.g.add(e):t.h=e}function aR(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}iR.prototype.cancel=function(){if(this.i=uR(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let t of this.g.values())t.cancel();this.g.clear()}};function uR(t){if(t.h!=null)return t.i.concat(t.h.F);if(t.g!=null&&t.g.size!==0){let e=t.i;for(let n of t.g.values())e=e.concat(n.F);return e}return kw(t.i)}var $q=class{stringify(t){return Q.JSON.stringify(t,void 0)}parse(t){return Q.JSON.parse(t,void 0)}};function Hq(){this.g=new $q}function qq(t,e,n){let r=n||"";try{JM(t,function(i,s){let o=i;Kc(i)&&(o=Bw(i)),e.push(r+s+"="+encodeURIComponent(o))})}catch(i){throw e.push(r+"type="+encodeURIComponent("_badmap")),i}}function Gq(t,e){let n=new ip;if(Q.Image){let r=new Image;r.onload=Uf(Gf,n,r,"TestLoadImage: loaded",!0,e),r.onerror=Uf(Gf,n,r,"TestLoadImage: error",!1,e),r.onabort=Uf(Gf,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=Uf(Gf,n,r,"TestLoadImage: timeout",!1,e),Q.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=t}else e(!1)}function Gf(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch{}}function el(t){this.l=t.ec||null,this.j=t.ob||!1}ft(el,Gw);el.prototype.g=function(){return new lp(this.l,this.j)};el.prototype.i=function(t){return function(){return t}}({});function lp(t,e){ht.call(this),this.F=t,this.u=e,this.m=void 0,this.readyState=Qw,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}ft(lp,ht);var Qw=0;R=lp.prototype;R.open=function(t,e){if(this.readyState!=Qw)throw this.abort(),Error("Error reopening a connection");this.C=t,this.B=e,this.readyState=1,Wc(this)};R.send=function(t){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;let e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};t&&(e.body=t),(this.F||Q).fetch(new Request(this.B,e)).then(this.$a.bind(this),this.ka.bind(this))};R.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,tl(this)),this.readyState=Qw};R.$a=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,Wc(this)),this.g&&(this.readyState=3,Wc(this),this.g)))if(this.responseType==="arraybuffer")t.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if(typeof Q.ReadableStream<"u"&&"body"in t){if(this.j=t.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;cR(this)}else t.text().then(this.Za.bind(this),this.ka.bind(this))};function cR(t){t.j.read().then(t.Xa.bind(t)).catch(t.ka.bind(t))}R.Xa=function(t){if(this.g){if(this.u&&t.value)this.response.push(t.value);else if(!this.u){var e=t.value?t.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?tl(this):Wc(this),this.readyState==3&&cR(this)}};R.Za=function(t){this.g&&(this.response=this.responseText=t,tl(this))};R.Ya=function(t){this.g&&(this.response=t,tl(this))};R.ka=function(){this.g&&tl(this)};function tl(t){t.readyState=4,t.l=null,t.j=null,t.A=null,Wc(t)}R.setRequestHeader=function(t,e){this.v.append(t,e)};R.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""};R.getAllResponseHeaders=function(){if(!this.h)return"";let t=[],e=this.h.entries();for(var n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join(`\r
`)};function Wc(t){t.onreadystatechange&&t.onreadystatechange.call(t)}Object.defineProperty(lp.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(t){this.m=t?"include":"same-origin"}});var zq=Q.JSON.parse;function Ue(t){ht.call(this),this.headers=new Map,this.u=t||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=lR,this.L=this.M=!1}ft(Ue,ht);var lR="",Wq=/^https?$/i,Kq=["POST","PUT"];R=Ue.prototype;R.Oa=function(t){this.M=t};R.ha=function(t,e,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+t);e=e?e.toUpperCase():"GET",this.I=t,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():bw.g(),this.C=this.u?_M(this.u):_M(bw),this.g.onreadystatechange=Mt(this.La,this);try{this.G=!0,this.g.open(e,String(t),!0),this.G=!1}catch(s){EM(this,s);return}if(t=n||"",n=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var i in r)n.set(i,r[i]);else if(typeof r.keys=="function"&&typeof r.get=="function")for(let s of r.keys())n.set(s,r.get(s));else throw Error("Unknown input type for opt_headers: "+String(r));r=Array.from(n.keys()).find(s=>s.toLowerCase()=="content-type"),i=Q.FormData&&t instanceof Q.FormData,!(0<=bM(Kq,e))||r||i||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[s,o]of n)this.g.setRequestHeader(s,o);this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{fR(this),0<this.B&&((this.L=Qq(this.g))?(this.g.timeout=this.B,this.g.ontimeout=Mt(this.ua,this)):this.A=qw(this.ua,this.B,this)),this.v=!0,this.g.send(t),this.v=!1}catch(s){EM(this,s)}};function Qq(t){return _a&&typeof t.timeout=="number"&&t.ontimeout!==void 0}R.ua=function(){typeof Pw<"u"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,Tt(this,"timeout"),this.abort(8))};function EM(t,e){t.h=!1,t.g&&(t.l=!0,t.g.abort(),t.l=!1),t.j=e,t.m=5,dR(t),dp(t)}function dR(t){t.F||(t.F=!0,Tt(t,"complete"),Tt(t,"error"))}R.abort=function(t){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=t||7,Tt(this,"complete"),Tt(this,"abort"),dp(this))};R.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),dp(this,!0)),Ue.$.N.call(this)};R.La=function(){this.s||(this.G||this.v||this.l?hR(this):this.kb())};R.kb=function(){hR(this)};function hR(t){if(t.h&&typeof Pw<"u"&&(!t.C[1]||cr(t)!=4||t.da()!=2)){if(t.v&&cr(t)==4)qw(t.La,0,t);else if(Tt(t,"readystatechange"),cr(t)==4){t.h=!1;try{let o=t.da();e:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break e;default:e=!1}var n;if(!(n=e)){var r;if(r=o===0){var i=String(t.I).match(eR)[1]||null;!i&&Q.self&&Q.self.location&&(i=Q.self.location.protocol.slice(0,-1)),r=!Wq.test(i?i.toLowerCase():"")}n=r}if(n)Tt(t,"complete"),Tt(t,"success");else{t.m=6;try{var s=2<cr(t)?t.g.statusText:""}catch{s=""}t.j=s+" ["+t.da()+"]",dR(t)}}finally{dp(t)}}}}function dp(t,e){if(t.g){fR(t);let n=t.g,r=t.C[0]?()=>{}:null;t.g=null,t.C=null,e||Tt(t,"ready");try{n.onreadystatechange=r}catch{}}}function fR(t){t.g&&t.L&&(t.g.ontimeout=null),t.A&&(Q.clearTimeout(t.A),t.A=null)}R.isActive=function(){return!!this.g};function cr(t){return t.g?t.g.readyState:0}R.da=function(){try{return 2<cr(this)?this.g.status:-1}catch{return-1}};R.ja=function(){try{return this.g?this.g.responseText:""}catch{return""}};R.Wa=function(t){if(this.g){var e=this.g.responseText;return t&&e.indexOf(t)==0&&(e=e.substring(t.length)),zq(e)}};function IM(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.K){case lR:case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch{return null}}function Yq(t){let e={};t=(t.g&&2<=cr(t)&&t.g.getAllResponseHeaders()||"").split(`\r
`);for(let r=0;r<t.length;r++){if(Uc(t[r]))continue;var n=Iq(t[r]);let i=n[0];if(n=n[1],typeof n!="string")continue;n=n.trim();let s=e[i]||[];e[i]=s,s.push(n)}_q(e,function(r){return r.join(", ")})}R.Ia=function(){return this.m};R.Sa=function(){return typeof this.j=="string"?this.j:String(this.j)};function pR(t){let e="";return Fw(t,function(n,r){e+=r,e+=":",e+=n,e+=`\r
`}),e}function Yw(t,e,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=pR(n),typeof t=="string"?n!=null&&encodeURIComponent(String(n)):Re(t,e,n))}function Oc(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function gR(t){this.Ga=0,this.j=[],this.l=new ip,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=Oc("failFast",!1,t),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=Oc("baseRetryDelayMs",5e3,t),this.hb=Oc("retryDelaySeedMs",1e4,t),this.eb=Oc("forwardChannelMaxRetries",2,t),this.xa=Oc("forwardChannelRequestTimeoutMs",2e4,t),this.va=t&&t.xmlHttpFactory||void 0,this.Ha=t&&t.useFetchStreams||!1,this.L=void 0,this.J=t&&t.supportsCrossDomainXhr||!1,this.K="",this.i=new iR(t&&t.concurrentRequestLimit),this.Ja=new Hq,this.P=t&&t.fastHandshake||!1,this.O=t&&t.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=t&&t.bc||!1,t&&t.Ea&&this.l.Ea(),t&&t.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&t&&t.detectBufferingProxy||!1,this.qa=void 0,t&&t.longPollingTimeout&&0<t.longPollingTimeout&&(this.qa=t.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}R=gR.prototype;R.ra=8;R.H=1;function Zw(t){if(mR(t),t.H==3){var e=t.W++,n=jr(t.I);if(Re(n,"SID",t.K),Re(n,"RID",e),Re(n,"TYPE","terminate"),nl(t,n),e=new Xc(t,t.l,e),e.L=2,e.A=cp(jr(n)),n=!1,Q.navigator&&Q.navigator.sendBeacon)try{n=Q.navigator.sendBeacon(e.A.toString(),"")}catch{}!n&&Q.Image&&(new Image().src=e.A,n=!0),n||(e.g=DR(e.l,null),e.g.ha(e.A)),e.G=Date.now(),Jc(e)}IR(t)}function hp(t){t.g&&(Jw(t),t.g.cancel(),t.g=null)}function mR(t){hp(t),t.u&&(Q.clearTimeout(t.u),t.u=null),Qf(t),t.i.cancel(),t.m&&(typeof t.m=="number"&&Q.clearTimeout(t.m),t.m=null)}function fp(t){if(!sR(t.i)&&!t.m){t.m=!0;var e=t.Na;$c||LM(),Hc||($c(),Hc=!0),$w.add(e,t),t.C=0}}function Zq(t,e){return oR(t.i)>=t.i.j-(t.m?1:0)?!1:t.m?(t.j=e.F.concat(t.j),!0):t.H==1||t.H==2||t.C>=(t.cb?0:t.eb)?!1:(t.m=Yc(Mt(t.Na,t,e),ER(t,t.C)),t.C++,!0)}R.Na=function(t){if(this.m)if(this.m=null,this.H==1){if(!t){this.W=Math.floor(1e5*Math.random()),t=this.W++;let i=new Xc(this,this.l,t),s=this.s;if(this.U&&(s?(s=MM(s),RM(s,this.U)):s=this.U),this.o!==null||this.O||(i.I=s,s=null),this.P)e:{for(var e=0,n=0;n<this.j.length;n++){t:{var r=this.j[n];if("__data__"in r.map&&(r=r.map.__data__,typeof r=="string")){r=r.length;break t}r=void 0}if(r===void 0)break;if(e+=r,4096<e){e=n;break e}if(e===4096||n===this.j.length-1){e=n+1;break e}}e=1e3}else e=1e3;e=yR(this,i,e),n=jr(this.I),Re(n,"RID",t),Re(n,"CVER",22),this.F&&Re(n,"X-HTTP-Session-Id",this.F),nl(this,n),s&&(this.O?e="headers="+encodeURIComponent(String(pR(s)))+"&"+e:this.o&&Yw(n,this.o,s)),Kw(this.i,i),this.bb&&Re(n,"TYPE","init"),this.P?(Re(n,"$req",e),Re(n,"SID","null"),i.aa=!0,Aw(i,n,null)):Aw(i,n,e),this.H=2}}else this.H==3&&(t?CM(this,t):this.j.length==0||sR(this.i)||CM(this))};function CM(t,e){var n;e?n=e.m:n=t.W++;let r=jr(t.I);Re(r,"SID",t.K),Re(r,"RID",n),Re(r,"AID",t.V),nl(t,r),t.o&&t.s&&Yw(r,t.o,t.s),n=new Xc(t,t.l,n,t.C+1),t.o===null&&(n.I=t.s),e&&(t.j=e.F.concat(t.j)),e=yR(t,n,1e3),n.setTimeout(Math.round(.5*t.xa)+Math.round(.5*t.xa*Math.random())),Kw(t.i,n),Aw(n,r,e)}function nl(t,e){t.na&&Fw(t.na,function(n,r){Re(e,r,n)}),t.h&&JM({},function(n,r){Re(e,r,n)})}function yR(t,e,n){n=Math.min(t.j.length,n);var r=t.h?Mt(t.h.Va,t.h,t):null;e:{var i=t.j;let s=-1;for(;;){let o=["count="+n];s==-1?0<n?(s=i[0].g,o.push("ofs="+s)):s=0:o.push("ofs="+s);let a=!0;for(let u=0;u<n;u++){let c=i[u].g,l=i[u].map;if(c-=s,0>c)s=Math.max(0,i[u].g-100),a=!1;else try{qq(l,o,"req"+c+"_")}catch{r&&r(l)}}if(a){r=o.join("&");break e}}}return t=t.j.splice(0,n),e.F=t,r}function _R(t){if(!t.g&&!t.u){t.ba=1;var e=t.Ma;$c||LM(),Hc||($c(),Hc=!0),$w.add(e,t),t.A=0}}function Xw(t){return t.g||t.u||3<=t.A?!1:(t.ba++,t.u=Yc(Mt(t.Ma,t),ER(t,t.A)),t.A++,!0)}R.Ma=function(){if(this.u=null,vR(this),this.ca&&!(this.M||this.g==null||0>=this.S)){var t=2*this.S;this.l.info("BP detection timer enabled: "+t),this.B=Yc(Mt(this.jb,this),t)}};R.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,jt(10),hp(this),vR(this))};function Jw(t){t.B!=null&&(Q.clearTimeout(t.B),t.B=null)}function vR(t){t.g=new Xc(t,t.l,"rpc",t.ba),t.o===null&&(t.g.I=t.s),t.g.O=0;var e=jr(t.wa);Re(e,"RID","rpc"),Re(e,"SID",t.K),Re(e,"AID",t.V),Re(e,"CI",t.G?"0":"1"),!t.G&&t.qa&&Re(e,"TO",t.qa),Re(e,"TYPE","xmlhttp"),nl(t,e),t.o&&t.s&&Yw(e,t.o,t.s),t.L&&t.g.setTimeout(t.L);var n=t.g;t=t.pa,n.L=1,n.A=cp(jr(e)),n.u=null,n.S=!0,QM(n,t)}R.ib=function(){this.v!=null&&(this.v=null,hp(this),Xw(this),jt(19))};function Qf(t){t.v!=null&&(Q.clearTimeout(t.v),t.v=null)}function wR(t,e){var n=null;if(t.g==e){Qf(t),Jw(t),t.g=null;var r=2}else if(Mw(t.i,e))n=e.F,aR(t.i,e),r=1;else return;if(t.H!=0){if(e.i)if(r==1){n=e.u?e.u.length:0,e=Date.now()-e.G;var i=t.C;r=sp(),Tt(r,new qM(r,n)),fp(t)}else _R(t);else if(i=e.s,i==3||i==0&&0<e.ca||!(r==1&&Zq(t,e)||r==2&&Xw(t)))switch(n&&0<n.length&&(e=t.i,e.i=e.i.concat(n)),i){case 1:As(t,5);break;case 4:As(t,10);break;case 3:As(t,6);break;default:As(t,2)}}}function ER(t,e){let n=t.ab+Math.floor(Math.random()*t.hb);return t.isActive()||(n*=2),n*e}function As(t,e){if(t.l.info("Error code "+e),e==2){var n=null;t.h&&(n=null);var r=Mt(t.pb,t);n||(n=new xs("//www.google.com/images/cleardot.gif"),Q.location&&Q.location.protocol=="http"||Wf(n,"https"),cp(n)),Gq(n.toString(),r)}else jt(2);t.H=0,t.h&&t.h.za(e),IR(t),mR(t)}R.pb=function(t){t?(this.l.info("Successfully pinged google.com"),jt(2)):(this.l.info("Failed to ping google.com"),jt(1))};function IR(t){if(t.H=0,t.ma=[],t.h){let e=uR(t.i);(e.length!=0||t.j.length!=0)&&(pM(t.ma,e),pM(t.ma,t.j),t.i.i.length=0,kw(t.j),t.j.length=0),t.h.ya()}}function CR(t,e,n){var r=n instanceof xs?jr(n):new xs(n);if(r.g!="")e&&(r.g=e+"."+r.g),Kf(r,r.m);else{var i=Q.location;r=i.protocol,e=e?e+"."+i.hostname:i.hostname,i=+i.port;var s=new xs(null);r&&Wf(s,r),e&&(s.g=e),i&&Kf(s,i),n&&(s.l=n),r=s}return n=t.F,e=t.Da,n&&e&&Re(r,n,e),Re(r,"VER",t.ra),nl(t,r),r}function DR(t,e,n){if(e&&!t.J)throw Error("Can't create secondary domain capable XhrIo object.");return e=t.Ha&&!t.va?new Ue(new el({ob:n})):new Ue(t.va),e.Oa(t.J),e}R.isActive=function(){return!!this.h&&this.h.isActive(this)};function TR(){}R=TR.prototype;R.Ba=function(){};R.Aa=function(){};R.za=function(){};R.ya=function(){};R.isActive=function(){return!0};R.Va=function(){};function Yf(){if(_a&&!(10<=Number(pq)))throw Error("Environmental error: no available transport.")}Yf.prototype.g=function(t,e){return new rn(t,e)};function rn(t,e){ht.call(this),this.g=new gR(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.s=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.Ca&&(t?t["X-WebChannel-Client-Profile"]=e.Ca:t={"X-WebChannel-Client-Profile":e.Ca}),this.g.U=t,(t=e&&e.cc)&&!Uc(t)&&(this.g.o=t),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!Uc(e)&&(this.g.F=e,t=this.h,t!==null&&e in t&&(t=this.h,e in t&&delete t[e])),this.j=new wa(this)}ft(rn,ht);rn.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var t=this.g,e=this.l,n=this.h||void 0;jt(0),t.Y=e,t.na=n||{},t.G=t.aa,t.I=CR(t,null,t.Y),fp(t)};rn.prototype.close=function(){Zw(this.g)};rn.prototype.u=function(t){var e=this.g;if(typeof t=="string"){var n={};n.__data__=t,t=n}else this.v&&(n={},n.__data__=Bw(t),t=n);e.j.push(new Uq(e.fb++,t)),e.H==3&&fp(e)};rn.prototype.N=function(){this.g.h=null,delete this.j,Zw(this.g),delete this.g,rn.$.N.call(this)};function bR(t){zw.call(this),t.__headers__&&(this.headers=t.__headers__,this.statusCode=t.__status__,delete t.__headers__,delete t.__status__);var e=t.__sm__;if(e){e:{for(let n in e){t=n;break e}t=void 0}(this.i=t)&&(t=this.i,e=e!==null&&t in e?e[t]:void 0),this.data=e}else this.data=t}ft(bR,zw);function SR(){Ww.call(this),this.status=1}ft(SR,Ww);function wa(t){this.g=t}ft(wa,TR);wa.prototype.Ba=function(){Tt(this.g,"a")};wa.prototype.Aa=function(t){Tt(this.g,new bR(t))};wa.prototype.za=function(t){Tt(this.g,new SR)};wa.prototype.ya=function(){Tt(this.g,"b")};function Xq(){this.blockSize=-1}function Un(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}ft(Un,Xq);Un.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0};function mw(t,e,n){n||(n=0);var r=Array(16);if(typeof e=="string")for(var i=0;16>i;++i)r[i]=e.charCodeAt(n++)|e.charCodeAt(n++)<<8|e.charCodeAt(n++)<<16|e.charCodeAt(n++)<<24;else for(i=0;16>i;++i)r[i]=e[n++]|e[n++]<<8|e[n++]<<16|e[n++]<<24;e=t.g[0],n=t.g[1],i=t.g[2];var s=t.g[3],o=e+(s^n&(i^s))+r[0]+3614090360&4294967295;e=n+(o<<7&4294967295|o>>>25),o=s+(i^e&(n^i))+r[1]+3905402710&4294967295,s=e+(o<<12&4294967295|o>>>20),o=i+(n^s&(e^n))+r[2]+606105819&4294967295,i=s+(o<<17&4294967295|o>>>15),o=n+(e^i&(s^e))+r[3]+3250441966&4294967295,n=i+(o<<22&4294967295|o>>>10),o=e+(s^n&(i^s))+r[4]+4118548399&4294967295,e=n+(o<<7&4294967295|o>>>25),o=s+(i^e&(n^i))+r[5]+1200080426&4294967295,s=e+(o<<12&4294967295|o>>>20),o=i+(n^s&(e^n))+r[6]+2821735955&4294967295,i=s+(o<<17&4294967295|o>>>15),o=n+(e^i&(s^e))+r[7]+4249261313&4294967295,n=i+(o<<22&4294967295|o>>>10),o=e+(s^n&(i^s))+r[8]+1770035416&4294967295,e=n+(o<<7&4294967295|o>>>25),o=s+(i^e&(n^i))+r[9]+2336552879&4294967295,s=e+(o<<12&4294967295|o>>>20),o=i+(n^s&(e^n))+r[10]+4294925233&4294967295,i=s+(o<<17&4294967295|o>>>15),o=n+(e^i&(s^e))+r[11]+2304563134&4294967295,n=i+(o<<22&4294967295|o>>>10),o=e+(s^n&(i^s))+r[12]+1804603682&4294967295,e=n+(o<<7&4294967295|o>>>25),o=s+(i^e&(n^i))+r[13]+4254626195&4294967295,s=e+(o<<12&4294967295|o>>>20),o=i+(n^s&(e^n))+r[14]+2792965006&4294967295,i=s+(o<<17&4294967295|o>>>15),o=n+(e^i&(s^e))+r[15]+1236535329&4294967295,n=i+(o<<22&4294967295|o>>>10),o=e+(i^s&(n^i))+r[1]+4129170786&4294967295,e=n+(o<<5&4294967295|o>>>27),o=s+(n^i&(e^n))+r[6]+3225465664&4294967295,s=e+(o<<9&4294967295|o>>>23),o=i+(e^n&(s^e))+r[11]+643717713&4294967295,i=s+(o<<14&4294967295|o>>>18),o=n+(s^e&(i^s))+r[0]+3921069994&4294967295,n=i+(o<<20&4294967295|o>>>12),o=e+(i^s&(n^i))+r[5]+3593408605&4294967295,e=n+(o<<5&4294967295|o>>>27),o=s+(n^i&(e^n))+r[10]+38016083&4294967295,s=e+(o<<9&4294967295|o>>>23),o=i+(e^n&(s^e))+r[15]+3634488961&4294967295,i=s+(o<<14&4294967295|o>>>18),o=n+(s^e&(i^s))+r[4]+3889429448&4294967295,n=i+(o<<20&4294967295|o>>>12),o=e+(i^s&(n^i))+r[9]+568446438&4294967295,e=n+(o<<5&4294967295|o>>>27),o=s+(n^i&(e^n))+r[14]+3275163606&4294967295,s=e+(o<<9&4294967295|o>>>23),o=i+(e^n&(s^e))+r[3]+4107603335&4294967295,i=s+(o<<14&4294967295|o>>>18),o=n+(s^e&(i^s))+r[8]+1163531501&4294967295,n=i+(o<<20&4294967295|o>>>12),o=e+(i^s&(n^i))+r[13]+2850285829&4294967295,e=n+(o<<5&4294967295|o>>>27),o=s+(n^i&(e^n))+r[2]+4243563512&4294967295,s=e+(o<<9&4294967295|o>>>23),o=i+(e^n&(s^e))+r[7]+1735328473&4294967295,i=s+(o<<14&4294967295|o>>>18),o=n+(s^e&(i^s))+r[12]+2368359562&4294967295,n=i+(o<<20&4294967295|o>>>12),o=e+(n^i^s)+r[5]+4294588738&4294967295,e=n+(o<<4&4294967295|o>>>28),o=s+(e^n^i)+r[8]+2272392833&4294967295,s=e+(o<<11&4294967295|o>>>21),o=i+(s^e^n)+r[11]+1839030562&4294967295,i=s+(o<<16&4294967295|o>>>16),o=n+(i^s^e)+r[14]+4259657740&4294967295,n=i+(o<<23&4294967295|o>>>9),o=e+(n^i^s)+r[1]+2763975236&4294967295,e=n+(o<<4&4294967295|o>>>28),o=s+(e^n^i)+r[4]+1272893353&4294967295,s=e+(o<<11&4294967295|o>>>21),o=i+(s^e^n)+r[7]+4139469664&4294967295,i=s+(o<<16&4294967295|o>>>16),o=n+(i^s^e)+r[10]+3200236656&4294967295,n=i+(o<<23&4294967295|o>>>9),o=e+(n^i^s)+r[13]+681279174&4294967295,e=n+(o<<4&4294967295|o>>>28),o=s+(e^n^i)+r[0]+3936430074&4294967295,s=e+(o<<11&4294967295|o>>>21),o=i+(s^e^n)+r[3]+3572445317&4294967295,i=s+(o<<16&4294967295|o>>>16),o=n+(i^s^e)+r[6]+76029189&4294967295,n=i+(o<<23&4294967295|o>>>9),o=e+(n^i^s)+r[9]+3654602809&4294967295,e=n+(o<<4&4294967295|o>>>28),o=s+(e^n^i)+r[12]+3873151461&4294967295,s=e+(o<<11&4294967295|o>>>21),o=i+(s^e^n)+r[15]+530742520&4294967295,i=s+(o<<16&4294967295|o>>>16),o=n+(i^s^e)+r[2]+3299628645&4294967295,n=i+(o<<23&4294967295|o>>>9),o=e+(i^(n|~s))+r[0]+4096336452&4294967295,e=n+(o<<6&4294967295|o>>>26),o=s+(n^(e|~i))+r[7]+1126891415&4294967295,s=e+(o<<10&4294967295|o>>>22),o=i+(e^(s|~n))+r[14]+2878612391&4294967295,i=s+(o<<15&4294967295|o>>>17),o=n+(s^(i|~e))+r[5]+4237533241&4294967295,n=i+(o<<21&4294967295|o>>>11),o=e+(i^(n|~s))+r[12]+1700485571&4294967295,e=n+(o<<6&4294967295|o>>>26),o=s+(n^(e|~i))+r[3]+2399980690&4294967295,s=e+(o<<10&4294967295|o>>>22),o=i+(e^(s|~n))+r[10]+4293915773&4294967295,i=s+(o<<15&4294967295|o>>>17),o=n+(s^(i|~e))+r[1]+2240044497&4294967295,n=i+(o<<21&4294967295|o>>>11),o=e+(i^(n|~s))+r[8]+1873313359&4294967295,e=n+(o<<6&4294967295|o>>>26),o=s+(n^(e|~i))+r[15]+4264355552&4294967295,s=e+(o<<10&4294967295|o>>>22),o=i+(e^(s|~n))+r[6]+2734768916&4294967295,i=s+(o<<15&4294967295|o>>>17),o=n+(s^(i|~e))+r[13]+1309151649&4294967295,n=i+(o<<21&4294967295|o>>>11),o=e+(i^(n|~s))+r[4]+4149444226&4294967295,e=n+(o<<6&4294967295|o>>>26),o=s+(n^(e|~i))+r[11]+3174756917&4294967295,s=e+(o<<10&4294967295|o>>>22),o=i+(e^(s|~n))+r[2]+718787259&4294967295,i=s+(o<<15&4294967295|o>>>17),o=n+(s^(i|~e))+r[9]+3951481745&4294967295,t.g[0]=t.g[0]+e&4294967295,t.g[1]=t.g[1]+(i+(o<<21&4294967295|o>>>11))&4294967295,t.g[2]=t.g[2]+i&4294967295,t.g[3]=t.g[3]+s&4294967295}Un.prototype.j=function(t,e){e===void 0&&(e=t.length);for(var n=e-this.blockSize,r=this.m,i=this.h,s=0;s<e;){if(i==0)for(;s<=n;)mw(this,t,s),s+=this.blockSize;if(typeof t=="string"){for(;s<e;)if(r[i++]=t.charCodeAt(s++),i==this.blockSize){mw(this,r),i=0;break}}else for(;s<e;)if(r[i++]=t[s++],i==this.blockSize){mw(this,r),i=0;break}}this.h=i,this.i+=e};Un.prototype.l=function(){var t=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);t[0]=128;for(var e=1;e<t.length-8;++e)t[e]=0;var n=8*this.i;for(e=t.length-8;e<t.length;++e)t[e]=n&255,n/=256;for(this.j(t),t=Array(16),e=n=0;4>e;++e)for(var r=0;32>r;r+=8)t[n++]=this.g[e]>>>r&255;return t};function Ce(t,e){this.h=e;for(var n=[],r=!0,i=t.length-1;0<=i;i--){var s=t[i]|0;r&&s==e||(n[i]=s,r=!1)}this.g=n}var Jq={};function eE(t){return-128<=t&&128>t?dq(t,function(e){return new Ce([e|0],0>e?-1:0)}):new Ce([t|0],0>t?-1:0)}function lr(t){if(isNaN(t)||!isFinite(t))return ya;if(0>t)return Dt(lr(-t));for(var e=[],n=1,r=0;t>=n;r++)e[r]=t/n|0,n*=Rw;return new Ce(e,0)}function AR(t,e){if(t.length==0)throw Error("number format error: empty string");if(e=e||10,2>e||36<e)throw Error("radix out of range: "+e);if(t.charAt(0)=="-")return Dt(AR(t.substring(1),e));if(0<=t.indexOf("-"))throw Error('number format error: interior "-" character');for(var n=lr(Math.pow(e,8)),r=ya,i=0;i<t.length;i+=8){var s=Math.min(8,t.length-i),o=parseInt(t.substring(i,i+s),e);8>s?(s=lr(Math.pow(e,s)),r=r.R(s).add(lr(o))):(r=r.R(n),r=r.add(lr(o)))}return r}var Rw=4294967296,ya=eE(0),Nw=eE(1),DM=eE(16777216);R=Ce.prototype;R.ea=function(){if(In(this))return-Dt(this).ea();for(var t=0,e=1,n=0;n<this.g.length;n++){var r=this.D(n);t+=(0<=r?r:Rw+r)*e,e*=Rw}return t};R.toString=function(t){if(t=t||10,2>t||36<t)throw Error("radix out of range: "+t);if(Lr(this))return"0";if(In(this))return"-"+Dt(this).toString(t);for(var e=lr(Math.pow(t,6)),n=this,r="";;){var i=Xf(n,e).g;n=Zf(n,i.R(e));var s=((0<n.g.length?n.g[0]:n.h)>>>0).toString(t);if(n=i,Lr(n))return s+r;for(;6>s.length;)s="0"+s;r=s+r}};R.D=function(t){return 0>t?0:t<this.g.length?this.g[t]:this.h};function Lr(t){if(t.h!=0)return!1;for(var e=0;e<t.g.length;e++)if(t.g[e]!=0)return!1;return!0}function In(t){return t.h==-1}R.X=function(t){return t=Zf(this,t),In(t)?-1:Lr(t)?0:1};function Dt(t){for(var e=t.g.length,n=[],r=0;r<e;r++)n[r]=~t.g[r];return new Ce(n,~t.h).add(Nw)}R.abs=function(){return In(this)?Dt(this):this};R.add=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0,i=0;i<=e;i++){var s=r+(this.D(i)&65535)+(t.D(i)&65535),o=(s>>>16)+(this.D(i)>>>16)+(t.D(i)>>>16);r=o>>>16,s&=65535,o&=65535,n[i]=o<<16|s}return new Ce(n,n[n.length-1]&-2147483648?-1:0)};function Zf(t,e){return t.add(Dt(e))}R.R=function(t){if(Lr(this)||Lr(t))return ya;if(In(this))return In(t)?Dt(this).R(Dt(t)):Dt(Dt(this).R(t));if(In(t))return Dt(this.R(Dt(t)));if(0>this.X(DM)&&0>t.X(DM))return lr(this.ea()*t.ea());for(var e=this.g.length+t.g.length,n=[],r=0;r<2*e;r++)n[r]=0;for(r=0;r<this.g.length;r++)for(var i=0;i<t.g.length;i++){var s=this.D(r)>>>16,o=this.D(r)&65535,a=t.D(i)>>>16,u=t.D(i)&65535;n[2*r+2*i]+=o*u,zf(n,2*r+2*i),n[2*r+2*i+1]+=s*u,zf(n,2*r+2*i+1),n[2*r+2*i+1]+=o*a,zf(n,2*r+2*i+1),n[2*r+2*i+2]+=s*a,zf(n,2*r+2*i+2)}for(r=0;r<e;r++)n[r]=n[2*r+1]<<16|n[2*r];for(r=e;r<2*e;r++)n[r]=0;return new Ce(n,0)};function zf(t,e){for(;(t[e]&65535)!=t[e];)t[e+1]+=t[e]>>>16,t[e]&=65535,e++}function Fc(t,e){this.g=t,this.h=e}function Xf(t,e){if(Lr(e))throw Error("division by zero");if(Lr(t))return new Fc(ya,ya);if(In(t))return e=Xf(Dt(t),e),new Fc(Dt(e.g),Dt(e.h));if(In(e))return e=Xf(t,Dt(e)),new Fc(Dt(e.g),e.h);if(30<t.g.length){if(In(t)||In(e))throw Error("slowDivide_ only works with positive integers.");for(var n=Nw,r=e;0>=r.X(t);)n=TM(n),r=TM(r);var i=ga(n,1),s=ga(r,1);for(r=ga(r,2),n=ga(n,2);!Lr(r);){var o=s.add(r);0>=o.X(t)&&(i=i.add(n),s=o),r=ga(r,1),n=ga(n,1)}return e=Zf(t,i.R(e)),new Fc(i,e)}for(i=ya;0<=t.X(e);){for(n=Math.max(1,Math.floor(t.ea()/e.ea())),r=Math.ceil(Math.log(n)/Math.LN2),r=48>=r?1:Math.pow(2,r-48),s=lr(n),o=s.R(e);In(o)||0<o.X(t);)n-=r,s=lr(n),o=s.R(e);Lr(s)&&(s=Nw),i=i.add(s),t=Zf(t,o)}return new Fc(i,t)}R.gb=function(t){return Xf(this,t).h};R.and=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)&t.D(r);return new Ce(n,this.h&t.h)};R.or=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)|t.D(r);return new Ce(n,this.h|t.h)};R.xor=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)^t.D(r);return new Ce(n,this.h^t.h)};function TM(t){for(var e=t.g.length+1,n=[],r=0;r<e;r++)n[r]=t.D(r)<<1|t.D(r-1)>>>31;return new Ce(n,t.h)}function ga(t,e){var n=e>>5;e%=32;for(var r=t.g.length-n,i=[],s=0;s<r;s++)i[s]=0<e?t.D(s+n)>>>e|t.D(s+n+1)<<32-e:t.D(s+n);return new Ce(i,t.h)}Yf.prototype.createWebChannel=Yf.prototype.g;rn.prototype.send=rn.prototype.u;rn.prototype.open=rn.prototype.m;rn.prototype.close=rn.prototype.close;op.NO_ERROR=0;op.TIMEOUT=8;op.HTTP_ERROR=6;GM.COMPLETE="complete";zM.EventType=Zc;Zc.OPEN="a";Zc.CLOSE="b";Zc.ERROR="c";Zc.MESSAGE="d";ht.prototype.listen=ht.prototype.O;Ue.prototype.listenOnce=Ue.prototype.P;Ue.prototype.getLastError=Ue.prototype.Sa;Ue.prototype.getLastErrorCode=Ue.prototype.Ia;Ue.prototype.getStatus=Ue.prototype.da;Ue.prototype.getResponseJson=Ue.prototype.Wa;Ue.prototype.getResponseText=Ue.prototype.ja;Ue.prototype.send=Ue.prototype.ha;Ue.prototype.setWithCredentials=Ue.prototype.Oa;Un.prototype.digest=Un.prototype.l;Un.prototype.reset=Un.prototype.reset;Un.prototype.update=Un.prototype.j;Ce.prototype.add=Ce.prototype.add;Ce.prototype.multiply=Ce.prototype.R;Ce.prototype.modulo=Ce.prototype.gb;Ce.prototype.compare=Ce.prototype.X;Ce.prototype.toNumber=Ce.prototype.ea;Ce.prototype.toString=Ce.prototype.toString;Ce.prototype.getBits=Ce.prototype.D;Ce.fromNumber=lr;Ce.fromString=AR;var xR=Bn.createWebChannelTransport=function(){return new Yf},MR=Bn.getStatEventTarget=function(){return sp()},pp=Bn.ErrorCode=op,RR=Bn.EventType=GM,NR=Bn.Event=Ms,tE=Bn.Stat={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},Iee=Bn.FetchXmlHttpFactory=el,rl=Bn.WebChannel=zM,PR=Bn.XhrIo=Ue,kR=Bn.Md5=Un,Rs=Bn.Integer=Ce;var OR="@firebase/firestore";var it=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};it.UNAUTHENTICATED=new it(null),it.GOOGLE_CREDENTIALS=new it("google-credentials-uid"),it.FIRST_PARTY=new it("first-party-uid"),it.MOCK_USER=new it("mock-user");var Ya="10.8.0";var Ai=new Xr("@firebase/firestore");function Ta(){return Ai.logLevel}function kN(t){Ai.setLogLevel(t)}function D(t,...e){if(Ai.logLevel<=fn.DEBUG){let n=e.map(rC);Ai.debug(`Firestore (${Ya}): ${t}`,...n)}}function ze(t,...e){if(Ai.logLevel<=fn.ERROR){let n=e.map(rC);Ai.error(`Firestore (${Ya}): ${t}`,...n)}}function Dn(t,...e){if(Ai.logLevel<=fn.WARN){let n=e.map(rC);Ai.warn(`Firestore (${Ya}): ${t}`,...n)}}function rC(t){if(typeof t=="string")return t;try{return function(n){return JSON.stringify(n)}(t)}catch{return t}}function O(t="Unexpected state"){let e=`FIRESTORE (${Ya}) INTERNAL ASSERTION FAILED: `+t;throw ze(e),new Error(e)}function L(t,e){t||O()}function ON(t,e){t||O()}function N(t,e){return t}var y={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},I=class extends aT{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var st=class{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}};var Tp=class{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},oE=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(it.UNAUTHENTICATED))}shutdown(){}},aE=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}},uE=class{constructor(e){this.t=e,this.currentUser=it.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){let r=this.i,i=u=>this.i!==r?(r=this.i,n(u)):Promise.resolve(),s=new st;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new st,e.enqueueRetryable(()=>i(this.currentUser))};let o=()=>{let u=s;e.enqueueRetryable(()=>v(this,null,function*(){yield u.promise,yield i(this.currentUser)}))},a=u=>{D("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.auth.addAuthTokenListener(this.o),o()};this.t.onInit(u=>a(u)),setTimeout(()=>{if(!this.auth){let u=this.t.getImmediate({optional:!0});u?a(u):(D("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new st)}},0),o()}getToken(){let e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(D("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(L(typeof r.accessToken=="string"),new Tp(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){let e=this.auth&&this.auth.getUid();return L(e===null||typeof e=="string"),new it(e)}},cE=class{constructor(e,n,r){this.l=e,this.h=n,this.P=r,this.type="FirstParty",this.user=it.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);let e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}},lE=class{constructor(e,n,r){this.l=e,this.h=n,this.P=r}getToken(){return Promise.resolve(new cE(this.l,this.h,this.P))}start(e,n){e.enqueueRetryable(()=>n(it.FIRST_PARTY))}shutdown(){}invalidateToken(){}},dE=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},hE=class{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,n){let r=s=>{s.error!=null&&D("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);let o=s.token!==this.R;return this.R=s.token,D("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};let i=s=>{D("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){let s=this.A.getImmediate({optional:!0});s?i(s):D("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(L(typeof n.token=="string"),this.R=n.token,new dE(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}};function tG(t){let e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}var bp=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length,r="";for(;r.length<20;){let i=tG(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<n&&(r+=e.charAt(i[s]%e.length))}return r}};function Z(t,e){return t<e?-1:t>e?1:0}function ka(t,e,n){return t.length===e.length&&t.every((r,i)=>n(r,e[i]))}function FN(t){return t+"\0"}var Le=class t{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new I(y.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new I(y.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new I(y.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new I(y.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return t.fromMillis(Date.now())}static fromDate(e){return t.fromMillis(e.getTime())}static fromMillis(e){let n=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*n));return new t(n,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?Z(this.nanoseconds,e.nanoseconds):Z(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){let e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};var B=class t{constructor(e){this.timestamp=e}static fromTimestamp(e){return new t(e)}static min(){return new t(new Le(0,0))}static max(){return new t(new Le(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var Sp=class t{constructor(e,n,r){n===void 0?n=0:n>e.length&&O(),r===void 0?r=e.length-n:r>e.length-n&&O(),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return t.comparator(this,e)===0}child(e){let n=this.segments.slice(this.offset,this.limit());return e instanceof t?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){let r=Math.min(e.length,n.length);for(let i=0;i<r;i++){let s=e.get(i),o=n.get(i);if(s<o)return-1;if(s>o)return 1}return e.length<n.length?-1:e.length>n.length?1:0}},me=class t extends Sp{construct(e,n,r){return new t(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let n=[];for(let r of e){if(r.indexOf("//")>=0)throw new I(y.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(i=>i.length>0))}return new t(n)}static emptyPath(){return new t([])}},nG=/^[_a-zA-Z][_a-zA-Z0-9]*$/,We=class t extends Sp{construct(e,n,r){return new t(e,n,r)}static isValidIdentifier(e){return nG.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),t.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new t(["__name__"])}static fromServerFormat(e){let n=[],r="",i=0,s=()=>{if(r.length===0)throw new I(y.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""},o=!1;for(;i<e.length;){let a=e[i];if(a==="\\"){if(i+1===e.length)throw new I(y.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let u=e[i+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new I(y.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=u,i+=2}else a==="`"?(o=!o,i++):a!=="."||o?(r+=a,i++):(s(),i++)}if(s(),o)throw new I(y.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new t(n)}static emptyPath(){return new t([])}};var M=class t{constructor(e){this.path=e}static fromPath(e){return new t(me.fromString(e))}static fromName(e){return new t(me.fromString(e).popFirst(5))}static empty(){return new t(me.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&me.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return me.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new t(new me(e.slice()))}};var Oa=class{constructor(e,n,r,i){this.indexId=e,this.collectionGroup=n,this.fields=r,this.indexState=i}};function fE(t){return t.fields.find(e=>e.kind===2)}function Ps(t){return t.fields.filter(e=>e.kind!==2)}Oa.UNKNOWN_ID=-1;var Ra=class{constructor(e,n){this.fieldPath=e,this.kind=n}};var gl=class t{constructor(e,n){this.sequenceNumber=e,this.offset=n}static empty(){return new t(0,Tn.min())}};function VN(t,e){let n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,i=B.fromTimestamp(r===1e9?new Le(n+1,0):new Le(n,r));return new Tn(i,M.empty(),e)}function LN(t){return new Tn(t.readTime,t.key,-1)}var Tn=class t{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new t(B.min(),M.empty(),-1)}static max(){return new t(B.max(),M.empty(),-1)}};function iC(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=M.comparator(t.documentKey,e.documentKey),n!==0?n:Z(t.largestBatchId,e.largestBatchId))}var jN="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Ap=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};function Li(t){return v(this,null,function*(){if(t.code!==y.FAILED_PRECONDITION||t.message!==jN)throw t;D("LocalStore","Unexpectedly lost primary lease")})}var m=class t{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&O(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new t((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(n,s).next(r,i)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{let n=e();return n instanceof t?n:t.resolve(n)}catch(n){return t.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):t.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):t.reject(n)}static resolve(e){return new t((n,r)=>{n(e)})}static reject(e){return new t((n,r)=>{r(e)})}static waitFor(e){return new t((n,r)=>{let i=0,s=0,o=!1;e.forEach(a=>{++i,a.next(()=>{++s,o&&s===i&&n()},u=>r(u))}),o=!0,s===i&&n()})}static or(e){let n=t.resolve(!1);for(let r of e)n=n.next(i=>i?t.resolve(i):r());return n}static forEach(e,n){let r=[];return e.forEach((i,s)=>{r.push(n.call(this,i,s))}),this.waitFor(r)}static mapArray(e,n){return new t((r,i)=>{let s=e.length,o=new Array(s),a=0;for(let u=0;u<s;u++){let c=u;n(e[c]).next(l=>{o[c]=l,++a,a===s&&r(o)},l=>i(l))}})}static doWhile(e,n){return new t((r,i)=>{let s=()=>{e()===!0?n().next(()=>{s()},i):r()};s()})}};var xp=class t{constructor(e,n){this.action=e,this.transaction=n,this.aborted=!1,this.V=new st,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{n.error?this.V.reject(new js(e,n.error)):this.V.resolve()},this.transaction.onerror=r=>{let i=sC(r.target.error);this.V.reject(new js(e,i))}}static open(e,n,r,i){try{return new t(n,e.transaction(i,r))}catch(s){throw new js(n,s)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(D("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){let e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){let n=this.transaction.objectStore(e);return new gE(n)}},$r=class t{constructor(e,n,r){this.name=e,this.version=n,this.p=r,t.S(Su())===12.2&&ze("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return D("SimpleDb","Removing database:",e),ks(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!Rd())return!1;if(t.C())return!0;let e=Su(),n=t.S(e),r=0<n&&n<10,i=t.v(e),s=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||s)}static C(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.F)==="YES"}static M(e,n){return e.store(n)}static S(e){let n=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=n?n[1].split("_").slice(0,2).join("."):"-1";return Number(r)}static v(e){let n=e.match(/Android ([\d.]+)/i),r=n?n[1].split(".").slice(0,2).join("."):"-1";return Number(r)}O(e){return v(this,null,function*(){return this.db||(D("SimpleDb","Opening database:",this.name),this.db=yield new Promise((n,r)=>{let i=indexedDB.open(this.name,this.version);i.onsuccess=s=>{let o=s.target.result;n(o)},i.onblocked=()=>{r(new js(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=s=>{let o=s.target.error;o.name==="VersionError"?r(new I(y.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new I(y.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new js(e,o))},i.onupgradeneeded=s=>{D("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);let o=s.target.result;this.p.N(o,i.transaction,s.oldVersion,this.version).next(()=>{D("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.B&&(this.db.onversionchange=n=>this.B(n)),this.db})}L(e){this.B=e,this.db&&(this.db.onversionchange=n=>e(n))}runTransaction(e,n,r,i){return v(this,null,function*(){let s=n==="readonly",o=0;for(;;){++o;try{this.db=yield this.O(e);let a=xp.open(this.db,e,s?"readonly":"readwrite",r),u=i(a).next(c=>(a.g(),c)).catch(c=>(a.abort(c),m.reject(c))).toPromise();return u.catch(()=>{}),yield a.m,u}catch(a){let u=a,c=u.name!=="FirebaseError"&&o<3;if(D("SimpleDb","Transaction failed with error:",u.message,"Retrying:",c),this.close(),!c)return Promise.reject(u)}}})}close(){this.db&&this.db.close(),this.db=void 0}},pE=class{constructor(e){this.k=e,this.q=!1,this.K=null}get isDone(){return this.q}get $(){return this.K}set cursor(e){this.k=e}done(){this.q=!0}U(e){this.K=e}delete(){return ks(this.k.delete())}},js=class extends I{constructor(e,n){super(y.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${n}`),this.name="IndexedDbTransactionError"}};function ji(t){return t.name==="IndexedDbTransactionError"}var gE=class{constructor(e){this.store=e}put(e,n){let r;return n!==void 0?(D("SimpleDb","PUT",this.store.name,e,n),r=this.store.put(n,e)):(D("SimpleDb","PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),ks(r)}add(e){return D("SimpleDb","ADD",this.store.name,e,e),ks(this.store.add(e))}get(e){return ks(this.store.get(e)).next(n=>(n===void 0&&(n=null),D("SimpleDb","GET",this.store.name,e,n),n))}delete(e){return D("SimpleDb","DELETE",this.store.name,e),ks(this.store.delete(e))}count(){return D("SimpleDb","COUNT",this.store.name),ks(this.store.count())}W(e,n){let r=this.options(e,n),i=r.index?this.store.index(r.index):this.store;if(typeof i.getAll=="function"){let s=i.getAll(r.range);return new m((o,a)=>{s.onerror=u=>{a(u.target.error)},s.onsuccess=u=>{o(u.target.result)}})}{let s=this.cursor(r),o=[];return this.G(s,(a,u)=>{o.push(u)}).next(()=>o)}}j(e,n){let r=this.store.getAll(e,n===null?void 0:n);return new m((i,s)=>{r.onerror=o=>{s(o.target.error)},r.onsuccess=o=>{i(o.target.result)}})}H(e,n){D("SimpleDb","DELETE ALL",this.store.name);let r=this.options(e,n);r.J=!1;let i=this.cursor(r);return this.G(i,(s,o,a)=>a.delete())}Y(e,n){let r;n?r=e:(r={},n=e);let i=this.cursor(r);return this.G(i,n)}Z(e){let n=this.cursor({});return new m((r,i)=>{n.onerror=s=>{let o=sC(s.target.error);i(o)},n.onsuccess=s=>{let o=s.target.result;o?e(o.primaryKey,o.value).next(a=>{a?o.continue():r()}):r()}})}G(e,n){let r=[];return new m((i,s)=>{e.onerror=o=>{s(o.target.error)},e.onsuccess=o=>{let a=o.target.result;if(!a)return void i();let u=new pE(a),c=n(a.primaryKey,a.value,u);if(c instanceof m){let l=c.catch(d=>(u.done(),m.reject(d)));r.push(l)}u.isDone?i():u.$===null?a.continue():a.continue(u.$)}}).next(()=>m.waitFor(r))}options(e,n){let r;return e!==void 0&&(typeof e=="string"?r=e:n=e),{index:r,range:n}}cursor(e){let n="next";if(e.reverse&&(n="prev"),e.index){let r=this.store.index(e.index);return e.J?r.openKeyCursor(e.range,n):r.openCursor(e.range,n)}return this.store.openCursor(e.range,n)}};function ks(t){return new m((e,n)=>{t.onsuccess=r=>{let i=r.target.result;e(i)},t.onerror=r=>{let i=sC(r.target.error);n(i)}})}var FR=!1;function sC(t){let e=$r.S(Su());if(e>=12.2&&e<13){let n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){let r=new I("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${n}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return FR||(FR=!0,setTimeout(()=>{throw r},0)),r}}return t}var mE=class{constructor(e,n){this.asyncQueue=e,this.X=n,this.task=null}start(){this.ee(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}ee(e){D("IndexBackfiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,()=>v(this,null,function*(){this.task=null;try{D("IndexBackfiller",`Documents written: ${yield this.X.te()}`)}catch(n){ji(n)?D("IndexBackfiller","Ignoring IndexedDB error during index backfill: ",n):yield Li(n)}yield this.ee(6e4)}))}},yE=class{constructor(e,n){this.localStore=e,this.persistence=n}te(e=50){return v(this,null,function*(){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",n=>this.ne(n,e))})}ne(e,n){let r=new Set,i=n,s=!0;return m.doWhile(()=>s===!0&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!r.has(o))return D("IndexBackfiller",`Processing collection: ${o}`),this.re(e,o,i).next(a=>{i-=a,r.add(o)});s=!1})).next(()=>n-i)}re(e,n,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,n).next(i=>this.localStore.localDocuments.getNextDocuments(e,n,i,r).next(s=>{let o=s.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this.ie(i,s)).next(a=>(D("IndexBackfiller",`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,n,a))).next(()=>o.size)}))}ie(e,n){let r=e;return n.changes.forEach((i,s)=>{let o=LN(s);iC(o,r)>0&&(r=o)}),new Tn(r.readTime,r.documentKey,Math.max(n.batchId,e.largestBatchId))}};var sn=(()=>{class t{constructor(n,r){this.previousValue=n,r&&(r.sequenceNumberHandler=i=>this.se(i),this.oe=i=>r.writeSequenceNumber(i))}se(n){return this.previousValue=Math.max(n,this.previousValue),this.previousValue}next(){let n=++this.previousValue;return this.oe&&this.oe(n),n}}return t._e=-1,t})();function Ll(t){return t==null}function ml(t){return t===0&&1/t==-1/0}function UN(t){return typeof t=="number"&&Number.isInteger(t)&&!ml(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}function Ut(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=VR(e)),e=rG(t.get(n),e);return VR(e)}function rG(t,e){let n=e,r=t.length;for(let i=0;i<r;i++){let s=t.charAt(i);switch(s){case"\0":n+="";break;case"":n+="";break;default:n+=s}}return n}function VR(t){return t+""}function dr(t){let e=t.length;if(L(e>=2),e===2)return L(t.charAt(0)===""&&t.charAt(1)===""),me.emptyPath();let n=e-2,r=[],i="";for(let s=0;s<e;){let o=t.indexOf("",s);switch((o<0||o>n)&&O(),t.charAt(o+1)){case"":let a=t.substring(s,o),u;i.length===0?u=a:(i+=a,u=i,i=""),r.push(u);break;case"":i+=t.substring(s,o),i+="\0";break;case"":i+=t.substring(s,o+1);break;default:O()}s=o+2}return new me(r)}var LR=["userId","batchId"];function vp(t,e){return[t,Ut(e)]}function BN(t,e,n){return[t,Ut(e),n]}var iG={},sG=["prefixPath","collectionGroup","readTime","documentId"],oG=["prefixPath","collectionGroup","documentId"],aG=["collectionGroup","readTime","prefixPath","documentId"],uG=["canonicalId","targetId"],cG=["targetId","path"],lG=["path","targetId"],dG=["collectionId","parent"],hG=["indexId","uid"],fG=["uid","sequenceNumber"],pG=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],gG=["indexId","uid","orderedDocumentKey"],mG=["userId","collectionPath","documentId"],yG=["userId","collectionPath","largestBatchId"],_G=["userId","collectionGroup","largestBatchId"],$N=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],vG=[...$N,"documentOverlays"],HN=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],qN=HN,wG=[...qN,"indexConfiguration","indexState","indexEntries"];var yl=class extends Ap{constructor(e,n){super(),this.ae=e,this.currentSequenceNumber=n}};function gt(t,e){let n=N(t);return $r.M(n.ae,e)}function jR(t){let e=0;for(let n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Zs(t,e){for(let n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function GN(t){for(let e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var Ne=class t{constructor(e,n){this.comparator=e,this.root=n||fr.EMPTY}insert(e,n){return new t(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,fr.BLACK,null,null))}remove(e){return new t(this.comparator,this.root.remove(e,this.comparator).copy(null,null,fr.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){let r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){let i=this.comparator(e,r.key);if(i===0)return n+r.left.size;i<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){let e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Ma(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Ma(this.root,e,this.comparator,!1)}getReverseIterator(){return new Ma(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Ma(this.root,e,this.comparator,!0)}},Ma=class{constructor(e,n,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=n?r(e.key,n):1,n&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},fr=class t{constructor(e,n,r,i,s){this.key=e,this.value=n,this.color=r??t.RED,this.left=i??t.EMPTY,this.right=s??t.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,i,s){return new t(e??this.key,n??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let i=this,s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,n,r),null):s===0?i.copy(null,n,null,null,null):i.copy(null,null,null,null,i.right.insert(e,n,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return t.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),n(e,i.key)===0){if(i.right.isEmpty())return t.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw O();let e=this.left.check();if(e!==this.right.check())throw O();return e+(this.isRed()?0:1)}};fr.EMPTY=null,fr.RED=!0,fr.BLACK=!1;fr.EMPTY=new class{constructor(){this.size=0}get key(){throw O()}get value(){throw O()}get color(){throw O()}get left(){throw O()}get right(){throw O()}copy(e,n,r,i,s){return this}insert(e,n,r){return new fr(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var Se=class t{constructor(e){this.comparator=e,this.data=new Ne(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){let r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){let i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;n(i.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){let n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new Mp(this.data.getIterator())}getIteratorFrom(e){return new Mp(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof t)||this.size!==e.size)return!1;let n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){let i=n.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(n=>{e.push(n)}),e}toString(){let e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){let n=new t(this.comparator);return n.data=e,n}},Mp=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};function Ea(t){return t.hasNext()?t.getNext():void 0}var on=class t{constructor(e){this.fields=e,e.sort(We.comparator)}static empty(){return new t([])}unionWith(e){let n=new Se(We.comparator);for(let r of this.fields)n=n.add(r);for(let r of e)n=n.add(r);return new t(n.toArray())}covers(e){for(let n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return ka(this.fields,e.fields,(n,r)=>n.isEqual(r))}};var Rp=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};function zN(){return typeof atob<"u"}var pt=class t{constructor(e){this.binaryString=e}static fromBase64String(e){let n=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new Rp("Invalid base64 string: "+s):s}}(e);return new t(n)}static fromUint8Array(e){let n=function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s}(e);return new t(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){let r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Z(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};pt.EMPTY_BYTE_STRING=new pt("");var EG=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function xi(t){if(L(!!t),typeof t=="string"){let e=0,n=EG.exec(t);if(L(!!n),n[1]){let i=n[1];i=(i+"000000000").substr(0,9),e=Number(i)}let r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Be(t.seconds),nanos:Be(t.nanos)}}function Be(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Mi(t){return typeof t=="string"?pt.fromBase64String(t):pt.fromUint8Array(t)}function Eg(t){var e,n;return((n=(((e=t?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function oC(t){let e=t.mapValue.fields.__previous_value__;return Eg(e)?oC(e):e}function _l(t){let e=xi(t.mapValue.fields.__local_write_time__.timestampValue);return new Le(e.seconds,e.nanos)}var _E=class{constructor(e,n,r,i,s,o,a,u,c){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=u,this.useFetchStreams=c}},Ri=class t{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new t("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database}};var bi={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},wp={nullValue:"NULL_VALUE"};function Us(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Eg(t)?4:WN(t)?9007199254740991:10:O()}function mr(t,e){if(t===e)return!0;let n=Us(t);if(n!==Us(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return _l(t).isEqual(_l(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;let o=xi(i.timestampValue),a=xi(s.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,s){return Mi(i.bytesValue).isEqual(Mi(s.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,s){return Be(i.geoPointValue.latitude)===Be(s.geoPointValue.latitude)&&Be(i.geoPointValue.longitude)===Be(s.geoPointValue.longitude)}(t,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return Be(i.integerValue)===Be(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){let o=Be(i.doubleValue),a=Be(s.doubleValue);return o===a?ml(o)===ml(a):isNaN(o)&&isNaN(a)}return!1}(t,e);case 9:return ka(t.arrayValue.values||[],e.arrayValue.values||[],mr);case 10:return function(i,s){let o=i.mapValue.fields||{},a=s.mapValue.fields||{};if(jR(o)!==jR(a))return!1;for(let u in o)if(o.hasOwnProperty(u)&&(a[u]===void 0||!mr(o[u],a[u])))return!1;return!0}(t,e);default:return O()}}function vl(t,e){return(t.values||[]).find(n=>mr(n,e))!==void 0}function Ni(t,e){if(t===e)return 0;let n=Us(t),r=Us(e);if(n!==r)return Z(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return Z(t.booleanValue,e.booleanValue);case 2:return function(s,o){let a=Be(s.integerValue||s.doubleValue),u=Be(o.integerValue||o.doubleValue);return a<u?-1:a>u?1:a===u?0:isNaN(a)?isNaN(u)?0:-1:1}(t,e);case 3:return UR(t.timestampValue,e.timestampValue);case 4:return UR(_l(t),_l(e));case 5:return Z(t.stringValue,e.stringValue);case 6:return function(s,o){let a=Mi(s),u=Mi(o);return a.compareTo(u)}(t.bytesValue,e.bytesValue);case 7:return function(s,o){let a=s.split("/"),u=o.split("/");for(let c=0;c<a.length&&c<u.length;c++){let l=Z(a[c],u[c]);if(l!==0)return l}return Z(a.length,u.length)}(t.referenceValue,e.referenceValue);case 8:return function(s,o){let a=Z(Be(s.latitude),Be(o.latitude));return a!==0?a:Z(Be(s.longitude),Be(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(s,o){let a=s.values||[],u=o.values||[];for(let c=0;c<a.length&&c<u.length;++c){let l=Ni(a[c],u[c]);if(l)return l}return Z(a.length,u.length)}(t.arrayValue,e.arrayValue);case 10:return function(s,o){if(s===bi.mapValue&&o===bi.mapValue)return 0;if(s===bi.mapValue)return 1;if(o===bi.mapValue)return-1;let a=s.fields||{},u=Object.keys(a),c=o.fields||{},l=Object.keys(c);u.sort(),l.sort();for(let d=0;d<u.length&&d<l.length;++d){let h=Z(u[d],l[d]);if(h!==0)return h;let f=Ni(a[u[d]],c[l[d]]);if(f!==0)return f}return Z(u.length,l.length)}(t.mapValue,e.mapValue);default:throw O()}}function UR(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return Z(t,e);let n=xi(t),r=xi(e),i=Z(n.seconds,r.seconds);return i!==0?i:Z(n.nanos,r.nanos)}function Fa(t){return vE(t)}function vE(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){let r=xi(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return Mi(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return M.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",i=!0;for(let s of n.values||[])i?i=!1:r+=",",r+=vE(s);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){let r=Object.keys(n.fields||{}).sort(),i="{",s=!0;for(let o of r)s?s=!1:i+=",",i+=`${o}:${vE(n.fields[o])}`;return i+"}"}(t.mapValue):O()}function Bs(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function wE(t){return!!t&&"integerValue"in t}function wl(t){return!!t&&"arrayValue"in t}function BR(t){return!!t&&"nullValue"in t}function $R(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Ep(t){return!!t&&"mapValue"in t}function ll(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){let e={mapValue:{fields:{}}};return Zs(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=ll(r)),e}if(t.arrayValue){let e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=ll(t.arrayValue.values[n]);return e}return Object.assign({},t)}function WN(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}function IG(t){return"nullValue"in t?wp:"booleanValue"in t?{booleanValue:!1}:"integerValue"in t||"doubleValue"in t?{doubleValue:NaN}:"timestampValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in t?{stringValue:""}:"bytesValue"in t?{bytesValue:""}:"referenceValue"in t?Bs(Ri.empty(),M.empty()):"geoPointValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in t?{arrayValue:{}}:"mapValue"in t?{mapValue:{}}:O()}function CG(t){return"nullValue"in t?{booleanValue:!1}:"booleanValue"in t?{doubleValue:NaN}:"integerValue"in t||"doubleValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in t?{stringValue:""}:"stringValue"in t?{bytesValue:""}:"bytesValue"in t?Bs(Ri.empty(),M.empty()):"referenceValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in t?{arrayValue:{}}:"arrayValue"in t?{mapValue:{}}:"mapValue"in t?bi:O()}function HR(t,e){let n=Ni(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?-1:!t.inclusive&&e.inclusive?1:0}function qR(t,e){let n=Ni(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?1:!t.inclusive&&e.inclusive?-1:0}var Pt=class t{constructor(e){this.value=e}static empty(){return new t({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!Ep(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=ll(n)}setAll(e){let n=We.emptyPath(),r={},i=[];e.forEach((o,a)=>{if(!n.isImmediateParentOf(a)){let u=this.getFieldsMap(n);this.applyChanges(u,r,i),r={},i=[],n=a.popLast()}o?r[a.lastSegment()]=ll(o):i.push(a.lastSegment())});let s=this.getFieldsMap(n);this.applyChanges(s,r,i)}delete(e){let n=this.field(e.popLast());Ep(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return mr(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=n.mapValue.fields[e.get(r)];Ep(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=i),n=i}return n.mapValue.fields}applyChanges(e,n,r){Zs(n,(i,s)=>e[i]=s);for(let i of r)delete e[i]}clone(){return new t(ll(this.value))}};function KN(t){let e=[];return Zs(t.fields,(n,r)=>{let i=new We([n]);if(Ep(r)){let s=KN(r.mapValue).fields;if(s.length===0)e.push(i);else for(let o of s)e.push(i.child(o))}else e.push(i)}),new on(e)}var ot=class t{constructor(e,n,r,i,s,o,a){this.key=e,this.documentType=n,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new t(e,0,B.min(),B.min(),B.min(),Pt.empty(),0)}static newFoundDocument(e,n,r,i){return new t(e,1,n,B.min(),r,i,0)}static newNoDocument(e,n){return new t(e,2,n,B.min(),B.min(),Pt.empty(),0)}static newUnknownDocument(e,n){return new t(e,3,n,B.min(),B.min(),Pt.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(B.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Pt.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Pt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=B.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof t&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new t(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var yr=class{constructor(e,n){this.position=e,this.inclusive=n}};function GR(t,e,n){let r=0;for(let i=0;i<t.position.length;i++){let s=e[i],o=t.position[i];if(s.field.isKeyField()?r=M.comparator(M.fromName(o.referenceValue),n.key):r=Ni(o,n.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function zR(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!mr(t.position[n],e.position[n]))return!1;return!0}var $s=class{constructor(e,n="asc"){this.field=e,this.dir=n}};function DG(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}var Np=class{},he=class t extends Np{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new CE(e,n,r):n==="array-contains"?new bE(e,r):n==="in"?new Pp(e,r):n==="not-in"?new SE(e,r):n==="array-contains-any"?new AE(e,r):new t(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new DE(e,r):new TE(e,r)}matches(e){let n=e.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison(Ni(n,this.value)):n!==null&&Us(this.value)===Us(n)&&this.matchesComparison(Ni(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return O()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},De=class t extends Np{constructor(e,n){super(),this.filters=e,this.op=n,this.ue=null}static create(e,n){return new t(e,n)}matches(e){return Va(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.ue!==null||(this.ue=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.ue}getFilters(){return Object.assign([],this.filters)}};function Va(t){return t.op==="and"}function EE(t){return t.op==="or"}function aC(t){return QN(t)&&Va(t)}function QN(t){for(let e of t.filters)if(e instanceof De)return!1;return!0}function IE(t){if(t instanceof he)return t.field.canonicalString()+t.op.toString()+Fa(t.value);if(aC(t))return t.filters.map(e=>IE(e)).join(",");{let e=t.filters.map(n=>IE(n)).join(",");return`${t.op}(${e})`}}function YN(t,e){return t instanceof he?function(r,i){return i instanceof he&&r.op===i.op&&r.field.isEqual(i.field)&&mr(r.value,i.value)}(t,e):t instanceof De?function(r,i){return i instanceof De&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,o,a)=>s&&YN(o,i.filters[a]),!0):!1}(t,e):void O()}function ZN(t,e){let n=t.filters.concat(e);return De.create(n,t.op)}function XN(t){return t instanceof he?function(n){return`${n.field.canonicalString()} ${n.op} ${Fa(n.value)}`}(t):t instanceof De?function(n){return n.op.toString()+" {"+n.getFilters().map(XN).join(" ,")+"}"}(t):"Filter"}var CE=class extends he{constructor(e,n,r){super(e,n,r),this.key=M.fromName(r.referenceValue)}matches(e){let n=M.comparator(e.key,this.key);return this.matchesComparison(n)}},DE=class extends he{constructor(e,n){super(e,"in",n),this.keys=JN("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}},TE=class extends he{constructor(e,n){super(e,"not-in",n),this.keys=JN("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}};function JN(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>M.fromName(r.referenceValue))}var bE=class extends he{constructor(e,n){super(e,"array-contains",n)}matches(e){let n=e.data.field(this.field);return wl(n)&&vl(n.arrayValue,this.value)}},Pp=class extends he{constructor(e,n){super(e,"in",n)}matches(e){let n=e.data.field(this.field);return n!==null&&vl(this.value.arrayValue,n)}},SE=class extends he{constructor(e,n){super(e,"not-in",n)}matches(e){if(vl(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let n=e.data.field(this.field);return n!==null&&!vl(this.value.arrayValue,n)}},AE=class extends he{constructor(e,n){super(e,"array-contains-any",n)}matches(e){let n=e.data.field(this.field);return!(!wl(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>vl(this.value.arrayValue,r))}};var xE=class{constructor(e,n=null,r=[],i=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=a,this.ce=null}};function ME(t,e=null,n=[],r=[],i=null,s=null,o=null){return new xE(t,e,n,r,i,s,o)}function Hs(t){let e=N(t);if(e.ce===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>IE(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),Ll(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>Fa(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>Fa(r)).join(",")),e.ce=n}return e.ce}function jl(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!DG(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!YN(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!zR(t.startAt,e.startAt)&&zR(t.endAt,e.endAt)}function kp(t){return M.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}function Op(t,e){return t.filters.filter(n=>n instanceof he&&n.field.isEqual(e))}function WR(t,e,n){let r=wp,i=!0;for(let s of Op(t,e)){let o=wp,a=!0;switch(s.op){case"<":case"<=":o=IG(s.value);break;case"==":case"in":case">=":o=s.value;break;case">":o=s.value,a=!1;break;case"!=":case"not-in":o=wp}HR({value:r,inclusive:i},{value:o,inclusive:a})<0&&(r=o,i=a)}if(n!==null){for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){let o=n.position[s];HR({value:r,inclusive:i},{value:o,inclusive:n.inclusive})<0&&(r=o,i=n.inclusive);break}}return{value:r,inclusive:i}}function KR(t,e,n){let r=bi,i=!0;for(let s of Op(t,e)){let o=bi,a=!0;switch(s.op){case">=":case">":o=CG(s.value),a=!1;break;case"==":case"in":case"<=":o=s.value;break;case"<":o=s.value,a=!1;break;case"!=":case"not-in":o=bi}qR({value:r,inclusive:i},{value:o,inclusive:a})>0&&(r=o,i=a)}if(n!==null){for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){let o=n.position[s];qR({value:r,inclusive:i},{value:o,inclusive:n.inclusive})>0&&(r=o,i=n.inclusive);break}}return{value:r,inclusive:i}}var $n=class{constructor(e,n=null,r=[],i=[],s=null,o="F",a=null,u=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=u,this.le=null,this.he=null,this.Pe=null,this.startAt,this.endAt}};function eP(t,e,n,r,i,s,o,a){return new $n(t,e,n,r,i,s,o,a)}function Za(t){return new $n(t)}function QR(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function uC(t){return t.collectionGroup!==null}function Na(t){let e=N(t);if(e.le===null){e.le=[];let n=new Set;for(let s of e.explicitOrderBy)e.le.push(s),n.add(s.field.canonicalString());let r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new Se(We.comparator);return o.filters.forEach(u=>{u.getFlattenedFilters().forEach(c=>{c.isInequality()&&(a=a.add(c.field))})}),a})(e).forEach(s=>{n.has(s.canonicalString())||s.isKeyField()||e.le.push(new $s(s,r))}),n.has(We.keyField().canonicalString())||e.le.push(new $s(We.keyField(),r))}return e.le}function Bt(t){let e=N(t);return e.he||(e.he=TG(e,Na(t))),e.he}function TG(t,e){if(t.limitType==="F")return ME(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{let s=i.dir==="desc"?"asc":"desc";return new $s(i.field,s)});let n=t.endAt?new yr(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new yr(t.startAt.position,t.startAt.inclusive):null;return ME(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function RE(t,e){let n=t.filters.concat([e]);return new $n(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function Fp(t,e,n){return new $n(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Ul(t,e){return jl(Bt(t),Bt(e))&&t.limitType===e.limitType}function tP(t){return`${Hs(Bt(t))}|lt:${t.limitType}`}function ba(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(i=>XN(i)).join(", ")}]`),Ll(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(i=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(i)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(i=>Fa(i)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(i=>Fa(i)).join(",")),`Target(${r})`}(Bt(t))}; limitType=${t.limitType})`}function Bl(t,e){return e.isFoundDocument()&&function(r,i){let s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):M.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(t,e)&&function(r,i){for(let s of Na(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(t,e)&&function(r,i){for(let s of r.filters)if(!s.matches(i))return!1;return!0}(t,e)&&function(r,i){return!(r.startAt&&!function(o,a,u){let c=GR(o,a,u);return o.inclusive?c<=0:c<0}(r.startAt,Na(r),i)||r.endAt&&!function(o,a,u){let c=GR(o,a,u);return o.inclusive?c>=0:c>0}(r.endAt,Na(r),i))}(t,e)}function nP(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function rP(t){return(e,n)=>{let r=!1;for(let i of Na(t)){let s=bG(i,e,n);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function bG(t,e,n){let r=t.field.isKeyField()?M.comparator(e.key,n.key):function(s,o,a){let u=o.data.field(s),c=a.data.field(s);return u!==null&&c!==null?Ni(u,c):O()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return O()}}var _r=class{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){let n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(let[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,n){let r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,n]);i.push([e,n]),this.innerSize++}delete(e){let n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[n]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Zs(this.inner,(n,r)=>{for(let[i,s]of r)e(i,s)})}isEmpty(){return GN(this.inner)}size(){return this.innerSize}};var SG=new Ne(M.comparator);function Zt(){return SG}var iP=new Ne(M.comparator);function ul(...t){let e=iP;for(let n of t)e=e.insert(n.key,n);return e}function sP(t){let e=iP;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function hr(){return dl()}function oP(){return dl()}function dl(){return new _r(t=>t.toString(),(t,e)=>t.isEqual(e))}var AG=new Ne(M.comparator),xG=new Se(M.comparator);function ee(...t){let e=xG;for(let n of t)e=e.add(n);return e}var MG=new Se(Z);function cC(){return MG}function aP(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ml(e)?"-0":e}}function uP(t){return{integerValue:""+t}}function cP(t,e){return UN(e)?uP(e):aP(t,e)}var La=class{constructor(){this._=void 0}};function RG(t,e,n){return t instanceof Pi?function(i,s){let o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&Eg(s)&&(s=oC(s)),s&&(o.fields.__previous_value__=s),{mapValue:o}}(n,e):t instanceof Hr?dP(t,e):t instanceof qr?hP(t,e):function(i,s){let o=lP(i,s),a=YR(o)+YR(i.Ie);return wE(o)&&wE(i.Ie)?uP(a):aP(i.serializer,a)}(t,e)}function NG(t,e,n){return t instanceof Hr?dP(t,e):t instanceof qr?hP(t,e):n}function lP(t,e){return t instanceof ki?function(r){return wE(r)||function(s){return!!s&&"doubleValue"in s}(r)}(e)?e:{integerValue:0}:null}var Pi=class extends La{},Hr=class extends La{constructor(e){super(),this.elements=e}};function dP(t,e){let n=fP(e);for(let r of t.elements)n.some(i=>mr(i,r))||n.push(r);return{arrayValue:{values:n}}}var qr=class extends La{constructor(e){super(),this.elements=e}};function hP(t,e){let n=fP(e);for(let r of t.elements)n=n.filter(i=>!mr(i,r));return{arrayValue:{values:n}}}var ki=class extends La{constructor(e,n){super(),this.serializer=e,this.Ie=n}};function YR(t){return Be(t.integerValue||t.doubleValue)}function fP(t){return wl(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}var qs=class{constructor(e,n){this.field=e,this.transform=n}};function PG(t,e){return t.field.isEqual(e.field)&&function(r,i){return r instanceof Hr&&i instanceof Hr||r instanceof qr&&i instanceof qr?ka(r.elements,i.elements,mr):r instanceof ki&&i instanceof ki?mr(r.Ie,i.Ie):r instanceof Pi&&i instanceof Pi}(t.transform,e.transform)}var NE=class{constructor(e,n){this.version=e,this.transformResults=n}},$e=class t{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new t}static exists(e){return new t(void 0,e)}static updateTime(e){return new t(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function Ip(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}var ja=class{};function pP(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new Fi(t.key,$e.none()):new Oi(t.key,t.data,$e.none());{let n=t.data,r=Pt.empty(),i=new Se(We.comparator);for(let s of e.fields)if(!i.has(s)){let o=n.field(s);o===null&&s.length>1&&(s=s.popLast(),o=n.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new Hn(t.key,r,new on(i.toArray()),$e.none())}}function kG(t,e,n){t instanceof Oi?function(i,s,o){let a=i.value.clone(),u=XR(i.fieldTransforms,s,o.transformResults);a.setAll(u),s.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(t,e,n):t instanceof Hn?function(i,s,o){if(!Ip(i.precondition,s))return void s.convertToUnknownDocument(o.version);let a=XR(i.fieldTransforms,s,o.transformResults),u=s.data;u.setAll(gP(i)),u.setAll(a),s.convertToFoundDocument(o.version,u).setHasCommittedMutations()}(t,e,n):function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function hl(t,e,n,r){return t instanceof Oi?function(s,o,a,u){if(!Ip(s.precondition,o))return a;let c=s.value.clone(),l=JR(s.fieldTransforms,u,o);return c.setAll(l),o.convertToFoundDocument(o.version,c).setHasLocalMutations(),null}(t,e,n,r):t instanceof Hn?function(s,o,a,u){if(!Ip(s.precondition,o))return a;let c=JR(s.fieldTransforms,u,o),l=o.data;return l.setAll(gP(s)),l.setAll(c),o.convertToFoundDocument(o.version,l).setHasLocalMutations(),a===null?null:a.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(d=>d.field))}(t,e,n,r):function(s,o,a){return Ip(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(t,e,n)}function OG(t,e){let n=null;for(let r of t.fieldTransforms){let i=e.data.field(r.field),s=lP(r.transform,i||null);s!=null&&(n===null&&(n=Pt.empty()),n.set(r.field,s))}return n||null}function ZR(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&ka(r,i,(s,o)=>PG(s,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}var Oi=class extends ja{constructor(e,n,r,i=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}},Hn=class extends ja{constructor(e,n,r,i,s=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}};function gP(t){let e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){let r=t.data.field(n);e.set(n,r)}}),e}function XR(t,e,n){let r=new Map;L(t.length===n.length);for(let i=0;i<n.length;i++){let s=t[i],o=s.transform,a=e.data.field(s.field);r.set(s.field,NG(o,a,n[i]))}return r}function JR(t,e,n){let r=new Map;for(let i of t){let s=i.transform,o=n.data.field(i.field);r.set(i.field,RG(s,o,e))}return r}var Fi=class extends ja{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}},El=class extends ja{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var Il=class{constructor(e,n,r,i){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,n){let r=n.mutationResults;for(let i=0;i<this.mutations.length;i++){let s=this.mutations[i];s.key.isEqual(e.key)&&kG(s,e,r[i])}}applyToLocalView(e,n){for(let r of this.baseMutations)r.key.isEqual(e.key)&&(n=hl(r,e,n,this.localWriteTime));for(let r of this.mutations)r.key.isEqual(e.key)&&(n=hl(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){let r=oP();return this.mutations.forEach(i=>{let s=e.get(i.key),o=s.overlayedDocument,a=this.applyToLocalView(o,s.mutatedFields);a=n.has(i.key)?null:a;let u=pP(o,a);u!==null&&r.set(i.key,u),o.isValidDocument()||o.convertToNoDocument(B.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),ee())}isEqual(e){return this.batchId===e.batchId&&ka(this.mutations,e.mutations,(n,r)=>ZR(n,r))&&ka(this.baseMutations,e.baseMutations,(n,r)=>ZR(n,r))}},PE=class t{constructor(e,n,r,i){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=i}static from(e,n,r){L(e.mutations.length===r.length);let i=function(){return AG}(),s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new t(e,n,r,i)}};var Cl=class{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var kE=class{constructor(e,n){this.count=e,this.unchangedNames=n}};var nt,ge;function mP(t){switch(t){default:return O();case y.CANCELLED:case y.UNKNOWN:case y.DEADLINE_EXCEEDED:case y.RESOURCE_EXHAUSTED:case y.INTERNAL:case y.UNAVAILABLE:case y.UNAUTHENTICATED:return!1;case y.INVALID_ARGUMENT:case y.NOT_FOUND:case y.ALREADY_EXISTS:case y.PERMISSION_DENIED:case y.FAILED_PRECONDITION:case y.ABORTED:case y.OUT_OF_RANGE:case y.UNIMPLEMENTED:case y.DATA_LOSS:return!0}}function yP(t){if(t===void 0)return ze("GRPC error has no .code"),y.UNKNOWN;switch(t){case nt.OK:return y.OK;case nt.CANCELLED:return y.CANCELLED;case nt.UNKNOWN:return y.UNKNOWN;case nt.DEADLINE_EXCEEDED:return y.DEADLINE_EXCEEDED;case nt.RESOURCE_EXHAUSTED:return y.RESOURCE_EXHAUSTED;case nt.INTERNAL:return y.INTERNAL;case nt.UNAVAILABLE:return y.UNAVAILABLE;case nt.UNAUTHENTICATED:return y.UNAUTHENTICATED;case nt.INVALID_ARGUMENT:return y.INVALID_ARGUMENT;case nt.NOT_FOUND:return y.NOT_FOUND;case nt.ALREADY_EXISTS:return y.ALREADY_EXISTS;case nt.PERMISSION_DENIED:return y.PERMISSION_DENIED;case nt.FAILED_PRECONDITION:return y.FAILED_PRECONDITION;case nt.ABORTED:return y.ABORTED;case nt.OUT_OF_RANGE:return y.OUT_OF_RANGE;case nt.UNIMPLEMENTED:return y.UNIMPLEMENTED;case nt.DATA_LOSS:return y.DATA_LOSS;default:return O()}}(ge=nt||(nt={}))[ge.OK=0]="OK",ge[ge.CANCELLED=1]="CANCELLED",ge[ge.UNKNOWN=2]="UNKNOWN",ge[ge.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ge[ge.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ge[ge.NOT_FOUND=5]="NOT_FOUND",ge[ge.ALREADY_EXISTS=6]="ALREADY_EXISTS",ge[ge.PERMISSION_DENIED=7]="PERMISSION_DENIED",ge[ge.UNAUTHENTICATED=16]="UNAUTHENTICATED",ge[ge.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ge[ge.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ge[ge.ABORTED=10]="ABORTED",ge[ge.OUT_OF_RANGE=11]="OUT_OF_RANGE",ge[ge.UNIMPLEMENTED=12]="UNIMPLEMENTED",ge[ge.INTERNAL=13]="INTERNAL",ge[ge.UNAVAILABLE=14]="UNAVAILABLE",ge[ge.DATA_LOSS=15]="DATA_LOSS";var eN=null;function _P(){return new TextEncoder}var FG=new Rs([4294967295,4294967295],0);function tN(t){let e=_P().encode(t),n=new kR;return n.update(e),new Uint8Array(n.digest())}function nN(t){let e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Rs([n,r],0),new Rs([i,s],0)]}var OE=class t{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new Ls(`Invalid padding: ${n}`);if(r<0)throw new Ls(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Ls(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new Ls(`Invalid padding when bitmap length is 0: ${n}`);this.Te=8*e.length-n,this.Ee=Rs.fromNumber(this.Te)}de(e,n,r){let i=e.add(n.multiply(Rs.fromNumber(r)));return i.compare(FG)===1&&(i=new Rs([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Ee).toNumber()}Ae(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Te===0)return!1;let n=tN(e),[r,i]=nN(n);for(let s=0;s<this.hashCount;s++){let o=this.de(r,i,s);if(!this.Ae(o))return!1}return!0}static create(e,n,r){let i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new t(s,i,n);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.Te===0)return;let n=tN(e),[r,i]=nN(n);for(let s=0;s<this.hashCount;s++){let o=this.de(r,i,s);this.Re(o)}}Re(e){let n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}},Ls=class extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};var Dl=class t{constructor(e,n,r,i,s){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,n,r){let i=new Map;return i.set(e,Tl.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new t(B.min(),i,new Ne(Z),Zt(),ee())}},Tl=class t{constructor(e,n,r,i,s){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new t(r,n,ee(),ee(),ee())}};var Pa=class{constructor(e,n,r,i){this.Ve=e,this.removedTargetIds=n,this.key=r,this.me=i}},Vp=class{constructor(e,n){this.targetId=e,this.fe=n}},Lp=class{constructor(e,n,r=pt.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=i}},jp=class{constructor(){this.ge=0,this.pe=iN(),this.ye=pt.EMPTY_BYTE_STRING,this.we=!1,this.Se=!0}get current(){return this.we}get resumeToken(){return this.ye}get be(){return this.ge!==0}get De(){return this.Se}Ce(e){e.approximateByteSize()>0&&(this.Se=!0,this.ye=e)}ve(){let e=ee(),n=ee(),r=ee();return this.pe.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:n=n.add(i);break;case 1:r=r.add(i);break;default:O()}}),new Tl(this.ye,this.we,e,n,r)}Fe(){this.Se=!1,this.pe=iN()}Me(e,n){this.Se=!0,this.pe=this.pe.insert(e,n)}xe(e){this.Se=!0,this.pe=this.pe.remove(e)}Oe(){this.ge+=1}Ne(){this.ge-=1,L(this.ge>=0)}Be(){this.Se=!0,this.we=!0}},FE=class{constructor(e){this.Le=e,this.ke=new Map,this.qe=Zt(),this.Qe=rN(),this.Ke=new Ne(Z)}$e(e){for(let n of e.Ve)e.me&&e.me.isFoundDocument()?this.Ue(n,e.me):this.We(n,e.key,e.me);for(let n of e.removedTargetIds)this.We(n,e.key,e.me)}Ge(e){this.forEachTarget(e,n=>{let r=this.ze(n);switch(e.state){case 0:this.je(n)&&r.Ce(e.resumeToken);break;case 1:r.Ne(),r.be||r.Fe(),r.Ce(e.resumeToken);break;case 2:r.Ne(),r.be||this.removeTarget(n);break;case 3:this.je(n)&&(r.Be(),r.Ce(e.resumeToken));break;case 4:this.je(n)&&(this.He(n),r.Ce(e.resumeToken));break;default:O()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.ke.forEach((r,i)=>{this.je(i)&&n(i)})}Je(e){let n=e.targetId,r=e.fe.count,i=this.Ye(n);if(i){let s=i.target;if(kp(s))if(r===0){let o=new M(s.path);this.We(n,o,ot.newNoDocument(o,B.min()))}else L(r===1);else{let o=this.Ze(n);if(o!==r){let a=this.Xe(e),u=a?this.et(a,e,o):1;if(u!==0){this.He(n);let c=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ke=this.Ke.insert(n,c)}eN?.tt(function(l,d,h,f,p){var g,_,b,P,A,H;let G={localCacheCount:l,existenceFilterCount:d.count,databaseId:h.database,projectId:h.projectId},J=d.unchangedNames;return J&&(G.bloomFilter={applied:p===0,hashCount:(g=J?.hashCount)!==null&&g!==void 0?g:0,bitmapLength:(P=(b=(_=J?.bits)===null||_===void 0?void 0:_.bitmap)===null||b===void 0?void 0:b.length)!==null&&P!==void 0?P:0,padding:(H=(A=J?.bits)===null||A===void 0?void 0:A.padding)!==null&&H!==void 0?H:0,mightContain:Pe=>{var dn;return(dn=f?.mightContain(Pe))!==null&&dn!==void 0&&dn}}),G}(o,e.fe,this.Le.nt(),a,u))}}}}Xe(e){let n=e.fe.unchangedNames;if(!n||!n.bits)return null;let{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=n,o,a;try{o=Mi(r).toUint8Array()}catch(u){if(u instanceof Rp)return Dn("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{a=new OE(o,i,s)}catch(u){return Dn(u instanceof Ls?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return a.Te===0?null:a}et(e,n,r){return n.fe.count===r-this.rt(e,n.targetId)?0:2}rt(e,n){let r=this.Le.getRemoteKeysForTarget(n),i=0;return r.forEach(s=>{let o=this.Le.nt(),a=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(a)||(this.We(n,s,null),i++)}),i}it(e){let n=new Map;this.ke.forEach((s,o)=>{let a=this.Ye(o);if(a){if(s.current&&kp(a.target)){let u=new M(a.target.path);this.qe.get(u)!==null||this.st(o,u)||this.We(o,u,ot.newNoDocument(u,e))}s.De&&(n.set(o,s.ve()),s.Fe())}});let r=ee();this.Qe.forEach((s,o)=>{let a=!0;o.forEachWhile(u=>{let c=this.Ye(u);return!c||c.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(s))}),this.qe.forEach((s,o)=>o.setReadTime(e));let i=new Dl(e,n,this.Ke,this.qe,r);return this.qe=Zt(),this.Qe=rN(),this.Ke=new Ne(Z),i}Ue(e,n){if(!this.je(e))return;let r=this.st(e,n.key)?2:0;this.ze(e).Me(n.key,r),this.qe=this.qe.insert(n.key,n),this.Qe=this.Qe.insert(n.key,this.ot(n.key).add(e))}We(e,n,r){if(!this.je(e))return;let i=this.ze(e);this.st(e,n)?i.Me(n,1):i.xe(n),this.Qe=this.Qe.insert(n,this.ot(n).delete(e)),r&&(this.qe=this.qe.insert(n,r))}removeTarget(e){this.ke.delete(e)}Ze(e){let n=this.ze(e).ve();return this.Le.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Oe(e){this.ze(e).Oe()}ze(e){let n=this.ke.get(e);return n||(n=new jp,this.ke.set(e,n)),n}ot(e){let n=this.Qe.get(e);return n||(n=new Se(Z),this.Qe=this.Qe.insert(e,n)),n}je(e){let n=this.Ye(e)!==null;return n||D("WatchChangeAggregator","Detected inactive target",e),n}Ye(e){let n=this.ke.get(e);return n&&n.be?null:this.Le._t(e)}He(e){this.ke.set(e,new jp),this.Le.getRemoteKeysForTarget(e).forEach(n=>{this.We(e,n,null)})}st(e,n){return this.Le.getRemoteKeysForTarget(e).has(n)}};function rN(){return new Ne(M.comparator)}function iN(){return new Ne(M.comparator)}var VG={asc:"ASCENDING",desc:"DESCENDING"},LG={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},jG={and:"AND",or:"OR"},VE=class{constructor(e,n){this.databaseId=e,this.useProto3Json=n}};function LE(t,e){return t.useProto3Json||Ll(e)?e:{value:e}}function Ua(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function vP(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function UG(t,e){return Ua(t,e.toTimestamp())}function Ke(t){return L(!!t),B.fromTimestamp(function(n){let r=xi(n);return new Le(r.seconds,r.nanos)}(t))}function lC(t,e){return jE(t,e).canonicalString()}function jE(t,e){let n=function(i){return new me(["projects",i.projectId,"databases",i.database])}(t).child("documents");return e===void 0?n:n.child(e)}function wP(t){let e=me.fromString(t);return L(MP(e)),e}function bl(t,e){return lC(t.databaseId,e.path)}function pr(t,e){let n=wP(e);if(n.get(1)!==t.databaseId.projectId)throw new I(y.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new I(y.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new M(CP(n))}function EP(t,e){return lC(t.databaseId,e)}function IP(t){let e=wP(t);return e.length===4?me.emptyPath():CP(e)}function UE(t){return new me(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function CP(t){return L(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function sN(t,e,n){return{name:bl(t,e),fields:n.value.mapValue.fields}}function DP(t,e,n){let r=pr(t,e.name),i=Ke(e.updateTime),s=e.createTime?Ke(e.createTime):B.min(),o=new Pt({mapValue:{fields:e.fields}}),a=ot.newFoundDocument(r,i,s,o);return n&&a.setHasCommittedMutations(),n?a.setHasCommittedMutations():a}function BG(t,e){return"found"in e?function(r,i){L(!!i.found),i.found.name,i.found.updateTime;let s=pr(r,i.found.name),o=Ke(i.found.updateTime),a=i.found.createTime?Ke(i.found.createTime):B.min(),u=new Pt({mapValue:{fields:i.found.fields}});return ot.newFoundDocument(s,o,a,u)}(t,e):"missing"in e?function(r,i){L(!!i.missing),L(!!i.readTime);let s=pr(r,i.missing),o=Ke(i.readTime);return ot.newNoDocument(s,o)}(t,e):O()}function $G(t,e){let n;if("targetChange"in e){e.targetChange;let r=function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:O()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(c,l){return c.useProto3Json?(L(l===void 0||typeof l=="string"),pt.fromBase64String(l||"")):(L(l===void 0||l instanceof Uint8Array),pt.fromUint8Array(l||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(c){let l=c.code===void 0?y.UNKNOWN:yP(c.code);return new I(l,c.message||"")}(o);n=new Lp(r,i,s,a||null)}else if("documentChange"in e){e.documentChange;let r=e.documentChange;r.document,r.document.name,r.document.updateTime;let i=pr(t,r.document.name),s=Ke(r.document.updateTime),o=r.document.createTime?Ke(r.document.createTime):B.min(),a=new Pt({mapValue:{fields:r.document.fields}}),u=ot.newFoundDocument(i,s,o,a),c=r.targetIds||[],l=r.removedTargetIds||[];n=new Pa(c,l,u.key,u)}else if("documentDelete"in e){e.documentDelete;let r=e.documentDelete;r.document;let i=pr(t,r.document),s=r.readTime?Ke(r.readTime):B.min(),o=ot.newNoDocument(i,s),a=r.removedTargetIds||[];n=new Pa([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;let r=e.documentRemove;r.document;let i=pr(t,r.document),s=r.removedTargetIds||[];n=new Pa([],s,i,null)}else{if(!("filter"in e))return O();{e.filter;let r=e.filter;r.targetId;let{count:i=0,unchangedNames:s}=r,o=new kE(i,s),a=r.targetId;n=new Vp(a,o)}}return n}function Sl(t,e){let n;if(e instanceof Oi)n={update:sN(t,e.key,e.value)};else if(e instanceof Fi)n={delete:bl(t,e.key)};else if(e instanceof Hn)n={update:sN(t,e.key,e.data),updateMask:KG(e.fieldMask)};else{if(!(e instanceof El))return O();n={verify:bl(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(s,o){let a=o.transform;if(a instanceof Pi)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof Hr)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof qr)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof ki)return{fieldPath:o.field.canonicalString(),increment:a.Ie};throw O()}(0,r))),e.precondition.isNone||(n.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:UG(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:O()}(t,e.precondition)),n}function BE(t,e){let n=e.currentDocument?function(s){return s.updateTime!==void 0?$e.updateTime(Ke(s.updateTime)):s.exists!==void 0?$e.exists(s.exists):$e.none()}(e.currentDocument):$e.none(),r=e.updateTransforms?e.updateTransforms.map(i=>function(o,a){let u=null;if("setToServerValue"in a)L(a.setToServerValue==="REQUEST_TIME"),u=new Pi;else if("appendMissingElements"in a){let l=a.appendMissingElements.values||[];u=new Hr(l)}else if("removeAllFromArray"in a){let l=a.removeAllFromArray.values||[];u=new qr(l)}else"increment"in a?u=new ki(o,a.increment):O();let c=We.fromServerFormat(a.fieldPath);return new qs(c,u)}(t,i)):[];if(e.update){e.update.name;let i=pr(t,e.update.name),s=new Pt({mapValue:{fields:e.update.fields}});if(e.updateMask){let o=function(u){let c=u.fieldPaths||[];return new on(c.map(l=>We.fromServerFormat(l)))}(e.updateMask);return new Hn(i,s,o,n,r)}return new Oi(i,s,n,r)}if(e.delete){let i=pr(t,e.delete);return new Fi(i,n)}if(e.verify){let i=pr(t,e.verify);return new El(i,n)}return O()}function HG(t,e){return t&&t.length>0?(L(e!==void 0),t.map(n=>function(i,s){let o=i.updateTime?Ke(i.updateTime):Ke(s);return o.isEqual(B.min())&&(o=Ke(s)),new NE(o,i.transformResults||[])}(n,e))):[]}function TP(t,e){return{documents:[EP(t,e.path)]}}function bP(t,e){let n={structuredQuery:{}},r=e.path,i;e.collectionGroup!==null?(i=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=EP(t,i);let s=function(c){if(c.length!==0)return xP(De.create(c,"and"))}(e.filters);s&&(n.structuredQuery.where=s);let o=function(c){if(c.length!==0)return c.map(l=>function(h){return{field:Sa(h.field),direction:GG(h.dir)}}(l))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);let a=LE(t,e.limit);return a!==null&&(n.structuredQuery.limit=a),e.startAt&&(n.structuredQuery.startAt=function(c){return{before:c.inclusive,values:c.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(c){return{before:!c.inclusive,values:c.position}}(e.endAt)),{ut:n,parent:i}}function SP(t){let e=IP(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){L(r===1);let l=n.from[0];l.allDescendants?i=l.collectionId:e=e.child(l.collectionId)}let s=[];n.where&&(s=function(d){let h=AP(d);return h instanceof De&&aC(h)?h.getFilters():[h]}(n.where));let o=[];n.orderBy&&(o=function(d){return d.map(h=>function(p){return new $s(Aa(p.field),function(_){switch(_){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(p.direction))}(h))}(n.orderBy));let a=null;n.limit&&(a=function(d){let h;return h=typeof d=="object"?d.value:d,Ll(h)?null:h}(n.limit));let u=null;n.startAt&&(u=function(d){let h=!!d.before,f=d.values||[];return new yr(f,h)}(n.startAt));let c=null;return n.endAt&&(c=function(d){let h=!d.before,f=d.values||[];return new yr(f,h)}(n.endAt)),eP(e,i,o,s,a,"F",u,c)}function qG(t,e){let n=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return O()}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function AP(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":let r=Aa(n.unaryFilter.field);return he.create(r,"==",{doubleValue:NaN});case"IS_NULL":let i=Aa(n.unaryFilter.field);return he.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let s=Aa(n.unaryFilter.field);return he.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let o=Aa(n.unaryFilter.field);return he.create(o,"!=",{nullValue:"NULL_VALUE"});default:return O()}}(t):t.fieldFilter!==void 0?function(n){return he.create(Aa(n.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return O()}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return De.create(n.compositeFilter.filters.map(r=>AP(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return O()}}(n.compositeFilter.op))}(t):O()}function GG(t){return VG[t]}function zG(t){return LG[t]}function WG(t){return jG[t]}function Sa(t){return{fieldPath:t.canonicalString()}}function Aa(t){return We.fromServerFormat(t.fieldPath)}function xP(t){return t instanceof he?function(n){if(n.op==="=="){if($R(n.value))return{unaryFilter:{field:Sa(n.field),op:"IS_NAN"}};if(BR(n.value))return{unaryFilter:{field:Sa(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if($R(n.value))return{unaryFilter:{field:Sa(n.field),op:"IS_NOT_NAN"}};if(BR(n.value))return{unaryFilter:{field:Sa(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Sa(n.field),op:zG(n.op),value:n.value}}}(t):t instanceof De?function(n){let r=n.getFilters().map(i=>xP(i));return r.length===1?r[0]:{compositeFilter:{op:WG(n.op),filters:r}}}(t):O()}function KG(t){let e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function MP(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}var Ba=class t{constructor(e,n,r,i,s=B.min(),o=B.min(),a=pt.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=u}withSequenceNumber(e){return new t(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}};var Up=class{constructor(e){this.ct=e}};function QG(t,e){let n;if(e.document)n=DP(t.ct,e.document,!!e.hasCommittedMutations);else if(e.noDocument){let r=M.fromSegments(e.noDocument.path),i=zs(e.noDocument.readTime);n=ot.newNoDocument(r,i),e.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!e.unknownDocument)return O();{let r=M.fromSegments(e.unknownDocument.path),i=zs(e.unknownDocument.version);n=ot.newUnknownDocument(r,i)}}return e.readTime&&n.setReadTime(function(i){let s=new Le(i[0],i[1]);return B.fromTimestamp(s)}(e.readTime)),n}function oN(t,e){let n=e.key,r={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:Bp(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(s,o){return{name:bl(s,o.key),fields:o.data.value.mapValue.fields,updateTime:Ua(s,o.version.toTimestamp()),createTime:Ua(s,o.createTime.toTimestamp())}}(t.ct,e);else if(e.isNoDocument())r.noDocument={path:n.path.toArray(),readTime:Gs(e.version)};else{if(!e.isUnknownDocument())return O();r.unknownDocument={path:n.path.toArray(),version:Gs(e.version)}}return r}function Bp(t){let e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function Gs(t){let e=t.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function zs(t){let e=new Le(t.seconds,t.nanoseconds);return B.fromTimestamp(e)}function Os(t,e){let n=(e.baseMutations||[]).map(s=>BE(t.ct,s));for(let s=0;s<e.mutations.length-1;++s){let o=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){let a=e.mutations[s+1];o.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}let r=e.mutations.map(s=>BE(t.ct,s)),i=Le.fromMillis(e.localWriteTimeMs);return new Il(e.batchId,i,n,r)}function cl(t){let e=zs(t.readTime),n=t.lastLimboFreeSnapshotVersion!==void 0?zs(t.lastLimboFreeSnapshotVersion):B.min(),r;return r=function(s){return s.documents!==void 0}(t.query)?function(s){return L(s.documents.length===1),Bt(Za(IP(s.documents[0])))}(t.query):function(s){return Bt(SP(s))}(t.query),new Ba(r,t.targetId,"TargetPurposeListen",t.lastListenSequenceNumber,e,n,pt.fromBase64String(t.resumeToken))}function RP(t,e){let n=Gs(e.snapshotVersion),r=Gs(e.lastLimboFreeSnapshotVersion),i;i=kp(e.target)?TP(t.ct,e.target):bP(t.ct,e.target).ut;let s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Hs(e.target),readTime:n,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function dC(t){let e=SP({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Fp(e,e.limit,"L"):e}function nE(t,e){return new Cl(e.largestBatchId,BE(t.ct,e.overlayMutation))}function aN(t,e){let n=e.path.lastSegment();return[t,Ut(e.path.popLast()),n]}function uN(t,e,n,r){return{indexId:t,uid:e,sequenceNumber:n,readTime:Gs(r.readTime),documentKey:Ut(r.documentKey.path),largestBatchId:r.largestBatchId}}var $E=class{getBundleMetadata(e,n){return cN(e).get(n).next(r=>{if(r)return function(s){return{id:s.bundleId,createTime:zs(s.createTime),version:s.version}}(r)})}saveBundleMetadata(e,n){return cN(e).put(function(i){return{bundleId:i.id,createTime:Gs(Ke(i.createTime)),version:i.version}}(n))}getNamedQuery(e,n){return lN(e).get(n).next(r=>{if(r)return function(s){return{name:s.name,query:dC(s.bundledQuery),readTime:zs(s.readTime)}}(r)})}saveNamedQuery(e,n){return lN(e).put(function(i){return{name:i.name,readTime:Gs(Ke(i.readTime)),bundledQuery:i.bundledQuery}}(n))}};function cN(t){return gt(t,"bundles")}function lN(t){return gt(t,"namedQueries")}var $p=class t{constructor(e,n){this.serializer=e,this.userId=n}static lt(e,n){let r=n.uid||"";return new t(e,r)}getOverlay(e,n){return il(e).get(aN(this.userId,n)).next(r=>r?nE(this.serializer,r):null)}getOverlays(e,n){let r=hr();return m.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){let i=[];return r.forEach((s,o)=>{let a=new Cl(n,o);i.push(this.ht(e,a))}),m.waitFor(i)}removeOverlaysForBatchId(e,n,r){let i=new Set;n.forEach(o=>i.add(Ut(o.getCollectionPath())));let s=[];return i.forEach(o=>{let a=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);s.push(il(e).H("collectionPathOverlayIndex",a))}),m.waitFor(s)}getOverlaysForCollection(e,n,r){let i=hr(),s=Ut(n),o=IDBKeyRange.bound([this.userId,s,r],[this.userId,s,Number.POSITIVE_INFINITY],!0);return il(e).W("collectionPathOverlayIndex",o).next(a=>{for(let u of a){let c=nE(this.serializer,u);i.set(c.getKey(),c)}return i})}getOverlaysForCollectionGroup(e,n,r,i){let s=hr(),o,a=IDBKeyRange.bound([this.userId,n,r],[this.userId,n,Number.POSITIVE_INFINITY],!0);return il(e).Y({index:"collectionGroupOverlayIndex",range:a},(u,c,l)=>{let d=nE(this.serializer,c);s.size()<i||d.largestBatchId===o?(s.set(d.getKey(),d),o=d.largestBatchId):l.done()}).next(()=>s)}ht(e,n){return il(e).put(function(i,s,o){let[a,u,c]=aN(s,o.mutation.key);return{userId:s,collectionPath:u,documentId:c,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:Sl(i.ct,o.mutation)}}(this.serializer,this.userId,n))}};function il(t){return gt(t,"documentOverlays")}var Ur=class{constructor(){}Pt(e,n){this.It(e,n),n.Tt()}It(e,n){if("nullValue"in e)this.Et(n,5);else if("booleanValue"in e)this.Et(n,10),n.dt(e.booleanValue?1:0);else if("integerValue"in e)this.Et(n,15),n.dt(Be(e.integerValue));else if("doubleValue"in e){let r=Be(e.doubleValue);isNaN(r)?this.Et(n,13):(this.Et(n,15),ml(r)?n.dt(0):n.dt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Et(n,20),typeof r=="string"?n.At(r):(n.At(`${r.seconds||""}`),n.dt(r.nanos||0))}else if("stringValue"in e)this.Rt(e.stringValue,n),this.Vt(n);else if("bytesValue"in e)this.Et(n,30),n.ft(Mi(e.bytesValue)),this.Vt(n);else if("referenceValue"in e)this.gt(e.referenceValue,n);else if("geoPointValue"in e){let r=e.geoPointValue;this.Et(n,45),n.dt(r.latitude||0),n.dt(r.longitude||0)}else"mapValue"in e?WN(e)?this.Et(n,Number.MAX_SAFE_INTEGER):(this.yt(e.mapValue,n),this.Vt(n)):"arrayValue"in e?(this.wt(e.arrayValue,n),this.Vt(n)):O()}Rt(e,n){this.Et(n,25),this.St(e,n)}St(e,n){n.At(e)}yt(e,n){let r=e.fields||{};this.Et(n,55);for(let i of Object.keys(r))this.Rt(i,n),this.It(r[i],n)}wt(e,n){let r=e.values||[];this.Et(n,50);for(let i of r)this.It(i,n)}gt(e,n){this.Et(n,37),M.fromName(e).path.forEach(r=>{this.Et(n,60),this.St(r,n)})}Et(e,n){e.dt(n)}Vt(e){e.dt(2)}};Ur.bt=new Ur;function YG(t){if(t===0)return 8;let e=0;return!(t>>4)&&(e+=4,t<<=4),!(t>>6)&&(e+=2,t<<=2),!(t>>7)&&(e+=1),e}function dN(t){let e=64-function(r){let i=0;for(let s=0;s<8;++s){let o=YG(255&r[s]);if(i+=o,o!==8)break}return i}(t);return Math.ceil(e/8)}var HE=class{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Dt(e){let n=e[Symbol.iterator](),r=n.next();for(;!r.done;)this.Ct(r.value),r=n.next();this.vt()}Ft(e){let n=e[Symbol.iterator](),r=n.next();for(;!r.done;)this.Mt(r.value),r=n.next();this.xt()}Ot(e){for(let n of e){let r=n.charCodeAt(0);if(r<128)this.Ct(r);else if(r<2048)this.Ct(960|r>>>6),this.Ct(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Ct(480|r>>>12),this.Ct(128|63&r>>>6),this.Ct(128|63&r);else{let i=n.codePointAt(0);this.Ct(240|i>>>18),this.Ct(128|63&i>>>12),this.Ct(128|63&i>>>6),this.Ct(128|63&i)}}this.vt()}Nt(e){for(let n of e){let r=n.charCodeAt(0);if(r<128)this.Mt(r);else if(r<2048)this.Mt(960|r>>>6),this.Mt(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Mt(480|r>>>12),this.Mt(128|63&r>>>6),this.Mt(128|63&r);else{let i=n.codePointAt(0);this.Mt(240|i>>>18),this.Mt(128|63&i>>>12),this.Mt(128|63&i>>>6),this.Mt(128|63&i)}}this.xt()}Bt(e){let n=this.Lt(e),r=dN(n);this.kt(1+r),this.buffer[this.position++]=255&r;for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=255&n[i]}qt(e){let n=this.Lt(e),r=dN(n);this.kt(1+r),this.buffer[this.position++]=~(255&r);for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=~(255&n[i])}Qt(){this.Kt(255),this.Kt(255)}$t(){this.Ut(255),this.Ut(255)}reset(){this.position=0}seed(e){this.kt(e.length),this.buffer.set(e,this.position),this.position+=e.length}Wt(){return this.buffer.slice(0,this.position)}Lt(e){let n=function(s){let o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,s,!1),new Uint8Array(o.buffer)}(e),r=(128&n[0])!=0;n[0]^=r?255:128;for(let i=1;i<n.length;++i)n[i]^=r?255:0;return n}Ct(e){let n=255&e;n===0?(this.Kt(0),this.Kt(255)):n===255?(this.Kt(255),this.Kt(0)):this.Kt(n)}Mt(e){let n=255&e;n===0?(this.Ut(0),this.Ut(255)):n===255?(this.Ut(255),this.Ut(0)):this.Ut(e)}vt(){this.Kt(0),this.Kt(1)}xt(){this.Ut(0),this.Ut(1)}Kt(e){this.kt(1),this.buffer[this.position++]=e}Ut(e){this.kt(1),this.buffer[this.position++]=~e}kt(e){let n=e+this.position;if(n<=this.buffer.length)return;let r=2*this.buffer.length;r<n&&(r=n);let i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}},qE=class{constructor(e){this.Gt=e}ft(e){this.Gt.Dt(e)}At(e){this.Gt.Ot(e)}dt(e){this.Gt.Bt(e)}Tt(){this.Gt.Qt()}},GE=class{constructor(e){this.Gt=e}ft(e){this.Gt.Ft(e)}At(e){this.Gt.Nt(e)}dt(e){this.Gt.qt(e)}Tt(){this.Gt.$t()}},Fs=class{constructor(){this.Gt=new HE,this.zt=new qE(this.Gt),this.jt=new GE(this.Gt)}seed(e){this.Gt.seed(e)}Ht(e){return e===0?this.zt:this.jt}Wt(){return this.Gt.Wt()}reset(){this.Gt.reset()}};var Vs=class t{constructor(e,n,r,i){this.indexId=e,this.documentKey=n,this.arrayValue=r,this.directionalValue=i}Jt(){let e=this.directionalValue.length,n=e===0||this.directionalValue[e-1]===255?e+1:e,r=new Uint8Array(n);return r.set(this.directionalValue,0),n!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new t(this.indexId,this.documentKey,this.arrayValue,r)}};function Ii(t,e){let n=t.indexId-e.indexId;return n!==0?n:(n=hN(t.arrayValue,e.arrayValue),n!==0?n:(n=hN(t.directionalValue,e.directionalValue),n!==0?n:M.comparator(t.documentKey,e.documentKey)))}function hN(t,e){for(let n=0;n<t.length&&n<e.length;++n){let r=t[n]-e[n];if(r!==0)return r}return t.length-e.length}var Hp=class{constructor(e){this.Yt=new Se((n,r)=>We.comparator(n.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.Zt=e.orderBy,this.Xt=[];for(let n of e.filters){let r=n;r.isInequality()?this.Yt=this.Yt.add(r):this.Xt.push(r)}}get en(){return this.Yt.size>1}tn(e){if(L(e.collectionGroup===this.collectionId),this.en)return!1;let n=fE(e);if(n!==void 0&&!this.nn(n))return!1;let r=Ps(e),i=new Set,s=0,o=0;for(;s<r.length&&this.nn(r[s]);++s)i=i.add(r[s].fieldPath.canonicalString());if(s===r.length)return!0;if(this.Yt.size>0){let a=this.Yt.getIterator().getNext();if(!i.has(a.field.canonicalString())){let u=r[s];if(!this.rn(a,u)||!this.sn(this.Zt[o++],u))return!1}++s}for(;s<r.length;++s){let a=r[s];if(o>=this.Zt.length||!this.sn(this.Zt[o++],a))return!1}return!0}on(){if(this.en)return null;let e=new Se(We.comparator),n=[];for(let r of this.Xt)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")n.push(new Ra(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),n.push(new Ra(r.field,0))}for(let r of this.Zt)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),n.push(new Ra(r.field,r.dir==="asc"?0:1)));return new Oa(Oa.UNKNOWN_ID,this.collectionId,n,gl.empty())}nn(e){for(let n of this.Xt)if(this.rn(n,e))return!0;return!1}rn(e,n){if(e===void 0||!e.field.isEqual(n.fieldPath))return!1;let r=e.op==="array-contains"||e.op==="array-contains-any";return n.kind===2===r}sn(e,n){return!!e.field.isEqual(n.fieldPath)&&(n.kind===0&&e.dir==="asc"||n.kind===1&&e.dir==="desc")}};function NP(t){var e,n;if(L(t instanceof he||t instanceof De),t instanceof he){if(t instanceof Pp){let i=((n=(e=t.value.arrayValue)===null||e===void 0?void 0:e.values)===null||n===void 0?void 0:n.map(s=>he.create(t.field,"==",s)))||[];return De.create(i,"or")}return t}let r=t.filters.map(i=>NP(i));return De.create(r,t.op)}function ZG(t){if(t.getFilters().length===0)return[];let e=KE(NP(t));return L(PP(e)),zE(e)||WE(e)?[e]:e.getFilters()}function zE(t){return t instanceof he}function WE(t){return t instanceof De&&aC(t)}function PP(t){return zE(t)||WE(t)||function(n){if(n instanceof De&&EE(n)){for(let r of n.getFilters())if(!zE(r)&&!WE(r))return!1;return!0}return!1}(t)}function KE(t){if(L(t instanceof he||t instanceof De),t instanceof he)return t;if(t.filters.length===1)return KE(t.filters[0]);let e=t.filters.map(r=>KE(r)),n=De.create(e,t.op);return n=qp(n),PP(n)?n:(L(n instanceof De),L(Va(n)),L(n.filters.length>1),n.filters.reduce((r,i)=>hC(r,i)))}function hC(t,e){let n;return L(t instanceof he||t instanceof De),L(e instanceof he||e instanceof De),n=t instanceof he?e instanceof he?function(i,s){return De.create([i,s],"and")}(t,e):fN(t,e):e instanceof he?fN(e,t):function(i,s){if(L(i.filters.length>0&&s.filters.length>0),Va(i)&&Va(s))return ZN(i,s.getFilters());let o=EE(i)?i:s,a=EE(i)?s:i,u=o.filters.map(c=>hC(c,a));return De.create(u,"or")}(t,e),qp(n)}function fN(t,e){if(Va(e))return ZN(e,t.getFilters());{let n=e.filters.map(r=>hC(t,r));return De.create(n,"or")}}function qp(t){if(L(t instanceof he||t instanceof De),t instanceof he)return t;let e=t.getFilters();if(e.length===1)return qp(e[0]);if(QN(t))return t;let n=e.map(i=>qp(i)),r=[];return n.forEach(i=>{i instanceof he?r.push(i):i instanceof De&&(i.op===t.op?r.push(...i.filters):r.push(i))}),r.length===1?r[0]:De.create(r,t.op)}var QE=class{constructor(){this._n=new Al}addToCollectionParentIndex(e,n){return this._n.add(n),m.resolve()}getCollectionParents(e,n){return m.resolve(this._n.getEntries(n))}addFieldIndex(e,n){return m.resolve()}deleteFieldIndex(e,n){return m.resolve()}deleteAllFieldIndexes(e){return m.resolve()}createTargetIndexes(e,n){return m.resolve()}getDocumentsMatchingTarget(e,n){return m.resolve(null)}getIndexType(e,n){return m.resolve(0)}getFieldIndexes(e,n){return m.resolve([])}getNextCollectionGroupToUpdate(e){return m.resolve(null)}getMinOffset(e,n){return m.resolve(Tn.min())}getMinOffsetFromCollectionGroup(e,n){return m.resolve(Tn.min())}updateCollectionGroup(e,n,r){return m.resolve()}updateIndexEntries(e,n){return m.resolve()}},Al=class{constructor(){this.index={}}add(e){let n=e.lastSegment(),r=e.popLast(),i=this.index[n]||new Se(me.comparator),s=!i.has(r);return this.index[n]=i.add(r),s}has(e){let n=e.lastSegment(),r=e.popLast(),i=this.index[n];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Se(me.comparator)).toArray()}};var gp=new Uint8Array(0),YE=class{constructor(e,n){this.databaseId=n,this.an=new Al,this.un=new _r(r=>Hs(r),(r,i)=>jl(r,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,n){if(!this.an.has(n)){let r=n.lastSegment(),i=n.popLast();e.addOnCommittedListener(()=>{this.an.add(n)});let s={collectionId:r,parent:Ut(i)};return pN(e).put(s)}return m.resolve()}getCollectionParents(e,n){let r=[],i=IDBKeyRange.bound([n,""],[FN(n),""],!1,!0);return pN(e).W(i).next(s=>{for(let o of s){if(o.collectionId!==n)break;r.push(dr(o.parent))}return r})}addFieldIndex(e,n){let r=sl(e),i=function(a){return{indexId:a.indexId,collectionGroup:a.collectionGroup,fields:a.fields.map(u=>[u.fieldPath.canonicalString(),u.kind])}}(n);delete i.indexId;let s=r.add(i);if(n.indexState){let o=Ca(e);return s.next(a=>{o.put(uN(a,this.uid,n.indexState.sequenceNumber,n.indexState.offset))})}return s.next()}deleteFieldIndex(e,n){let r=sl(e),i=Ca(e),s=Ia(e);return r.delete(n.indexId).next(()=>i.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0))).next(()=>s.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){let n=sl(e),r=Ia(e),i=Ca(e);return n.H().next(()=>r.H()).next(()=>i.H())}createTargetIndexes(e,n){return m.forEach(this.cn(n),r=>this.getIndexType(e,r).next(i=>{if(i===0||i===1){let s=new Hp(r).on();if(s!=null)return this.addFieldIndex(e,s)}}))}getDocumentsMatchingTarget(e,n){let r=Ia(e),i=!0,s=new Map;return m.forEach(this.cn(n),o=>this.ln(e,o).next(a=>{i&&(i=!!a),s.set(o,a)})).next(()=>{if(i){let o=ee(),a=[];return m.forEach(s,(u,c)=>{D("IndexedDbIndexManager",`Using index ${function(A){return`id=${A.indexId}|cg=${A.collectionGroup}|f=${A.fields.map(H=>`${H.fieldPath}:${H.kind}`).join(",")}`}(u)} to execute ${Hs(n)}`);let l=function(A,H){let G=fE(H);if(G===void 0)return null;for(let J of Op(A,G.fieldPath))switch(J.op){case"array-contains-any":return J.value.arrayValue.values||[];case"array-contains":return[J.value]}return null}(c,u),d=function(A,H){let G=new Map;for(let J of Ps(H))for(let Pe of Op(A,J.fieldPath))switch(Pe.op){case"==":case"in":G.set(J.fieldPath.canonicalString(),Pe.value);break;case"not-in":case"!=":return G.set(J.fieldPath.canonicalString(),Pe.value),Array.from(G.values())}return null}(c,u),h=function(A,H){let G=[],J=!0;for(let Pe of Ps(H)){let dn=Pe.kind===0?WR(A,Pe.fieldPath,A.startAt):KR(A,Pe.fieldPath,A.startAt);G.push(dn.value),J&&(J=dn.inclusive)}return new yr(G,J)}(c,u),f=function(A,H){let G=[],J=!0;for(let Pe of Ps(H)){let dn=Pe.kind===0?KR(A,Pe.fieldPath,A.endAt):WR(A,Pe.fieldPath,A.endAt);G.push(dn.value),J&&(J=dn.inclusive)}return new yr(G,J)}(c,u),p=this.hn(u,c,h),g=this.hn(u,c,f),_=this.Pn(u,c,d),b=this.In(u.indexId,l,p,h.inclusive,g,f.inclusive,_);return m.forEach(b,P=>r.j(P,n.limit).next(A=>{A.forEach(H=>{let G=M.fromSegments(H.documentKey);o.has(G)||(o=o.add(G),a.push(G))})}))}).next(()=>a)}return m.resolve(null)})}cn(e){let n=this.un.get(e);return n||(e.filters.length===0?n=[e]:n=ZG(De.create(e.filters,"and")).map(r=>ME(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.un.set(e,n),n)}In(e,n,r,i,s,o,a){let u=(n!=null?n.length:1)*Math.max(r.length,s.length),c=u/(n!=null?n.length:1),l=[];for(let d=0;d<u;++d){let h=n?this.Tn(n[d/c]):gp,f=this.En(e,h,r[d%c],i),p=this.dn(e,h,s[d%c],o),g=a.map(_=>this.En(e,h,_,!0));l.push(...this.createRange(f,p,g))}return l}En(e,n,r,i){let s=new Vs(e,M.empty(),n,r);return i?s:s.Jt()}dn(e,n,r,i){let s=new Vs(e,M.empty(),n,r);return i?s.Jt():s}ln(e,n){let r=new Hp(n),i=n.collectionGroup!=null?n.collectionGroup:n.path.lastSegment();return this.getFieldIndexes(e,i).next(s=>{let o=null;for(let a of s)r.tn(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o})}getIndexType(e,n){let r=2,i=this.cn(n);return m.forEach(i,s=>this.ln(e,s).next(o=>{o?r!==0&&o.fields.length<function(u){let c=new Se(We.comparator),l=!1;for(let d of u.filters)for(let h of d.getFlattenedFilters())h.field.isKeyField()||(h.op==="array-contains"||h.op==="array-contains-any"?l=!0:c=c.add(h.field));for(let d of u.orderBy)d.field.isKeyField()||(c=c.add(d.field));return c.size+(l?1:0)}(s)&&(r=1):r=0})).next(()=>function(o){return o.limit!==null}(n)&&i.length>1&&r===2?1:r)}An(e,n){let r=new Fs;for(let i of Ps(e)){let s=n.data.field(i.fieldPath);if(s==null)return null;let o=r.Ht(i.kind);Ur.bt.Pt(s,o)}return r.Wt()}Tn(e){let n=new Fs;return Ur.bt.Pt(e,n.Ht(0)),n.Wt()}Rn(e,n){let r=new Fs;return Ur.bt.Pt(Bs(this.databaseId,n),r.Ht(function(s){let o=Ps(s);return o.length===0?0:o[o.length-1].kind}(e))),r.Wt()}Pn(e,n,r){if(r===null)return[];let i=[];i.push(new Fs);let s=0;for(let o of Ps(e)){let a=r[s++];for(let u of i)if(this.Vn(n,o.fieldPath)&&wl(a))i=this.mn(i,o,a);else{let c=u.Ht(o.kind);Ur.bt.Pt(a,c)}}return this.fn(i)}hn(e,n,r){return this.Pn(e,n,r.position)}fn(e){let n=[];for(let r=0;r<e.length;++r)n[r]=e[r].Wt();return n}mn(e,n,r){let i=[...e],s=[];for(let o of r.arrayValue.values||[])for(let a of i){let u=new Fs;u.seed(a.Wt()),Ur.bt.Pt(o,u.Ht(n.kind)),s.push(u)}return s}Vn(e,n){return!!e.filters.find(r=>r instanceof he&&r.field.isEqual(n)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,n){let r=sl(e),i=Ca(e);return(n?r.W("collectionGroupIndex",IDBKeyRange.bound(n,n)):r.W()).next(s=>{let o=[];return m.forEach(s,a=>i.get([a.indexId,this.uid]).next(u=>{o.push(function(l,d){let h=d?new gl(d.sequenceNumber,new Tn(zs(d.readTime),new M(dr(d.documentKey)),d.largestBatchId)):gl.empty(),f=l.fields.map(([p,g])=>new Ra(We.fromServerFormat(p),g));return new Oa(l.indexId,l.collectionGroup,f,h)}(a,u))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(n=>n.length===0?null:(n.sort((r,i)=>{let s=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return s!==0?s:Z(r.collectionGroup,i.collectionGroup)}),n[0].collectionGroup))}updateCollectionGroup(e,n,r){let i=sl(e),s=Ca(e);return this.gn(e).next(o=>i.W("collectionGroupIndex",IDBKeyRange.bound(n,n)).next(a=>m.forEach(a,u=>s.put(uN(u.indexId,this.uid,o,r)))))}updateIndexEntries(e,n){let r=new Map;return m.forEach(n,(i,s)=>{let o=r.get(i.collectionGroup);return(o?m.resolve(o):this.getFieldIndexes(e,i.collectionGroup)).next(a=>(r.set(i.collectionGroup,a),m.forEach(a,u=>this.pn(e,i,u).next(c=>{let l=this.yn(s,u);return c.isEqual(l)?m.resolve():this.wn(e,s,u,c,l)}))))})}Sn(e,n,r,i){return Ia(e).put({indexId:i.indexId,uid:this.uid,arrayValue:i.arrayValue,directionalValue:i.directionalValue,orderedDocumentKey:this.Rn(r,n.key),documentKey:n.key.path.toArray()})}bn(e,n,r,i){return Ia(e).delete([i.indexId,this.uid,i.arrayValue,i.directionalValue,this.Rn(r,n.key),n.key.path.toArray()])}pn(e,n,r){let i=Ia(e),s=new Se(Ii);return i.Y({index:"documentKeyIndex",range:IDBKeyRange.only([r.indexId,this.uid,this.Rn(r,n)])},(o,a)=>{s=s.add(new Vs(r.indexId,n,a.arrayValue,a.directionalValue))}).next(()=>s)}yn(e,n){let r=new Se(Ii),i=this.An(n,e);if(i==null)return r;let s=fE(n);if(s!=null){let o=e.data.field(s.fieldPath);if(wl(o))for(let a of o.arrayValue.values||[])r=r.add(new Vs(n.indexId,e.key,this.Tn(a),i))}else r=r.add(new Vs(n.indexId,e.key,gp,i));return r}wn(e,n,r,i,s){D("IndexedDbIndexManager","Updating index entries for document '%s'",n.key);let o=[];return function(u,c,l,d,h){let f=u.getIterator(),p=c.getIterator(),g=Ea(f),_=Ea(p);for(;g||_;){let b=!1,P=!1;if(g&&_){let A=l(g,_);A<0?P=!0:A>0&&(b=!0)}else g!=null?P=!0:b=!0;b?(d(_),_=Ea(p)):P?(h(g),g=Ea(f)):(g=Ea(f),_=Ea(p))}}(i,s,Ii,a=>{o.push(this.Sn(e,n,r,a))},a=>{o.push(this.bn(e,n,r,a))}),m.waitFor(o)}gn(e){let n=1;return Ca(e).Y({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,i,s)=>{s.done(),n=i.sequenceNumber+1}).next(()=>n)}createRange(e,n,r){r=r.sort((o,a)=>Ii(o,a)).filter((o,a,u)=>!a||Ii(o,u[a-1])!==0);let i=[];i.push(e);for(let o of r){let a=Ii(o,e),u=Ii(o,n);if(a===0)i[0]=e.Jt();else if(a>0&&u<0)i.push(o),i.push(o.Jt());else if(u>0)break}i.push(n);let s=[];for(let o=0;o<i.length;o+=2){if(this.Dn(i[o],i[o+1]))return[];let a=[i[o].indexId,this.uid,i[o].arrayValue,i[o].directionalValue,gp,[]],u=[i[o+1].indexId,this.uid,i[o+1].arrayValue,i[o+1].directionalValue,gp,[]];s.push(IDBKeyRange.bound(a,u))}return s}Dn(e,n){return Ii(e,n)>0}getMinOffsetFromCollectionGroup(e,n){return this.getFieldIndexes(e,n).next(gN)}getMinOffset(e,n){return m.mapArray(this.cn(n),r=>this.ln(e,r).next(i=>i||O())).next(gN)}};function pN(t){return gt(t,"collectionParents")}function Ia(t){return gt(t,"indexEntries")}function sl(t){return gt(t,"indexConfiguration")}function Ca(t){return gt(t,"indexState")}function gN(t){L(t.length!==0);let e=t[0].indexState.offset,n=e.largestBatchId;for(let r=1;r<t.length;r++){let i=t[r].indexState.offset;iC(i,e)<0&&(e=i),n<i.largestBatchId&&(n=i.largestBatchId)}return new Tn(e.readTime,e.documentKey,n)}var mN={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Cn=class t{constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new t(e,t.DEFAULT_COLLECTION_PERCENTILE,t.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}};function kP(t,e,n){let r=t.store("mutations"),i=t.store("documentMutations"),s=[],o=IDBKeyRange.only(n.batchId),a=0,u=r.Y({range:o},(l,d,h)=>(a++,h.delete()));s.push(u.next(()=>{L(a===1)}));let c=[];for(let l of n.mutations){let d=BN(e,l.key.path,n.batchId);s.push(i.delete(d)),c.push(l.key)}return m.waitFor(s).next(()=>c)}function Gp(t){if(!t)return 0;let e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw O();e=t.noDocument}return JSON.stringify(e).length}Cn.DEFAULT_COLLECTION_PERCENTILE=10,Cn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Cn.DEFAULT=new Cn(41943040,Cn.DEFAULT_COLLECTION_PERCENTILE,Cn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Cn.DISABLED=new Cn(-1,0,0);var zp=class t{constructor(e,n,r,i){this.userId=e,this.serializer=n,this.indexManager=r,this.referenceDelegate=i,this.Cn={}}static lt(e,n,r,i){L(e.uid!=="");let s=e.isAuthenticated()?e.uid:"";return new t(s,n,r,i)}checkEmpty(e){let n=!0,r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Ci(e).Y({index:"userMutationsIndex",range:r},(i,s,o)=>{n=!1,o.done()}).next(()=>n)}addMutationBatch(e,n,r,i){let s=xa(e),o=Ci(e);return o.add({}).next(a=>{L(typeof a=="number");let u=new Il(a,n,r,i),c=function(f,p,g){let _=g.baseMutations.map(P=>Sl(f.ct,P)),b=g.mutations.map(P=>Sl(f.ct,P));return{userId:p,batchId:g.batchId,localWriteTimeMs:g.localWriteTime.toMillis(),baseMutations:_,mutations:b}}(this.serializer,this.userId,u),l=[],d=new Se((h,f)=>Z(h.canonicalString(),f.canonicalString()));for(let h of i){let f=BN(this.userId,h.key.path,a);d=d.add(h.key.path.popLast()),l.push(o.put(c)),l.push(s.put(f,iG))}return d.forEach(h=>{l.push(this.indexManager.addToCollectionParentIndex(e,h))}),e.addOnCommittedListener(()=>{this.Cn[a]=u.keys()}),m.waitFor(l).next(()=>u)})}lookupMutationBatch(e,n){return Ci(e).get(n).next(r=>r?(L(r.userId===this.userId),Os(this.serializer,r)):null)}vn(e,n){return this.Cn[n]?m.resolve(this.Cn[n]):this.lookupMutationBatch(e,n).next(r=>{if(r){let i=r.keys();return this.Cn[n]=i,i}return null})}getNextMutationBatchAfterBatchId(e,n){let r=n+1,i=IDBKeyRange.lowerBound([this.userId,r]),s=null;return Ci(e).Y({index:"userMutationsIndex",range:i},(o,a,u)=>{a.userId===this.userId&&(L(a.batchId>=r),s=Os(this.serializer,a)),u.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(e){let n=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),r=-1;return Ci(e).Y({index:"userMutationsIndex",range:n,reverse:!0},(i,s,o)=>{r=s.batchId,o.done()}).next(()=>r)}getAllMutationBatches(e){let n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Ci(e).W("userMutationsIndex",n).next(r=>r.map(i=>Os(this.serializer,i)))}getAllMutationBatchesAffectingDocumentKey(e,n){let r=vp(this.userId,n.path),i=IDBKeyRange.lowerBound(r),s=[];return xa(e).Y({range:i},(o,a,u)=>{let[c,l,d]=o,h=dr(l);if(c===this.userId&&n.path.isEqual(h))return Ci(e).get(d).next(f=>{if(!f)throw O();L(f.userId===this.userId),s.push(Os(this.serializer,f))});u.done()}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Se(Z),i=[];return n.forEach(s=>{let o=vp(this.userId,s.path),a=IDBKeyRange.lowerBound(o),u=xa(e).Y({range:a},(c,l,d)=>{let[h,f,p]=c,g=dr(f);h===this.userId&&s.path.isEqual(g)?r=r.add(p):d.done()});i.push(u)}),m.waitFor(i).next(()=>this.Fn(e,r))}getAllMutationBatchesAffectingQuery(e,n){let r=n.path,i=r.length+1,s=vp(this.userId,r),o=IDBKeyRange.lowerBound(s),a=new Se(Z);return xa(e).Y({range:o},(u,c,l)=>{let[d,h,f]=u,p=dr(h);d===this.userId&&r.isPrefixOf(p)?p.length===i&&(a=a.add(f)):l.done()}).next(()=>this.Fn(e,a))}Fn(e,n){let r=[],i=[];return n.forEach(s=>{i.push(Ci(e).get(s).next(o=>{if(o===null)throw O();L(o.userId===this.userId),r.push(Os(this.serializer,o))}))}),m.waitFor(i).next(()=>r)}removeMutationBatch(e,n){return kP(e.ae,this.userId,n).next(r=>(e.addOnCommittedListener(()=>{this.Mn(n.batchId)}),m.forEach(r,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}Mn(e){delete this.Cn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(n=>{if(!n)return m.resolve();let r=IDBKeyRange.lowerBound(function(o){return[o]}(this.userId)),i=[];return xa(e).Y({range:r},(s,o,a)=>{if(s[0]===this.userId){let u=dr(s[1]);i.push(u)}else a.done()}).next(()=>{L(i.length===0)})})}containsKey(e,n){return OP(e,this.userId,n)}xn(e){return FP(e).get(this.userId).next(n=>n||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}};function OP(t,e,n){let r=vp(e,n.path),i=r[1],s=IDBKeyRange.lowerBound(r),o=!1;return xa(t).Y({range:s,J:!0},(a,u,c)=>{let[l,d,h]=a;l===e&&d===i&&(o=!0),c.done()}).next(()=>o)}function Ci(t){return gt(t,"mutations")}function xa(t){return gt(t,"documentMutations")}function FP(t){return gt(t,"mutationQueues")}var $a=class t{constructor(e){this.On=e}next(){return this.On+=2,this.On}static Nn(){return new t(0)}static Bn(){return new t(-1)}};var ZE=class{constructor(e,n){this.referenceDelegate=e,this.serializer=n}allocateTargetId(e){return this.Ln(e).next(n=>{let r=new $a(n.highestTargetId);return n.highestTargetId=r.next(),this.kn(e,n).next(()=>n.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.Ln(e).next(n=>B.fromTimestamp(new Le(n.lastRemoteSnapshotVersion.seconds,n.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.Ln(e).next(n=>n.highestListenSequenceNumber)}setTargetsMetadata(e,n,r){return this.Ln(e).next(i=>(i.highestListenSequenceNumber=n,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),n>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=n),this.kn(e,i)))}addTargetData(e,n){return this.qn(e,n).next(()=>this.Ln(e).next(r=>(r.targetCount+=1,this.Qn(n,r),this.kn(e,r))))}updateTargetData(e,n){return this.qn(e,n)}removeTargetData(e,n){return this.removeMatchingKeysForTargetId(e,n.targetId).next(()=>Da(e).delete(n.targetId)).next(()=>this.Ln(e)).next(r=>(L(r.targetCount>0),r.targetCount-=1,this.kn(e,r)))}removeTargets(e,n,r){let i=0,s=[];return Da(e).Y((o,a)=>{let u=cl(a);u.sequenceNumber<=n&&r.get(u.targetId)===null&&(i++,s.push(this.removeTargetData(e,u)))}).next(()=>m.waitFor(s)).next(()=>i)}forEachTarget(e,n){return Da(e).Y((r,i)=>{let s=cl(i);n(s)})}Ln(e){return yN(e).get("targetGlobalKey").next(n=>(L(n!==null),n))}kn(e,n){return yN(e).put("targetGlobalKey",n)}qn(e,n){return Da(e).put(RP(this.serializer,n))}Qn(e,n){let r=!1;return e.targetId>n.highestTargetId&&(n.highestTargetId=e.targetId,r=!0),e.sequenceNumber>n.highestListenSequenceNumber&&(n.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.Ln(e).next(n=>n.targetCount)}getTargetData(e,n){let r=Hs(n),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]),s=null;return Da(e).Y({range:i,index:"queryTargetsIndex"},(o,a,u)=>{let c=cl(a);jl(n,c.target)&&(s=c,u.done())}).next(()=>s)}addMatchingKeys(e,n,r){let i=[],s=Di(e);return n.forEach(o=>{let a=Ut(o.path);i.push(s.put({targetId:r,path:a})),i.push(this.referenceDelegate.addReference(e,r,o))}),m.waitFor(i)}removeMatchingKeys(e,n,r){let i=Di(e);return m.forEach(n,s=>{let o=Ut(s.path);return m.waitFor([i.delete([r,o]),this.referenceDelegate.removeReference(e,r,s)])})}removeMatchingKeysForTargetId(e,n){let r=Di(e),i=IDBKeyRange.bound([n],[n+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,n){let r=IDBKeyRange.bound([n],[n+1],!1,!0),i=Di(e),s=ee();return i.Y({range:r,J:!0},(o,a,u)=>{let c=dr(o[1]),l=new M(c);s=s.add(l)}).next(()=>s)}containsKey(e,n){let r=Ut(n.path),i=IDBKeyRange.bound([r],[FN(r)],!1,!0),s=0;return Di(e).Y({index:"documentTargetsIndex",J:!0,range:i},([o,a],u,c)=>{o!==0&&(s++,c.done())}).next(()=>s>0)}_t(e,n){return Da(e).get(n).next(r=>r?cl(r):null)}};function Da(t){return gt(t,"targets")}function yN(t){return gt(t,"targetGlobal")}function Di(t){return gt(t,"targetDocuments")}function _N([t,e],[n,r]){let i=Z(t,n);return i===0?Z(e,r):i}var XE=class{constructor(e){this.Kn=e,this.buffer=new Se(_N),this.$n=0}Un(){return++this.$n}Wn(e){let n=[e,this.Un()];if(this.buffer.size<this.Kn)this.buffer=this.buffer.add(n);else{let r=this.buffer.last();_N(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}},JE=class{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.Gn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.zn(6e4)}stop(){this.Gn&&(this.Gn.cancel(),this.Gn=null)}get started(){return this.Gn!==null}zn(e){D("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.Gn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,()=>v(this,null,function*(){this.Gn=null;try{yield this.localStore.collectGarbage(this.garbageCollector)}catch(n){ji(n)?D("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",n):yield Li(n)}yield this.zn(3e5)}))}},eI=class{constructor(e,n){this.jn=e,this.params=n}calculateTargetCount(e,n){return this.jn.Hn(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(n===0)return m.resolve(sn._e);let r=new XE(n);return this.jn.forEachTarget(e,i=>r.Wn(i.sequenceNumber)).next(()=>this.jn.Jn(e,i=>r.Wn(i))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.jn.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.jn.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(D("LruGarbageCollector","Garbage collection skipped; disabled"),m.resolve(mN)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(D("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),mN):this.Yn(e,n))}getCacheSize(e){return this.jn.getCacheSize(e)}Yn(e,n){let r,i,s,o,a,u,c,l=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(d=>(d>this.params.maximumSequenceNumbersToCollect?(D("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${d}`),i=this.params.maximumSequenceNumbersToCollect):i=d,o=Date.now(),this.nthSequenceNumber(e,i))).next(d=>(r=d,a=Date.now(),this.removeTargets(e,r,n))).next(d=>(s=d,u=Date.now(),this.removeOrphanedDocuments(e,r))).next(d=>(c=Date.now(),Ta()<=fn.DEBUG&&D("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-l}ms
	Determined least recently used ${i} in `+(a-o)+`ms
	Removed ${s} targets in `+(u-a)+`ms
	Removed ${d} documents in `+(c-u)+`ms
Total Duration: ${c-l}ms`),m.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:d})))}};function XG(t,e){return new eI(t,e)}var tI=class{constructor(e,n){this.db=e,this.garbageCollector=XG(this,n)}Hn(e){let n=this.Zn(e);return this.db.getTargetCache().getTargetCount(e).next(r=>n.next(i=>r+i))}Zn(e){let n=0;return this.Jn(e,r=>{n++}).next(()=>n)}forEachTarget(e,n){return this.db.getTargetCache().forEachTarget(e,n)}Jn(e,n){return this.Xn(e,(r,i)=>n(i))}addReference(e,n,r){return mp(e,r)}removeReference(e,n,r){return mp(e,r)}removeTargets(e,n,r){return this.db.getTargetCache().removeTargets(e,n,r)}markPotentiallyOrphaned(e,n){return mp(e,n)}er(e,n){return function(i,s){let o=!1;return FP(i).Z(a=>OP(i,a,s).next(u=>(u&&(o=!0),m.resolve(!u)))).next(()=>o)}(e,n)}removeOrphanedDocuments(e,n){let r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[],s=0;return this.Xn(e,(o,a)=>{if(a<=n){let u=this.er(e,o).next(c=>{if(!c)return s++,r.getEntry(e,o).next(()=>(r.removeEntry(o,B.min()),Di(e).delete(function(d){return[0,Ut(d.path)]}(o))))});i.push(u)}}).next(()=>m.waitFor(i)).next(()=>r.apply(e)).next(()=>s)}removeTarget(e,n){let r=n.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,n){return mp(e,n)}Xn(e,n){let r=Di(e),i,s=sn._e;return r.Y({index:"documentTargetsIndex"},([o,a],{path:u,sequenceNumber:c})=>{o===0?(s!==sn._e&&n(new M(dr(i)),s),s=c,i=u):s=sn._e}).next(()=>{s!==sn._e&&n(new M(dr(i)),s)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}};function mp(t,e){return Di(t).put(function(r,i){return{targetId:0,path:Ut(r.path),sequenceNumber:i}}(e,t.currentSequenceNumber))}var Wp=class{constructor(){this.changes=new _r(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,ot.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();let r=this.changes.get(n);return r!==void 0?m.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var nI=class{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,n,r){return Ns(e).put(r)}removeEntry(e,n,r){return Ns(e).delete(function(s,o){let a=s.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],Bp(o),a[a.length-1]]}(n,r))}updateMetadata(e,n){return this.getMetadata(e).next(r=>(r.byteSize+=n,this.tr(e,r)))}getEntry(e,n){let r=ot.newInvalidDocument(n);return Ns(e).Y({index:"documentKeyIndex",range:IDBKeyRange.only(ol(n))},(i,s)=>{r=this.nr(n,s)}).next(()=>r)}rr(e,n){let r={size:0,document:ot.newInvalidDocument(n)};return Ns(e).Y({index:"documentKeyIndex",range:IDBKeyRange.only(ol(n))},(i,s)=>{r={document:this.nr(n,s),size:Gp(s)}}).next(()=>r)}getEntries(e,n){let r=Zt();return this.ir(e,n,(i,s)=>{let o=this.nr(i,s);r=r.insert(i,o)}).next(()=>r)}sr(e,n){let r=Zt(),i=new Ne(M.comparator);return this.ir(e,n,(s,o)=>{let a=this.nr(s,o);r=r.insert(s,a),i=i.insert(s,Gp(o))}).next(()=>({documents:r,_r:i}))}ir(e,n,r){if(n.isEmpty())return m.resolve();let i=new Se(EN);n.forEach(u=>i=i.add(u));let s=IDBKeyRange.bound(ol(i.first()),ol(i.last())),o=i.getIterator(),a=o.getNext();return Ns(e).Y({index:"documentKeyIndex",range:s},(u,c,l)=>{let d=M.fromSegments([...c.prefixPath,c.collectionGroup,c.documentId]);for(;a&&EN(a,d)<0;)r(a,null),a=o.getNext();a&&a.isEqual(d)&&(r(a,c),a=o.hasNext()?o.getNext():null),a?l.U(ol(a)):l.done()}).next(()=>{for(;a;)r(a,null),a=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,n,r,i,s){let o=n.path,a=[o.popLast().toArray(),o.lastSegment(),Bp(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],u=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Ns(e).W(IDBKeyRange.bound(a,u,!0)).next(c=>{s?.incrementDocumentReadCount(c.length);let l=Zt();for(let d of c){let h=this.nr(M.fromSegments(d.prefixPath.concat(d.collectionGroup,d.documentId)),d);h.isFoundDocument()&&(Bl(n,h)||i.has(h.key))&&(l=l.insert(h.key,h))}return l})}getAllFromCollectionGroup(e,n,r,i){let s=Zt(),o=wN(n,r),a=wN(n,Tn.max());return Ns(e).Y({index:"collectionGroupIndex",range:IDBKeyRange.bound(o,a,!0)},(u,c,l)=>{let d=this.nr(M.fromSegments(c.prefixPath.concat(c.collectionGroup,c.documentId)),c);s=s.insert(d.key,d),s.size===i&&l.done()}).next(()=>s)}newChangeBuffer(e){return new rI(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(n=>n.byteSize)}getMetadata(e){return vN(e).get("remoteDocumentGlobalKey").next(n=>(L(!!n),n))}tr(e,n){return vN(e).put("remoteDocumentGlobalKey",n)}nr(e,n){if(n){let r=QG(this.serializer,n);if(!(r.isNoDocument()&&r.version.isEqual(B.min())))return r}return ot.newInvalidDocument(e)}};function VP(t){return new nI(t)}var rI=class extends Wp{constructor(e,n){super(),this.ar=e,this.trackRemovals=n,this.ur=new _r(r=>r.toString(),(r,i)=>r.isEqual(i))}applyChanges(e){let n=[],r=0,i=new Se((s,o)=>Z(s.canonicalString(),o.canonicalString()));return this.changes.forEach((s,o)=>{let a=this.ur.get(s);if(n.push(this.ar.removeEntry(e,s,a.readTime)),o.isValidDocument()){let u=oN(this.ar.serializer,o);i=i.add(s.path.popLast());let c=Gp(u);r+=c-a.size,n.push(this.ar.addEntry(e,s,u))}else if(r-=a.size,this.trackRemovals){let u=oN(this.ar.serializer,o.convertToNoDocument(B.min()));n.push(this.ar.addEntry(e,s,u))}}),i.forEach(s=>{n.push(this.ar.indexManager.addToCollectionParentIndex(e,s))}),n.push(this.ar.updateMetadata(e,r)),m.waitFor(n)}getFromCache(e,n){return this.ar.rr(e,n).next(r=>(this.ur.set(n,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,n){return this.ar.sr(e,n).next(({documents:r,_r:i})=>(i.forEach((s,o)=>{this.ur.set(s,{size:o,readTime:r.get(s).readTime})}),r))}};function vN(t){return gt(t,"remoteDocumentGlobal")}function Ns(t){return gt(t,"remoteDocumentsV14")}function ol(t){let e=t.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function wN(t,e){let n=e.documentKey.path.toArray();return[t,Bp(e.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function EN(t,e){let n=t.path.toArray(),r=e.path.toArray(),i=0;for(let s=0;s<n.length-2&&s<r.length-2;++s)if(i=Z(n[s],r[s]),i)return i;return i=Z(n.length,r.length),i||(i=Z(n[n.length-2],r[r.length-2]),i||Z(n[n.length-1],r[r.length-1]))}var iI=class{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}};var Kp=class{constructor(e,n,r,i){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,n))).next(i=>(r!==null&&hl(r.mutation,i,on.empty(),Le.now()),i))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,ee()).next(()=>r))}getLocalViewOfDocuments(e,n,r=ee()){let i=hr();return this.populateOverlays(e,i,n).next(()=>this.computeViews(e,n,i,r).next(s=>{let o=ul();return s.forEach((a,u)=>{o=o.insert(a,u.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){let r=hr();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,ee()))}populateOverlays(e,n,r){let i=[];return r.forEach(s=>{n.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,a)=>{n.set(o,a)})})}computeViews(e,n,r,i){let s=Zt(),o=dl(),a=function(){return dl()}();return n.forEach((u,c)=>{let l=r.get(c.key);i.has(c.key)&&(l===void 0||l.mutation instanceof Hn)?s=s.insert(c.key,c):l!==void 0?(o.set(c.key,l.mutation.getFieldMask()),hl(l.mutation,c,l.mutation.getFieldMask(),Le.now())):o.set(c.key,on.empty())}),this.recalculateAndSaveOverlays(e,s).next(u=>(u.forEach((c,l)=>o.set(c,l)),n.forEach((c,l)=>{var d;return a.set(c,new iI(l,(d=o.get(c))!==null&&d!==void 0?d:null))}),a))}recalculateAndSaveOverlays(e,n){let r=dl(),i=new Ne((o,a)=>o-a),s=ee();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(let a of o)a.keys().forEach(u=>{let c=n.get(u);if(c===null)return;let l=r.get(u)||on.empty();l=a.applyToLocalView(c,l),r.set(u,l);let d=(i.get(a.batchId)||ee()).add(u);i=i.insert(a.batchId,d)})}).next(()=>{let o=[],a=i.getReverseIterator();for(;a.hasNext();){let u=a.getNext(),c=u.key,l=u.value,d=oP();l.forEach(h=>{if(!s.has(h)){let f=pP(n.get(h),r.get(h));f!==null&&d.set(h,f),s=s.add(h)}}),o.push(this.documentOverlayCache.saveOverlays(e,c,d))}return m.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,i){return function(o){return M.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):uC(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,i):this.getDocumentsMatchingCollectionQuery(e,n,r,i)}getNextDocuments(e,n,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,i).next(s=>{let o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,i-s.size):m.resolve(hr()),a=-1,u=s;return o.next(c=>m.forEach(c,(l,d)=>(a<d.largestBatchId&&(a=d.largestBatchId),s.get(l)?m.resolve():this.remoteDocumentCache.getEntry(e,l).next(h=>{u=u.insert(l,h)}))).next(()=>this.populateOverlays(e,c,s)).next(()=>this.computeViews(e,u,c,ee())).next(l=>({batchId:a,changes:sP(l)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new M(n)).next(r=>{let i=ul();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,n,r,i){let s=n.collectionGroup,o=ul();return this.indexManager.getCollectionParents(e,s).next(a=>m.forEach(a,u=>{let c=function(d,h){return new $n(h,null,d.explicitOrderBy.slice(),d.filters.slice(),d.limit,d.limitType,d.startAt,d.endAt)}(n,u.child(s));return this.getDocumentsMatchingCollectionQuery(e,c,r,i).next(l=>{l.forEach((d,h)=>{o=o.insert(d,h)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,s,i))).next(o=>{s.forEach((u,c)=>{let l=c.getKey();o.get(l)===null&&(o=o.insert(l,ot.newInvalidDocument(l)))});let a=ul();return o.forEach((u,c)=>{let l=s.get(u);l!==void 0&&hl(l.mutation,c,on.empty(),Le.now()),Bl(n,c)&&(a=a.insert(u,c))}),a})}};var sI=class{constructor(e){this.serializer=e,this.cr=new Map,this.lr=new Map}getBundleMetadata(e,n){return m.resolve(this.cr.get(n))}saveBundleMetadata(e,n){return this.cr.set(n.id,function(i){return{id:i.id,version:i.version,createTime:Ke(i.createTime)}}(n)),m.resolve()}getNamedQuery(e,n){return m.resolve(this.lr.get(n))}saveNamedQuery(e,n){return this.lr.set(n.name,function(i){return{name:i.name,query:dC(i.bundledQuery),readTime:Ke(i.readTime)}}(n)),m.resolve()}};var oI=class{constructor(){this.overlays=new Ne(M.comparator),this.hr=new Map}getOverlay(e,n){return m.resolve(this.overlays.get(n))}getOverlays(e,n){let r=hr();return m.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((i,s)=>{this.ht(e,n,s)}),m.resolve()}removeOverlaysForBatchId(e,n,r){let i=this.hr.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.hr.delete(r)),m.resolve()}getOverlaysForCollection(e,n,r){let i=hr(),s=n.length+1,o=new M(n.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){let u=a.getNext().value,c=u.getKey();if(!n.isPrefixOf(c.path))break;c.path.length===s&&u.largestBatchId>r&&i.set(u.getKey(),u)}return m.resolve(i)}getOverlaysForCollectionGroup(e,n,r,i){let s=new Ne((c,l)=>c-l),o=this.overlays.getIterator();for(;o.hasNext();){let c=o.getNext().value;if(c.getKey().getCollectionGroup()===n&&c.largestBatchId>r){let l=s.get(c.largestBatchId);l===null&&(l=hr(),s=s.insert(c.largestBatchId,l)),l.set(c.getKey(),c)}}let a=hr(),u=s.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((c,l)=>a.set(c,l)),!(a.size()>=i)););return m.resolve(a)}ht(e,n,r){let i=this.overlays.get(r.key);if(i!==null){let o=this.hr.get(i.largestBatchId).delete(r.key);this.hr.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new Cl(n,r));let s=this.hr.get(n);s===void 0&&(s=ee(),this.hr.set(n,s)),this.hr.set(n,s.add(r.key))}};var xl=class{constructor(){this.Pr=new Se(rt.Ir),this.Tr=new Se(rt.Er)}isEmpty(){return this.Pr.isEmpty()}addReference(e,n){let r=new rt(e,n);this.Pr=this.Pr.add(r),this.Tr=this.Tr.add(r)}dr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Ar(new rt(e,n))}Rr(e,n){e.forEach(r=>this.removeReference(r,n))}Vr(e){let n=new M(new me([])),r=new rt(n,e),i=new rt(n,e+1),s=[];return this.Tr.forEachInRange([r,i],o=>{this.Ar(o),s.push(o.key)}),s}mr(){this.Pr.forEach(e=>this.Ar(e))}Ar(e){this.Pr=this.Pr.delete(e),this.Tr=this.Tr.delete(e)}gr(e){let n=new M(new me([])),r=new rt(n,e),i=new rt(n,e+1),s=ee();return this.Tr.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(e){let n=new rt(e,0),r=this.Pr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}},rt=class{constructor(e,n){this.key=e,this.pr=n}static Ir(e,n){return M.comparator(e.key,n.key)||Z(e.pr,n.pr)}static Er(e,n){return Z(e.pr,n.pr)||M.comparator(e.key,n.key)}};var aI=class{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.yr=1,this.wr=new Se(rt.Ir)}checkEmpty(e){return m.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,i){let s=this.yr;this.yr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let o=new Il(s,n,r,i);this.mutationQueue.push(o);for(let a of i)this.wr=this.wr.add(new rt(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return m.resolve(o)}lookupMutationBatch(e,n){return m.resolve(this.Sr(n))}getNextMutationBatchAfterBatchId(e,n){let r=n+1,i=this.br(r),s=i<0?0:i;return m.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return m.resolve(this.mutationQueue.length===0?-1:this.yr-1)}getAllMutationBatches(e){return m.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){let r=new rt(n,0),i=new rt(n,Number.POSITIVE_INFINITY),s=[];return this.wr.forEachInRange([r,i],o=>{let a=this.Sr(o.pr);s.push(a)}),m.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Se(Z);return n.forEach(i=>{let s=new rt(i,0),o=new rt(i,Number.POSITIVE_INFINITY);this.wr.forEachInRange([s,o],a=>{r=r.add(a.pr)})}),m.resolve(this.Dr(r))}getAllMutationBatchesAffectingQuery(e,n){let r=n.path,i=r.length+1,s=r;M.isDocumentKey(s)||(s=s.child(""));let o=new rt(new M(s),0),a=new Se(Z);return this.wr.forEachWhile(u=>{let c=u.key.path;return!!r.isPrefixOf(c)&&(c.length===i&&(a=a.add(u.pr)),!0)},o),m.resolve(this.Dr(a))}Dr(e){let n=[];return e.forEach(r=>{let i=this.Sr(r);i!==null&&n.push(i)}),n}removeMutationBatch(e,n){L(this.Cr(n.batchId,"removed")===0),this.mutationQueue.shift();let r=this.wr;return m.forEach(n.mutations,i=>{let s=new rt(i.key,n.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.wr=r})}Mn(e){}containsKey(e,n){let r=new rt(n,0),i=this.wr.firstAfterOrEqual(r);return m.resolve(n.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,m.resolve()}Cr(e,n){return this.br(e)}br(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Sr(e){let n=this.br(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}};var uI=class{constructor(e){this.vr=e,this.docs=function(){return new Ne(M.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){let r=n.key,i=this.docs.get(r),s=i?i.size:0,o=this.vr(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){let n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){let r=this.docs.get(n);return m.resolve(r?r.document.mutableCopy():ot.newInvalidDocument(n))}getEntries(e,n){let r=Zt();return n.forEach(i=>{let s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():ot.newInvalidDocument(i))}),m.resolve(r)}getDocumentsMatchingQuery(e,n,r,i){let s=Zt(),o=n.path,a=new M(o.child("")),u=this.docs.getIteratorFrom(a);for(;u.hasNext();){let{key:c,value:{document:l}}=u.getNext();if(!o.isPrefixOf(c.path))break;c.path.length>o.length+1||iC(LN(l),r)<=0||(i.has(l.key)||Bl(n,l))&&(s=s.insert(l.key,l.mutableCopy()))}return m.resolve(s)}getAllFromCollectionGroup(e,n,r,i){O()}Fr(e,n){return m.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new cI(this)}getSize(e){return m.resolve(this.size)}},cI=class extends Wp{constructor(e){super(),this.ar=e}applyChanges(e){let n=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?n.push(this.ar.addEntry(e,i)):this.ar.removeEntry(r)}),m.waitFor(n)}getFromCache(e,n){return this.ar.getEntry(e,n)}getAllFromCache(e,n){return this.ar.getEntries(e,n)}};var lI=class{constructor(e){this.persistence=e,this.Mr=new _r(n=>Hs(n),jl),this.lastRemoteSnapshotVersion=B.min(),this.highestTargetId=0,this.Or=0,this.Nr=new xl,this.targetCount=0,this.Br=$a.Nn()}forEachTarget(e,n){return this.Mr.forEach((r,i)=>n(i)),m.resolve()}getLastRemoteSnapshotVersion(e){return m.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return m.resolve(this.Or)}allocateTargetId(e){return this.highestTargetId=this.Br.next(),m.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.Or&&(this.Or=n),m.resolve()}qn(e){this.Mr.set(e.target,e);let n=e.targetId;n>this.highestTargetId&&(this.Br=new $a(n),this.highestTargetId=n),e.sequenceNumber>this.Or&&(this.Or=e.sequenceNumber)}addTargetData(e,n){return this.qn(n),this.targetCount+=1,m.resolve()}updateTargetData(e,n){return this.qn(n),m.resolve()}removeTargetData(e,n){return this.Mr.delete(n.target),this.Nr.Vr(n.targetId),this.targetCount-=1,m.resolve()}removeTargets(e,n,r){let i=0,s=[];return this.Mr.forEach((o,a)=>{a.sequenceNumber<=n&&r.get(a.targetId)===null&&(this.Mr.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),m.waitFor(s).next(()=>i)}getTargetCount(e){return m.resolve(this.targetCount)}getTargetData(e,n){let r=this.Mr.get(n)||null;return m.resolve(r)}addMatchingKeys(e,n,r){return this.Nr.dr(n,r),m.resolve()}removeMatchingKeys(e,n,r){this.Nr.Rr(n,r);let i=this.persistence.referenceDelegate,s=[];return i&&n.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),m.waitFor(s)}removeMatchingKeysForTargetId(e,n){return this.Nr.Vr(n),m.resolve()}getMatchingKeysForTargetId(e,n){let r=this.Nr.gr(n);return m.resolve(r)}containsKey(e,n){return m.resolve(this.Nr.containsKey(n))}};var Qp=class{constructor(e,n){this.Lr={},this.overlays={},this.kr=new sn(0),this.qr=!1,this.qr=!0,this.referenceDelegate=e(this),this.Qr=new lI(this),this.indexManager=new QE,this.remoteDocumentCache=function(i){return new uI(i)}(r=>this.referenceDelegate.Kr(r)),this.serializer=new Up(n),this.$r=new sI(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.qr=!1,Promise.resolve()}get started(){return this.qr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new oI,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.Lr[e.toKey()];return r||(r=new aI(n,this.referenceDelegate),this.Lr[e.toKey()]=r),r}getTargetCache(){return this.Qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.$r}runTransaction(e,n,r){D("MemoryPersistence","Starting transaction:",e);let i=new dI(this.kr.next());return this.referenceDelegate.Ur(),r(i).next(s=>this.referenceDelegate.Wr(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Gr(e,n){return m.or(Object.values(this.Lr).map(r=>()=>r.containsKey(e,n)))}},dI=class extends Ap{constructor(e){super(),this.currentSequenceNumber=e}},Yp=class t{constructor(e){this.persistence=e,this.zr=new xl,this.jr=null}static Hr(e){return new t(e)}get Jr(){if(this.jr)return this.jr;throw O()}addReference(e,n,r){return this.zr.addReference(r,n),this.Jr.delete(r.toString()),m.resolve()}removeReference(e,n,r){return this.zr.removeReference(r,n),this.Jr.add(r.toString()),m.resolve()}markPotentiallyOrphaned(e,n){return this.Jr.add(n.toString()),m.resolve()}removeTarget(e,n){this.zr.Vr(n.targetId).forEach(i=>this.Jr.add(i.toString()));let r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(i=>{i.forEach(s=>this.Jr.add(s.toString()))}).next(()=>r.removeTargetData(e,n))}Ur(){this.jr=new Set}Wr(e){let n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return m.forEach(this.Jr,r=>{let i=M.fromPath(r);return this.Yr(e,i).next(s=>{s||n.removeEntry(i,B.min())})}).next(()=>(this.jr=null,n.apply(e)))}updateLimboDocument(e,n){return this.Yr(e,n).next(r=>{r?this.Jr.delete(n.toString()):this.Jr.add(n.toString())})}Kr(e){return 0}Yr(e,n){return m.or([()=>m.resolve(this.zr.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Gr(e,n)])}};var hI=class{constructor(e){this.serializer=e}N(e,n,r,i){let s=new xp("createOrUpgrade",n);r<1&&i>=1&&(function(u){u.createObjectStore("owner")}(e),function(u){u.createObjectStore("mutationQueues",{keyPath:"userId"}),u.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",LR,{unique:!0}),u.createObjectStore("documentMutations")}(e),IN(e),function(u){u.createObjectStore("remoteDocuments")}(e));let o=m.resolve();return r<3&&i>=3&&(r!==0&&(function(u){u.deleteObjectStore("targetDocuments"),u.deleteObjectStore("targets"),u.deleteObjectStore("targetGlobal")}(e),IN(e)),o=o.next(()=>function(u){let c=u.store("targetGlobal"),l={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:B.min().toTimestamp(),targetCount:0};return c.put("targetGlobalKey",l)}(s))),r<4&&i>=4&&(r!==0&&(o=o.next(()=>function(u,c){return c.store("mutations").W().next(l=>{u.deleteObjectStore("mutations"),u.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",LR,{unique:!0});let d=c.store("mutations"),h=l.map(f=>d.put(f));return m.waitFor(h)})}(e,s))),o=o.next(()=>{(function(u){u.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)})),r<5&&i>=5&&(o=o.next(()=>this.Xr(s))),r<6&&i>=6&&(o=o.next(()=>(function(u){u.createObjectStore("remoteDocumentGlobal")}(e),this.ei(s)))),r<7&&i>=7&&(o=o.next(()=>this.ti(s))),r<8&&i>=8&&(o=o.next(()=>this.ni(e,s))),r<9&&i>=9&&(o=o.next(()=>{(function(u){u.objectStoreNames.contains("remoteDocumentChanges")&&u.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&i>=10&&(o=o.next(()=>this.ri(s))),r<11&&i>=11&&(o=o.next(()=>{(function(u){u.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(u){u.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),r<12&&i>=12&&(o=o.next(()=>{(function(u){let c=u.createObjectStore("documentOverlays",{keyPath:mG});c.createIndex("collectionPathOverlayIndex",yG,{unique:!1}),c.createIndex("collectionGroupOverlayIndex",_G,{unique:!1})})(e)})),r<13&&i>=13&&(o=o.next(()=>function(u){let c=u.createObjectStore("remoteDocumentsV14",{keyPath:sG});c.createIndex("documentKeyIndex",oG),c.createIndex("collectionGroupIndex",aG)}(e)).next(()=>this.ii(e,s)).next(()=>e.deleteObjectStore("remoteDocuments"))),r<14&&i>=14&&(o=o.next(()=>this.si(e,s))),r<15&&i>=15&&(o=o.next(()=>function(u){u.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),u.createObjectStore("indexState",{keyPath:hG}).createIndex("sequenceNumberIndex",fG,{unique:!1}),u.createObjectStore("indexEntries",{keyPath:pG}).createIndex("documentKeyIndex",gG,{unique:!1})}(e))),o}ei(e){let n=0;return e.store("remoteDocuments").Y((r,i)=>{n+=Gp(i)}).next(()=>{let r={byteSize:n};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",r)})}Xr(e){let n=e.store("mutationQueues"),r=e.store("mutations");return n.W().next(i=>m.forEach(i,s=>{let o=IDBKeyRange.bound([s.userId,-1],[s.userId,s.lastAcknowledgedBatchId]);return r.W("userMutationsIndex",o).next(a=>m.forEach(a,u=>{L(u.userId===s.userId);let c=Os(this.serializer,u);return kP(e,s.userId,c).next(()=>{})}))}))}ti(e){let n=e.store("targetDocuments"),r=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(i=>{let s=[];return r.Y((o,a)=>{let u=new me(o),c=function(d){return[0,Ut(d)]}(u);s.push(n.get(c).next(l=>l?m.resolve():(d=>n.put({targetId:0,path:Ut(d),sequenceNumber:i.highestListenSequenceNumber}))(u)))}).next(()=>m.waitFor(s))})}ni(e,n){e.createObjectStore("collectionParents",{keyPath:dG});let r=n.store("collectionParents"),i=new Al,s=o=>{if(i.add(o)){let a=o.lastSegment(),u=o.popLast();return r.put({collectionId:a,parent:Ut(u)})}};return n.store("remoteDocuments").Y({J:!0},(o,a)=>{let u=new me(o);return s(u.popLast())}).next(()=>n.store("documentMutations").Y({J:!0},([o,a,u],c)=>{let l=dr(a);return s(l.popLast())}))}ri(e){let n=e.store("targets");return n.Y((r,i)=>{let s=cl(i),o=RP(this.serializer,s);return n.put(o)})}ii(e,n){let r=n.store("remoteDocuments"),i=[];return r.Y((s,o)=>{let a=n.store("remoteDocumentsV14"),u=function(d){return d.document?new M(me.fromString(d.document.name).popFirst(5)):d.noDocument?M.fromSegments(d.noDocument.path):d.unknownDocument?M.fromSegments(d.unknownDocument.path):O()}(o).path.toArray(),c={prefixPath:u.slice(0,u.length-2),collectionGroup:u[u.length-2],documentId:u[u.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};i.push(a.put(c))}).next(()=>m.waitFor(i))}si(e,n){let r=n.store("mutations"),i=VP(this.serializer),s=new Qp(Yp.Hr,this.serializer.ct);return r.W().next(o=>{let a=new Map;return o.forEach(u=>{var c;let l=(c=a.get(u.userId))!==null&&c!==void 0?c:ee();Os(this.serializer,u).keys().forEach(d=>l=l.add(d)),a.set(u.userId,l)}),m.forEach(a,(u,c)=>{let l=new it(c),d=$p.lt(this.serializer,l),h=s.getIndexManager(l),f=zp.lt(l,this.serializer,h,s.referenceDelegate);return new Kp(i,f,d,h).recalculateAndSaveOverlaysForDocumentKeys(new yl(n,sn._e),u).next()})})}};function IN(t){t.createObjectStore("targetDocuments",{keyPath:cG}).createIndex("documentTargetsIndex",lG,{unique:!0}),t.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",uG,{unique:!0}),t.createObjectStore("targetGlobal")}var rE="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",fI=class t{constructor(e,n,r,i,s,o,a,u,c,l,d=15){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.oi=s,this.window=o,this.document=a,this._i=c,this.ai=l,this.ui=d,this.kr=null,this.qr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.ci=null,this.inForeground=!1,this.li=null,this.hi=null,this.Pi=Number.NEGATIVE_INFINITY,this.Ii=h=>Promise.resolve(),!t.D())throw new I(y.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new tI(this,i),this.Ti=n+"main",this.serializer=new Up(u),this.Ei=new $r(this.Ti,this.ui,new hI(this.serializer)),this.Qr=new ZE(this.referenceDelegate,this.serializer),this.remoteDocumentCache=VP(this.serializer),this.$r=new $E,this.window&&this.window.localStorage?this.di=this.window.localStorage:(this.di=null,l===!1&&ze("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Ai().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new I(y.FAILED_PRECONDITION,rE);return this.Ri(),this.Vi(),this.mi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Qr.getHighestSequenceNumber(e))}).then(e=>{this.kr=new sn(e,this._i)}).then(()=>{this.qr=!0}).catch(e=>(this.Ei&&this.Ei.close(),Promise.reject(e)))}fi(e){return this.Ii=n=>v(this,null,function*(){if(this.started)return e(n)}),e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ei.L(n=>v(this,null,function*(){n.newVersion===null&&(yield e())}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.oi.enqueueAndForget(()=>v(this,null,function*(){this.started&&(yield this.Ai())})))}Ai(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>yp(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.gi(e).next(n=>{n||(this.isPrimary=!1,this.oi.enqueueRetryable(()=>this.Ii(!1)))})}).next(()=>this.pi(e)).next(n=>this.isPrimary&&!n?this.yi(e).next(()=>!1):!!n&&this.wi(e).next(()=>!0))).catch(e=>{if(ji(e))return D("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return D("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.oi.enqueueRetryable(()=>this.Ii(e)),this.isPrimary=e})}gi(e){return al(e).get("owner").next(n=>m.resolve(this.Si(n)))}bi(e){return yp(e).delete(this.clientId)}Di(){return v(this,null,function*(){if(this.isPrimary&&!this.Ci(this.Pi,18e5)){this.Pi=Date.now();let e=yield this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",n=>{let r=gt(n,"clientMetadata");return r.W().next(i=>{let s=this.vi(i,18e5),o=i.filter(a=>s.indexOf(a)===-1);return m.forEach(o,a=>r.delete(a.clientId)).next(()=>o)})}).catch(()=>[]);if(this.di)for(let n of e)this.di.removeItem(this.Fi(n.clientId))}})}mi(){this.hi=this.oi.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.Ai().then(()=>this.Di()).then(()=>this.mi()))}Si(e){return!!e&&e.ownerId===this.clientId}pi(e){return this.ai?m.resolve(!0):al(e).get("owner").next(n=>{if(n!==null&&this.Ci(n.leaseTimestampMs,5e3)&&!this.Mi(n.ownerId)){if(this.Si(n)&&this.networkEnabled)return!0;if(!this.Si(n)){if(!n.allowTabSynchronization)throw new I(y.FAILED_PRECONDITION,rE);return!1}}return!(!this.networkEnabled||!this.inForeground)||yp(e).W().next(r=>this.vi(r,5e3).find(i=>{if(this.clientId!==i.clientId){let s=!this.networkEnabled&&i.networkEnabled,o=!this.inForeground&&i.inForeground,a=this.networkEnabled===i.networkEnabled;if(s||o&&a)return!0}return!1})===void 0)}).next(n=>(this.isPrimary!==n&&D("IndexedDbPersistence",`Client ${n?"is":"is not"} eligible for a primary lease.`),n))}shutdown(){return v(this,null,function*(){this.qr=!1,this.xi(),this.hi&&(this.hi.cancel(),this.hi=null),this.Oi(),this.Ni(),yield this.Ei.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{let n=new yl(e,sn._e);return this.yi(n).next(()=>this.bi(n))}),this.Ei.close(),this.Bi()})}vi(e,n){return e.filter(r=>this.Ci(r.updateTimeMs,n)&&!this.Mi(r.clientId))}Li(){return this.runTransaction("getActiveClients","readonly",e=>yp(e).W().next(n=>this.vi(n,18e5).map(r=>r.clientId)))}get started(){return this.qr}getMutationQueue(e,n){return zp.lt(e,this.serializer,n,this.referenceDelegate)}getTargetCache(){return this.Qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new YE(e,this.serializer.ct.databaseId)}getDocumentOverlayCache(e){return $p.lt(this.serializer,e)}getBundleCache(){return this.$r}runTransaction(e,n,r){D("IndexedDbPersistence","Starting transaction:",e);let i=n==="readonly"?"readonly":"readwrite",s=function(u){return u===15?wG:u===14?qN:u===13?HN:u===12?vG:u===11?$N:void O()}(this.ui),o;return this.Ei.runTransaction(e,i,s,a=>(o=new yl(a,this.kr?this.kr.next():sn._e),n==="readwrite-primary"?this.gi(o).next(u=>!!u||this.pi(o)).next(u=>{if(!u)throw ze(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.oi.enqueueRetryable(()=>this.Ii(!1)),new I(y.FAILED_PRECONDITION,jN);return r(o)}).next(u=>this.wi(o).next(()=>u)):this.ki(o).next(()=>r(o)))).then(a=>(o.raiseOnCommittedEvent(),a))}ki(e){return al(e).get("owner").next(n=>{if(n!==null&&this.Ci(n.leaseTimestampMs,5e3)&&!this.Mi(n.ownerId)&&!this.Si(n)&&!(this.ai||this.allowTabSynchronization&&n.allowTabSynchronization))throw new I(y.FAILED_PRECONDITION,rE)})}wi(e){let n={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return al(e).put("owner",n)}static D(){return $r.D()}yi(e){let n=al(e);return n.get("owner").next(r=>this.Si(r)?(D("IndexedDbPersistence","Releasing primary lease."),n.delete("owner")):m.resolve())}Ci(e,n){let r=Date.now();return!(e<r-n)&&(!(e>r)||(ze(`Detected an update time that is in the future: ${e} > ${r}`),!1))}Ri(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.li=()=>{this.oi.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.Ai()))},this.document.addEventListener("visibilitychange",this.li),this.inForeground=this.document.visibilityState==="visible")}Oi(){this.li&&(this.document.removeEventListener("visibilitychange",this.li),this.li=null)}Vi(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.ci=()=>{this.xi();let n=/(?:Version|Mobile)\/1[456]/;Vm()&&(navigator.appVersion.match(n)||navigator.userAgent.match(n))&&this.oi.enterRestrictedMode(!0),this.oi.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.ci))}Ni(){this.ci&&(this.window.removeEventListener("pagehide",this.ci),this.ci=null)}Mi(e){var n;try{let r=((n=this.di)===null||n===void 0?void 0:n.getItem(this.Fi(e)))!==null;return D("IndexedDbPersistence",`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return ze("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}xi(){if(this.di)try{this.di.setItem(this.Fi(this.clientId),String(Date.now()))}catch(e){ze("Failed to set zombie client id.",e)}}Bi(){if(this.di)try{this.di.removeItem(this.Fi(this.clientId))}catch{}}Fi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}};function al(t){return gt(t,"owner")}function yp(t){return gt(t,"clientMetadata")}function fC(t,e){let n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}var pI=class t{constructor(e,n,r,i){this.targetId=e,this.fromCache=n,this.qi=r,this.Qi=i}static Ki(e,n){let r=ee(),i=ee();for(let s of n.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new t(e,n.fromCache,r,i)}};var gI=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var Zp=class{constructor(){this.$i=!1,this.Ui=!1,this.Wi=100,this.Gi=function(){return Vm()?8:$r.v(Su())>0?6:4}()}initialize(e,n){this.zi=e,this.indexManager=n,this.$i=!0}getDocumentsMatchingQuery(e,n,r,i){let s={result:null};return this.ji(e,n).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.Hi(e,n,i,r).next(o=>{s.result=o})}).next(()=>{if(s.result)return;let o=new gI;return this.Ji(e,n,o).next(a=>{if(s.result=a,this.Ui)return this.Yi(e,n,o,a.size)})}).next(()=>s.result)}Yi(e,n,r,i){return r.documentReadCount<this.Wi?(Ta()<=fn.DEBUG&&D("QueryEngine","SDK will not create cache indexes for query:",ba(n),"since it only creates cache indexes for collection contains","more than or equal to",this.Wi,"documents"),m.resolve()):(Ta()<=fn.DEBUG&&D("QueryEngine","Query:",ba(n),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.Gi*i?(Ta()<=fn.DEBUG&&D("QueryEngine","The SDK decides to create cache indexes for query:",ba(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Bt(n))):m.resolve())}ji(e,n){if(QR(n))return m.resolve(null);let r=Bt(n);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(n.limit!==null&&i===1&&(n=Fp(n,null,"F"),r=Bt(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{let o=ee(...s);return this.zi.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(u=>{let c=this.Zi(n,a);return this.Xi(n,c,o,u.readTime)?this.ji(e,Fp(n,null,"F")):this.es(e,c,n,u)}))})))}Hi(e,n,r,i){return QR(n)||i.isEqual(B.min())?m.resolve(null):this.zi.getDocuments(e,r).next(s=>{let o=this.Zi(n,s);return this.Xi(n,o,r,i)?m.resolve(null):(Ta()<=fn.DEBUG&&D("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),ba(n)),this.es(e,o,n,VN(i,-1)).next(a=>a))})}Zi(e,n){let r=new Se(rP(e));return n.forEach((i,s)=>{Bl(e,s)&&(r=r.add(s))}),r}Xi(e,n,r,i){if(e.limit===null)return!1;if(r.size!==n.size)return!0;let s=e.limitType==="F"?n.last():n.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Ji(e,n,r){return Ta()<=fn.DEBUG&&D("QueryEngine","Using full collection scan to execute query:",ba(n)),this.zi.getDocumentsMatchingQuery(e,n,Tn.min(),r)}es(e,n,r,i){return this.zi.getDocumentsMatchingQuery(e,r,i).next(s=>(n.forEach(o=>{s=s.insert(o.key,o)}),s))}};var mI=class{constructor(e,n,r,i){this.persistence=e,this.ts=n,this.serializer=i,this.ns=new Ne(Z),this.rs=new _r(s=>Hs(s),jl),this.ss=new Map,this.os=e.getRemoteDocumentCache(),this.Qr=e.getTargetCache(),this.$r=e.getBundleCache(),this._s(r)}_s(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Kp(this.os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.os.setIndexManager(this.indexManager),this.ts.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.ns))}};function LP(t,e,n,r){return new mI(t,e,n,r)}function jP(t,e){return v(this,null,function*(){let n=N(t);return yield n.persistence.runTransaction("Handle user change","readonly",r=>{let i;return n.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,n._s(e),n.mutationQueue.getAllMutationBatches(r))).next(s=>{let o=[],a=[],u=ee();for(let c of i){o.push(c.batchId);for(let l of c.mutations)u=u.add(l.key)}for(let c of s){a.push(c.batchId);for(let l of c.mutations)u=u.add(l.key)}return n.localDocuments.getDocuments(r,u).next(c=>({us:c,removedBatchIds:o,addedBatchIds:a}))})})})}function JG(t,e){let n=N(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{let i=e.batch.keys(),s=n.os.newChangeBuffer({trackRemovals:!0});return function(a,u,c,l){let d=c.batch,h=d.keys(),f=m.resolve();return h.forEach(p=>{f=f.next(()=>l.getEntry(u,p)).next(g=>{let _=c.docVersions.get(p);L(_!==null),g.version.compareTo(_)<0&&(d.applyToRemoteDocument(g,c),g.isValidDocument()&&(g.setReadTime(c.commitVersion),l.addEntry(g)))})}),f.next(()=>a.mutationQueue.removeMutationBatch(u,d))}(n,r,e,s).next(()=>s.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let u=ee();for(let c=0;c<a.mutationResults.length;++c)a.mutationResults[c].transformResults.length>0&&(u=u.add(a.batch.mutations[c].key));return u}(e))).next(()=>n.localDocuments.getDocuments(r,i))})}function UP(t){let e=N(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Qr.getLastRemoteSnapshotVersion(n))}function ez(t,e){let n=N(t),r=e.snapshotVersion,i=n.ns;return n.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{let o=n.os.newChangeBuffer({trackRemovals:!0});i=n.ns;let a=[];e.targetChanges.forEach((l,d)=>{let h=i.get(d);if(!h)return;a.push(n.Qr.removeMatchingKeys(s,l.removedDocuments,d).next(()=>n.Qr.addMatchingKeys(s,l.addedDocuments,d)));let f=h.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(d)!==null?f=f.withResumeToken(pt.EMPTY_BYTE_STRING,B.min()).withLastLimboFreeSnapshotVersion(B.min()):l.resumeToken.approximateByteSize()>0&&(f=f.withResumeToken(l.resumeToken,r)),i=i.insert(d,f),function(g,_,b){return g.resumeToken.approximateByteSize()===0||_.snapshotVersion.toMicroseconds()-g.snapshotVersion.toMicroseconds()>=3e8?!0:b.addedDocuments.size+b.modifiedDocuments.size+b.removedDocuments.size>0}(h,f,l)&&a.push(n.Qr.updateTargetData(s,f))});let u=Zt(),c=ee();if(e.documentUpdates.forEach(l=>{e.resolvedLimboDocuments.has(l)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(s,l))}),a.push(BP(s,o,e.documentUpdates).next(l=>{u=l.cs,c=l.ls})),!r.isEqual(B.min())){let l=n.Qr.getLastRemoteSnapshotVersion(s).next(d=>n.Qr.setTargetsMetadata(s,s.currentSequenceNumber,r));a.push(l)}return m.waitFor(a).next(()=>o.apply(s)).next(()=>n.localDocuments.getLocalViewOfDocuments(s,u,c)).next(()=>u)}).then(s=>(n.ns=i,s))}function BP(t,e,n){let r=ee(),i=ee();return n.forEach(s=>r=r.add(s)),e.getEntries(t,r).next(s=>{let o=Zt();return n.forEach((a,u)=>{let c=s.get(a);u.isFoundDocument()!==c.isFoundDocument()&&(i=i.add(a)),u.isNoDocument()&&u.version.isEqual(B.min())?(e.removeEntry(a,u.readTime),o=o.insert(a,u)):!c.isValidDocument()||u.version.compareTo(c.version)>0||u.version.compareTo(c.version)===0&&c.hasPendingWrites?(e.addEntry(u),o=o.insert(a,u)):D("LocalStore","Ignoring outdated watch update for ",a,". Current version:",c.version," Watch version:",u.version)}),{cs:o,ls:i}})}function tz(t,e){let n=N(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function Ha(t,e){let n=N(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return n.Qr.getTargetData(r,e).next(s=>s?(i=s,m.resolve(i)):n.Qr.allocateTargetId(r).next(o=>(i=new Ba(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.Qr.addTargetData(r,i).next(()=>i))))}).then(r=>{let i=n.ns.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.ns=n.ns.insert(r.targetId,r),n.rs.set(e,r.targetId)),r})}function qa(t,e,n){return v(this,null,function*(){let r=N(t),i=r.ns.get(e),s=n?"readwrite":"readwrite-primary";try{n||(yield r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i)))}catch(o){if(!ji(o))throw o;D("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.ns=r.ns.remove(e),r.rs.delete(i.target)})}function Xp(t,e,n){let r=N(t),i=B.min(),s=ee();return r.persistence.runTransaction("Execute query","readwrite",o=>function(u,c,l){let d=N(u),h=d.rs.get(l);return h!==void 0?m.resolve(d.ns.get(h)):d.Qr.getTargetData(c,l)}(r,o,Bt(e)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,r.Qr.getMatchingKeysForTargetId(o,a.targetId).next(u=>{s=u})}).next(()=>r.ts.getDocumentsMatchingQuery(o,e,n?i:B.min(),n?s:ee())).next(a=>(qP(r,nP(e),a),{documents:a,hs:s})))}function $P(t,e){let n=N(t),r=N(n.Qr),i=n.ns.get(e);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",s=>r._t(s,e).next(o=>o?o.target:null))}function HP(t,e){let n=N(t),r=n.ss.get(e)||B.min();return n.persistence.runTransaction("Get new document changes","readonly",i=>n.os.getAllFromCollectionGroup(i,e,VN(r,-1),Number.MAX_SAFE_INTEGER)).then(i=>(qP(n,e,i),i))}function qP(t,e,n){let r=t.ss.get(e)||B.min();n.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),t.ss.set(e,r)}function nz(t,e,n,r){return v(this,null,function*(){let i=N(t),s=ee(),o=Zt();for(let c of n){let l=e.Ps(c.metadata.name);c.document&&(s=s.add(l));let d=e.Is(c);d.setReadTime(e.Ts(c.metadata.readTime)),o=o.insert(l,d)}let a=i.os.newChangeBuffer({trackRemovals:!0}),u=yield Ha(i,function(l){return Bt(Za(me.fromString(`__bundle__/docs/${l}`)))}(r));return i.persistence.runTransaction("Apply bundle documents","readwrite",c=>BP(c,a,o).next(l=>(a.apply(c),l)).next(l=>i.Qr.removeMatchingKeysForTargetId(c,u.targetId).next(()=>i.Qr.addMatchingKeys(c,s,u.targetId)).next(()=>i.localDocuments.getLocalViewOfDocuments(c,l.cs,l.ls)).next(()=>l.cs)))})}function rz(r,i){return v(this,arguments,function*(t,e,n=ee()){let s=yield Ha(t,Bt(dC(e.bundledQuery))),o=N(t);return o.persistence.runTransaction("Save named query","readwrite",a=>{let u=Ke(e.readTime);if(s.snapshotVersion.compareTo(u)>=0)return o.$r.saveNamedQuery(a,e);let c=s.withResumeToken(pt.EMPTY_BYTE_STRING,u);return o.ns=o.ns.insert(c.targetId,c),o.Qr.updateTargetData(a,c).next(()=>o.Qr.removeMatchingKeysForTargetId(a,s.targetId)).next(()=>o.Qr.addMatchingKeys(a,n,s.targetId)).next(()=>o.$r.saveNamedQuery(a,e))})})}function CN(t,e){return`firestore_clients_${t}_${e}`}function DN(t,e,n){let r=`firestore_mutations_${t}_${n}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}function iE(t,e){return`firestore_targets_${t}_${e}`}var Jp=class t{constructor(e,n,r,i){this.user=e,this.batchId=n,this.state=r,this.error=i}static Es(e,n,r){let i=JSON.parse(r),s,o=typeof i=="object"&&["pending","acknowledged","rejected"].indexOf(i.state)!==-1&&(i.error===void 0||typeof i.error=="object");return o&&i.error&&(o=typeof i.error.message=="string"&&typeof i.error.code=="string",o&&(s=new I(i.error.code,i.error.message))),o?new t(e,n,i.state,s):(ze("SharedClientState",`Failed to parse mutation state for ID '${n}': ${r}`),null)}ds(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}},fl=class t{constructor(e,n,r){this.targetId=e,this.state=n,this.error=r}static Es(e,n){let r=JSON.parse(n),i,s=typeof r=="object"&&["not-current","current","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return s&&r.error&&(s=typeof r.error.message=="string"&&typeof r.error.code=="string",s&&(i=new I(r.error.code,r.error.message))),s?new t(e,r.state,i):(ze("SharedClientState",`Failed to parse target state for ID '${e}': ${n}`),null)}ds(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}},eg=class t{constructor(e,n){this.clientId=e,this.activeTargetIds=n}static Es(e,n){let r=JSON.parse(n),i=typeof r=="object"&&r.activeTargetIds instanceof Array,s=cC();for(let o=0;i&&o<r.activeTargetIds.length;++o)i=UN(r.activeTargetIds[o]),s=s.add(r.activeTargetIds[o]);return i?new t(e,s):(ze("SharedClientState",`Failed to parse client data for instance '${e}': ${n}`),null)}},yI=class t{constructor(e,n){this.clientId=e,this.onlineState=n}static Es(e){let n=JSON.parse(e);return typeof n=="object"&&["Unknown","Online","Offline"].indexOf(n.onlineState)!==-1&&typeof n.clientId=="string"?new t(n.clientId,n.onlineState):(ze("SharedClientState",`Failed to parse online state: ${e}`),null)}},Ml=class{constructor(){this.activeTargetIds=cC()}As(e){this.activeTargetIds=this.activeTargetIds.add(e)}Rs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}ds(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}},pl=class{constructor(e,n,r,i,s){this.window=e,this.oi=n,this.persistenceKey=r,this.Vs=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.fs=this.gs.bind(this),this.ps=new Ne(Z),this.started=!1,this.ys=[];let o=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=s,this.ws=CN(this.persistenceKey,this.Vs),this.Ss=function(u){return`firestore_sequence_number_${u}`}(this.persistenceKey),this.ps=this.ps.insert(this.Vs,new Ml),this.bs=new RegExp(`^firestore_clients_${o}_([^_]*)$`),this.Ds=new RegExp(`^firestore_mutations_${o}_(\\d+)(?:_(.*))?$`),this.Cs=new RegExp(`^firestore_targets_${o}_(\\d+)$`),this.vs=function(u){return`firestore_online_state_${u}`}(this.persistenceKey),this.Fs=function(u){return`firestore_bundle_loaded_v2_${u}`}(this.persistenceKey),this.window.addEventListener("storage",this.fs)}static D(e){return!(!e||!e.localStorage)}start(){return v(this,null,function*(){let e=yield this.syncEngine.Li();for(let r of e){if(r===this.Vs)continue;let i=this.getItem(CN(this.persistenceKey,r));if(i){let s=eg.Es(r,i);s&&(this.ps=this.ps.insert(s.clientId,s))}}this.Ms();let n=this.storage.getItem(this.vs);if(n){let r=this.xs(n);r&&this.Os(r)}for(let r of this.ys)this.gs(r);this.ys=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0})}writeSequenceNumber(e){this.setItem(this.Ss,JSON.stringify(e))}getAllActiveQueryTargets(){return this.Ns(this.ps)}isActiveQueryTarget(e){let n=!1;return this.ps.forEach((r,i)=>{i.activeTargetIds.has(e)&&(n=!0)}),n}addPendingMutation(e){this.Bs(e,"pending")}updateMutationState(e,n,r){this.Bs(e,n,r),this.Ls(e)}addLocalQueryTarget(e){let n="not-current";if(this.isActiveQueryTarget(e)){let r=this.storage.getItem(iE(this.persistenceKey,e));if(r){let i=fl.Es(e,r);i&&(n=i.state)}}return this.ks.As(e),this.Ms(),n}removeLocalQueryTarget(e){this.ks.Rs(e),this.Ms()}isLocalQueryTarget(e){return this.ks.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(iE(this.persistenceKey,e))}updateQueryState(e,n,r){this.qs(e,n,r)}handleUserChange(e,n,r){n.forEach(i=>{this.Ls(i)}),this.currentUser=e,r.forEach(i=>{this.addPendingMutation(i)})}setOnlineState(e){this.Qs(e)}notifyBundleLoaded(e){this.Ks(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.fs),this.removeItem(this.ws),this.started=!1)}getItem(e){let n=this.storage.getItem(e);return D("SharedClientState","READ",e,n),n}setItem(e,n){D("SharedClientState","SET",e,n),this.storage.setItem(e,n)}removeItem(e){D("SharedClientState","REMOVE",e),this.storage.removeItem(e)}gs(e){let n=e;if(n.storageArea===this.storage){if(D("SharedClientState","EVENT",n.key,n.newValue),n.key===this.ws)return void ze("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.oi.enqueueRetryable(()=>v(this,null,function*(){if(this.started){if(n.key!==null){if(this.bs.test(n.key)){if(n.newValue==null){let r=this.$s(n.key);return this.Us(r,null)}{let r=this.Ws(n.key,n.newValue);if(r)return this.Us(r.clientId,r)}}else if(this.Ds.test(n.key)){if(n.newValue!==null){let r=this.Gs(n.key,n.newValue);if(r)return this.zs(r)}}else if(this.Cs.test(n.key)){if(n.newValue!==null){let r=this.js(n.key,n.newValue);if(r)return this.Hs(r)}}else if(n.key===this.vs){if(n.newValue!==null){let r=this.xs(n.newValue);if(r)return this.Os(r)}}else if(n.key===this.Ss){let r=function(s){let o=sn._e;if(s!=null)try{let a=JSON.parse(s);L(typeof a=="number"),o=a}catch(a){ze("SharedClientState","Failed to read sequence number from WebStorage",a)}return o}(n.newValue);r!==sn._e&&this.sequenceNumberHandler(r)}else if(n.key===this.Fs){let r=this.Js(n.newValue);yield Promise.all(r.map(i=>this.syncEngine.Ys(i)))}}}else this.ys.push(n)}))}}get ks(){return this.ps.get(this.Vs)}Ms(){this.setItem(this.ws,this.ks.ds())}Bs(e,n,r){let i=new Jp(this.currentUser,e,n,r),s=DN(this.persistenceKey,this.currentUser,e);this.setItem(s,i.ds())}Ls(e){let n=DN(this.persistenceKey,this.currentUser,e);this.removeItem(n)}Qs(e){let n={clientId:this.Vs,onlineState:e};this.storage.setItem(this.vs,JSON.stringify(n))}qs(e,n,r){let i=iE(this.persistenceKey,e),s=new fl(e,n,r);this.setItem(i,s.ds())}Ks(e){let n=JSON.stringify(Array.from(e));this.setItem(this.Fs,n)}$s(e){let n=this.bs.exec(e);return n?n[1]:null}Ws(e,n){let r=this.$s(e);return eg.Es(r,n)}Gs(e,n){let r=this.Ds.exec(e),i=Number(r[1]),s=r[2]!==void 0?r[2]:null;return Jp.Es(new it(s),i,n)}js(e,n){let r=this.Cs.exec(e),i=Number(r[1]);return fl.Es(i,n)}xs(e){return yI.Es(e)}Js(e){return JSON.parse(e)}zs(e){return v(this,null,function*(){if(e.user.uid===this.currentUser.uid)return this.syncEngine.Zs(e.batchId,e.state,e.error);D("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)})}Hs(e){return this.syncEngine.Xs(e.targetId,e.state,e.error)}Us(e,n){let r=n?this.ps.insert(e,n):this.ps.remove(e),i=this.Ns(this.ps),s=this.Ns(r),o=[],a=[];return s.forEach(u=>{i.has(u)||o.push(u)}),i.forEach(u=>{s.has(u)||a.push(u)}),this.syncEngine.eo(o,a).then(()=>{this.ps=r})}Os(e){this.ps.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}Ns(e){let n=cC();return e.forEach((r,i)=>{n=n.unionWith(i.activeTargetIds)}),n}},tg=class{constructor(){this.no=new Ml,this.ro={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e){return this.no.As(e),this.ro[e]||"not-current"}updateQueryState(e,n,r){this.ro[e]=n}removeLocalQueryTarget(e){this.no.Rs(e)}isLocalQueryTarget(e){return this.no.activeTargetIds.has(e)}clearQueryState(e){delete this.ro[e]}getAllActiveQueryTargets(){return this.no.activeTargetIds}isActiveQueryTarget(e){return this.no.activeTargetIds.has(e)}start(){return this.no=new Ml,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var _I=class{io(e){}shutdown(){}};var ng=class{constructor(){this.so=()=>this.oo(),this._o=()=>this.ao(),this.uo=[],this.co()}io(e){this.uo.push(e)}shutdown(){window.removeEventListener("online",this.so),window.removeEventListener("offline",this._o)}co(){window.addEventListener("online",this.so),window.addEventListener("offline",this._o)}oo(){D("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(let e of this.uo)e(0)}ao(){D("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(let e of this.uo)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var _p=null;function sE(){return _p===null?_p=function(){return 268435456+Math.round(2147483648*Math.random())}():_p++,"0x"+_p.toString(16)}var iz={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};var vI=class{constructor(e){this.lo=e.lo,this.ho=e.ho}Po(e){this.Io=e}To(e){this.Eo=e}onMessage(e){this.Ao=e}close(){this.ho()}send(e){this.lo(e)}Ro(){this.Io()}Vo(e){this.Eo(e)}mo(e){this.Ao(e)}};var Nt="WebChannelConnection",wI=class extends class{constructor(n){this.databaseInfo=n,this.databaseId=n.databaseId;let r=n.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.fo=r+"://"+n.host,this.po=`projects/${i}/databases/${s}`,this.yo=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get wo(){return!1}So(n,r,i,s,o){let a=sE(),u=this.bo(n,r.toUriEncodedString());D("RestConnection",`Sending RPC '${n}' ${a}:`,u,i);let c={"google-cloud-resource-prefix":this.po,"x-goog-request-params":this.yo};return this.Do(c,s,o),this.Co(n,u,c,i).then(l=>(D("RestConnection",`Received RPC '${n}' ${a}: `,l),l),l=>{throw Dn("RestConnection",`RPC '${n}' ${a} failed with error: `,l,"url: ",u,"request:",i),l})}vo(n,r,i,s,o,a){return this.So(n,r,i,s,o)}Do(n,r,i){n["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Ya}(),n["Content-Type"]="text/plain",this.databaseInfo.appId&&(n["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((s,o)=>n[o]=s),i&&i.headers.forEach((s,o)=>n[o]=s)}bo(n,r){let i=iz[n];return`${this.fo}/v1/${r}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Co(e,n,r,i){let s=sE();return new Promise((o,a)=>{let u=new PR;u.setWithCredentials(!0),u.listenOnce(RR.COMPLETE,()=>{try{switch(u.getLastErrorCode()){case pp.NO_ERROR:let l=u.getResponseJson();D(Nt,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(l)),o(l);break;case pp.TIMEOUT:D(Nt,`RPC '${e}' ${s} timed out`),a(new I(y.DEADLINE_EXCEEDED,"Request time out"));break;case pp.HTTP_ERROR:let d=u.getStatus();if(D(Nt,`RPC '${e}' ${s} failed with status:`,d,"response text:",u.getResponseText()),d>0){let h=u.getResponseJson();Array.isArray(h)&&(h=h[0]);let f=h?.error;if(f&&f.status&&f.message){let p=function(_){let b=_.toLowerCase().replace(/_/g,"-");return Object.values(y).indexOf(b)>=0?b:y.UNKNOWN}(f.status);a(new I(p,f.message))}else a(new I(y.UNKNOWN,"Server responded with status "+u.getStatus()))}else a(new I(y.UNAVAILABLE,"Connection failed."));break;default:O()}}finally{D(Nt,`RPC '${e}' ${s} completed.`)}});let c=JSON.stringify(i);D(Nt,`RPC '${e}' ${s} sending request:`,i),u.send(n,"POST",c,r,15)})}Fo(e,n,r){let i=sE(),s=[this.fo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=xR(),a=MR(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(u.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(u.useFetchStreams=!0),this.Do(u.initMessageHeaders,n,r),u.encodeInitMessageHeaders=!0;let l=s.join("");D(Nt,`Creating RPC '${e}' stream ${i}: ${l}`,u);let d=o.createWebChannel(l,u),h=!1,f=!1,p=new vI({lo:_=>{f?D(Nt,`Not sending because RPC '${e}' stream ${i} is closed:`,_):(h||(D(Nt,`Opening RPC '${e}' stream ${i} transport.`),d.open(),h=!0),D(Nt,`RPC '${e}' stream ${i} sending:`,_),d.send(_))},ho:()=>d.close()}),g=(_,b,P)=>{_.listen(b,A=>{try{P(A)}catch(H){setTimeout(()=>{throw H},0)}})};return g(d,rl.EventType.OPEN,()=>{f||D(Nt,`RPC '${e}' stream ${i} transport opened.`)}),g(d,rl.EventType.CLOSE,()=>{f||(f=!0,D(Nt,`RPC '${e}' stream ${i} transport closed`),p.Vo())}),g(d,rl.EventType.ERROR,_=>{f||(f=!0,Dn(Nt,`RPC '${e}' stream ${i} transport errored:`,_),p.Vo(new I(y.UNAVAILABLE,"The operation could not be completed")))}),g(d,rl.EventType.MESSAGE,_=>{var b;if(!f){let P=_.data[0];L(!!P);let A=P,H=A.error||((b=A[0])===null||b===void 0?void 0:b.error);if(H){D(Nt,`RPC '${e}' stream ${i} received error:`,H);let G=H.status,J=function(km){let eT=nt[km];if(eT!==void 0)return yP(eT)}(G),Pe=H.message;J===void 0&&(J=y.INTERNAL,Pe="Unknown error status: "+G+" with message "+H.message),f=!0,p.Vo(new I(J,Pe)),d.close()}else D(Nt,`RPC '${e}' stream ${i} received:`,P),p.mo(P)}}),g(a,NR.STAT_EVENT,_=>{_.stat===tE.PROXY?D(Nt,`RPC '${e}' stream ${i} detected buffering proxy`):_.stat===tE.NOPROXY&&D(Nt,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{p.Ro()},0),p}};function GP(){return typeof window<"u"?window:null}function Cp(){return typeof document<"u"?document:null}function $l(t){return new VE(t,!0)}var Rl=class{constructor(e,n,r=1e3,i=1.5,s=6e4){this.oi=e,this.timerId=n,this.Mo=r,this.xo=i,this.Oo=s,this.No=0,this.Bo=null,this.Lo=Date.now(),this.reset()}reset(){this.No=0}ko(){this.No=this.Oo}qo(e){this.cancel();let n=Math.floor(this.No+this.Qo()),r=Math.max(0,Date.now()-this.Lo),i=Math.max(0,n-r);i>0&&D("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.No} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.Bo=this.oi.enqueueAfterDelay(this.timerId,i,()=>(this.Lo=Date.now(),e())),this.No*=this.xo,this.No<this.Mo&&(this.No=this.Mo),this.No>this.Oo&&(this.No=this.Oo)}Ko(){this.Bo!==null&&(this.Bo.skipDelay(),this.Bo=null)}cancel(){this.Bo!==null&&(this.Bo.cancel(),this.Bo=null)}Qo(){return(Math.random()-.5)*this.No}};var rg=class{constructor(e,n,r,i,s,o,a,u){this.oi=e,this.$o=r,this.Uo=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=u,this.state=0,this.Wo=0,this.Go=null,this.zo=null,this.stream=null,this.jo=new Rl(e,n)}Ho(){return this.state===1||this.state===5||this.Jo()}Jo(){return this.state===2||this.state===3}start(){this.state!==4?this.auth():this.Yo()}stop(){return v(this,null,function*(){this.Ho()&&(yield this.close(0))})}Zo(){this.state=0,this.jo.reset()}Xo(){this.Jo()&&this.Go===null&&(this.Go=this.oi.enqueueAfterDelay(this.$o,6e4,()=>this.e_()))}t_(e){this.n_(),this.stream.send(e)}e_(){return v(this,null,function*(){if(this.Jo())return this.close(0)})}n_(){this.Go&&(this.Go.cancel(),this.Go=null)}r_(){this.zo&&(this.zo.cancel(),this.zo=null)}close(e,n){return v(this,null,function*(){this.n_(),this.r_(),this.jo.cancel(),this.Wo++,e!==4?this.jo.reset():n&&n.code===y.RESOURCE_EXHAUSTED?(ze(n.toString()),ze("Using maximum backoff delay to prevent overloading the backend."),this.jo.ko()):n&&n.code===y.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.i_(),this.stream.close(),this.stream=null),this.state=e,yield this.listener.To(n)})}i_(){}auth(){this.state=1;let e=this.s_(this.Wo),n=this.Wo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.Wo===n&&this.o_(r,i)},r=>{e(()=>{let i=new I(y.UNKNOWN,"Fetching auth token failed: "+r.message);return this.__(i)})})}o_(e,n){let r=this.s_(this.Wo);this.stream=this.a_(e,n),this.stream.Po(()=>{r(()=>(this.state=2,this.zo=this.oi.enqueueAfterDelay(this.Uo,1e4,()=>(this.Jo()&&(this.state=3),Promise.resolve())),this.listener.Po()))}),this.stream.To(i=>{r(()=>this.__(i))}),this.stream.onMessage(i=>{r(()=>this.onMessage(i))})}Yo(){this.state=5,this.jo.qo(()=>v(this,null,function*(){this.state=0,this.start()}))}__(e){return D("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}s_(e){return n=>{this.oi.enqueueAndForget(()=>this.Wo===e?n():(D("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}},EI=class extends rg{constructor(e,n,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}a_(e,n){return this.connection.Fo("Listen",e,n)}onMessage(e){this.jo.reset();let n=$G(this.serializer,e),r=function(s){if(!("targetChange"in s))return B.min();let o=s.targetChange;return o.targetIds&&o.targetIds.length?B.min():o.readTime?Ke(o.readTime):B.min()}(e);return this.listener.u_(n,r)}c_(e){let n={};n.database=UE(this.serializer),n.addTarget=function(s,o){let a,u=o.target;if(a=kp(u)?{documents:TP(s,u)}:{query:bP(s,u).ut},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=vP(s,o.resumeToken);let c=LE(s,o.expectedCount);c!==null&&(a.expectedCount=c)}else if(o.snapshotVersion.compareTo(B.min())>0){a.readTime=Ua(s,o.snapshotVersion.toTimestamp());let c=LE(s,o.expectedCount);c!==null&&(a.expectedCount=c)}return a}(this.serializer,e);let r=qG(this.serializer,e);r&&(n.labels=r),this.t_(n)}l_(e){let n={};n.database=UE(this.serializer),n.removeTarget=e,this.t_(n)}},II=class extends rg{constructor(e,n,r,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s,this.h_=!1}get P_(){return this.h_}start(){this.h_=!1,this.lastStreamToken=void 0,super.start()}i_(){this.h_&&this.I_([])}a_(e,n){return this.connection.Fo("Write",e,n)}onMessage(e){if(L(!!e.streamToken),this.lastStreamToken=e.streamToken,this.h_){this.jo.reset();let n=HG(e.writeResults,e.commitTime),r=Ke(e.commitTime);return this.listener.T_(r,n)}return L(!e.writeResults||e.writeResults.length===0),this.h_=!0,this.listener.E_()}d_(){let e={};e.database=UE(this.serializer),this.t_(e)}I_(e){let n={streamToken:this.lastStreamToken,writes:e.map(r=>Sl(this.serializer,r))};this.t_(n)}};var CI=class extends class{}{constructor(e,n,r,i){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=i,this.A_=!1}R_(){if(this.A_)throw new I(y.FAILED_PRECONDITION,"The client has already been terminated.")}So(e,n,r,i){return this.R_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.So(e,jE(n,r),i,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===y.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new I(y.UNKNOWN,s.toString())})}vo(e,n,r,i,s){return this.R_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.vo(e,jE(n,r),i,o,a,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===y.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new I(y.UNKNOWN,o.toString())})}terminate(){this.A_=!0,this.connection.terminate()}};var DI=class{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.m_=0,this.f_=null,this.g_=!0}p_(){this.m_===0&&(this.y_("Unknown"),this.f_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.f_=null,this.w_("Backend didn't respond within 10 seconds."),this.y_("Offline"),Promise.resolve())))}S_(e){this.state==="Online"?this.y_("Unknown"):(this.m_++,this.m_>=1&&(this.b_(),this.w_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.y_("Offline")))}set(e){this.b_(),this.m_=0,e==="Online"&&(this.g_=!1),this.y_(e)}y_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}w_(e){let n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.g_?(ze(n),this.g_=!1):D("OnlineStateTracker",n)}b_(){this.f_!==null&&(this.f_.cancel(),this.f_=null)}};var TI=class{constructor(e,n,r,i,s){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.D_=[],this.C_=new Map,this.v_=new Set,this.F_=[],this.M_=s,this.M_.io(o=>{r.enqueueAndForget(()=>v(this,null,function*(){Ui(this)&&(D("RemoteStore","Restarting streams for network reachability change."),yield function(u){return v(this,null,function*(){let c=N(u);c.v_.add(4),yield Xa(c),c.x_.set("Unknown"),c.v_.delete(4),yield Hl(c)})}(this))}))}),this.x_=new DI(r,i)}};function Hl(t){return v(this,null,function*(){if(Ui(t))for(let e of t.F_)yield e(!0)})}function Xa(t){return v(this,null,function*(){for(let e of t.F_)yield e(!1)})}function Ig(t,e){let n=N(t);n.C_.has(e.targetId)||(n.C_.set(e.targetId,e),mC(n)?gC(n):eu(n).Jo()&&pC(n,e))}function Nl(t,e){let n=N(t),r=eu(n);n.C_.delete(e),r.Jo()&&zP(n,e),n.C_.size===0&&(r.Jo()?r.Xo():Ui(n)&&n.x_.set("Unknown"))}function pC(t,e){if(t.O_.Oe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(B.min())>0){let n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}eu(t).c_(e)}function zP(t,e){t.O_.Oe(e),eu(t).l_(e)}function gC(t){t.O_=new FE({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),_t:e=>t.C_.get(e)||null,nt:()=>t.datastore.serializer.databaseId}),eu(t).start(),t.x_.p_()}function mC(t){return Ui(t)&&!eu(t).Ho()&&t.C_.size>0}function Ui(t){return N(t).v_.size===0}function WP(t){t.O_=void 0}function sz(t){return v(this,null,function*(){t.C_.forEach((e,n)=>{pC(t,e)})})}function oz(t,e){return v(this,null,function*(){WP(t),mC(t)?(t.x_.S_(e),gC(t)):t.x_.set("Unknown")})}function az(t,e,n){return v(this,null,function*(){if(t.x_.set("Online"),e instanceof Lp&&e.state===2&&e.cause)try{yield function(i,s){return v(this,null,function*(){let o=s.cause;for(let a of s.targetIds)i.C_.has(a)&&(yield i.remoteSyncer.rejectListen(a,o),i.C_.delete(a),i.O_.removeTarget(a))})}(t,e)}catch(r){D("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),yield ig(t,r)}else if(e instanceof Pa?t.O_.$e(e):e instanceof Vp?t.O_.Je(e):t.O_.Ge(e),!n.isEqual(B.min()))try{let r=yield UP(t.localStore);n.compareTo(r)>=0&&(yield function(s,o){let a=s.O_.it(o);return a.targetChanges.forEach((u,c)=>{if(u.resumeToken.approximateByteSize()>0){let l=s.C_.get(c);l&&s.C_.set(c,l.withResumeToken(u.resumeToken,o))}}),a.targetMismatches.forEach((u,c)=>{let l=s.C_.get(u);if(!l)return;s.C_.set(u,l.withResumeToken(pt.EMPTY_BYTE_STRING,l.snapshotVersion)),zP(s,u);let d=new Ba(l.target,u,c,l.sequenceNumber);pC(s,d)}),s.remoteSyncer.applyRemoteEvent(a)}(t,n))}catch(r){D("RemoteStore","Failed to raise snapshot:",r),yield ig(t,r)}})}function ig(t,e,n){return v(this,null,function*(){if(!ji(e))throw e;t.v_.add(1),yield Xa(t),t.x_.set("Offline"),n||(n=()=>UP(t.localStore)),t.asyncQueue.enqueueRetryable(()=>v(this,null,function*(){D("RemoteStore","Retrying IndexedDB access"),yield n(),t.v_.delete(1),yield Hl(t)}))})}function KP(t,e){return e().catch(n=>ig(t,n,e))}function Ja(t){return v(this,null,function*(){let e=N(t),n=Vi(e),r=e.D_.length>0?e.D_[e.D_.length-1].batchId:-1;for(;uz(e);)try{let i=yield tz(e.localStore,r);if(i===null){e.D_.length===0&&n.Xo();break}r=i.batchId,cz(e,i)}catch(i){yield ig(e,i)}QP(e)&&YP(e)})}function uz(t){return Ui(t)&&t.D_.length<10}function cz(t,e){t.D_.push(e);let n=Vi(t);n.Jo()&&n.P_&&n.I_(e.mutations)}function QP(t){return Ui(t)&&!Vi(t).Ho()&&t.D_.length>0}function YP(t){Vi(t).start()}function lz(t){return v(this,null,function*(){Vi(t).d_()})}function dz(t){return v(this,null,function*(){let e=Vi(t);for(let n of t.D_)e.I_(n.mutations)})}function hz(t,e,n){return v(this,null,function*(){let r=t.D_.shift(),i=PE.from(r,e,n);yield KP(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),yield Ja(t)})}function fz(t,e){return v(this,null,function*(){e&&Vi(t).P_&&(yield function(r,i){return v(this,null,function*(){if(function(o){return mP(o)&&o!==y.ABORTED}(i.code)){let s=r.D_.shift();Vi(r).Zo(),yield KP(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),yield Ja(r)}})}(t,e)),QP(t)&&YP(t)})}function TN(t,e){return v(this,null,function*(){let n=N(t);n.asyncQueue.verifyOperationInProgress(),D("RemoteStore","RemoteStore received new credentials");let r=Ui(n);n.v_.add(3),yield Xa(n),r&&n.x_.set("Unknown"),yield n.remoteSyncer.handleCredentialChange(e),n.v_.delete(3),yield Hl(n)})}function bI(t,e){return v(this,null,function*(){let n=N(t);e?(n.v_.delete(2),yield Hl(n)):e||(n.v_.add(2),yield Xa(n),n.x_.set("Unknown"))})}function eu(t){return t.N_||(t.N_=function(n,r,i){let s=N(n);return s.R_(),new EI(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Po:sz.bind(null,t),To:oz.bind(null,t),u_:az.bind(null,t)}),t.F_.push(e=>v(this,null,function*(){e?(t.N_.Zo(),mC(t)?gC(t):t.x_.set("Unknown")):(yield t.N_.stop(),WP(t))}))),t.N_}function Vi(t){return t.B_||(t.B_=function(n,r,i){let s=N(n);return s.R_(),new II(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Po:lz.bind(null,t),To:fz.bind(null,t),E_:dz.bind(null,t),T_:hz.bind(null,t)}),t.F_.push(e=>v(this,null,function*(){e?(t.B_.Zo(),yield Ja(t)):(yield t.B_.stop(),t.D_.length>0&&(D("RemoteStore",`Stopping write stream with ${t.D_.length} pending writes`),t.D_=[]))}))),t.B_}var SI=class t{constructor(e,n,r,i,s){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new st,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,i,s){let o=Date.now()+r,a=new t(e,n,o,i,s);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new I(y.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function tu(t,e){if(ze("AsyncQueue",`${e}: ${t}`),ji(t))return new I(y.UNAVAILABLE,`${e}: ${t}`);throw t}var sg=class t{constructor(e){this.comparator=e?(n,r)=>e(n,r)||M.comparator(n.key,r.key):(n,r)=>M.comparator(n.key,r.key),this.keyedMap=ul(),this.sortedSet=new Ne(this.comparator)}static emptySet(e){return new t(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){let n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){let n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof t)||this.size!==e.size)return!1;let n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){let i=n.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){let e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){let r=new t;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}};var og=class{constructor(){this.L_=new Ne(M.comparator)}track(e){let n=e.doc.key,r=this.L_.get(n);r?e.type!==0&&r.type===3?this.L_=this.L_.insert(n,e):e.type===3&&r.type!==1?this.L_=this.L_.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.L_=this.L_.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.L_=this.L_.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.L_=this.L_.remove(n):e.type===1&&r.type===2?this.L_=this.L_.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.L_=this.L_.insert(n,{type:2,doc:e.doc}):O():this.L_=this.L_.insert(n,e)}k_(){let e=[];return this.L_.inorderTraversal((n,r)=>{e.push(r)}),e}},Ga=class t{constructor(e,n,r,i,s,o,a,u,c){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=u,this.hasCachedResults=c}static fromInitialDocuments(e,n,r,i,s){let o=[];return n.forEach(a=>{o.push({type:0,doc:a})}),new t(e,n,sg.emptySet(n),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Ul(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;let n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let i=0;i<n.length;i++)if(n[i].type!==r[i].type||!n[i].doc.isEqual(r[i].doc))return!1;return!0}};var AI=class{constructor(){this.q_=void 0,this.Q_=[]}},xI=class{constructor(){this.queries=new _r(e=>tP(e),Ul),this.onlineState="Unknown",this.K_=new Set}};function yC(t,e){return v(this,null,function*(){let n=N(t),r=e.query,i=!1,s=n.queries.get(r);if(s||(i=!0,s=new AI),i)try{s.q_=yield n.onListen(r)}catch(o){let a=tu(o,`Initialization of query '${ba(e.query)}' failed`);return void e.onError(a)}n.queries.set(r,s),s.Q_.push(e),e.U_(n.onlineState),s.q_&&e.W_(s.q_)&&vC(n)})}function _C(t,e){return v(this,null,function*(){let n=N(t),r=e.query,i=!1,s=n.queries.get(r);if(s){let o=s.Q_.indexOf(e);o>=0&&(s.Q_.splice(o,1),i=s.Q_.length===0)}if(i)return n.queries.delete(r),n.onUnlisten(r)})}function pz(t,e){let n=N(t),r=!1;for(let i of e){let s=i.query,o=n.queries.get(s);if(o){for(let a of o.Q_)a.W_(i)&&(r=!0);o.q_=i}}r&&vC(n)}function gz(t,e,n){let r=N(t),i=r.queries.get(e);if(i)for(let s of i.Q_)s.onError(n);r.queries.delete(e)}function vC(t){t.K_.forEach(e=>{e.next()})}var Pl=class{constructor(e,n,r){this.query=e,this.G_=n,this.z_=!1,this.j_=null,this.onlineState="Unknown",this.options=r||{}}W_(e){if(!this.options.includeMetadataChanges){let r=[];for(let i of e.docChanges)i.type!==3&&r.push(i);e=new Ga(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.z_?this.H_(e)&&(this.G_.next(e),n=!0):this.J_(e,this.onlineState)&&(this.Y_(e),n=!0),this.j_=e,n}onError(e){this.G_.error(e)}U_(e){this.onlineState=e;let n=!1;return this.j_&&!this.z_&&this.J_(this.j_,e)&&(this.Y_(this.j_),n=!0),n}J_(e,n){if(!e.fromCache)return!0;let r=n!=="Offline";return(!this.options.Z_||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}H_(e){if(e.docChanges.length>0)return!0;let n=this.j_&&this.j_.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}Y_(e){e=Ga.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.z_=!0,this.G_.next(e)}};var MI=class{constructor(e,n){this.X_=e,this.byteLength=n}ea(){return"metadata"in this.X_}};var ag=class{constructor(e){this.serializer=e}Ps(e){return pr(this.serializer,e)}Is(e){return e.metadata.exists?DP(this.serializer,e.document,!1):ot.newNoDocument(this.Ps(e.metadata.name),this.Ts(e.metadata.readTime))}Ts(e){return Ke(e)}},RI=class{constructor(e,n,r){this.ta=e,this.localStore=n,this.serializer=r,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=ZP(e)}na(e){this.progress.bytesLoaded+=e.byteLength;let n=this.progress.documentsLoaded;if(e.X_.namedQuery)this.queries.push(e.X_.namedQuery);else if(e.X_.documentMetadata){this.documents.push({metadata:e.X_.documentMetadata}),e.X_.documentMetadata.exists||++n;let r=me.fromString(e.X_.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.X_.document&&(this.documents[this.documents.length-1].document=e.X_.document,++n);return n!==this.progress.documentsLoaded?(this.progress.documentsLoaded=n,Object.assign({},this.progress)):null}ra(e){let n=new Map,r=new ag(this.serializer);for(let i of e)if(i.metadata.queries){let s=r.Ps(i.metadata.name);for(let o of i.metadata.queries){let a=(n.get(o)||ee()).add(s);n.set(o,a)}}return n}complete(){return v(this,null,function*(){let e=yield nz(this.localStore,new ag(this.serializer),this.documents,this.ta.id),n=this.ra(this.documents);for(let r of this.queries)yield rz(this.localStore,r,n.get(r.name));return this.progress.taskState="Success",{progress:this.progress,ia:this.collectionGroups,sa:e}})}};function ZP(t){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}var ug=class{constructor(e){this.key=e}},cg=class{constructor(e){this.key=e}},lg=class{constructor(e,n){this.query=e,this.oa=n,this._a=null,this.hasCachedResults=!1,this.current=!1,this.aa=ee(),this.mutatedKeys=ee(),this.ua=rP(e),this.ca=new sg(this.ua)}get la(){return this.oa}ha(e,n){let r=n?n.Pa:new og,i=n?n.ca:this.ca,s=n?n.mutatedKeys:this.mutatedKeys,o=i,a=!1,u=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,c=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((l,d)=>{let h=i.get(l),f=Bl(this.query,d)?d:null,p=!!h&&this.mutatedKeys.has(h.key),g=!!f&&(f.hasLocalMutations||this.mutatedKeys.has(f.key)&&f.hasCommittedMutations),_=!1;h&&f?h.data.isEqual(f.data)?p!==g&&(r.track({type:3,doc:f}),_=!0):this.Ia(h,f)||(r.track({type:2,doc:f}),_=!0,(u&&this.ua(f,u)>0||c&&this.ua(f,c)<0)&&(a=!0)):!h&&f?(r.track({type:0,doc:f}),_=!0):h&&!f&&(r.track({type:1,doc:h}),_=!0,(u||c)&&(a=!0)),_&&(f?(o=o.add(f),s=g?s.add(l):s.delete(l)):(o=o.delete(l),s=s.delete(l)))}),this.query.limit!==null)for(;o.size>this.query.limit;){let l=this.query.limitType==="F"?o.last():o.first();o=o.delete(l.key),s=s.delete(l.key),r.track({type:1,doc:l})}return{ca:o,Pa:r,Xi:a,mutatedKeys:s}}Ia(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,i){let s=this.ca;this.ca=e.ca,this.mutatedKeys=e.mutatedKeys;let o=e.Pa.k_();o.sort((l,d)=>function(f,p){let g=_=>{switch(_){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return O()}};return g(f)-g(p)}(l.type,d.type)||this.ua(l.doc,d.doc)),this.Ta(r),i=i!=null&&i;let a=n&&!i?this.Ea():[],u=this.aa.size===0&&this.current&&!i?1:0,c=u!==this._a;return this._a=u,o.length!==0||c?{snapshot:new Ga(this.query,e.ca,s,o,e.mutatedKeys,u===0,c,!1,!!r&&r.resumeToken.approximateByteSize()>0),da:a}:{da:a}}U_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({ca:this.ca,Pa:new og,mutatedKeys:this.mutatedKeys,Xi:!1},!1)):{da:[]}}Aa(e){return!this.oa.has(e)&&!!this.ca.has(e)&&!this.ca.get(e).hasLocalMutations}Ta(e){e&&(e.addedDocuments.forEach(n=>this.oa=this.oa.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.oa=this.oa.delete(n)),this.current=e.current)}Ea(){if(!this.current)return[];let e=this.aa;this.aa=ee(),this.ca.forEach(r=>{this.Aa(r.key)&&(this.aa=this.aa.add(r.key))});let n=[];return e.forEach(r=>{this.aa.has(r)||n.push(new cg(r))}),this.aa.forEach(r=>{e.has(r)||n.push(new ug(r))}),n}Ra(e){this.oa=e.hs,this.aa=ee();let n=this.ha(e.documents);return this.applyChanges(n,!0)}Va(){return Ga.fromInitialDocuments(this.query,this.ca,this.mutatedKeys,this._a===0,this.hasCachedResults)}},NI=class{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}},PI=class{constructor(e){this.key=e,this.ma=!1}},kI=class{constructor(e,n,r,i,s,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.fa={},this.ga=new _r(a=>tP(a),Ul),this.pa=new Map,this.ya=new Set,this.wa=new Ne(M.comparator),this.Sa=new Map,this.ba=new xl,this.Da={},this.Ca=new Map,this.va=$a.Bn(),this.onlineState="Unknown",this.Fa=void 0}get isPrimaryClient(){return this.Fa===!0}};function mz(t,e){return v(this,null,function*(){let n=DC(t),r,i,s=n.ga.get(e);if(s)r=s.targetId,n.sharedClientState.addLocalQueryTarget(r),i=s.view.Va();else{let o=yield Ha(n.localStore,Bt(e)),a=n.sharedClientState.addLocalQueryTarget(o.targetId);r=o.targetId,i=yield wC(n,e,r,a==="current",o.resumeToken),n.isPrimaryClient&&Ig(n.remoteStore,o)}return i})}function wC(t,e,n,r,i){return v(this,null,function*(){t.Ma=(d,h,f)=>function(g,_,b,P){return v(this,null,function*(){let A=_.view.ha(b);A.Xi&&(A=yield Xp(g.localStore,_.query,!1).then(({documents:Pe})=>_.view.ha(Pe,A)));let H=P&&P.targetChanges.get(_.targetId),G=P&&P.targetMismatches.get(_.targetId)!=null,J=_.view.applyChanges(A,g.isPrimaryClient,H,G);return OI(g,_.targetId,J.da),J.snapshot})}(t,d,h,f);let s=yield Xp(t.localStore,e,!0),o=new lg(e,s.hs),a=o.ha(s.documents),u=Tl.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",i),c=o.applyChanges(a,t.isPrimaryClient,u);OI(t,n,c.da);let l=new NI(e,n,o);return t.ga.set(e,l),t.pa.has(n)?t.pa.get(n).push(e):t.pa.set(n,[e]),c.snapshot})}function yz(t,e){return v(this,null,function*(){let n=N(t),r=n.ga.get(e),i=n.pa.get(r.targetId);if(i.length>1)return n.pa.set(r.targetId,i.filter(s=>!Ul(s,e))),void n.ga.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(r.targetId),n.sharedClientState.isActiveQueryTarget(r.targetId)||(yield qa(n.localStore,r.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(r.targetId),Nl(n.remoteStore,r.targetId),za(n,r.targetId)}).catch(Li))):(za(n,r.targetId),yield qa(n.localStore,r.targetId,!0))})}function _z(t,e,n){return v(this,null,function*(){let r=TC(t);try{let i=yield function(o,a){let u=N(o),c=Le.now(),l=a.reduce((f,p)=>f.add(p.key),ee()),d,h;return u.persistence.runTransaction("Locally write mutations","readwrite",f=>{let p=Zt(),g=ee();return u.os.getEntries(f,l).next(_=>{p=_,p.forEach((b,P)=>{P.isValidDocument()||(g=g.add(b))})}).next(()=>u.localDocuments.getOverlayedDocuments(f,p)).next(_=>{d=_;let b=[];for(let P of a){let A=OG(P,d.get(P.key).overlayedDocument);A!=null&&b.push(new Hn(P.key,A,KN(A.value.mapValue),$e.exists(!0)))}return u.mutationQueue.addMutationBatch(f,c,b,a)}).next(_=>{h=_;let b=_.applyToLocalDocumentSet(d,g);return u.documentOverlayCache.saveOverlays(f,_.batchId,b)})}).then(()=>({batchId:h.batchId,changes:sP(d)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(o,a,u){let c=o.Da[o.currentUser.toKey()];c||(c=new Ne(Z)),c=c.insert(a,u),o.Da[o.currentUser.toKey()]=c}(r,i.batchId,n),yield Wr(r,i.changes),yield Ja(r.remoteStore)}catch(i){let s=tu(i,"Failed to persist write");n.reject(s)}})}function XP(t,e){return v(this,null,function*(){let n=N(t);try{let r=yield ez(n.localStore,e);e.targetChanges.forEach((i,s)=>{let o=n.Sa.get(s);o&&(L(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?o.ma=!0:i.modifiedDocuments.size>0?L(o.ma):i.removedDocuments.size>0&&(L(o.ma),o.ma=!1))}),yield Wr(n,r,e)}catch(r){yield Li(r)}})}function bN(t,e,n){let r=N(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){let i=[];r.ga.forEach((s,o)=>{let a=o.view.U_(e);a.snapshot&&i.push(a.snapshot)}),function(o,a){let u=N(o);u.onlineState=a;let c=!1;u.queries.forEach((l,d)=>{for(let h of d.Q_)h.U_(a)&&(c=!0)}),c&&vC(u)}(r.eventManager,e),i.length&&r.fa.u_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function vz(t,e,n){return v(this,null,function*(){let r=N(t);r.sharedClientState.updateQueryState(e,"rejected",n);let i=r.Sa.get(e),s=i&&i.key;if(s){let o=new Ne(M.comparator);o=o.insert(s,ot.newNoDocument(s,B.min()));let a=ee().add(s),u=new Dl(B.min(),new Map,new Ne(Z),o,a);yield XP(r,u),r.wa=r.wa.remove(s),r.Sa.delete(e),CC(r)}else yield qa(r.localStore,e,!1).then(()=>za(r,e,n)).catch(Li)})}function wz(t,e){return v(this,null,function*(){let n=N(t),r=e.batch.batchId;try{let i=yield JG(n.localStore,e);IC(n,r,null),EC(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),yield Wr(n,i)}catch(i){yield Li(i)}})}function Ez(t,e,n){return v(this,null,function*(){let r=N(t);try{let i=yield function(o,a){let u=N(o);return u.persistence.runTransaction("Reject batch","readwrite-primary",c=>{let l;return u.mutationQueue.lookupMutationBatch(c,a).next(d=>(L(d!==null),l=d.keys(),u.mutationQueue.removeMutationBatch(c,d))).next(()=>u.mutationQueue.performConsistencyCheck(c)).next(()=>u.documentOverlayCache.removeOverlaysForBatchId(c,l,a)).next(()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,l)).next(()=>u.localDocuments.getDocuments(c,l))})}(r.localStore,e);IC(r,e,n),EC(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),yield Wr(r,i)}catch(i){yield Li(i)}})}function Iz(t,e){return v(this,null,function*(){let n=N(t);Ui(n.remoteStore)||D("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{let r=yield function(o){let a=N(o);return a.persistence.runTransaction("Get highest unacknowledged batch id","readonly",u=>a.mutationQueue.getHighestUnacknowledgedBatchId(u))}(n.localStore);if(r===-1)return void e.resolve();let i=n.Ca.get(r)||[];i.push(e),n.Ca.set(r,i)}catch(r){let i=tu(r,"Initialization of waitForPendingWrites() operation failed");e.reject(i)}})}function EC(t,e){(t.Ca.get(e)||[]).forEach(n=>{n.resolve()}),t.Ca.delete(e)}function IC(t,e,n){let r=N(t),i=r.Da[r.currentUser.toKey()];if(i){let s=i.get(e);s&&(n?s.reject(n):s.resolve(),i=i.remove(e)),r.Da[r.currentUser.toKey()]=i}}function za(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(let r of t.pa.get(e))t.ga.delete(r),n&&t.fa.xa(r,n);t.pa.delete(e),t.isPrimaryClient&&t.ba.Vr(e).forEach(r=>{t.ba.containsKey(r)||JP(t,r)})}function JP(t,e){t.ya.delete(e.path.canonicalString());let n=t.wa.get(e);n!==null&&(Nl(t.remoteStore,n),t.wa=t.wa.remove(e),t.Sa.delete(n),CC(t))}function OI(t,e,n){for(let r of n)r instanceof ug?(t.ba.addReference(r.key,e),Cz(t,r)):r instanceof cg?(D("SyncEngine","Document no longer in limbo: "+r.key),t.ba.removeReference(r.key,e),t.ba.containsKey(r.key)||JP(t,r.key)):O()}function Cz(t,e){let n=e.key,r=n.path.canonicalString();t.wa.get(n)||t.ya.has(r)||(D("SyncEngine","New document in limbo: "+n),t.ya.add(r),CC(t))}function CC(t){for(;t.ya.size>0&&t.wa.size<t.maxConcurrentLimboResolutions;){let e=t.ya.values().next().value;t.ya.delete(e);let n=new M(me.fromString(e)),r=t.va.next();t.Sa.set(r,new PI(n)),t.wa=t.wa.insert(n,r),Ig(t.remoteStore,new Ba(Bt(Za(n.path)),r,"TargetPurposeLimboResolution",sn._e))}}function Wr(t,e,n){return v(this,null,function*(){let r=N(t),i=[],s=[],o=[];r.ga.isEmpty()||(r.ga.forEach((a,u)=>{o.push(r.Ma(u,e,n).then(c=>{if((c||n)&&r.isPrimaryClient&&r.sharedClientState.updateQueryState(u.targetId,c?.fromCache?"not-current":"current"),c){i.push(c);let l=pI.Ki(u.targetId,c);s.push(l)}}))}),yield Promise.all(o),r.fa.u_(i),yield function(u,c){return v(this,null,function*(){let l=N(u);try{yield l.persistence.runTransaction("notifyLocalViewChanges","readwrite",d=>m.forEach(c,h=>m.forEach(h.qi,f=>l.persistence.referenceDelegate.addReference(d,h.targetId,f)).next(()=>m.forEach(h.Qi,f=>l.persistence.referenceDelegate.removeReference(d,h.targetId,f)))))}catch(d){if(!ji(d))throw d;D("LocalStore","Failed to update sequence numbers: "+d)}for(let d of c){let h=d.targetId;if(!d.fromCache){let f=l.ns.get(h),p=f.snapshotVersion,g=f.withLastLimboFreeSnapshotVersion(p);l.ns=l.ns.insert(h,g)}}})}(r.localStore,s))})}function Dz(t,e){return v(this,null,function*(){let n=N(t);if(!n.currentUser.isEqual(e)){D("SyncEngine","User change. New user:",e.toKey());let r=yield jP(n.localStore,e);n.currentUser=e,function(s,o){s.Ca.forEach(a=>{a.forEach(u=>{u.reject(new I(y.CANCELLED,o))})}),s.Ca.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),yield Wr(n,r.us)}})}function Tz(t,e){let n=N(t),r=n.Sa.get(e);if(r&&r.ma)return ee().add(r.key);{let i=ee(),s=n.pa.get(e);if(!s)return i;for(let o of s){let a=n.ga.get(o);i=i.unionWith(a.view.la)}return i}}function bz(t,e){return v(this,null,function*(){let n=N(t),r=yield Xp(n.localStore,e.query,!0),i=e.view.Ra(r);return n.isPrimaryClient&&OI(n,e.targetId,i.da),i})}function Sz(t,e){return v(this,null,function*(){let n=N(t);return HP(n.localStore,e).then(r=>Wr(n,r))})}function Az(t,e,n,r){return v(this,null,function*(){let i=N(t),s=yield function(a,u){let c=N(a),l=N(c.mutationQueue);return c.persistence.runTransaction("Lookup mutation documents","readonly",d=>l.vn(d,u).next(h=>h?c.localDocuments.getDocuments(d,h):m.resolve(null)))}(i.localStore,e);s!==null?(n==="pending"?yield Ja(i.remoteStore):n==="acknowledged"||n==="rejected"?(IC(i,e,r||null),EC(i,e),function(a,u){N(N(a).mutationQueue).Mn(u)}(i.localStore,e)):O(),yield Wr(i,s)):D("SyncEngine","Cannot apply mutation batch with id: "+e)})}function xz(t,e){return v(this,null,function*(){let n=N(t);if(DC(n),TC(n),e===!0&&n.Fa!==!0){let r=n.sharedClientState.getAllActiveQueryTargets(),i=yield SN(n,r.toArray());n.Fa=!0,yield bI(n.remoteStore,!0);for(let s of i)Ig(n.remoteStore,s)}else if(e===!1&&n.Fa!==!1){let r=[],i=Promise.resolve();n.pa.forEach((s,o)=>{n.sharedClientState.isLocalQueryTarget(o)?r.push(o):i=i.then(()=>(za(n,o),qa(n.localStore,o,!0))),Nl(n.remoteStore,o)}),yield i,yield SN(n,r),function(o){let a=N(o);a.Sa.forEach((u,c)=>{Nl(a.remoteStore,c)}),a.ba.mr(),a.Sa=new Map,a.wa=new Ne(M.comparator)}(n),n.Fa=!1,yield bI(n.remoteStore,!1)}})}function SN(t,e,n){return v(this,null,function*(){let r=N(t),i=[],s=[];for(let o of e){let a,u=r.pa.get(o);if(u&&u.length!==0){a=yield Ha(r.localStore,Bt(u[0]));for(let c of u){let l=r.ga.get(c),d=yield bz(r,l);d.snapshot&&s.push(d.snapshot)}}else{let c=yield $P(r.localStore,o);a=yield Ha(r.localStore,c),yield wC(r,ek(c),o,!1,a.resumeToken)}i.push(a)}return r.fa.u_(s),i})}function ek(t){return eP(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function Mz(t){return function(n){return N(N(n).persistence).Li()}(N(t).localStore)}function Rz(t,e,n,r){return v(this,null,function*(){let i=N(t);if(i.Fa)return void D("SyncEngine","Ignoring unexpected query state notification.");let s=i.pa.get(e);if(s&&s.length>0)switch(n){case"current":case"not-current":{let o=yield HP(i.localStore,nP(s[0])),a=Dl.createSynthesizedRemoteEventForCurrentChange(e,n==="current",pt.EMPTY_BYTE_STRING);yield Wr(i,o,a);break}case"rejected":yield qa(i.localStore,e,!0),za(i,e,r);break;default:O()}})}function Nz(t,e,n){return v(this,null,function*(){let r=DC(t);if(r.Fa){for(let i of e){if(r.pa.has(i)){D("SyncEngine","Adding an already active target "+i);continue}let s=yield $P(r.localStore,i),o=yield Ha(r.localStore,s);yield wC(r,ek(s),o.targetId,!1,o.resumeToken),Ig(r.remoteStore,o)}for(let i of n)r.pa.has(i)&&(yield qa(r.localStore,i,!1).then(()=>{Nl(r.remoteStore,i),za(r,i)}).catch(Li))}})}function DC(t){let e=N(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=XP.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=Tz.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=vz.bind(null,e),e.fa.u_=pz.bind(null,e.eventManager),e.fa.xa=gz.bind(null,e.eventManager),e}function TC(t){let e=N(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=wz.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=Ez.bind(null,e),e}function Pz(t,e,n){let r=N(t);(function(s,o,a){return v(this,null,function*(){try{let u=yield o.getMetadata();if(yield function(f,p){let g=N(f),_=Ke(p.createTime);return g.persistence.runTransaction("hasNewerBundle","readonly",b=>g.$r.getBundleMetadata(b,p.id)).then(b=>!!b&&b.createTime.compareTo(_)>=0)}(s.localStore,u))return yield o.close(),a._completeWith(function(f){return{taskState:"Success",documentsLoaded:f.totalDocuments,bytesLoaded:f.totalBytes,totalDocuments:f.totalDocuments,totalBytes:f.totalBytes}}(u)),Promise.resolve(new Set);a._updateProgress(ZP(u));let c=new RI(u,s.localStore,o.serializer),l=yield o.Oa();for(;l;){let h=yield c.na(l);h&&a._updateProgress(h),l=yield o.Oa()}let d=yield c.complete();return yield Wr(s,d.sa,void 0),yield function(f,p){let g=N(f);return g.persistence.runTransaction("Save bundle","readwrite",_=>g.$r.saveBundleMetadata(_,p))}(s.localStore,u),a._completeWith(d.progress),Promise.resolve(d.ia)}catch(u){return Dn("SyncEngine",`Loading bundle failed with ${u}`),a._failWith(u),Promise.resolve(new Set)}})})(r,e,n).then(i=>{r.sharedClientState.notifyBundleLoaded(i)})}var kl=class{constructor(){this.synchronizeTabs=!1}initialize(e){return v(this,null,function*(){this.serializer=$l(e.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(e),this.persistence=this.createPersistence(e),yield this.persistence.start(),this.localStore=this.createLocalStore(e),this.gcScheduler=this.createGarbageCollectionScheduler(e,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(e,this.localStore)})}createGarbageCollectionScheduler(e,n){return null}createIndexBackfillerScheduler(e,n){return null}createLocalStore(e){return LP(this.persistence,new Zp,e.initialUser,this.serializer)}createPersistence(e){return new Qp(Yp.Hr,this.serializer)}createSharedClientState(e){return new tg}terminate(){return v(this,null,function*(){var e,n;(e=this.gcScheduler)===null||e===void 0||e.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),yield this.persistence.shutdown()})}};var dg=class t extends kl{constructor(e,n,r){super(),this.Na=e,this.cacheSizeBytes=n,this.forceOwnership=r,this.synchronizeTabs=!1}initialize(e){return v(this,null,function*(){yield Om(t.prototype,this,"initialize").call(this,e),yield this.Na.initialize(this,e),yield TC(this.Na.syncEngine),yield Ja(this.Na.remoteStore),yield this.persistence.fi(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))})}createLocalStore(e){return LP(this.persistence,new Zp,e.initialUser,this.serializer)}createGarbageCollectionScheduler(e,n){let r=this.persistence.referenceDelegate.garbageCollector;return new JE(r,e.asyncQueue,n)}createIndexBackfillerScheduler(e,n){let r=new yE(n,this.persistence);return new mE(e.asyncQueue,r)}createPersistence(e){let n=fC(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?Cn.withCacheSize(this.cacheSizeBytes):Cn.DEFAULT;return new fI(this.synchronizeTabs,n,e.clientId,r,e.asyncQueue,GP(),Cp(),this.serializer,this.sharedClientState,!!this.forceOwnership)}createSharedClientState(e){return new tg}},FI=class t extends dg{constructor(e,n){super(e,n,!1),this.Na=e,this.cacheSizeBytes=n,this.synchronizeTabs=!0}initialize(e){return v(this,null,function*(){yield Om(t.prototype,this,"initialize").call(this,e);let n=this.Na.syncEngine;this.sharedClientState instanceof pl&&(this.sharedClientState.syncEngine={Zs:Az.bind(null,n),Xs:Rz.bind(null,n),eo:Nz.bind(null,n),Li:Mz.bind(null,n),Ys:Sz.bind(null,n)},yield this.sharedClientState.start()),yield this.persistence.fi(r=>v(this,null,function*(){yield xz(this.Na.syncEngine,r),this.gcScheduler&&(r&&!this.gcScheduler.started?this.gcScheduler.start():r||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(r&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():r||this.indexBackfillerScheduler.stop())}))})}createSharedClientState(e){let n=GP();if(!pl.D(n))throw new I(y.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");let r=fC(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new pl(n,e.asyncQueue,r,e.clientId,e.initialUser)}},Ol=class{initialize(e,n){return v(this,null,function*(){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>bN(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=Dz.bind(null,this.syncEngine),yield bI(this.remoteStore,this.syncEngine.isPrimaryClient))})}createEventManager(e){return function(){return new xI}()}createDatastore(e){let n=$l(e.databaseInfo.databaseId),r=function(s){return new wI(s)}(e.databaseInfo);return function(s,o,a,u){return new CI(s,o,a,u)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,i,s,o,a){return new TI(r,i,s,o,a)}(this.localStore,this.datastore,e.asyncQueue,n=>bN(this.syncEngine,n,0),function(){return ng.D()?new ng:new _I}())}createSyncEngine(e,n){return function(i,s,o,a,u,c,l){let d=new kI(i,s,o,a,u,c);return l&&(d.Fa=!0),d}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}terminate(){return v(this,null,function*(){var e;yield function(r){return v(this,null,function*(){let i=N(r);D("RemoteStore","RemoteStore shutting down."),i.v_.add(5),yield Xa(i),i.M_.shutdown(),i.x_.set("Unknown")})}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate()})}};function AN(t,e=10240){let n=0;return{read(){return v(this,null,function*(){if(n<t.byteLength){let i={value:t.slice(n,n+e),done:!1};return n+=e,i}return{done:!0}})},cancel(){return v(this,null,function*(){})},releaseLock(){},closed:Promise.resolve()}}var Wa=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Ba(this.observer.next,e)}error(e){this.observer.error?this.Ba(this.observer.error,e):ze("Uncaught Error in snapshot listener:",e.toString())}La(){this.muted=!0}Ba(e,n){this.muted||setTimeout(()=>{this.muted||e(n)},0)}};var VI=class{constructor(e,n){this.ka=e,this.serializer=n,this.metadata=new st,this.buffer=new Uint8Array,this.qa=function(){return new TextDecoder("utf-8")}(),this.Qa().then(r=>{r&&r.ea()?this.metadata.resolve(r.X_.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(r?.X_)}`))},r=>this.metadata.reject(r))}close(){return this.ka.cancel()}getMetadata(){return v(this,null,function*(){return this.metadata.promise})}Oa(){return v(this,null,function*(){return yield this.getMetadata(),this.Qa()})}Qa(){return v(this,null,function*(){let e=yield this.Ka();if(e===null)return null;let n=this.qa.decode(e),r=Number(n);isNaN(r)&&this.$a(`length string (${n}) is not valid number`);let i=yield this.Ua(r);return new MI(JSON.parse(i),e.length+r)})}Wa(){return this.buffer.findIndex(e=>e===123)}Ka(){return v(this,null,function*(){for(;this.Wa()<0&&!(yield this.Ga()););if(this.buffer.length===0)return null;let e=this.Wa();e<0&&this.$a("Reached the end of bundle when a length string is expected.");let n=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),n})}Ua(e){return v(this,null,function*(){for(;this.buffer.length<e;)(yield this.Ga())&&this.$a("Reached the end of bundle when more is expected.");let n=this.qa.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),n})}$a(e){throw this.ka.cancel(),new Error(`Invalid bundle format: ${e}`)}Ga(){return v(this,null,function*(){let e=yield this.ka.read();if(!e.done){let n=new Uint8Array(this.buffer.length+e.value.length);n.set(this.buffer),n.set(e.value,this.buffer.length),this.buffer=n}return e.done})}};var LI=class{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}lookup(e){return v(this,null,function*(){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new I(y.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;let n=yield function(i,s){return v(this,null,function*(){let o=N(i),a={documents:s.map(d=>bl(o.serializer,d))},u=yield o.vo("BatchGetDocuments",o.serializer.databaseId,me.emptyPath(),a,s.length),c=new Map;u.forEach(d=>{let h=BG(o.serializer,d);c.set(h.key.toString(),h)});let l=[];return s.forEach(d=>{let h=c.get(d.toString());L(!!h),l.push(h)}),l})}(this.datastore,e);return n.forEach(r=>this.recordVersion(r)),n})}set(e,n){this.write(n.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,n){try{this.write(n.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastTransactionError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new Fi(e,this.precondition(e))),this.writtenDocs.add(e.toString())}commit(){return v(this,null,function*(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;let e=this.readVersions;this.mutations.forEach(n=>{e.delete(n.key.toString())}),e.forEach((n,r)=>{let i=M.fromPath(r);this.mutations.push(new El(i,this.precondition(i)))}),yield function(r,i){return v(this,null,function*(){let s=N(r),o={writes:i.map(a=>Sl(s.serializer,a))};yield s.So("Commit",s.serializer.databaseId,me.emptyPath(),o)})}(this.datastore,this.mutations),this.committed=!0})}recordVersion(e){let n;if(e.isFoundDocument())n=e.version;else{if(!e.isNoDocument())throw O();n=B.min()}let r=this.readVersions.get(e.key.toString());if(r){if(!n.isEqual(r))throw new I(y.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),n)}precondition(e){let n=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&n?n.isEqual(B.min())?$e.exists(!1):$e.updateTime(n):$e.none()}preconditionForUpdate(e){let n=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&n){if(n.isEqual(B.min()))throw new I(y.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return $e.updateTime(n)}return $e.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}};var jI=class{constructor(e,n,r,i,s){this.asyncQueue=e,this.datastore=n,this.options=r,this.updateFunction=i,this.deferred=s,this.za=r.maxAttempts,this.jo=new Rl(this.asyncQueue,"transaction_retry")}ja(){this.za-=1,this.Ha()}Ha(){this.jo.qo(()=>v(this,null,function*(){let e=new LI(this.datastore),n=this.Ja(e);n&&n.then(r=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(r)}).catch(i=>{this.Ya(i)}))}).catch(r=>{this.Ya(r)})}))}Ja(e){try{let n=this.updateFunction(e);return!Ll(n)&&n.catch&&n.then?n:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(n){return this.deferred.reject(n),null}}Ya(e){this.za>0&&this.Za(e)?(this.za-=1,this.asyncQueue.enqueueAndForget(()=>(this.Ha(),Promise.resolve()))):this.deferred.reject(e)}Za(e){if(e.name==="FirebaseError"){let n=e.code;return n==="aborted"||n==="failed-precondition"||n==="already-exists"||!mP(n)}return!1}};var UI=class{constructor(e,n,r,i){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=i,this.user=it.UNAUTHENTICATED,this.clientId=bp.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,s=>v(this,null,function*(){D("FirestoreClient","Received user=",s.uid),yield this.authCredentialListener(s),this.user=s})),this.appCheckCredentials.start(r,s=>(D("FirestoreClient","Received new app check token=",s),this.appCheckCredentialListener(s,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new I(y.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();let e=new st;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(()=>v(this,null,function*(){try{this._onlineComponents&&(yield this._onlineComponents.terminate()),this._offlineComponents&&(yield this._offlineComponents.terminate()),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){let r=tu(n,"Failed to shutdown persistence");e.reject(r)}})),e.promise}};function Dp(t,e){return v(this,null,function*(){t.asyncQueue.verifyOperationInProgress(),D("FirestoreClient","Initializing OfflineComponentProvider");let n=t.configuration;yield e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(i=>v(this,null,function*(){r.isEqual(i)||(yield jP(e.localStore,i),r=i)})),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e})}function BI(t,e){return v(this,null,function*(){t.asyncQueue.verifyOperationInProgress();let n=yield bC(t);D("FirestoreClient","Initializing OnlineComponentProvider"),yield e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>TN(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,i)=>TN(e.remoteStore,i)),t._onlineComponents=e})}function tk(t){return t.name==="FirebaseError"?t.code===y.FAILED_PRECONDITION||t.code===y.UNIMPLEMENTED:!(typeof DOMException<"u"&&t instanceof DOMException)||t.code===22||t.code===20||t.code===11}function bC(t){return v(this,null,function*(){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){D("FirestoreClient","Using user provided OfflineComponentProvider");try{yield Dp(t,t._uninitializedComponentsProvider._offline)}catch(e){let n=e;if(!tk(n))throw n;Dn("Error using user provided cache. Falling back to memory cache: "+n),yield Dp(t,new kl)}}else D("FirestoreClient","Using default OfflineComponentProvider"),yield Dp(t,new kl);return t._offlineComponents})}function Cg(t){return v(this,null,function*(){return t._onlineComponents||(t._uninitializedComponentsProvider?(D("FirestoreClient","Using user provided OnlineComponentProvider"),yield BI(t,t._uninitializedComponentsProvider._online)):(D("FirestoreClient","Using default OnlineComponentProvider"),yield BI(t,new Ol))),t._onlineComponents})}function nk(t){return bC(t).then(e=>e.persistence)}function SC(t){return bC(t).then(e=>e.localStore)}function rk(t){return Cg(t).then(e=>e.remoteStore)}function AC(t){return Cg(t).then(e=>e.syncEngine)}function kz(t){return Cg(t).then(e=>e.datastore)}function Ka(t){return v(this,null,function*(){let e=yield Cg(t),n=e.eventManager;return n.onListen=mz.bind(null,e.syncEngine),n.onUnlisten=yz.bind(null,e.syncEngine),n})}function Oz(t){return t.asyncQueue.enqueue(()=>v(this,null,function*(){let e=yield nk(t),n=yield rk(t);return e.setNetworkEnabled(!0),function(i){let s=N(i);return s.v_.delete(0),Hl(s)}(n)}))}function Fz(t){return t.asyncQueue.enqueue(()=>v(this,null,function*(){let e=yield nk(t),n=yield rk(t);return e.setNetworkEnabled(!1),function(i){return v(this,null,function*(){let s=N(i);s.v_.add(0),yield Xa(s),s.x_.set("Offline")})}(n)}))}function Vz(t,e){let n=new st;return t.asyncQueue.enqueueAndForget(()=>v(this,null,function*(){return function(i,s,o){return v(this,null,function*(){try{let a=yield function(c,l){let d=N(c);return d.persistence.runTransaction("read document","readonly",h=>d.localDocuments.getDocument(h,l))}(i,s);a.isFoundDocument()?o.resolve(a):a.isNoDocument()?o.resolve(null):o.reject(new I(y.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(a){let u=tu(a,`Failed to get document '${s} from cache`);o.reject(u)}})}(yield SC(t),e,n)})),n.promise}function ik(t,e,n={}){let r=new st;return t.asyncQueue.enqueueAndForget(()=>v(this,null,function*(){return function(s,o,a,u,c){let l=new Wa({next:h=>{o.enqueueAndForget(()=>_C(s,d));let f=h.docs.has(a);!f&&h.fromCache?c.reject(new I(y.UNAVAILABLE,"Failed to get document because the client is offline.")):f&&h.fromCache&&u&&u.source==="server"?c.reject(new I(y.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):c.resolve(h)},error:h=>c.reject(h)}),d=new Pl(Za(a.path),l,{includeMetadataChanges:!0,Z_:!0});return yC(s,d)}(yield Ka(t),t.asyncQueue,e,n,r)})),r.promise}function Lz(t,e){let n=new st;return t.asyncQueue.enqueueAndForget(()=>v(this,null,function*(){return function(i,s,o){return v(this,null,function*(){try{let a=yield Xp(i,s,!0),u=new lg(s,a.hs),c=u.ha(a.documents),l=u.applyChanges(c,!1);o.resolve(l.snapshot)}catch(a){let u=tu(a,`Failed to execute query '${s} against cache`);o.reject(u)}})}(yield SC(t),e,n)})),n.promise}function sk(t,e,n={}){let r=new st;return t.asyncQueue.enqueueAndForget(()=>v(this,null,function*(){return function(s,o,a,u,c){let l=new Wa({next:h=>{o.enqueueAndForget(()=>_C(s,d)),h.fromCache&&u.source==="server"?c.reject(new I(y.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):c.resolve(h)},error:h=>c.reject(h)}),d=new Pl(a,l,{includeMetadataChanges:!0,Z_:!0});return yC(s,d)}(yield Ka(t),t.asyncQueue,e,n,r)})),r.promise}function jz(t,e){let n=new Wa(e);return t.asyncQueue.enqueueAndForget(()=>v(this,null,function*(){return function(i,s){N(i).K_.add(s),s.next()}(yield Ka(t),n)})),()=>{n.La(),t.asyncQueue.enqueueAndForget(()=>v(this,null,function*(){return function(i,s){N(i).K_.delete(s)}(yield Ka(t),n)}))}}function Uz(t,e,n,r){let i=function(o,a){let u;return u=typeof o=="string"?_P().encode(o):o,function(l,d){return new VI(l,d)}(function(l,d){if(l instanceof Uint8Array)return AN(l,d);if(l instanceof ArrayBuffer)return AN(new Uint8Array(l),d);if(l instanceof ReadableStream)return l.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(u),a)}(n,$l(e));t.asyncQueue.enqueueAndForget(()=>v(this,null,function*(){Pz(yield AC(t),i,r)}))}function Bz(t,e){return t.asyncQueue.enqueue(()=>v(this,null,function*(){return function(r,i){let s=N(r);return s.persistence.runTransaction("Get named query","readonly",o=>s.$r.getNamedQuery(o,i))}(yield SC(t),e)}))}function ok(t){let e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}var xN=new Map;function xC(t,e,n){if(!n)throw new I(y.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function MC(t,e,n,r){if(e===!0&&r===!0)throw new I(y.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function MN(t){if(!M.isDocumentKey(t))throw new I(y.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function RN(t){if(M.isDocumentKey(t))throw new I(y.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function Dg(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{let e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":O()}function ye(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new I(y.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let n=Dg(t);throw new I(y.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}function ak(t,e){if(e<=0)throw new I(y.INVALID_ARGUMENT,`Function ${t}() requires a positive number, but it was: ${e}.`)}var hg=class{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new I(y.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new I(y.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}MC("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=ok((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new I(y.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new I(y.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new I(y.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},Ws=class{constructor(e,n,r,i){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new hg({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new I(y.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(e){if(this._settingsFrozen)throw new I(y.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new hg(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new oE;switch(r.type){case"firstParty":return new lE(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new I(y.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){let r=xN.get(n);r&&(D("ComponentProvider","Removing Datastore"),xN.delete(n),r.terminate())}(this),Promise.resolve()}};function uk(t,e,n,r={}){var i;let s=(t=ye(t,Ws))._getSettings(),o=`${e}:${n}`;if(s.host!=="firestore.googleapis.com"&&s.host!==o&&Dn("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),r.mockUserToken){let a,u;if(typeof r.mockUserToken=="string")a=r.mockUserToken,u=it.MOCK_USER;else{a=Md(r.mockUserToken,(i=t._app)===null||i===void 0?void 0:i.options.projectId);let c=r.mockUserToken.sub||r.mockUserToken.user_id;if(!c)throw new I(y.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");u=new it(c)}t._authCredentials=new aE(new Tp(a,u))}}var bt=class t{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new t(this.firestore,e,this._query)}},xe=class t{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new gr(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new t(this.firestore,e,this._key)}},gr=class t extends bt{constructor(e,n,r){super(e,n,Za(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new xe(this.firestore,null,new M(e))}withConverter(e){return new t(this.firestore,e,this._path)}};function RC(t,e,...n){if(t=ce(t),xC("collection","path",e),t instanceof Ws){let r=me.fromString(e,...n);return RN(r),new gr(t,null,r)}{if(!(t instanceof xe||t instanceof gr))throw new I(y.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=t._path.child(me.fromString(e,...n));return RN(r),new gr(t.firestore,null,r)}}function ck(t,e){if(t=ye(t,Ws),xC("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new I(y.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new bt(t,null,function(r){return new $n(me.emptyPath(),r)}(e))}function ql(t,e,...n){if(t=ce(t),arguments.length===1&&(e=bp.newId()),xC("doc","path",e),t instanceof Ws){let r=me.fromString(e,...n);return MN(r),new xe(t,null,new M(r))}{if(!(t instanceof xe||t instanceof gr))throw new I(y.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=t._path.child(me.fromString(e,...n));return MN(r),new xe(t.firestore,t instanceof gr?t.converter:null,new M(r))}}function NC(t,e){return t=ce(t),e=ce(e),(t instanceof xe||t instanceof gr)&&(e instanceof xe||e instanceof gr)&&t.firestore===e.firestore&&t.path===e.path&&t.converter===e.converter}function PC(t,e){return t=ce(t),e=ce(e),t instanceof bt&&e instanceof bt&&t.firestore===e.firestore&&Ul(t._query,e._query)&&t.converter===e.converter}var $I=class{constructor(){this.Xa=Promise.resolve(),this.eu=[],this.tu=!1,this.nu=[],this.ru=null,this.iu=!1,this.su=!1,this.ou=[],this.jo=new Rl(this,"async_queue_retry"),this._u=()=>{let n=Cp();n&&D("AsyncQueue","Visibility state changed to "+n.visibilityState),this.jo.Ko()};let e=Cp();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this._u)}get isShuttingDown(){return this.tu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.au(),this.uu(e)}enterRestrictedMode(e){if(!this.tu){this.tu=!0,this.su=e||!1;let n=Cp();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this._u)}}enqueue(e){if(this.au(),this.tu)return new Promise(()=>{});let n=new st;return this.uu(()=>this.tu&&this.su?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.eu.push(e),this.cu()))}cu(){return v(this,null,function*(){if(this.eu.length!==0){try{yield this.eu[0](),this.eu.shift(),this.jo.reset()}catch(e){if(!ji(e))throw e;D("AsyncQueue","Operation failed with retryable error: "+e)}this.eu.length>0&&this.jo.qo(()=>this.cu())}})}uu(e){let n=this.Xa.then(()=>(this.iu=!0,e().catch(r=>{this.ru=r,this.iu=!1;let i=function(o){let a=o.message||"";return o.stack&&(a=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),a}(r);throw ze("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this.iu=!1,r))));return this.Xa=n,n}enqueueAfterDelay(e,n,r){this.au(),this.ou.indexOf(e)>-1&&(n=0);let i=SI.createAndSchedule(this,e,n,r,s=>this.lu(s));return this.nu.push(i),i}au(){this.ru&&O()}verifyOperationInProgress(){}hu(){return v(this,null,function*(){let e;do e=this.Xa,yield e;while(e!==this.Xa)})}Pu(e){for(let n of this.nu)if(n.timerId===e)return!0;return!1}Iu(e){return this.hu().then(()=>{this.nu.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(let n of this.nu)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.hu()})}Tu(e){this.ou.push(e)}lu(e){let n=this.nu.indexOf(e);this.nu.splice(n,1)}};function HI(t){return function(n,r){if(typeof n!="object"||n===null)return!1;let i=n;for(let s of r)if(s in i&&typeof i[s]=="function")return!0;return!1}(t,["next","error","complete"])}var qI=class{constructor(){this._progressObserver={},this._taskCompletionResolver=new st,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,n,r){this._progressObserver={next:e,error:n,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,n){return this._taskCompletionResolver.promise.then(e,n)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}};var lk=-1,Oe=class extends Ws{constructor(e,n,r,i){super(e,n,r,i),this.type="firestore",this._queue=function(){return new $I}(),this._persistenceKey=i?.name||"[DEFAULT]"}_terminate(){return this._firestoreClient||dk(this),this._firestoreClient.terminate()}};function ct(t){return t._firestoreClient||dk(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}function dk(t){var e,n,r;let i=t._freezeSettings(),s=function(a,u,c,l){return new _E(a,u,c,l.host,l.ssl,l.experimentalForceLongPolling,l.experimentalAutoDetectLongPolling,ok(l.experimentalLongPollingOptions),l.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,i);t._firestoreClient=new UI(t._authCredentials,t._appCheckCredentials,t._queue,s),!((n=i.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._firestoreClient._uninitializedComponentsProvider={_offlineKind:i.localCache.kind,_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider})}function hk(t,e){Ek(t=ye(t,Oe));let n=ct(t);if(n._uninitializedComponentsProvider)throw new I(y.FAILED_PRECONDITION,"SDK cache is already specified.");Dn("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let r=t._freezeSettings(),i=new Ol;return pk(n,i,new dg(i,r.cacheSizeBytes,e?.forceOwnership))}function fk(t){Ek(t=ye(t,Oe));let e=ct(t);if(e._uninitializedComponentsProvider)throw new I(y.FAILED_PRECONDITION,"SDK cache is already specified.");Dn("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let n=t._freezeSettings(),r=new Ol;return pk(e,r,new FI(r,n.cacheSizeBytes))}function pk(t,e,n){let r=new st;return t.asyncQueue.enqueue(()=>v(this,null,function*(){try{yield Dp(t,n),yield BI(t,e),r.resolve()}catch(i){let s=i;if(!tk(s))throw s;Dn("Error enabling indexeddb cache. Falling back to memory cache: "+s),r.reject(s)}})).then(()=>r.promise)}function gk(t){if(t._initialized&&!t._terminated)throw new I(y.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");let e=new st;return t._queue.enqueueAndForgetEvenWhileRestricted(()=>v(this,null,function*(){try{yield function(r){return v(this,null,function*(){if(!$r.D())return Promise.resolve();let i=r+"main";yield $r.delete(i)})}(fC(t._databaseId,t._persistenceKey)),e.resolve()}catch(n){e.reject(n)}})),e.promise}function mk(t){return function(n){let r=new st;return n.asyncQueue.enqueueAndForget(()=>v(this,null,function*(){return Iz(yield AC(n),r)})),r.promise}(ct(t=ye(t,Oe)))}function yk(t){return Oz(ct(t=ye(t,Oe)))}function _k(t){return Fz(ct(t=ye(t,Oe)))}function vk(t,e){let n=ct(t=ye(t,Oe)),r=new qI;return Uz(n,t._databaseId,e,r),r}function wk(t,e){return Bz(ct(t=ye(t,Oe)),e).then(n=>n?new bt(t,null,n.query):null)}function Ek(t){if(t._initialized||t._terminated)throw new I(y.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}var vr=class t{constructor(e){this._byteString=e}static fromBase64String(e){try{return new t(pt.fromBase64String(e))}catch(n){throw new I(y.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new t(pt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}};var qn=class{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new I(y.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new We(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var Gr=class{constructor(e){this._methodName=e}};var Ks=class{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new I(y.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new I(y.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Z(this._lat,e._lat)||Z(this._long,e._long)}};var $z=/^__.*__$/,GI=class{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new Hn(e,this.data,this.fieldMask,n,this.fieldTransforms):new Oi(e,this.data,n,this.fieldTransforms)}},fg=class{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new Hn(e,this.data,this.fieldMask,n,this.fieldTransforms)}};function Ik(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw O()}}var pg=class t{constructor(e,n,r,i,s,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.Eu(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get du(){return this.settings.du}Au(e){return new t(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Ru(e){var n;let r=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.Au({path:r,Vu:!1});return i.mu(e),i}fu(e){var n;let r=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.Au({path:r,Vu:!1});return i.Eu(),i}gu(e){return this.Au({path:void 0,Vu:!0})}pu(e){return gg(e,this.settings.methodName,this.settings.yu||!1,this.path,this.settings.wu)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}Eu(){if(this.path)for(let e=0;e<this.path.length;e++)this.mu(this.path.get(e))}mu(e){if(e.length===0)throw this.pu("Document fields must not be empty");if(Ik(this.du)&&$z.test(e))throw this.pu('Document fields cannot begin and end with "__"')}},zI=class{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||$l(e)}Su(e,n,r,i=!1){return new pg({du:e,methodName:n,wu:r,path:We.emptyPath(),Vu:!1,yu:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function Xs(t){let e=t._freezeSettings(),n=$l(t._databaseId);return new zI(t._databaseId,!!e.ignoreUndefinedProperties,n)}function Tg(t,e,n,r,i,s={}){let o=t.Su(s.merge||s.mergeFields?2:0,e,n,i);FC("Data must be an object, but it was:",o,r);let a=Tk(r,o),u,c;if(s.merge)u=new on(o.fieldMask),c=o.fieldTransforms;else if(s.mergeFields){let l=[];for(let d of s.mergeFields){let h=ZI(e,d,n);if(!o.contains(h))throw new I(y.INVALID_ARGUMENT,`Field '${h}' is specified in your field mask but missing from your input data.`);Sk(l,h)||l.push(h)}u=new on(l),c=o.fieldTransforms.filter(d=>u.covers(d.field))}else u=null,c=o.fieldTransforms;return new GI(new Pt(a),u,c)}var Fl=class t extends Gr{_toFieldTransform(e){if(e.du!==2)throw e.du===1?e.pu(`${this._methodName}() can only appear at the top level of your update data`):e.pu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof t}};function Ck(t,e,n){return new pg({du:3,wu:e.settings.wu,methodName:t._methodName,Vu:n},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}var WI=class t extends Gr{_toFieldTransform(e){return new qs(e.path,new Pi)}isEqual(e){return e instanceof t}},KI=class t extends Gr{constructor(e,n){super(e),this.bu=n}_toFieldTransform(e){let n=Ck(this,e,!0),r=this.bu.map(s=>Js(s,n)),i=new Hr(r);return new qs(e.path,i)}isEqual(e){return e instanceof t&&Lm(this.bu,e.bu)}},QI=class t extends Gr{constructor(e,n){super(e),this.bu=n}_toFieldTransform(e){let n=Ck(this,e,!0),r=this.bu.map(s=>Js(s,n)),i=new qr(r);return new qs(e.path,i)}isEqual(e){return e instanceof t&&Lm(this.bu,e.bu)}},YI=class t extends Gr{constructor(e,n){super(e),this.Du=n}_toFieldTransform(e){let n=new ki(e.serializer,cP(e.serializer,this.Du));return new qs(e.path,n)}isEqual(e){return e instanceof t&&this.Du===e.Du}};function kC(t,e,n,r){let i=t.Su(1,e,n);FC("Data must be an object, but it was:",i,r);let s=[],o=Pt.empty();Zs(r,(u,c)=>{let l=VC(e,u,n);c=ce(c);let d=i.fu(l);if(c instanceof Fl)s.push(l);else{let h=Js(c,d);h!=null&&(s.push(l),o.set(l,h))}});let a=new on(s);return new fg(o,a,i.fieldTransforms)}function OC(t,e,n,r,i,s){let o=t.Su(1,e,n),a=[ZI(e,r,n)],u=[i];if(s.length%2!=0)throw new I(y.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let h=0;h<s.length;h+=2)a.push(ZI(e,s[h])),u.push(s[h+1]);let c=[],l=Pt.empty();for(let h=a.length-1;h>=0;--h)if(!Sk(c,a[h])){let f=a[h],p=u[h];p=ce(p);let g=o.fu(f);if(p instanceof Fl)c.push(f);else{let _=Js(p,g);_!=null&&(c.push(f),l.set(f,_))}}let d=new on(c);return new fg(l,d,o.fieldTransforms)}function Dk(t,e,n,r=!1){return Js(n,t.Su(r?4:3,e))}function Js(t,e){if(bk(t=ce(t)))return FC("Unsupported field value:",e,t),Tk(t,e);if(t instanceof Gr)return function(r,i){if(!Ik(i.du))throw i.pu(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.pu(`${r._methodName}() is not currently supported inside arrays`);let s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.Vu&&e.du!==4)throw e.pu("Nested arrays are not supported");return function(r,i){let s=[],o=0;for(let a of r){let u=Js(a,i.gu(o));u==null&&(u={nullValue:"NULL_VALUE"}),s.push(u),o++}return{arrayValue:{values:s}}}(t,e)}return function(r,i){if((r=ce(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return cP(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){let s=Le.fromDate(r);return{timestampValue:Ua(i.serializer,s)}}if(r instanceof Le){let s=new Le(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Ua(i.serializer,s)}}if(r instanceof Ks)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof vr)return{bytesValue:vP(i.serializer,r._byteString)};if(r instanceof xe){let s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.pu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:lC(r.firestore._databaseId||i.databaseId,r._key.path)}}throw i.pu(`Unsupported field value: ${Dg(r)}`)}(t,e)}function Tk(t,e){let n={};return GN(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Zs(t,(r,i)=>{let s=Js(i,e.Ru(r));s!=null&&(n[r]=s)}),{mapValue:{fields:n}}}function bk(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof Le||t instanceof Ks||t instanceof vr||t instanceof xe||t instanceof Gr)}function FC(t,e,n){if(!bk(n)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(n)){let r=Dg(n);throw r==="an object"?e.pu(t+" a custom object"):e.pu(t+" "+r)}}function ZI(t,e,n){if((e=ce(e))instanceof qn)return e._internalPath;if(typeof e=="string")return VC(t,e);throw gg("Field path arguments must be of type string or ",t,!1,void 0,n)}var Hz=new RegExp("[~\\*/\\[\\]]");function VC(t,e,n){if(e.search(Hz)>=0)throw gg(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new qn(...e.split("."))._internalPath}catch{throw gg(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function gg(t,e,n,r,i){let s=r&&!r.isEmpty(),o=i!==void 0,a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let u="";return(s||o)&&(u+=" (found",s&&(u+=` in field ${r}`),o&&(u+=` in document ${i}`),u+=")"),new I(y.INVALID_ARGUMENT,a+t+u)}function Sk(t,e){return t.some(n=>n.isEqual(e))}var Qs=class{constructor(e,n,r,i,s){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new xe(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){let e=new XI(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){let n=this._document.data.field(bg("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}},XI=class extends Qs{data(){return super.data()}};function bg(t,e){return typeof e=="string"?VC(t,e):e instanceof qn?e._internalPath:e._delegate._internalPath}function Ak(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new I(y.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Vl=class{},Ys=class extends Vl{};function Kr(t,e,...n){let r=[];e instanceof Vl&&r.push(e),r=r.concat(n),function(s){let o=s.filter(u=>u instanceof JI).length,a=s.filter(u=>u instanceof mg).length;if(o>1||o>0&&a>0)throw new I(y.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(let i of r)t=i._apply(t);return t}var mg=class t extends Ys{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new t(e,n,r)}_apply(e){let n=this._parse(e);return Lk(e._query,n),new bt(e.firestore,e.converter,RE(e._query,n))}_parse(e){let n=Xs(e.firestore);return function(s,o,a,u,c,l,d){let h;if(c.isKeyField()){if(l==="array-contains"||l==="array-contains-any")throw new I(y.INVALID_ARGUMENT,`Invalid Query. You can't perform '${l}' queries on documentId().`);if(l==="in"||l==="not-in"){PN(d,l);let f=[];for(let p of d)f.push(NN(u,s,p));h={arrayValue:{values:f}}}else h=NN(u,s,d)}else l!=="in"&&l!=="not-in"&&l!=="array-contains-any"||PN(d,l),h=Dk(a,o,d,l==="in"||l==="not-in");return he.create(c,l,h)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}};function xk(t,e,n){let r=e,i=bg("where",t);return mg._create(i,r,n)}var JI=class t extends Vl{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new t(e,n)}_parse(e){let n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:De.create(n,this._getOperator())}_apply(e){let n=this._parse(e);return n.getFilters().length===0?e:(function(i,s){let o=i,a=s.getFlattenedFilters();for(let u of a)Lk(o,u),o=RE(o,u)}(e._query,n),new bt(e.firestore,e.converter,RE(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}};var eC=class t extends Ys{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new t(e,n)}_apply(e){let n=function(i,s,o){if(i.startAt!==null)throw new I(y.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new I(y.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new $s(s,o)}(e._query,this._field,this._direction);return new bt(e.firestore,e.converter,function(i,s){let o=i.explicitOrderBy.concat([s]);return new $n(i.path,i.collectionGroup,o,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,n))}};function Mk(t,e="asc"){let n=e,r=bg("orderBy",t);return eC._create(r,n)}var yg=class t extends Ys{constructor(e,n,r){super(),this.type=e,this._limit=n,this._limitType=r}static _create(e,n,r){return new t(e,n,r)}_apply(e){return new bt(e.firestore,e.converter,Fp(e._query,this._limit,this._limitType))}};function Rk(t){return ak("limit",t),yg._create("limit",t,"F")}function Nk(t){return ak("limitToLast",t),yg._create("limitToLast",t,"L")}var _g=class t extends Ys{constructor(e,n,r){super(),this.type=e,this._docOrFields=n,this._inclusive=r}static _create(e,n,r){return new t(e,n,r)}_apply(e){let n=Vk(e,this.type,this._docOrFields,this._inclusive);return new bt(e.firestore,e.converter,function(i,s){return new $n(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,s,i.endAt)}(e._query,n))}};function Pk(...t){return _g._create("startAt",t,!0)}function kk(...t){return _g._create("startAfter",t,!1)}var vg=class t extends Ys{constructor(e,n,r){super(),this.type=e,this._docOrFields=n,this._inclusive=r}static _create(e,n,r){return new t(e,n,r)}_apply(e){let n=Vk(e,this.type,this._docOrFields,this._inclusive);return new bt(e.firestore,e.converter,function(i,s){return new $n(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,i.startAt,s)}(e._query,n))}};function Ok(...t){return vg._create("endBefore",t,!1)}function Fk(...t){return vg._create("endAt",t,!0)}function Vk(t,e,n,r){if(n[0]=ce(n[0]),n[0]instanceof Qs)return function(s,o,a,u,c){if(!u)throw new I(y.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${a}().`);let l=[];for(let d of Na(s))if(d.field.isKeyField())l.push(Bs(o,u.key));else{let h=u.data.field(d.field);if(Eg(h))throw new I(y.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+d.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(h===null){let f=d.field.canonicalString();throw new I(y.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${f}' (used as the orderBy) does not exist.`)}l.push(h)}return new yr(l,c)}(t._query,t.firestore._databaseId,e,n[0]._document,r);{let i=Xs(t.firestore);return function(o,a,u,c,l,d){let h=o.explicitOrderBy;if(l.length>h.length)throw new I(y.INVALID_ARGUMENT,`Too many arguments provided to ${c}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);let f=[];for(let p=0;p<l.length;p++){let g=l[p];if(h[p].field.isKeyField()){if(typeof g!="string")throw new I(y.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${c}(), but got a ${typeof g}`);if(!uC(o)&&g.indexOf("/")!==-1)throw new I(y.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${c}() must be a plain document ID, but '${g}' contains a slash.`);let _=o.path.child(me.fromString(g));if(!M.isDocumentKey(_))throw new I(y.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${c}() must result in a valid document path, but '${_}' is not because it contains an odd number of segments.`);let b=new M(_);f.push(Bs(a,b))}else{let _=Dk(u,c,g);f.push(_)}}return new yr(f,d)}(t._query,t.firestore._databaseId,i,e,n,r)}}function NN(t,e,n){if(typeof(n=ce(n))=="string"){if(n==="")throw new I(y.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!uC(e)&&n.indexOf("/")!==-1)throw new I(y.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);let r=e.path.child(me.fromString(n));if(!M.isDocumentKey(r))throw new I(y.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Bs(t,new M(r))}if(n instanceof xe)return Bs(t,n._key);throw new I(y.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Dg(n)}.`)}function PN(t,e){if(!Array.isArray(t)||t.length===0)throw new I(y.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function Lk(t,e){let n=function(i,s){for(let o of i)for(let a of o.getFlattenedFilters())if(s.indexOf(a.op)>=0)return a.op;return null}(t.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new I(y.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new I(y.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}var Qa=class{convertValue(e,n="none"){switch(Us(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Be(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(Mi(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 10:return this.convertObject(e.mapValue,n);default:throw O()}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){let r={};return Zs(e,(i,s)=>{r[i]=this.convertValue(s,n)}),r}convertGeoPoint(e){return new Ks(Be(e.latitude),Be(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":let r=oC(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(_l(e));default:return null}}convertTimestamp(e){let n=xi(e);return new Le(n.seconds,n.nanos)}convertDocumentKey(e,n){let r=me.fromString(e);L(MP(r));let i=new Ri(r.get(1),r.get(3)),s=new M(r.popFirst(5));return i.isEqual(n)||ze(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),s}};function Sg(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}var tC=class extends Qa{constructor(e){super(),this.firestore=e}convertBytes(e){return new vr(e)}convertReference(e){let n=this.convertDocumentKey(e,this.firestore._databaseId);return new xe(this.firestore,null,n)}};var Br=class{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},bn=class extends Qs{constructor(e,n,r,i,s,o){super(e,n,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let n=new Si(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){let r=this._document.data.field(bg("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}},Si=class extends bn{data(e={}){return super.data(e)}},Gn=class{constructor(e,n,r,i){this._firestore=e,this._userDataWriter=n,this._snapshot=i,this.metadata=new Br(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){let e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new Si(this._firestore,this._userDataWriter,r.key,r,new Br(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new I(y.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(a=>{let u=new Si(i._firestore,i._userDataWriter,a.doc.key,a.doc,new Br(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);return a.doc,{type:"added",doc:u,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(a=>s||a.type!==3).map(a=>{let u=new Si(i._firestore,i._userDataWriter,a.doc.key,a.doc,new Br(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter),c=-1,l=-1;return a.type!==0&&(c=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),l=o.indexOf(a.doc.key)),{type:qz(a.type),doc:u,oldIndex:c,newIndex:l}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}};function qz(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return O()}}function LC(t,e){return t instanceof bn&&e instanceof bn?t._firestore===e._firestore&&t._key.isEqual(e._key)&&(t._document===null?e._document===null:t._document.isEqual(e._document))&&t._converter===e._converter:t instanceof Gn&&e instanceof Gn&&t._firestore===e._firestore&&PC(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t._snapshot.isEqual(e._snapshot)}function jk(t){t=ye(t,xe);let e=ye(t.firestore,Oe);return ik(ct(e),t._key).then(n=>$C(e,t,n))}var zr=class extends Qa{constructor(e){super(),this.firestore=e}convertBytes(e){return new vr(e)}convertReference(e){let n=this.convertDocumentKey(e,this.firestore._databaseId);return new xe(this.firestore,null,n)}};function Uk(t){t=ye(t,xe);let e=ye(t.firestore,Oe),n=ct(e),r=new zr(e);return Vz(n,t._key).then(i=>new bn(e,r,t._key,i,new Br(i!==null&&i.hasLocalMutations,!0),t.converter))}function Bk(t){t=ye(t,xe);let e=ye(t.firestore,Oe);return ik(ct(e),t._key,{source:"server"}).then(n=>$C(e,t,n))}function $k(t){t=ye(t,bt);let e=ye(t.firestore,Oe),n=ct(e),r=new zr(e);return Ak(t._query),sk(n,t._query).then(i=>new Gn(e,r,t,i))}function Hk(t){t=ye(t,bt);let e=ye(t.firestore,Oe),n=ct(e),r=new zr(e);return Lz(n,t._query).then(i=>new Gn(e,r,t,i))}function qk(t){t=ye(t,bt);let e=ye(t.firestore,Oe),n=ct(e),r=new zr(e);return sk(n,t._query,{source:"server"}).then(i=>new Gn(e,r,t,i))}function jC(t,e,n){t=ye(t,xe);let r=ye(t.firestore,Oe),i=Sg(t.converter,e,n);return nu(r,[Tg(Xs(r),"setDoc",t._key,i,t.converter!==null,n).toMutation(t._key,$e.none())])}function UC(t,e,n,...r){t=ye(t,xe);let i=ye(t.firestore,Oe),s=Xs(i),o;return o=typeof(e=ce(e))=="string"||e instanceof qn?OC(s,"updateDoc",t._key,e,n,r):kC(s,"updateDoc",t._key,e),nu(i,[o.toMutation(t._key,$e.exists(!0))])}function Gk(t){return nu(ye(t.firestore,Oe),[new Fi(t._key,$e.none())])}function zk(t,e){let n=ye(t.firestore,Oe),r=ql(t),i=Sg(t.converter,e);return nu(n,[Tg(Xs(t.firestore),"addDoc",r._key,i,t.converter!==null,{}).toMutation(r._key,$e.exists(!1))]).then(()=>r)}function BC(t,...e){var n,r,i;t=ce(t);let s={includeMetadataChanges:!1},o=0;typeof e[o]!="object"||HI(e[o])||(s=e[o],o++);let a={includeMetadataChanges:s.includeMetadataChanges};if(HI(e[o])){let d=e[o];e[o]=(n=d.next)===null||n===void 0?void 0:n.bind(d),e[o+1]=(r=d.error)===null||r===void 0?void 0:r.bind(d),e[o+2]=(i=d.complete)===null||i===void 0?void 0:i.bind(d)}let u,c,l;if(t instanceof xe)c=ye(t.firestore,Oe),l=Za(t._key.path),u={next:d=>{e[o]&&e[o]($C(c,t,d))},error:e[o+1],complete:e[o+2]};else{let d=ye(t,bt);c=ye(d.firestore,Oe),l=d._query;let h=new zr(c);u={next:f=>{e[o]&&e[o](new Gn(c,h,d,f))},error:e[o+1],complete:e[o+2]},Ak(t._query)}return function(h,f,p,g){let _=new Wa(g),b=new Pl(f,_,p);return h.asyncQueue.enqueueAndForget(()=>v(this,null,function*(){return yC(yield Ka(h),b)})),()=>{_.La(),h.asyncQueue.enqueueAndForget(()=>v(this,null,function*(){return _C(yield Ka(h),b)}))}}(ct(c),l,a,u)}function Wk(t,e){return jz(ct(t=ye(t,Oe)),HI(e)?e:{next:e})}function nu(t,e){return function(r,i){let s=new st;return r.asyncQueue.enqueueAndForget(()=>v(this,null,function*(){return _z(yield AC(r),i,s)})),s.promise}(ct(t),e)}function $C(t,e,n){let r=n.docs.get(e._key),i=new zr(t);return new bn(t,i,e._key,r,new Br(n.hasPendingWrites,n.fromCache),e.converter)}var Gz={maxAttempts:5};var wg=class{constructor(e,n){this._firestore=e,this._commitHandler=n,this._mutations=[],this._committed=!1,this._dataReader=Xs(e)}set(e,n,r){this._verifyNotCommitted();let i=Ti(e,this._firestore),s=Sg(i.converter,n,r),o=Tg(this._dataReader,"WriteBatch.set",i._key,s,i.converter!==null,r);return this._mutations.push(o.toMutation(i._key,$e.none())),this}update(e,n,r,...i){this._verifyNotCommitted();let s=Ti(e,this._firestore),o;return o=typeof(n=ce(n))=="string"||n instanceof qn?OC(this._dataReader,"WriteBatch.update",s._key,n,r,i):kC(this._dataReader,"WriteBatch.update",s._key,n),this._mutations.push(o.toMutation(s._key,$e.exists(!0))),this}delete(e){this._verifyNotCommitted();let n=Ti(e,this._firestore);return this._mutations=this._mutations.concat(new Fi(n._key,$e.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new I(y.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}};function Ti(t,e){if((t=ce(t)).firestore!==e)throw new I(y.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}var nC=class extends class{constructor(n,r){this._firestore=n,this._transaction=r,this._dataReader=Xs(n)}get(n){let r=Ti(n,this._firestore),i=new tC(this._firestore);return this._transaction.lookup([r._key]).then(s=>{if(!s||s.length!==1)return O();let o=s[0];if(o.isFoundDocument())return new Qs(this._firestore,i,o.key,o,r.converter);if(o.isNoDocument())return new Qs(this._firestore,i,r._key,null,r.converter);throw O()})}set(n,r,i){let s=Ti(n,this._firestore),o=Sg(s.converter,r,i),a=Tg(this._dataReader,"Transaction.set",s._key,o,s.converter!==null,i);return this._transaction.set(s._key,a),this}update(n,r,i,...s){let o=Ti(n,this._firestore),a;return a=typeof(r=ce(r))=="string"||r instanceof qn?OC(this._dataReader,"Transaction.update",o._key,r,i,s):kC(this._dataReader,"Transaction.update",o._key,r),this._transaction.update(o._key,a),this}delete(n){let r=Ti(n,this._firestore);return this._transaction.delete(r._key),this}}{constructor(e,n){super(e,n),this._firestore=e}get(e){let n=Ti(e,this._firestore),r=new zr(this._firestore);return super.get(e).then(i=>new bn(this._firestore,r,n._key,i._document,new Br(!1,!1),n.converter))}};function Kk(t,e,n){t=ye(t,Oe);let r=Object.assign(Object.assign({},Gz),n);return function(s){if(s.maxAttempts<1)throw new I(y.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(s,o,a){let u=new st;return s.asyncQueue.enqueueAndForget(()=>v(this,null,function*(){let c=yield kz(s);new jI(s.asyncQueue,c,a,o,u).ja()})),u.promise}(ct(t),i=>e(new nC(t,i)),r)}function Qk(){return new Fl("deleteField")}function Yk(){return new WI("serverTimestamp")}function Zk(...t){return new KI("arrayUnion",t)}function Xk(...t){return new QI("arrayRemove",t)}function Jk(t){return new YI("increment",t)}(function(e,n=!0){(function(i){Ya=i})(Od),Zi(new Xt("firestore",(r,{instanceIdentifier:i,options:s})=>{let o=r.getProvider("app").getImmediate(),a=new Oe(new uE(r.getProvider("auth-internal")),new hE(r.getProvider("app-check-internal")),function(c,l){if(!Object.prototype.hasOwnProperty.apply(c.options,["projectId"]))throw new I(y.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Ri(c.options.projectId,l)}(o,i),o);return s=Object.assign({useFetchStreams:n},s),a._setSettings(s),a},"PUBLIC").setMultipleInstances(!0)),Mn(OR,"4.4.2",e),Mn(OR,"4.4.2","esm2017")})();var zz="@firebase/firestore-compat",Wz="0.3.25";function KC(t,e){if(e===void 0)return{merge:!1};if(e.mergeFields!==void 0&&e.merge!==void 0)throw new I("invalid-argument",`Invalid options passed to function ${t}(): You cannot specify both "merge" and "mergeFields".`);return e}function eO(){if(typeof Uint8Array>"u")throw new I("unimplemented","Uint8Arrays are not available in this environment.")}function tO(){if(!zN())throw new I("unimplemented","Blobs are unavailable in Firestore in this environment.")}var Ag=class t{constructor(e){this._delegate=e}static fromBase64String(e){return tO(),new t(vr.fromBase64String(e))}static fromUint8Array(e){return eO(),new t(vr.fromUint8Array(e))}toBase64(){return tO(),this._delegate.toBase64()}toUint8Array(){return eO(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}};function HC(t){return Kz(t,["next","error","complete"])}function Kz(t,e){if(typeof t!="object"||t===null)return!1;let n=t;for(let r of e)if(r in n&&typeof n[r]=="function")return!0;return!1}var qC=class{enableIndexedDbPersistence(e,n){return hk(e._delegate,{forceOwnership:n})}enableMultiTabIndexedDbPersistence(e){return fk(e._delegate)}clearIndexedDbPersistence(e){return gk(e._delegate)}},xg=class{constructor(e,n,r){this._delegate=n,this._persistenceProvider=r,this.INTERNAL={delete:()=>this.terminate()},e instanceof Ri||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){let n=this._delegate._getSettings();!e.merge&&n.host!==e.host&&Dn("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&(e=Object.assign(Object.assign({},n),e),delete e.merge),this._delegate._setSettings(e)}useEmulator(e,n,r={}){uk(this._delegate,e,n,r)}enableNetwork(){return yk(this._delegate)}disableNetwork(){return _k(this._delegate)}enablePersistence(e){let n=!1,r=!1;return e&&(n=!!e.synchronizeTabs,r=!!e.experimentalForceOwningTab,MC("synchronizeTabs",n,"experimentalForceOwningTab",r)),n?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,r)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return mk(this._delegate)}onSnapshotsInSync(e){return Wk(this._delegate,e)}get app(){if(!this._appCompat)throw new I("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new su(this,RC(this._delegate,e))}catch(n){throw $t(n,"collection()","Firestore.collection()")}}doc(e){try{return new wr(this,ql(this._delegate,e))}catch(n){throw $t(n,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new ro(this,ck(this._delegate,e))}catch(n){throw $t(n,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return Kk(this._delegate,n=>e(new Mg(this,n)))}batch(){return ct(this._delegate),new Rg(new wg(this._delegate,e=>nu(this._delegate,e)))}loadBundle(e){return vk(this._delegate,e)}namedQuery(e){return wk(this._delegate,e).then(n=>n?new ro(this,n):null)}},ru=class extends Qa{constructor(e){super(),this.firestore=e}convertBytes(e){return new Ag(new vr(e))}convertReference(e){let n=this.convertDocumentKey(e,this.firestore._databaseId);return wr.forKey(n,this.firestore,null)}};function Qz(t){kN(t)}var Mg=class{constructor(e,n){this._firestore=e,this._delegate=n,this._userDataWriter=new ru(e)}get(e){let n=eo(e);return this._delegate.get(n).then(r=>new to(this._firestore,new bn(this._firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,n.converter)))}set(e,n,r){let i=eo(e);return r?(KC("Transaction.set",r),this._delegate.set(i,n,r)):this._delegate.set(i,n),this}update(e,n,r,...i){let s=eo(e);return arguments.length===2?this._delegate.update(s,n):this._delegate.update(s,n,r,...i),this}delete(e){let n=eo(e);return this._delegate.delete(n),this}},Rg=class{constructor(e){this._delegate=e}set(e,n,r){let i=eo(e);return r?(KC("WriteBatch.set",r),this._delegate.set(i,n,r)):this._delegate.set(i,n),this}update(e,n,r,...i){let s=eo(e);return arguments.length===2?this._delegate.update(s,n):this._delegate.update(s,n,r,...i),this}delete(e){let n=eo(e);return this._delegate.delete(n),this}commit(){return this._delegate.commit()}},iu=class t{constructor(e,n,r){this._firestore=e,this._userDataWriter=n,this._delegate=r}fromFirestore(e,n){let r=new Si(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new no(this._firestore,r),n??{})}toFirestore(e,n){return n?this._delegate.toFirestore(e,n):this._delegate.toFirestore(e)}static getInstance(e,n){let r=t.INSTANCES,i=r.get(e);i||(i=new WeakMap,r.set(e,i));let s=i.get(n);return s||(s=new t(e,new ru(e),n),i.set(n,s)),s}};iu.INSTANCES=new WeakMap;var wr=class t{constructor(e,n){this.firestore=e,this._delegate=n,this._userDataWriter=new ru(e)}static forPath(e,n,r){if(e.length%2!==0)throw new I("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new t(n,new xe(n._delegate,r,new M(e)))}static forKey(e,n,r){return new t(n,new xe(n._delegate,r,e))}get id(){return this._delegate.id}get parent(){return new su(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new su(this.firestore,RC(this._delegate,e))}catch(n){throw $t(n,"collection()","DocumentReference.collection()")}}isEqual(e){return e=ce(e),e instanceof xe?NC(this._delegate,e):!1}set(e,n){n=KC("DocumentReference.set",n);try{return n?jC(this._delegate,e,n):jC(this._delegate,e)}catch(r){throw $t(r,"setDoc()","DocumentReference.set()")}}update(e,n,...r){try{return arguments.length===1?UC(this._delegate,e):UC(this._delegate,e,n,...r)}catch(i){throw $t(i,"updateDoc()","DocumentReference.update()")}}delete(){return Gk(this._delegate)}onSnapshot(...e){let n=nO(e),r=rO(e,i=>new to(this.firestore,new bn(this.firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,this._delegate.converter)));return BC(this._delegate,n,r)}get(e){let n;return e?.source==="cache"?n=Uk(this._delegate):e?.source==="server"?n=Bk(this._delegate):n=jk(this._delegate),n.then(r=>new to(this.firestore,new bn(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)))}withConverter(e){return new t(this.firestore,e?this._delegate.withConverter(iu.getInstance(this.firestore,e)):this._delegate.withConverter(null))}};function $t(t,e,n){return t.message=t.message.replace(e,n),t}function nO(t){for(let e of t)if(typeof e=="object"&&!HC(e))return e;return{}}function rO(t,e){var n,r;let i;return HC(t[0])?i=t[0]:HC(t[1])?i=t[1]:typeof t[0]=="function"?i={next:t[0],error:t[1],complete:t[2]}:i={next:t[1],error:t[2],complete:t[3]},{next:s=>{i.next&&i.next(e(s))},error:(n=i.error)===null||n===void 0?void 0:n.bind(i),complete:(r=i.complete)===null||r===void 0?void 0:r.bind(i)}}var to=class{constructor(e,n){this._firestore=e,this._delegate=n}get ref(){return new wr(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,n){return this._delegate.get(e,n)}isEqual(e){return LC(this._delegate,e._delegate)}},no=class extends to{data(e){let n=this._delegate.data(e);return this._delegate._converter||ON(n!==void 0,"Document in a QueryDocumentSnapshot should exist"),n}},ro=class t{constructor(e,n){this.firestore=e,this._delegate=n,this._userDataWriter=new ru(e)}where(e,n,r){try{return new t(this.firestore,Kr(this._delegate,xk(e,n,r)))}catch(i){throw $t(i,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,n){try{return new t(this.firestore,Kr(this._delegate,Mk(e,n)))}catch(r){throw $t(r,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new t(this.firestore,Kr(this._delegate,Rk(e)))}catch(n){throw $t(n,"limit()","Query.limit()")}}limitToLast(e){try{return new t(this.firestore,Kr(this._delegate,Nk(e)))}catch(n){throw $t(n,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new t(this.firestore,Kr(this._delegate,Pk(...e)))}catch(n){throw $t(n,"startAt()","Query.startAt()")}}startAfter(...e){try{return new t(this.firestore,Kr(this._delegate,kk(...e)))}catch(n){throw $t(n,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new t(this.firestore,Kr(this._delegate,Ok(...e)))}catch(n){throw $t(n,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new t(this.firestore,Kr(this._delegate,Fk(...e)))}catch(n){throw $t(n,"endAt()","Query.endAt()")}}isEqual(e){return PC(this._delegate,e._delegate)}get(e){let n;return e?.source==="cache"?n=Hk(this._delegate):e?.source==="server"?n=qk(this._delegate):n=$k(this._delegate),n.then(r=>new Gl(this.firestore,new Gn(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)))}onSnapshot(...e){let n=nO(e),r=rO(e,i=>new Gl(this.firestore,new Gn(this.firestore._delegate,this._userDataWriter,this._delegate,i._snapshot)));return BC(this._delegate,n,r)}withConverter(e){return new t(this.firestore,e?this._delegate.withConverter(iu.getInstance(this.firestore,e)):this._delegate.withConverter(null))}},GC=class{constructor(e,n){this._firestore=e,this._delegate=n}get type(){return this._delegate.type}get doc(){return new no(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}},Gl=class{constructor(e,n){this._firestore=e,this._delegate=n}get query(){return new ro(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new no(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(n=>new GC(this._firestore,n))}forEach(e,n){this._delegate.forEach(r=>{e.call(n,new no(this._firestore,r))})}isEqual(e){return LC(this._delegate,e._delegate)}},su=class t extends ro{constructor(e,n){super(e,n),this.firestore=e,this._delegate=n}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){let e=this._delegate.parent;return e?new wr(this.firestore,e):null}doc(e){try{return e===void 0?new wr(this.firestore,ql(this._delegate)):new wr(this.firestore,ql(this._delegate,e))}catch(n){throw $t(n,"doc()","CollectionReference.doc()")}}add(e){return zk(this._delegate,e).then(n=>new wr(this.firestore,n))}isEqual(e){return NC(this._delegate,e._delegate)}withConverter(e){return new t(this.firestore,e?this._delegate.withConverter(iu.getInstance(this.firestore,e)):this._delegate.withConverter(null))}};function eo(t){return ye(t,xe)}var zC=class t{constructor(...e){this._delegate=new qn(...e)}static documentId(){return new t(We.keyField().canonicalString())}isEqual(e){return e=ce(e),e instanceof qn?this._delegate._internalPath.isEqual(e._internalPath):!1}};var WC=class t{constructor(e){this._delegate=e}static serverTimestamp(){let e=Yk();return e._methodName="FieldValue.serverTimestamp",new t(e)}static delete(){let e=Qk();return e._methodName="FieldValue.delete",new t(e)}static arrayUnion(...e){let n=Zk(...e);return n._methodName="FieldValue.arrayUnion",new t(n)}static arrayRemove(...e){let n=Xk(...e);return n._methodName="FieldValue.arrayRemove",new t(n)}static increment(e){let n=Jk(e);return n._methodName="FieldValue.increment",new t(n)}isEqual(e){return this._delegate.isEqual(e._delegate)}};var Yz={Firestore:xg,GeoPoint:Ks,Timestamp:Le,Blob:Ag,Transaction:Mg,WriteBatch:Rg,DocumentReference:wr,DocumentSnapshot:to,Query:ro,QueryDocumentSnapshot:no,QuerySnapshot:Gl,CollectionReference:su,FieldPath:zC,FieldValue:WC,setLogLevel:Qz,CACHE_SIZE_UNLIMITED:lk};function Zz(t,e){t.INTERNAL.registerComponent(new Xt("firestore-compat",n=>{let r=n.getProvider("app-compat").getImmediate(),i=n.getProvider("firestore").getImmediate();return e(r,i)},"PUBLIC").setServiceProps(Object.assign({},Yz)))}function Xz(t){Zz(t,(e,n)=>new xg(e,n,new qC)),t.registerVersion(zz,Wz)}Xz(_t);function Jz(t,e=ns){return new ne(n=>{let r;return e!=null?e.schedule(()=>{r=t.onSnapshot({includeMetadataChanges:!0},n)}):r=t.onSnapshot({includeMetadataChanges:!0},n),()=>{r?.()}})}function iO(t,e){return Jz(t,e)}function e3(t,e){return iO(t,e).pipe(is(void 0),Ou(),j(n=>{let[r,i]=n;return i.exists?r?.exists?{payload:i,type:"modified"}:{payload:i,type:"added"}:{payload:i,type:"removed"}}))}function ZC(t,e){return iO(t,e).pipe(j(n=>({payload:n,type:"query"})))}var Ng=class{ref;afs;constructor(e,n){this.ref=e,this.afs=n}set(e,n){return this.ref.set(e,n)}update(e){return this.ref.update(e)}delete(){return this.ref.delete()}collection(e,n){let r=this.ref.collection(e),{ref:i,query:s}=aO(r,n);return new kg(i,s,this.afs)}snapshotChanges(){return e3(this.ref,this.afs.schedulers.outsideAngular).pipe(Ge)}valueChanges(e={}){return this.snapshotChanges().pipe(j(({payload:n})=>e.idField?ue(x({},n.data()),{[e.idField]:n.id}):n.data()))}get(e){return _e(this.ref.get(e)).pipe(Ge)}};function Pg(t,e){return ZC(t,e).pipe(is(void 0),Ou(),j(n=>{let[r,i]=n,s=i.payload.docChanges(),o=s.map(a=>({type:a.type,payload:a}));return r&&JSON.stringify(r.payload.metadata)!==JSON.stringify(i.payload.metadata)&&i.payload.docs.forEach((a,u)=>{let c=s.find(d=>d.doc.ref.isEqual(a.ref)),l=r?.payload.docs.find(d=>d.ref.isEqual(a.ref));c&&JSON.stringify(c.doc.metadata)===JSON.stringify(a.metadata)||!c&&l&&JSON.stringify(l.metadata)===JSON.stringify(a.metadata)||o.push({type:"modified",payload:{oldIndex:u,newIndex:u,type:"modified",doc:a}})}),o}))}function sO(t,e,n){return Pg(t,n).pipe(Yn((r,i)=>t3(r,i.map(s=>s.payload),e),[]),Pu(),j(r=>r.map(i=>({type:i.type,payload:i}))))}function t3(t,e,n){return e.forEach(r=>{n.indexOf(r.type)>-1&&(t=n3(t,r))}),t}function QC(t,e,n,...r){let i=t.slice();return i.splice(e,n,...r),i}function n3(t,e){switch(e.type){case"added":if(!(t[e.newIndex]&&t[e.newIndex].doc.ref.isEqual(e.doc.ref)))return QC(t,e.newIndex,0,e);break;case"modified":if(t[e.oldIndex]==null||t[e.oldIndex].doc.ref.isEqual(e.doc.ref))if(e.oldIndex!==e.newIndex){let n=t.slice();return n.splice(e.oldIndex,1),n.splice(e.newIndex,0,e),n}else return QC(t,e.newIndex,1,e);break;case"removed":if(t[e.oldIndex]&&t[e.oldIndex].doc.ref.isEqual(e.doc.ref))return QC(t,e.oldIndex,1);break}return t}function oO(t){return(!t||t.length===0)&&(t=["added","removed","modified"]),t}var kg=class{ref;query;afs;constructor(e,n,r){this.ref=e,this.query=n,this.afs=r}stateChanges(e){let n=Pg(this.query,this.afs.schedulers.outsideAngular);return e&&e.length>0&&(n=n.pipe(j(r=>r.filter(i=>e.indexOf(i.type)>-1)))),n.pipe(is(void 0),Ou(),Et(([r,i])=>i.length>0||!r),j(([,r])=>r),Ge)}auditTrail(e){return this.stateChanges(e).pipe(Yn((n,r)=>[...n,...r],[]))}snapshotChanges(e){let n=oO(e);return sO(this.query,n,this.afs.schedulers.outsideAngular).pipe(Ge)}valueChanges(e={}){return ZC(this.query,this.afs.schedulers.outsideAngular).pipe(j(n=>n.payload.docs.map(r=>e.idField?ue(x({},r.data()),{[e.idField]:r.id}):r.data())),Ge)}get(e){return _e(this.query.get(e)).pipe(Ge)}add(e){return this.ref.add(e)}doc(e){return new Ng(this.ref.doc(e),this.afs)}},YC=class{query;afs;constructor(e,n){this.query=e,this.afs=n}stateChanges(e){return!e||e.length===0?Pg(this.query,this.afs.schedulers.outsideAngular).pipe(Ge):Pg(this.query,this.afs.schedulers.outsideAngular).pipe(j(n=>n.filter(r=>e.indexOf(r.type)>-1)),Et(n=>n.length>0),Ge)}auditTrail(e){return this.stateChanges(e).pipe(Yn((n,r)=>[...n,...r],[]))}snapshotChanges(e){let n=oO(e);return sO(this.query,n,this.afs.schedulers.outsideAngular).pipe(Ge)}valueChanges(e={}){return ZC(this.query,this.afs.schedulers.outsideAngular).pipe(j(r=>r.payload.docs.map(i=>e.idField?x({[e.idField]:i.id},i.data()):i.data())),Ge)}get(e){return _e(this.query.get(e)).pipe(Ge)}},r3=new F("angularfire2.enableFirestorePersistence"),i3=new F("angularfire2.firestore.persistenceSettings"),s3=new F("angularfire2.firestore.settings"),o3=new F("angularfire2.firestore.use-emulator");function aO(t,e=n=>n){return{query:e(t),ref:t}}var ou=(()=>{class t{schedulers;firestore;persistenceEnabled$;constructor(n,r,i,s,o,a,u,c,l,d,h,f,p,g,_,b,P){this.schedulers=u;let A=bs(n,a,r),H=l;d&&kc(A,a,h,p,g,_,f,b),[this.firestore,this.persistenceEnabled$]=pa(`${A.name}.firestore`,"AngularFirestore",A.name,()=>{let G=a.runOutsideAngular(()=>A.firestore());if(s&&G.settings(s),H&&G.useEmulator(...H),i&&!Es(o)){let J=()=>{try{return _e(G.enablePersistence(c||void 0).then(()=>!0,()=>!1))}catch(Pe){return typeof console<"u"&&console.warn(Pe),U(!1)}};return[G,a.runOutsideAngular(J)]}else return[G,U(!1)]},[s,H,i])}collection(n,r){let i;typeof n=="string"?i=this.firestore.collection(n):i=n;let{ref:s,query:o}=aO(i,r),a=this.schedulers.ngZone.run(()=>s);return new kg(a,o,this)}collectionGroup(n,r){let i=r||(o=>o),s=this.firestore.collectionGroup(n);return new YC(i(s),this)}doc(n){let r;typeof n=="string"?r=this.firestore.doc(n):r=n;let i=this.schedulers.ngZone.run(()=>r);return new Ng(i,this)}createId(){return this.firestore.collection("_").doc().id}static \u0275fac=function(r){return new(r||t)(C(_i),C(vi,8),C(r3,8),C(s3,8),C(xt),C(le),C(fa),C(i3,8),C(o3,8),C(jf,8),C(Ac,8),C(xc,8),C(Mc,8),C(Rc,8),C(Nc,8),C(Pc,8),C(Vr,8))};static \u0275prov=V({token:t,factory:t.\u0275fac,providedIn:"any"})}return t})();var uO=(()=>{let e=class e{constructor(r){this.firestore=r}getLibros(){return this.firestore.collection("libros").snapshotChanges()}createLibro(r){return console.log(r),this.firestore.collection("/libros").add(Object.assign({},r))}updateLibro(r){this.firestore.doc("/libros/"+r.id).update(r)}deleteLibro(r){this.firestore.doc("libros/"+r).delete()}};e.\u0275fac=function(i){return new(i||e)(C(ou))},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var yO=(()=>{let e=class e{constructor(r,i){this._renderer=r,this._elementRef=i,this.onChange=s=>{},this.onTouched=()=>{}}setProperty(r,i){this._renderer.setProperty(this._elementRef.nativeElement,r,i)}registerOnTouched(r){this.onTouched=r}registerOnChange(r){this.onChange=r}setDisabledState(r){this.setProperty("disabled",r)}};e.\u0275fac=function(i){return new(i||e)(oe(kr),oe(rr))},e.\u0275dir=Lt({type:e});let t=e;return t})(),r0=(()=>{let e=class e extends yO{};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=ms(e)))(s||e)}})(),e.\u0275dir=Lt({type:e,features:[li]});let t=e;return t})(),Lg=new F("");var u3={provide:Lg,useExisting:ps(()=>Bi),multi:!0};function c3(){let t=ir()?ir().getUserAgent():"";return/android (\d+)/.test(t.toLowerCase())}var l3=new F(""),Bi=(()=>{let e=class e extends yO{constructor(r,i,s){super(r,i),this._compositionMode=s,this._composing=!1,this._compositionMode==null&&(this._compositionMode=!c3())}writeValue(r){let i=r??"";this.setProperty("value",i)}_handleInput(r){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(r)}_compositionStart(){this._composing=!0}_compositionEnd(r){this._composing=!1,this._compositionMode&&this.onChange(r)}};e.\u0275fac=function(i){return new(i||e)(oe(kr),oe(rr),oe(l3,8))},e.\u0275dir=Lt({type:e,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(i,s){i&1&&pe("input",function(a){return s._handleInput(a.target.value)})("blur",function(){return s.onTouched()})("compositionstart",function(){return s._compositionStart()})("compositionend",function(a){return s._compositionEnd(a.target.value)})},features:[tc([u3]),li]});let t=e;return t})();var d3=new F(""),h3=new F("");function _O(t){return t!=null}function vO(t){return vs(t)?_e(t):t}function wO(t){let e={};return t.forEach(n=>{e=n!=null?x(x({},e),n):e}),Object.keys(e).length===0?null:e}function EO(t,e){return e.map(n=>n(t))}function f3(t){return!t.validate}function IO(t){return t.map(e=>f3(e)?e:n=>e.validate(n))}function p3(t){if(!t)return null;let e=t.filter(_O);return e.length==0?null:function(n){return wO(EO(n,e))}}function CO(t){return t!=null?p3(IO(t)):null}function g3(t){if(!t)return null;let e=t.filter(_O);return e.length==0?null:function(n){let r=EO(n,e).map(vO);return ry(r).pipe(j(wO))}}function DO(t){return t!=null?g3(IO(t)):null}function cO(t,e){return t===null?[e]:Array.isArray(t)?[...t,e]:[t,e]}function m3(t){return t._rawValidators}function y3(t){return t._rawAsyncValidators}function JC(t){return t?Array.isArray(t)?t:[t]:[]}function Fg(t,e){return Array.isArray(t)?t.includes(e):t===e}function lO(t,e){let n=JC(e);return JC(t).forEach(i=>{Fg(n,i)||n.push(i)}),n}function dO(t,e){return JC(e).filter(n=>!Fg(t,n))}var Vg=class{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=CO(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=DO(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e=void 0){this.control&&this.control.reset(e)}hasError(e,n){return this.control?this.control.hasError(e,n):!1}getError(e,n){return this.control?this.control.getError(e,n):null}},e0=class extends Vg{get formDirective(){return null}get path(){return null}},Kl=class extends Vg{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}},t0=class{constructor(e){this._cd=e}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}},_3={"[class.ng-untouched]":"isUntouched","[class.ng-touched]":"isTouched","[class.ng-pristine]":"isPristine","[class.ng-dirty]":"isDirty","[class.ng-valid]":"isValid","[class.ng-invalid]":"isInvalid","[class.ng-pending]":"isPending"},Ete=ue(x({},_3),{"[class.ng-submitted]":"isSubmitted"}),uu=(()=>{let e=class e extends t0{constructor(r){super(r)}};e.\u0275fac=function(i){return new(i||e)(oe(Kl,2))},e.\u0275dir=Lt({type:e,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(i,s){i&2&&W_("ng-untouched",s.isUntouched)("ng-touched",s.isTouched)("ng-pristine",s.isPristine)("ng-dirty",s.isDirty)("ng-valid",s.isValid)("ng-invalid",s.isInvalid)("ng-pending",s.isPending)},features:[li]});let t=e;return t})();var zl="VALID",Og="INVALID",au="PENDING",Wl="DISABLED";function v3(t){return(jg(t)?t.validators:t)||null}function w3(t){return Array.isArray(t)?CO(t):t||null}function E3(t,e){return(jg(e)?e.asyncValidators:t)||null}function I3(t){return Array.isArray(t)?DO(t):t||null}function jg(t){return t!=null&&!Array.isArray(t)&&typeof t=="object"}var n0=class{constructor(e,n){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._assignValidators(e),this._assignAsyncValidators(n)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get valid(){return this.status===zl}get invalid(){return this.status===Og}get pending(){return this.status==au}get disabled(){return this.status===Wl}get enabled(){return this.status!==Wl}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._assignValidators(e)}setAsyncValidators(e){this._assignAsyncValidators(e)}addValidators(e){this.setValidators(lO(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(lO(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(dO(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(dO(e,this._rawAsyncValidators))}hasValidator(e){return Fg(this._rawValidators,e)}hasAsyncValidator(e){return Fg(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){this.touched=!0,this._parent&&!e.onlySelf&&this._parent.markAsTouched(e)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(e=>e.markAllAsTouched())}markAsUntouched(e={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(n=>{n.markAsUntouched({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}markAsDirty(e={}){this.pristine=!1,this._parent&&!e.onlySelf&&this._parent.markAsDirty(e)}markAsPristine(e={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(n=>{n.markAsPristine({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}markAsPending(e={}){this.status=au,e.emitEvent!==!1&&this.statusChanges.emit(this.status),this._parent&&!e.onlySelf&&this._parent.markAsPending(e)}disable(e={}){let n=this._parentMarkedDirty(e.onlySelf);this.status=Wl,this.errors=null,this._forEachChild(r=>{r.disable(ue(x({},e),{onlySelf:!0}))}),this._updateValue(),e.emitEvent!==!1&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(ue(x({},e),{skipPristineCheck:n})),this._onDisabledChange.forEach(r=>r(!0))}enable(e={}){let n=this._parentMarkedDirty(e.onlySelf);this.status=zl,this._forEachChild(r=>{r.enable(ue(x({},e),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors(ue(x({},e),{skipPristineCheck:n})),this._onDisabledChange.forEach(r=>r(!1))}_updateAncestors(e){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===zl||this.status===au)&&this._runAsyncValidator(e.emitEvent)),e.emitEvent!==!1&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(e)}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(n=>n._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?Wl:zl}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e){if(this.asyncValidator){this.status=au,this._hasOwnPendingAsyncValidator=!0;let n=vO(this.asyncValidator(this));this._asyncValidationSubscription=n.subscribe(r=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(r,{emitEvent:e})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(e,n={}){this.errors=e,this._updateControlsErrors(n.emitEvent!==!1)}get(e){let n=e;return n==null||(Array.isArray(n)||(n=n.split(".")),n.length===0)?null:n.reduce((r,i)=>r&&r._find(i),this)}getError(e,n){let r=n?this.get(n):this;return r&&r.errors?r.errors[e]:null}hasError(e,n){return!!this.getError(e,n)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(e)}_initObservables(){this.valueChanges=new ut,this.statusChanges=new ut}_calculateStatus(){return this._allControlsDisabled()?Wl:this.errors?Og:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(au)?au:this._anyControlsHaveStatus(Og)?Og:zl}_anyControlsHaveStatus(e){return this._anyControls(n=>n.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e={}){this.pristine=!this._anyControlsDirty(),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}_updateTouched(e={}){this.touched=this._anyControlsTouched(),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){jg(e)&&e.updateOn!=null&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){let n=this._parent&&this._parent.dirty;return!e&&!!n&&!this._parent._anyControlsDirty()}_find(e){return null}_assignValidators(e){this._rawValidators=Array.isArray(e)?e.slice():e,this._composedValidatorFn=w3(this._rawValidators)}_assignAsyncValidators(e){this._rawAsyncValidators=Array.isArray(e)?e.slice():e,this._composedAsyncValidatorFn=I3(this._rawAsyncValidators)}};var TO=new F("CallSetDisabledState",{providedIn:"root",factory:()=>i0}),i0="always";function C3(t,e){return[...e.path,t]}function D3(t,e,n=i0){b3(t,e),e.valueAccessor.writeValue(t.value),(t.disabled||n==="always")&&e.valueAccessor.setDisabledState?.(t.disabled),S3(t,e),x3(t,e),A3(t,e),T3(t,e)}function hO(t,e){t.forEach(n=>{n.registerOnValidatorChange&&n.registerOnValidatorChange(e)})}function T3(t,e){if(e.valueAccessor.setDisabledState){let n=r=>{e.valueAccessor.setDisabledState(r)};t.registerOnDisabledChange(n),e._registerOnDestroy(()=>{t._unregisterOnDisabledChange(n)})}}function b3(t,e){let n=m3(t);e.validator!==null?t.setValidators(cO(n,e.validator)):typeof n=="function"&&t.setValidators([n]);let r=y3(t);e.asyncValidator!==null?t.setAsyncValidators(cO(r,e.asyncValidator)):typeof r=="function"&&t.setAsyncValidators([r]);let i=()=>t.updateValueAndValidity();hO(e._rawValidators,i),hO(e._rawAsyncValidators,i)}function S3(t,e){e.valueAccessor.registerOnChange(n=>{t._pendingValue=n,t._pendingChange=!0,t._pendingDirty=!0,t.updateOn==="change"&&bO(t,e)})}function A3(t,e){e.valueAccessor.registerOnTouched(()=>{t._pendingTouched=!0,t.updateOn==="blur"&&t._pendingChange&&bO(t,e),t.updateOn!=="submit"&&t.markAsTouched()})}function bO(t,e){t._pendingDirty&&t.markAsDirty(),t.setValue(t._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(t._pendingValue),t._pendingChange=!1}function x3(t,e){let n=(r,i)=>{e.valueAccessor.writeValue(r),i&&e.viewToModelUpdate(r)};t.registerOnChange(n),e._registerOnDestroy(()=>{t._unregisterOnChange(n)})}function M3(t,e){if(!t.hasOwnProperty("model"))return!1;let n=t.model;return n.isFirstChange()?!0:!Object.is(e,n.currentValue)}function R3(t){return Object.getPrototypeOf(t.constructor)===r0}function N3(t,e){if(!e)return null;Array.isArray(e);let n,r,i;return e.forEach(s=>{s.constructor===Bi?n=s:R3(s)?r=s:i=s}),i||r||n||null}function fO(t,e){let n=t.indexOf(e);n>-1&&t.splice(n,1)}function pO(t){return typeof t=="object"&&t!==null&&Object.keys(t).length===2&&"value"in t&&"disabled"in t}var P3=class extends n0{constructor(e=null,n,r){super(v3(n),E3(r,n)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(e),this._setUpdateStrategy(n),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),jg(n)&&(n.nonNullable||n.initialValueIsDefault)&&(pO(e)?this.defaultValue=e.value:this.defaultValue=e)}setValue(e,n={}){this.value=this._pendingValue=e,this._onChange.length&&n.emitModelToViewChange!==!1&&this._onChange.forEach(r=>r(this.value,n.emitViewToModelChange!==!1)),this.updateValueAndValidity(n)}patchValue(e,n={}){this.setValue(e,n)}reset(e=this.defaultValue,n={}){this._applyFormState(e),this.markAsPristine(n),this.markAsUntouched(n),this.setValue(this.value,n),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){fO(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){fO(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return this.updateOn==="submit"&&(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),this._pendingChange)?(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),!0):!1}_applyFormState(e){pO(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}};var k3={provide:Kl,useExisting:ps(()=>io)},gO=Promise.resolve(),io=(()=>{let e=class e extends Kl{constructor(r,i,s,o,a,u){super(),this._changeDetectorRef=a,this.callSetDisabledState=u,this.control=new P3,this._registered=!1,this.name="",this.update=new ut,this._parent=r,this._setValidators(i),this._setAsyncValidators(s),this.valueAccessor=N3(this,o)}ngOnChanges(r){if(this._checkForErrors(),!this._registered||"name"in r){if(this._registered&&(this._checkName(),this.formDirective)){let i=r.name.previousValue;this.formDirective.removeControl({name:i,path:this._getPath(i)})}this._setUpControl()}"isDisabled"in r&&this._updateDisabled(r),M3(r,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(r){this.viewModel=r,this.update.emit(r)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!!(this.options&&this.options.standalone)}_setUpStandalone(){D3(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),!this._isStandalone()&&this.name}_updateValue(r){gO.then(()=>{this.control.setValue(r,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(r){let i=r.isDisabled.currentValue,s=i!==0&&ws(i);gO.then(()=>{s&&!this.control.disabled?this.control.disable():!s&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(r){return this._parent?C3(r,this._parent):[r]}};e.\u0275fac=function(i){return new(i||e)(oe(e0,9),oe(d3,10),oe(h3,10),oe(Lg,10),oe(Xo,8),oe(TO,8))},e.\u0275dir=Lt({type:e,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:[Vt.None,"disabled","isDisabled"],model:[Vt.None,"ngModel","model"],options:[Vt.None,"ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[tc([k3]),li,gs]});let t=e;return t})();var O3={provide:Lg,useExisting:ps(()=>cu),multi:!0};function SO(t,e){return t==null?`${e}`:(e&&typeof e=="object"&&(e="Object"),`${t}: ${e}`.slice(0,50))}function F3(t){return t.split(":")[0]}var cu=(()=>{let e=class e extends r0{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(r){this._compareWith=r}writeValue(r){this.value=r;let i=this._getOptionId(r),s=SO(i,r);this.setProperty("value",s)}registerOnChange(r){this.onChange=i=>{this.value=this._getOptionValue(i),r(this.value)}}_registerOption(){return(this._idCounter++).toString()}_getOptionId(r){for(let i of this._optionMap.keys())if(this._compareWith(this._optionMap.get(i),r))return i;return null}_getOptionValue(r){let i=F3(r);return this._optionMap.has(i)?this._optionMap.get(i):r}};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=ms(e)))(s||e)}})(),e.\u0275dir=Lt({type:e,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(i,s){i&1&&pe("change",function(a){return s.onChange(a.target.value)})("blur",function(){return s.onTouched()})},inputs:{compareWith:"compareWith"},features:[tc([O3]),li]});let t=e;return t})(),Ug=(()=>{let e=class e{constructor(r,i,s){this._element=r,this._renderer=i,this._select=s,this._select&&(this.id=this._select._registerOption())}set ngValue(r){this._select!=null&&(this._select._optionMap.set(this.id,r),this._setElementValue(SO(this.id,r)),this._select.writeValue(this._select.value))}set value(r){this._setElementValue(r),this._select&&this._select.writeValue(this._select.value)}_setElementValue(r){this._renderer.setProperty(this._element.nativeElement,"value",r)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}};e.\u0275fac=function(i){return new(i||e)(oe(rr),oe(kr),oe(cu,9))},e.\u0275dir=Lt({type:e,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}});let t=e;return t})(),V3={provide:Lg,useExisting:ps(()=>AO),multi:!0};function mO(t,e){return t==null?`${e}`:(typeof e=="string"&&(e=`'${e}'`),e&&typeof e=="object"&&(e="Object"),`${t}: ${e}`.slice(0,50))}function L3(t){return t.split(":")[0]}var AO=(()=>{let e=class e extends r0{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(r){this._compareWith=r}writeValue(r){this.value=r;let i;if(Array.isArray(r)){let s=r.map(o=>this._getOptionId(o));i=(o,a)=>{o._setSelected(s.indexOf(a.toString())>-1)}}else i=(s,o)=>{s._setSelected(!1)};this._optionMap.forEach(i)}registerOnChange(r){this.onChange=i=>{let s=[],o=i.selectedOptions;if(o!==void 0){let a=o;for(let u=0;u<a.length;u++){let c=a[u],l=this._getOptionValue(c.value);s.push(l)}}else{let a=i.options;for(let u=0;u<a.length;u++){let c=a[u];if(c.selected){let l=this._getOptionValue(c.value);s.push(l)}}}this.value=s,r(s)}}_registerOption(r){let i=(this._idCounter++).toString();return this._optionMap.set(i,r),i}_getOptionId(r){for(let i of this._optionMap.keys())if(this._compareWith(this._optionMap.get(i)._value,r))return i;return null}_getOptionValue(r){let i=L3(r);return this._optionMap.has(i)?this._optionMap.get(i)._value:r}};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=ms(e)))(s||e)}})(),e.\u0275dir=Lt({type:e,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(i,s){i&1&&pe("change",function(a){return s.onChange(a.target)})("blur",function(){return s.onTouched()})},inputs:{compareWith:"compareWith"},features:[tc([V3]),li]});let t=e;return t})(),Bg=(()=>{let e=class e{constructor(r,i,s){this._element=r,this._renderer=i,this._select=s,this._select&&(this.id=this._select._registerOption(this))}set ngValue(r){this._select!=null&&(this._value=r,this._setElementValue(mO(this.id,r)),this._select.writeValue(this._select.value))}set value(r){this._select?(this._value=r,this._setElementValue(mO(this.id,r)),this._select.writeValue(this._select.value)):this._setElementValue(r)}_setElementValue(r){this._renderer.setProperty(this._element.nativeElement,"value",r)}_setSelected(r){this._renderer.setProperty(this._element.nativeElement,"selected",r)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}};e.\u0275fac=function(i){return new(i||e)(oe(rr),oe(kr),oe(AO,9))},e.\u0275dir=Lt({type:e,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}});let t=e;return t})();var j3=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=et({type:e}),e.\u0275inj=Je({});let t=e;return t})();var xO=(()=>{let e=class e{static withConfig(r){return{ngModule:e,providers:[{provide:TO,useValue:r.callSetDisabledState??i0}]}}};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=et({type:e}),e.\u0275inj=Je({imports:[j3]});let t=e;return t})();function U3(t,e){if(t&1){let n=Jo();w(0,"tr")(1,"td"),T(2),E(),w(3,"td"),T(4),E(),w(5,"td"),T(6),E(),w(7,"td"),T(8),E(),w(9,"td")(10,"button",12),pe("click",function(){let s=Wo(n).$implicit,o=ea();return Ko(o.selectLibro(s))}),T(11,"Seleccionar"),E()()()}if(t&2){let n=e.$implicit;ve(2),Ct(n.titulo),ve(2),Ct(n.autor),ve(2),Ct(n.editorial),ve(2),Ct(n.ano)}}var MO=(()=>{let e=class e{constructor(r){this.libroService=r,this.libros=[],this.libro=new mi}ngOnInit(){this.libroService.getLibros().subscribe(r=>{this.libros=r.map(i=>ue(x({},i.payload.doc.data()),{id:i.payload.doc.id}))})}insertarLibro(){this.libroService.createLibro(this.libro),this.libro=new mi}selectLibro(r){this.libro=r}updateLibro(){this.libroService.updateLibro(this.libro),this.libro=new mi}deleteLibro(r){this.libroService.deleteLibro(r),this.libro=new mi}};e.\u0275fac=function(i){return new(i||e)(oe(uO))},e.\u0275cmp=At({type:e,selectors:[["app-libros"]],decls:43,vars:5,consts:[[1,"container"],[1,"row"],[1,"col-8"],[1,"table"],[4,"ngFor","ngForOf"],[1,"col"],["for",""],["type","text",1,"form-control",3,"ngModel","ngModelChange"],[1,"space-around"],["type","button",1,"btn","in",3,"click"],["type","button",1,"btn","up",3,"click"],["type","button",1,"btn","del",3,"click"],["type","button",1,"btn","sel",3,"click"]],template:function(i,s){i&1&&(w(0,"div",0)(1,"h1"),T(2,"Cat\xE1logo de Libros"),E(),w(3,"div",1)(4,"div",2)(5,"table",3)(6,"thead")(7,"th"),T(8,"T\xEDtulo"),E(),w(9,"th"),T(10,"Autor"),E(),w(11,"th"),T(12,"Editorial"),E(),w(13,"th"),T(14,"A\xF1o de publicaci\xF3n"),E()(),w(15,"tbody"),ys(16,U3,12,4,"tr",4),E()()(),w(17,"div",5)(18,"h5"),T(19,"Agregar un libro"),E(),w(20,"p")(21,"label",6),T(22,"T\xEDtulo"),E(),w(23,"input",7),pe("ngModelChange",function(a){return s.libro.titulo=a}),E()(),w(24,"p")(25,"label",6),T(26,"Autor"),E(),w(27,"input",7),pe("ngModelChange",function(a){return s.libro.autor=a}),E()(),w(28,"p")(29,"label",6),T(30,"Editorial"),E(),w(31,"input",7),pe("ngModelChange",function(a){return s.libro.editorial=a}),E()(),w(32,"p")(33,"label",6),T(34,"A\xF1o de publicaci\xF3n"),E(),w(35,"input",7),pe("ngModelChange",function(a){return s.libro.ano=a}),E()(),w(36,"div",8)(37,"button",9),pe("click",function(){return s.insertarLibro()}),T(38,"Insertar"),E(),w(39,"button",10),pe("click",function(){return s.updateLibro()}),T(40,"Actualizar "),E(),w(41,"button",11),pe("click",function(){return s.deleteLibro(s.libro.id)}),T(42,"Eliminar"),E()()()()()),i&2&&(ve(16),tt("ngForOf",s.libros),ve(7),tt("ngModel",s.libro.titulo),ve(4),tt("ngModel",s.libro.autor),ve(4),tt("ngModel",s.libro.editorial),ve(4),tt("ngModel",s.libro.ano))},dependencies:[ra,Bi,uu,io],styles:["h1[_ngcontent-%COMP%]{text-align:center;margin:2rem 0;padding-bottom:1rem;border-bottom:solid 2px teal}table[_ngcontent-%COMP%]{text-align:center}button[_ngcontent-%COMP%]{color:#f0f8ff;font-weight:700;border:none;border-radius:1rem;padding:.5rem 1rem}button[_ngcontent-%COMP%]:hover{color:#f0f8ff}.sel[_ngcontent-%COMP%]{background-color:#5f9ea0}.sel[_ngcontent-%COMP%]:hover{background-color:#477475}"]});let t=e;return t})();var so=class{};var RO=(()=>{let e=class e{constructor(r){this.firestore=r}getClientes(){return this.firestore.collection("clientes").snapshotChanges()}createCliente(r){return console.log(r),this.firestore.collection("/clientes").add(Object.assign({},r))}updateCliente(r){this.firestore.doc("clientes/"+r.id).update(r)}deleteCliente(r){this.firestore.doc("clientes/"+r).delete()}};e.\u0275fac=function(i){return new(i||e)(C(ou))},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function $3(t,e){if(t&1){let n=Jo();w(0,"tr")(1,"td"),T(2),E(),w(3,"td"),T(4),E(),w(5,"td"),T(6),E(),w(7,"td"),T(8),E(),w(9,"td")(10,"button",17),pe("click",function(){let s=Wo(n).$implicit,o=ea();return Ko(o.selectCliente(s))}),T(11,"Seleccionar"),E()()()}if(t&2){let n=e.$implicit;ve(2),Ct(n.nombre),ve(2),Ct(n.rfc),ve(2),Ct(n.domicilio),ve(2),Ct(n.tipoCliente)}}var NO=(()=>{let e=class e{constructor(r){this.clienteService=r,this.clientes=[],this.cliente=new so}ngOnInit(){this.clienteService.getClientes().subscribe(r=>{this.clientes=r.map(i=>ue(x({},i.payload.doc.data()),{id:i.payload.doc.id}))})}insertarCliente(){this.clienteService.createCliente(this.cliente),this.cliente=new so}selectCliente(r){this.cliente=r}updateCliente(){this.clienteService.updateCliente(this.cliente),this.cliente=new so}deleteCliente(r){this.clienteService.deleteCliente(r),this.cliente=new so}};e.\u0275fac=function(i){return new(i||e)(oe(RO))},e.\u0275cmp=At({type:e,selectors:[["app-clientes"]],decls:51,vars:5,consts:[[1,"container"],[1,"row"],[1,"col-8"],[1,"table"],[4,"ngFor","ngForOf"],[1,"col"],["for",""],["type","text",1,"form-control",3,"ngModel","ngModelChange"],["name","",1,"select",3,"ngModel","ngModelChange"],["value","Sin definir"],["value","Activo"],["value","Inactivo"],["value","Deudor"],[1,"space-around"],["type","button",1,"btn","in",3,"click"],["type","button",1,"btn","up",3,"click"],["type","button",1,"btn","del",3,"click"],["type","button",1,"btn","sel",3,"click"]],template:function(i,s){i&1&&(w(0,"div",0)(1,"h1"),T(2,"Registro de Clientes"),E(),w(3,"div",1)(4,"div",2)(5,"table",3)(6,"thead")(7,"th"),T(8,"Nombre"),E(),w(9,"th"),T(10,"RFC"),E(),w(11,"th"),T(12,"Domicilio"),E(),w(13,"th"),T(14,"Tipo de cliente"),E()(),w(15,"tbody"),ys(16,$3,12,4,"tr",4),E()()(),w(17,"div",5)(18,"h5"),T(19,"Dar de alta un cliente"),E(),w(20,"p")(21,"label",6),T(22,"Nombre"),E(),w(23,"input",7),pe("ngModelChange",function(a){return s.cliente.nombre=a}),E()(),w(24,"p")(25,"label",6),T(26,"RFC"),E(),w(27,"input",7),pe("ngModelChange",function(a){return s.cliente.rfc=a}),E()(),w(28,"p")(29,"label",6),T(30,"Domicilio"),E(),w(31,"input",7),pe("ngModelChange",function(a){return s.cliente.domicilio=a}),E()(),w(32,"p")(33,"label",6),T(34,"Tipo de cliente"),E(),w(35,"select",8),pe("ngModelChange",function(a){return s.cliente.tipoCliente=a}),w(36,"option",9),T(37,"Sin definir"),E(),w(38,"option",10),T(39,"Activo"),E(),w(40,"option",11),T(41,"Inactivo"),E(),w(42,"option",12),T(43,"Deudor"),E()()(),w(44,"div",13)(45,"button",14),pe("click",function(){return s.insertarCliente()}),T(46,"Insertar"),E(),w(47,"button",15),pe("click",function(){return s.updateCliente()}),T(48,"Actualizar "),E(),w(49,"button",16),pe("click",function(){return s.deleteCliente(s.cliente.id)}),T(50,"Eliminar"),E()()()()()),i&2&&(ve(16),tt("ngForOf",s.clientes),ve(7),tt("ngModel",s.cliente.nombre),ve(4),tt("ngModel",s.cliente.rfc),ve(4),tt("ngModel",s.cliente.domicilio),ve(4),tt("ngModel",s.cliente.tipoCliente))},dependencies:[ra,Ug,Bg,Bi,cu,uu,io],styles:["h1[_ngcontent-%COMP%]{text-align:center;margin:2rem 0;padding-bottom:1rem;border-bottom:solid 2px royalblue}table[_ngcontent-%COMP%]{text-align:center}button[_ngcontent-%COMP%]{color:#f0f8ff;font-weight:700;border:none;border-radius:1rem;padding:.5rem 1rem}button[_ngcontent-%COMP%]:hover{color:#f0f8ff}.sel[_ngcontent-%COMP%]{background-color:#4169e1}.sel[_ngcontent-%COMP%]:hover{background-color:#0e0f4d}"]});let t=e;return t})();var oo=class{};var PO=(()=>{let e=class e{constructor(r){this.firestore=r}getTareas(){return this.firestore.collection("tareas").snapshotChanges()}createTarea(r){return this.firestore.collection("/tareas").add(Object.assign({},r))}updateTarea(r){this.firestore.doc("/tareas/"+r.id).update(r)}deleteTarea(r){this.firestore.doc("/tareas/"+r).delete()}};e.\u0275fac=function(i){return new(i||e)(C(ou))},e.\u0275prov=V({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function q3(t,e){if(t&1){let n=Jo();w(0,"tr")(1,"td"),T(2),E(),w(3,"td"),T(4),E(),w(5,"td"),T(6),E(),w(7,"td"),T(8),E(),w(9,"td"),T(10),E(),w(11,"td")(12,"button",23),pe("click",function(){let s=Wo(n).$implicit,o=ea();return Ko(o.selectTarea(s))}),T(13,"Seleccionar"),E()()()}if(t&2){let n=e.$implicit;ve(2),Ct(n.titulo),ve(2),Ct(n.asunto),ve(2),Ct(n.descripcion),ve(2),Ct(n.fecha),ve(2),Ct(n.urgencia)}}var kO=(()=>{let e=class e{constructor(r){this.tareaService=r,this.tareas=[],this.tarea=new oo}ngOnInit(){this.tareaService.getTareas().subscribe(r=>{this.tareas=r.map(i=>ue(x({},i.payload.doc.data()),{id:i.payload.doc.id}))})}insertarTarea(){this.tareaService.createTarea(this.tarea),this.tarea=new oo}selectTarea(r){this.tarea=r}updateTarea(){this.tareaService.updateTarea(this.tarea),this.tarea=new oo}deleteTarea(r){this.tareaService.deleteTarea(r),this.tarea=new oo}};e.\u0275fac=function(i){return new(i||e)(oe(PO))},e.\u0275cmp=At({type:e,selectors:[["app-agenda"]],decls:67,vars:6,consts:[[1,"container"],[1,"row"],[1,"col-8"],[1,"table"],[4,"ngFor","ngForOf"],[1,"col"],["for",""],["type","text",1,"form-control",3,"ngModel","ngModelChange"],["name","",1,"select",3,"ngModel","ngModelChange"],["value","Personal"],["value","Acad\xE9mico"],["value","Laboral"],["value","Otro"],["type","date",1,"form-control",3,"ngModel","ngModelChange"],["value","Nada importante"],["value","Poco importante"],["value","Importante"],["value","Muy importante"],["value","De vida o muerte"],[1,"space-around"],["type","button",1,"btn","in",3,"click"],["type","button",1,"btn","up",3,"click"],["type","button",1,"btn","del",3,"click"],["type","button",1,"btn","sel",3,"click"]],template:function(i,s){i&1&&(w(0,"div",0)(1,"h1"),T(2,"Agenda"),E(),w(3,"div",1)(4,"div",2)(5,"table",3)(6,"thead")(7,"th"),T(8,"T\xEDtulo"),E(),w(9,"th"),T(10,"Asunto"),E(),w(11,"th"),T(12,"Descripci\xF3n"),E(),w(13,"th"),T(14,"Fecha"),E(),w(15,"th"),T(16,"Urgente"),E()(),w(17,"tbody"),ys(18,q3,14,5,"tr",4),E()()(),w(19,"div",5)(20,"h5"),T(21,"Crear nueva tarea"),E(),w(22,"p")(23,"label",6),T(24,"T\xEDtulo"),E(),w(25,"input",7),pe("ngModelChange",function(a){return s.tarea.titulo=a}),E()(),w(26,"p")(27,"label",6),T(28,"Asunto"),E(),w(29,"select",8),pe("ngModelChange",function(a){return s.tarea.asunto=a}),w(30,"option",9),T(31,"Personal"),E(),w(32,"option",10),T(33,"Acad\xE9mico"),E(),w(34,"option",11),T(35,"Laboral"),E(),w(36,"option",12),T(37,"Otro"),E()()(),w(38,"p")(39,"label",6),T(40,"Descripci\xF3n"),E(),w(41,"input",7),pe("ngModelChange",function(a){return s.tarea.descripcion=a}),E()(),w(42,"p")(43,"label",6),T(44,"Fecha"),E(),w(45,"input",13),pe("ngModelChange",function(a){return s.tarea.fecha=a}),E()(),w(46,"p")(47,"label",6),T(48,"Urgencia"),E(),w(49,"select",8),pe("ngModelChange",function(a){return s.tarea.urgencia=a}),w(50,"option",14),T(51,"Nada importante"),E(),w(52,"option",15),T(53,"Poco importante"),E(),w(54,"option",16),T(55,"Importante"),E(),w(56,"option",17),T(57,"Muy importante"),E(),w(58,"option",18),T(59,"De vida o muerte"),E()()(),w(60,"div",19)(61,"button",20),pe("click",function(){return s.insertarTarea()}),T(62,"Insertar"),E(),w(63,"button",21),pe("click",function(){return s.updateTarea()}),T(64,"Actualizar "),E(),w(65,"button",22),pe("click",function(){return s.deleteTarea(s.tarea.id)}),T(66,"Eliminar"),E()()()()()),i&2&&(ve(18),tt("ngForOf",s.tareas),ve(7),tt("ngModel",s.tarea.titulo),ve(4),tt("ngModel",s.tarea.asunto),ve(12),tt("ngModel",s.tarea.descripcion),ve(4),tt("ngModel",s.tarea.fecha),ve(4),tt("ngModel",s.tarea.urgencia))},dependencies:[ra,Ug,Bg,Bi,cu,uu,io],styles:["h1[_ngcontent-%COMP%]{text-align:center;margin:2rem 0;padding-bottom:1rem;border-bottom:solid 2px palevioletred}button[_ngcontent-%COMP%]{color:#f0f8ff;font-weight:700;border:none;border-radius:1rem;padding:.5rem 1rem}button[_ngcontent-%COMP%]:hover{color:#f0f8ff}.sel[_ngcontent-%COMP%]{background-color:#ff1493}.sel[_ngcontent-%COMP%]:hover{background-color:#bb0c6a}"]});let t=e;return t})();var OO=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=At({type:e,selectors:[["app-about"]],decls:37,vars:0,consts:[[1,"container"],[1,"d-flex","justify-content-center","mt-5"],[1,"d-flex","justify-content-center","align-items-center","mt-5"],["src","./src/assets/images/foto.jpg","alt","no se","id","mi-foto"],[1,"m-5"],[1,"d-flex","mb-3"],[1,"bold"],[1,""]],template:function(i,s){i&1&&(w(0,"div",0)(1,"div",1)(2,"h1"),T(3,"Perfil del desarrollador"),E()(),w(4,"div",2),_s(5,"img",3),w(6,"div",4)(7,"div",5)(8,"label",6),T(9,"Nombre: "),E(),w(10,"span",7),T(11," Fernanda Montserrat Hern\xE1ndez \xC1vila"),E()(),w(12,"div",5)(13,"label",6),T(14,"Fecha de nacimiento: "),E(),w(15,"span",7),T(16," 04 de Julio de 2003"),E()(),w(17,"div",5)(18,"label",6),T(19,"Carrera: "),E(),w(20,"span",7),T(21," Desarrollo Y Gesti\xF3n de Software"),E()(),w(22,"div",5)(23,"label",6),T(24,"Color favorito: "),E(),w(25,"span",7),T(26,"Rojo"),E()(),w(27,"div",5)(28,"label",6),T(29,"Serie favorita: "),E(),w(30,"span",7),T(31,"One Piece"),E()(),w(32,"div",5)(33,"label",6),T(34,"Pok\xE9mon favorito: "),E(),w(35,"span",7),T(36,"Flaaffy"),E()()()()())},styles:["h1[_ngcontent-%COMP%]{color:#a00840;border-bottom:solid 2px rgb(122,0,65)}#mi-foto[_ngcontent-%COMP%]{width:20rem;height:23rem;object-fit:cover;object-position:50% 15%;border-radius:3rem}.bold[_ngcontent-%COMP%]{font-weight:700;margin-right:.5rem;color:#8b0000}"]});let t=e;return t})();var FO=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=At({type:e,selectors:[["app-home"]],decls:11,vars:0,consts:[[1,"container"],[1,"d-flex","mt-5","justify-content-center"],[1,""]],template:function(i,s){i&1&&(w(0,"div",0)(1,"div",1)(2,"div",2)(3,"h1"),T(4,"Evaluaci\xF3n de Segundo Parcial"),E(),w(5,"h3"),T(6,"Asignatura: Desarrollo Web Profesional"),E(),w(7,"h3"),T(8,"Asesor: Alejandro C\xE9sar Valencia Garc\xEDa"),E(),w(9,"h3"),T(10,"Alumno: Fernanda Montserrat Hern\xE1ndez \xC1vila"),E()()()())},styles:["h3[_ngcontent-%COMP%]{margin-top:3rem}"]});let t=e;return t})();var G3=[{path:"home",component:FO},{path:"libros",component:MO},{path:"clientes",component:NO},{path:"agenda",component:kO},{path:"about",component:OO},{path:"**",redirectTo:"home"}],VO=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=et({type:e}),e.\u0275inj=Je({imports:[tw.forRoot(G3),tw]});let t=e;return t})();var LO=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=At({type:e,selectors:[["app-menu"]],decls:16,vars:0,consts:[[1,"nav","nav-tabs"],[1,"nav-item"],["routerLink","/home",1,"nav-link"],["routerLink","/libros",1,"nav-link"],["routerLink","/clientes",1,"nav-link"],["routerLink","/agenda",1,"nav-link"],["routerLink","/about",1,"nav-link"]],template:function(i,s){i&1&&(w(0,"ul",0)(1,"li",1)(2,"a",2),T(3,"Home"),E()(),w(4,"li",1)(5,"a",3),T(6,"Libros"),E()(),w(7,"li",1)(8,"a",4),T(9,"Clientes"),E()(),w(10,"li",1)(11,"a",5),T(12,"Agenda"),E()(),w(13,"li",1)(14,"a",6),T(15,"Acerca de m\xED"),E()()())},dependencies:[zx],styles:["ul[_ngcontent-%COMP%]{justify-content:center}.nav-link[_ngcontent-%COMP%]{color:#8a2be2;font-weight:700}.nav-link[_ngcontent-%COMP%]:hover{background-color:#483d8b;color:#f0f8ff}"]});let t=e;return t})();var jO=(()=>{let e=class e{constructor(){this.title="libros"}};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=At({type:e,selectors:[["app-root"]],decls:2,vars:0,template:function(i,s){i&1&&_s(0,"app-menu")(1,"router-outlet")},dependencies:[Kv,LO]});let t=e;return t})();var UO="@firebase/database",BO="1.0.3";var yD="";function _D(t){yD=t}var f0=class{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,n){n==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),Qe(n))}get(e){let n=this.domStorage_.getItem(this.prefixedName_(e));return n==null?null:Nd(n)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}};var p0=class{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,n){n==null?delete this.cache_[e]:this.cache_[e]=n}get(e){return hn(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}};var _1=function(t){try{if(typeof window<"u"&&typeof window[t]<"u"){let e=window[t];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new f0(e)}}catch{}return new p0},uo=_1("localStorage"),g0=_1("sessionStorage");var fu=new Xr("@firebase/database"),v1=function(){let t=1;return function(){return t++}}(),w1=function(t){let e=fT(t),n=new hT;n.update(e);let r=n.digest();return xd.encodeByteArray(r)},_d=function(...t){let e="";for(let n=0;n<t.length;n++){let r=t[n];Array.isArray(r)||r&&typeof r=="object"&&typeof r.length=="number"?e+=_d.apply(null,r):typeof r=="object"?e+=Qe(r):e+=r,e+=" "}return e},co=null,$O=!0,E1=function(t,e){S(!e||t===!0||t===!1,"Can't turn on custom loggers persistently."),t===!0?(fu.logLevel=fn.VERBOSE,co=fu.log.bind(fu),e&&g0.set("logging_enabled",!0)):typeof t=="function"?co=t:(co=null,g0.remove("logging_enabled"))},mt=function(...t){if($O===!0&&($O=!1,co===null&&g0.get("logging_enabled")===!0&&E1(!0)),co){let e=_d.apply(null,t);co(e)}},vd=function(t){return function(...e){mt(t,...e)}},m0=function(...t){let e="FIREBASE INTERNAL ERROR: "+_d(...t);fu.error(e)},Cr=function(...t){let e=`FIREBASE FATAL ERROR: ${_d(...t)}`;throw fu.error(e),new Error(e)},kt=function(...t){let e="FIREBASE WARNING: "+_d(...t);fu.warn(e)},W3=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&kt("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},gm=function(t){return typeof t=="number"&&(t!==t||t===Number.POSITIVE_INFINITY||t===Number.NEGATIVE_INFINITY)},K3=function(t){if(Kn()||document.readyState==="complete")t();else{let e=!1,n=function(){if(!document.body){setTimeout(n,Math.floor(10));return}e||(e=!0,t())};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&n()}),window.attachEvent("onload",n))}},Gi="[MIN_NAME]",Qr="[MAX_NAME]",ho=function(t,e){if(t===e)return 0;if(t===Gi||e===Qr)return-1;if(e===Gi||t===Qr)return 1;{let n=HO(t),r=HO(e);return n!==null?r!==null?n-r===0?t.length-e.length:n-r:-1:r!==null?1:t<e?-1:1}},Q3=function(t,e){return t===e?0:t<e?-1:1},Ql=function(t,e){if(e&&t in e)return e[t];throw new Error("Missing required key ("+t+") in object: "+Qe(e))},vD=function(t){if(typeof t!="object"||t===null)return Qe(t);let e=[];for(let r in t)e.push(r);e.sort();let n="{";for(let r=0;r<e.length;r++)r!==0&&(n+=","),n+=Qe(e[r]),n+=":",n+=vD(t[e[r]]);return n+="}",n},I1=function(t,e){let n=t.length;if(n<=e)return[t];let r=[];for(let i=0;i<n;i+=e)i+e>n?r.push(t.substring(i,n)):r.push(t.substring(i,i+e));return r};function yt(t,e){for(let n in t)t.hasOwnProperty(n)&&e(n,t[n])}var C1=function(t){S(!gm(t),"Invalid JSON number");let e=11,n=52,r=(1<<e-1)-1,i,s,o,a,u;t===0?(s=0,o=0,i=1/t===-1/0?1:0):(i=t<0,t=Math.abs(t),t>=Math.pow(2,1-r)?(a=Math.min(Math.floor(Math.log(t)/Math.LN2),r),s=a+r,o=Math.round(t*Math.pow(2,n-a)-Math.pow(2,n))):(s=0,o=Math.round(t/Math.pow(2,1-r-n))));let c=[];for(u=n;u;u-=1)c.push(o%2?1:0),o=Math.floor(o/2);for(u=e;u;u-=1)c.push(s%2?1:0),s=Math.floor(s/2);c.push(i?1:0),c.reverse();let l=c.join(""),d="";for(u=0;u<64;u+=8){let h=parseInt(l.substr(u,8),2).toString(16);h.length===1&&(h="0"+h),d=d+h}return d.toLowerCase()},Y3=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},Z3=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function X3(t,e){let n="Unknown Error";t==="too_big"?n="The data requested exceeds the maximum size that can be accessed with a single request.":t==="permission_denied"?n="Client doesn't have permission to access the desired data.":t==="unavailable"&&(n="The service is unavailable");let r=new Error(t+" at "+e._path.toString()+": "+n);return r.code=t.toUpperCase(),r}var J3=new RegExp("^-?(0*)\\d{1,10}$"),e9=-2147483648,t9=2147483647,HO=function(t){if(J3.test(t)){let e=Number(t);if(e>=e9&&e<=t9)return e}return null},Iu=function(t){try{t()}catch(e){setTimeout(()=>{let n=e.stack||"";throw kt("Exception was thrown by user callback.",n),e},Math.floor(0))}},n9=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},Jl=function(t,e){let n=setTimeout(t,e);return typeof n=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(n):typeof n=="object"&&n.unref&&n.unref(),n};var y0=class{constructor(e,n){this.appName_=e,this.appCheckProvider=n,this.appCheck=n?.getImmediate({optional:!0}),this.appCheck||n?.get().then(r=>this.appCheck=r)}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise((n,r)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(n,r):n(null)},0)})}addTokenChangeListener(e){var n;(n=this.appCheckProvider)===null||n===void 0||n.get().then(r=>r.addTokenListener(e))}notifyForInvalidToken(){kt(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}};var _0=class{constructor(e,n,r){this.appName_=e,this.firebaseOptions_=n,this.authProvider_=r,this.auth_=null,this.auth_=r.getImmediate({optional:!0}),this.auth_||r.onInit(i=>this.auth_=i)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(n=>n&&n.code==="auth/token-not-initialized"?(mt("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(n)):new Promise((n,r)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(n,r):n(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(n=>n.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(n=>n.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',kt(e)}},ed=(()=>{class t{constructor(n){this.accessToken=n}getToken(n){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(n){n(this.accessToken)}removeTokenChangeListener(n){}notifyForInvalidToken(){}}t.OWNER="owner";return t})(),Hg="5",D1="v",T1="s",b1="r",S1="f",A1=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,x1="ls",M1="p",v0="ac",R1="websocket",N1="long_polling";var qg=class{constructor(e,n,r,i,s=!1,o="",a=!1,u=!1){this.secure=n,this.namespace=r,this.webSocketOnly=i,this.nodeAdmin=s,this.persistenceKey=o,this.includeNamespaceInQueryParams=a,this.isUsingEmulator=u,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=uo.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&uo.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){let e=this.secure?"https://":"http://",n=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${n}`}};function r9(t){return t.host!==t.internalHost||t.isCustomHost()||t.includeNamespaceInQueryParams}function P1(t,e,n){S(typeof e=="string","typeof type must == string"),S(typeof n=="object","typeof params must == object");let r;if(e===R1)r=(t.secure?"wss://":"ws://")+t.internalHost+"/.ws?";else if(e===N1)r=(t.secure?"https://":"http://")+t.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);r9(t)&&(n.ns=t.namespace);let i=[];return yt(n,(s,o)=>{i.push(s+"="+o)}),r+i.join("&")}var w0=class{constructor(){this.counters_={}}incrementCounter(e,n=1){hn(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=n}get(){return sT(this.counters_)}};var o0={},a0={};function wD(t){let e=t.toString();return o0[e]||(o0[e]=new w0),o0[e]}function i9(t,e){let n=t.toString();return a0[n]||(a0[n]=e()),a0[n]}var E0=class{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,n){this.closeAfterResponse=e,this.onClose=n,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,n){for(this.pendingResponses[e]=n;this.pendingResponses[this.currentResponseNum];){let r=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let i=0;i<r.length;++i)r[i]&&Iu(()=>{this.onMessage_(r[i])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}};var qO="start",s9="close",o9="pLPCommand",a9="pRTLPCB",k1="id",O1="pw",F1="ser",u9="cb",c9="seg",l9="ts",d9="d",h9="dframe",V1=1870,L1=30,f9=V1-L1,p9=25e3,g9=3e4,id=class t{constructor(e,n,r,i,s,o,a){this.connId=e,this.repoInfo=n,this.applicationId=r,this.appCheckToken=i,this.authToken=s,this.transportSessionId=o,this.lastSessionId=a,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=vd(e),this.stats_=wD(n),this.urlFn=u=>(this.appCheckToken&&(u[v0]=this.appCheckToken),P1(n,N1,u))}open(e,n){this.curSegmentNum=0,this.onDisconnect_=n,this.myPacketOrderer=new E0(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(g9)),K3(()=>{if(this.isClosed_)return;this.scriptTagHolder=new I0((...s)=>{let[o,a,u,c,l]=s;if(this.incrementIncomingBytes_(s),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,o===qO)this.id=a,this.password=u;else if(o===s9)a?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(a,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+o)},(...s)=>{let[o,a]=s;this.incrementIncomingBytes_(s),this.myPacketOrderer.handleResponse(o,a)},()=>{this.onClosed_()},this.urlFn);let r={};r[qO]="t",r[F1]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(r[u9]=this.scriptTagHolder.uniqueCallbackIdentifier),r[D1]=Hg,this.transportSessionId&&(r[T1]=this.transportSessionId),this.lastSessionId&&(r[x1]=this.lastSessionId),this.applicationId&&(r[M1]=this.applicationId),this.appCheckToken&&(r[v0]=this.appCheckToken),typeof location<"u"&&location.hostname&&A1.test(location.hostname)&&(r[b1]=S1);let i=this.urlFn(r);this.log_("Connecting via long-poll to "+i),this.scriptTagHolder.addTag(i,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){t.forceAllow_=!0}static forceDisallow(){t.forceDisallow_=!0}static isAvailable(){return Kn()?!1:t.forceAllow_?!0:!t.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!Y3()&&!Z3()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){let n=Qe(e);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);let r=iT(n),i=I1(r,f9);for(let s=0;s<i.length;s++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[s]),this.curSegmentNum++}addDisconnectPingFrame(e,n){if(Kn())return;this.myDisconnFrame=document.createElement("iframe");let r={};r[h9]="t",r[k1]=e,r[O1]=n,this.myDisconnFrame.src=this.urlFn(r),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){let n=Qe(e).length;this.bytesReceived+=n,this.stats_.incrementCounter("bytes_received",n)}},I0=class t{constructor(e,n,r,i){if(this.onDisconnect=r,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0,Kn())this.commandCB=e,this.onMessageCB=n;else{this.uniqueCallbackIdentifier=v1(),window[o9+this.uniqueCallbackIdentifier]=e,window[a9+this.uniqueCallbackIdentifier]=n,this.myIFrame=t.createIFrame_();let s="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(s='<script>document.domain="'+document.domain+'";<\/script>');let o="<html><body>"+s+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(a){mt("frame writing exception"),a.stack&&mt(a.stack),mt(a)}}}static createIFrame_(){let e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||mt("No IE domain setting required")}catch{let r=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+r+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));let e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,n){for(this.myID=e,this.myPW=n,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;let e={};e[k1]=this.myID,e[O1]=this.myPW,e[F1]=this.currentSerial;let n=this.urlFn(e),r="",i=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+L1+r.length<=V1;){let o=this.pendingSegs.shift();r=r+"&"+c9+i+"="+o.seg+"&"+l9+i+"="+o.ts+"&"+d9+i+"="+o.d,i++}return n=n+r,this.addLongPollTag_(n,this.currentSerial),!0}else return!1}enqueueSegment(e,n,r){this.pendingSegs.push({seg:e,ts:n,d:r}),this.alive&&this.newRequest_()}addLongPollTag_(e,n){this.outstandingRequests.add(n);let r=()=>{this.outstandingRequests.delete(n),this.newRequest_()},i=setTimeout(r,Math.floor(p9)),s=()=>{clearTimeout(i),r()};this.addTag(e,s)}addTag(e,n){Kn()?this.doNodeLongPoll(e,n):setTimeout(()=>{try{if(!this.sendNewPolls)return;let r=this.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=e,r.onload=r.onreadystatechange=function(){let i=r.readyState;(!i||i==="loaded"||i==="complete")&&(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),n())},r.onerror=()=>{mt("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(r)}catch{}},Math.floor(1))}};var m9=16384,y9=45e3,Gg=null;typeof MozWebSocket<"u"?Gg=MozWebSocket:typeof WebSocket<"u"&&(Gg=WebSocket);var du=(()=>{class t{constructor(n,r,i,s,o,a,u){this.connId=n,this.applicationId=i,this.appCheckToken=s,this.authToken=o,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=vd(this.connId),this.stats_=wD(r),this.connURL=t.connectionURL_(r,a,u,s,i),this.nodeAdmin=r.nodeAdmin}static connectionURL_(n,r,i,s,o){let a={};return a[D1]=Hg,!Kn()&&typeof location<"u"&&location.hostname&&A1.test(location.hostname)&&(a[b1]=S1),r&&(a[T1]=r),i&&(a[x1]=i),s&&(a[v0]=s),o&&(a[M1]=o),P1(n,R1,a)}open(n,r){this.onDisconnect=r,this.onMessage=n,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,uo.set("previous_websocket_failure",!0);try{let i;if(Kn()){let s=this.nodeAdmin?"AdminNode":"Node";i={headers:{"User-Agent":`Firebase/${Hg}/${yD}/${process.platform}/${s}`,"X-Firebase-GMPID":this.applicationId||""}},this.authToken&&(i.headers.Authorization=`Bearer ${this.authToken}`),this.appCheckToken&&(i.headers["X-Firebase-AppCheck"]=this.appCheckToken);let o=process.env,a=this.connURL.indexOf("wss://")===0?o.HTTPS_PROXY||o.https_proxy:o.HTTP_PROXY||o.http_proxy;a&&(i.proxy={origin:a})}this.mySock=new Gg(this.connURL,[],i)}catch(i){this.log_("Error instantiating WebSocket.");let s=i.message||i.data;s&&this.log_(s),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=i=>{this.handleIncomingFrame(i)},this.mySock.onerror=i=>{this.log_("WebSocket error.  Closing connection.");let s=i.message||i.data;s&&this.log_(s),this.onClosed_()}}start(){}static forceDisallow(){t.forceDisallow_=!0}static isAvailable(){let n=!1;if(typeof navigator<"u"&&navigator.userAgent){let r=/Android ([0-9]{0,}\.[0-9]{0,})/,i=navigator.userAgent.match(r);i&&i.length>1&&parseFloat(i[1])<4.4&&(n=!0)}return!n&&Gg!==null&&!t.forceDisallow_}static previouslyFailed(){return uo.isInMemoryStorage||uo.get("previous_websocket_failure")===!0}markConnectionHealthy(){uo.remove("previous_websocket_failure")}appendFrame_(n){if(this.frames.push(n),this.frames.length===this.totalFrames){let r=this.frames.join("");this.frames=null;let i=Nd(r);this.onMessage(i)}}handleNewFrameCount_(n){this.totalFrames=n,this.frames=[]}extractFrameCount_(n){if(S(this.frames===null,"We already have a frame buffer"),n.length<=6){let r=Number(n);if(!isNaN(r))return this.handleNewFrameCount_(r),null}return this.handleNewFrameCount_(1),n}handleIncomingFrame(n){if(this.mySock===null)return;let r=n.data;if(this.bytesReceived+=r.length,this.stats_.incrementCounter("bytes_received",r.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(r);else{let i=this.extractFrameCount_(r);i!==null&&this.appendFrame_(i)}}send(n){this.resetKeepAlive();let r=Qe(n);this.bytesSent+=r.length,this.stats_.incrementCounter("bytes_sent",r.length);let i=I1(r,m9);i.length>1&&this.sendString_(String(i.length));for(let s=0;s<i.length;s++)this.sendString_(i[s])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(y9))}sendString_(n){try{this.mySock.send(n)}catch(r){this.log_("Exception thrown from WebSocket.send():",r.message||r.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}t.responsesRequiredToBeHealthy=2,t.healthyTimeout=3e4;return t})(),j1=(()=>{class t{constructor(n){this.initTransports_(n)}static get ALL_TRANSPORTS(){return[id,du]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(n){let r=du&&du.isAvailable(),i=r&&!du.previouslyFailed();if(n.webSocketOnly&&(r||kt("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),i=!0),i)this.transports_=[du];else{let s=this.transports_=[];for(let o of t.ALL_TRANSPORTS)o&&o.isAvailable()&&s.push(o);t.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}t.globalTransportInitialized_=!1;return t})(),_9=6e4,v9=5e3,w9=10*1024,E9=100*1024,u0="t",GO="d",I9="s",zO="r",C9="e",WO="o",KO="a",QO="n",YO="p",D9="h",C0=class{constructor(e,n,r,i,s,o,a,u,c,l){this.id=e,this.repoInfo_=n,this.applicationId_=r,this.appCheckToken_=i,this.authToken_=s,this.onMessage_=o,this.onReady_=a,this.onDisconnect_=u,this.onKill_=c,this.lastSessionId=l,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=vd("c:"+this.id+":"),this.transportManager_=new j1(n),this.log_("Connection created"),this.start_()}start_(){let e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;let n=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(n,r)},Math.floor(0));let i=e.healthyTimeout||0;i>0&&(this.healthyTimeout_=Jl(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>E9?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>w9?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(i)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return n=>{e===this.conn_?this.onConnectionLost_(n):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return n=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(n):e===this.secondaryConn_?this.onSecondaryMessageReceived_(n):this.log_("message on old connection"))}}sendRequest(e){let n={t:"d",d:e};this.sendData_(n)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(u0 in e){let n=e[u0];n===KO?this.upgradeIfSecondaryHealthy_():n===zO?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):n===WO&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){let n=Ql("t",e),r=Ql("d",e);if(n==="c")this.onSecondaryControl_(r);else if(n==="d")this.pendingDataMessages.push(r);else throw new Error("Unknown protocol layer: "+n)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:YO,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:KO,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:QO,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){let n=Ql("t",e),r=Ql("d",e);n==="c"?this.onControl_(r):n==="d"&&this.onDataMessage_(r)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){let n=Ql(u0,e);if(GO in e){let r=e[GO];if(n===D9){let i=Object.assign({},r);this.repoInfo_.isUsingEmulator&&(i.h=this.repoInfo_.host),this.onHandshake_(i)}else if(n===QO){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let i=0;i<this.pendingDataMessages.length;++i)this.onDataMessage_(this.pendingDataMessages[i]);this.pendingDataMessages=[],this.tryCleanupConnection()}else n===I9?this.onConnectionShutdown_(r):n===zO?this.onReset_(r):n===C9?m0("Server Error: "+r):n===WO?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):m0("Unknown control packet command: "+n)}}onHandshake_(e){let n=e.ts,r=e.v,i=e.h;this.sessionId=e.s,this.repoInfo_.host=i,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,n),Hg!==r&&kt("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){let e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;let n=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,r),Jl(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(_9))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,n){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(n,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):Jl(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(v9))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:YO,d:{}}}))}onSecondaryConnectionLost_(){let e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(uo.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}};var zg=class{put(e,n,r,i){}merge(e,n,r,i){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,n,r){}onDisconnectMerge(e,n,r){}onDisconnectCancel(e,n){}reportStats(e){}};var Wg=class{constructor(e){this.allowedEvents_=e,this.listeners_={},S(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...n){if(Array.isArray(this.listeners_[e])){let r=[...this.listeners_[e]];for(let i=0;i<r.length;i++)r[i].callback.apply(r[i].context,n)}}on(e,n,r){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:n,context:r});let i=this.getInitialEvent(e);i&&n.apply(r,i)}off(e,n,r){this.validateEventType_(e);let i=this.listeners_[e]||[];for(let s=0;s<i.length;s++)if(i[s].callback===n&&(!r||r===i[s].context)){i.splice(s,1);return}}validateEventType_(e){S(this.allowedEvents_.find(n=>n===e),"Unknown event: "+e)}};var Kg=class t extends Wg{constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!Fm()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new t}getInitialEvent(e){return S(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}};var ZO=32,XO=768,Ee=class{constructor(e,n){if(n===void 0){this.pieces_=e.split("/");let r=0;for(let i=0;i<this.pieces_.length;i++)this.pieces_[i].length>0&&(this.pieces_[r]=this.pieces_[i],r++);this.pieces_.length=r,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=n}toString(){let e="";for(let n=this.pieceNum_;n<this.pieces_.length;n++)this.pieces_[n]!==""&&(e+="/"+this.pieces_[n]);return e||"/"}};function we(){return new Ee("")}function re(t){return t.pieceNum_>=t.pieces_.length?null:t.pieces_[t.pieceNum_]}function zi(t){return t.pieces_.length-t.pieceNum_}function Ae(t){let e=t.pieceNum_;return e<t.pieces_.length&&e++,new Ee(t.pieces_,e)}function ED(t){return t.pieceNum_<t.pieces_.length?t.pieces_[t.pieces_.length-1]:null}function T9(t){let e="";for(let n=t.pieceNum_;n<t.pieces_.length;n++)t.pieces_[n]!==""&&(e+="/"+encodeURIComponent(String(t.pieces_[n])));return e||"/"}function sd(t,e=0){return t.pieces_.slice(t.pieceNum_+e)}function U1(t){if(t.pieceNum_>=t.pieces_.length)return null;let e=[];for(let n=t.pieceNum_;n<t.pieces_.length-1;n++)e.push(t.pieces_[n]);return new Ee(e,0)}function Fe(t,e){let n=[];for(let r=t.pieceNum_;r<t.pieces_.length;r++)n.push(t.pieces_[r]);if(e instanceof Ee)for(let r=e.pieceNum_;r<e.pieces_.length;r++)n.push(e.pieces_[r]);else{let r=e.split("/");for(let i=0;i<r.length;i++)r[i].length>0&&n.push(r[i])}return new Ee(n,0)}function ie(t){return t.pieceNum_>=t.pieces_.length}function Ht(t,e){let n=re(t),r=re(e);if(n===null)return e;if(n===r)return Ht(Ae(t),Ae(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+t+")")}function b9(t,e){let n=sd(t,0),r=sd(e,0);for(let i=0;i<n.length&&i<r.length;i++){let s=ho(n[i],r[i]);if(s!==0)return s}return n.length===r.length?0:n.length<r.length?-1:1}function ID(t,e){if(zi(t)!==zi(e))return!1;for(let n=t.pieceNum_,r=e.pieceNum_;n<=t.pieces_.length;n++,r++)if(t.pieces_[n]!==e.pieces_[r])return!1;return!0}function Sn(t,e){let n=t.pieceNum_,r=e.pieceNum_;if(zi(t)>zi(e))return!1;for(;n<t.pieces_.length;){if(t.pieces_[n]!==e.pieces_[r])return!1;++n,++r}return!0}var D0=class{constructor(e,n){this.errorPrefix_=n,this.parts_=sd(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let r=0;r<this.parts_.length;r++)this.byteLength_+=xu(this.parts_[r]);B1(this)}};function S9(t,e){t.parts_.length>0&&(t.byteLength_+=1),t.parts_.push(e),t.byteLength_+=xu(e),B1(t)}function A9(t){let e=t.parts_.pop();t.byteLength_-=xu(e),t.parts_.length>0&&(t.byteLength_-=1)}function B1(t){if(t.byteLength_>XO)throw new Error(t.errorPrefix_+"has a key path longer than "+XO+" bytes ("+t.byteLength_+").");if(t.parts_.length>ZO)throw new Error(t.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+ZO+") or object contains a cycle "+ao(t))}function ao(t){return t.parts_.length===0?"":"in property '"+t.parts_.join(".")+"'"}var T0=class t extends Wg{constructor(){super(["visible"]);let e,n;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(n="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(n="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(n="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(n="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,n&&document.addEventListener(n,()=>{let r=!document[e];r!==this.visible_&&(this.visible_=r,this.trigger("visible",r))},!1)}static getInstance(){return new t}getInitialEvent(e){return S(e==="visible","Unknown event type: "+e),[this.visible_]}};var Yl=1e3,x9=60*5*1e3,JO=30*1e3,M9=1.3,R9=3e4,N9="server_kill",e1=3,CD=(()=>{class t extends zg{constructor(n,r,i,s,o,a,u,c){if(super(),this.repoInfo_=n,this.applicationId_=r,this.onDataUpdate_=i,this.onConnectStatus_=s,this.onServerInfoUpdate_=o,this.authTokenProvider_=a,this.appCheckTokenProvider_=u,this.authOverride_=c,this.id=t.nextPersistentConnectionId_++,this.log_=vd("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=Yl,this.maxReconnectDelay_=x9,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,c&&!Kn())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");T0.getInstance().on("visible",this.onVisible_,this),n.host.indexOf("fblocal")===-1&&Kg.getInstance().on("online",this.onOnline_,this)}sendRequest(n,r,i){let s=++this.requestNumber_,o={r:s,a:n,b:r};this.log_(Qe(o)),S(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(o),i&&(this.requestCBHash_[s]=i)}get(n){this.initConnection_();let r=new lt,s={action:"g",request:{p:n._path.toString(),q:n._queryObject},onComplete:a=>{let u=a.d;a.s==="ok"?r.resolve(u):r.reject(u)}};this.outstandingGets_.push(s),this.outstandingGetCount_++;let o=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(o),r.promise}listen(n,r,i,s){this.initConnection_();let o=n._queryIdentifier,a=n._path.toString();this.log_("Listen called for "+a+" "+o),this.listens.has(a)||this.listens.set(a,new Map),S(n._queryParams.isDefault()||!n._queryParams.loadsAllData(),"listen() called for non-default but complete query"),S(!this.listens.get(a).has(o),"listen() called twice for same path/queryId.");let u={onComplete:s,hashFn:r,query:n,tag:i};this.listens.get(a).set(o,u),this.connected_&&this.sendListen_(u)}sendGet_(n){let r=this.outstandingGets_[n];this.sendRequest("g",r.request,i=>{delete this.outstandingGets_[n],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),r.onComplete&&r.onComplete(i)})}sendListen_(n){let r=n.query,i=r._path.toString(),s=r._queryIdentifier;this.log_("Listen on "+i+" for "+s);let o={p:i},a="q";n.tag&&(o.q=r._queryObject,o.t=n.tag),o.h=n.hashFn(),this.sendRequest(a,o,u=>{let c=u.d,l=u.s;t.warnOnListenWarnings_(c,r),(this.listens.get(i)&&this.listens.get(i).get(s))===n&&(this.log_("listen response",u),l!=="ok"&&this.removeListen_(i,s),n.onComplete&&n.onComplete(l,c))})}static warnOnListenWarnings_(n,r){if(n&&typeof n=="object"&&hn(n,"w")){let i=Zr(n,"w");if(Array.isArray(i)&&~i.indexOf("no_index")){let s='".indexOn": "'+r._queryParams.getIndex().toString()+'"',o=r._path.toString();kt(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${s} at ${o} to your security rules for better performance.`)}}}refreshAuthToken(n){this.authToken_=n,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(n)}reduceReconnectDelayIfAdminCredential_(n){(n&&n.length===40||lT(n))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=JO)}refreshAppCheckToken(n){this.appCheckToken_=n,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){let n=this.authToken_,r=cT(n)?"auth":"gauth",i={cred:n};this.authOverride_===null?i.noauth=!0:typeof this.authOverride_=="object"&&(i.authvar=this.authOverride_),this.sendRequest(r,i,s=>{let o=s.s,a=s.d||"error";this.authToken_===n&&(o==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(o,a))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},n=>{let r=n.s,i=n.d||"error";r==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(r,i)})}unlisten(n,r){let i=n._path.toString(),s=n._queryIdentifier;this.log_("Unlisten called for "+i+" "+s),S(n._queryParams.isDefault()||!n._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(i,s)&&this.connected_&&this.sendUnlisten_(i,s,n._queryObject,r)}sendUnlisten_(n,r,i,s){this.log_("Unlisten on "+n+" for "+r);let o={p:n},a="n";s&&(o.q=i,o.t=s),this.sendRequest(a,o)}onDisconnectPut(n,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",n,r,i):this.onDisconnectRequestQueue_.push({pathString:n,action:"o",data:r,onComplete:i})}onDisconnectMerge(n,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",n,r,i):this.onDisconnectRequestQueue_.push({pathString:n,action:"om",data:r,onComplete:i})}onDisconnectCancel(n,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",n,null,r):this.onDisconnectRequestQueue_.push({pathString:n,action:"oc",data:null,onComplete:r})}sendOnDisconnect_(n,r,i,s){let o={p:r,d:i};this.log_("onDisconnect "+n,o),this.sendRequest(n,o,a=>{s&&setTimeout(()=>{s(a.s,a.d)},Math.floor(0))})}put(n,r,i,s){this.putInternal("p",n,r,i,s)}merge(n,r,i,s){this.putInternal("m",n,r,i,s)}putInternal(n,r,i,s,o){this.initConnection_();let a={p:r,d:i};o!==void 0&&(a.h=o),this.outstandingPuts_.push({action:n,request:a,onComplete:s}),this.outstandingPutCount_++;let u=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(u):this.log_("Buffering put: "+r)}sendPut_(n){let r=this.outstandingPuts_[n].action,i=this.outstandingPuts_[n].request,s=this.outstandingPuts_[n].onComplete;this.outstandingPuts_[n].queued=this.connected_,this.sendRequest(r,i,o=>{this.log_(r+" response",o),delete this.outstandingPuts_[n],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),s&&s(o.s,o.d)})}reportStats(n){if(this.connected_){let r={c:n};this.log_("reportStats",r),this.sendRequest("s",r,i=>{if(i.s!=="ok"){let o=i.d;this.log_("reportStats","Error sending stats: "+o)}})}}onDataMessage_(n){if("r"in n){this.log_("from server: "+Qe(n));let r=n.r,i=this.requestCBHash_[r];i&&(delete this.requestCBHash_[r],i(n.b))}else{if("error"in n)throw"A server-side error has occurred: "+n.error;"a"in n&&this.onDataPush_(n.a,n.b)}}onDataPush_(n,r){this.log_("handleServerMessage",n,r),n==="d"?this.onDataUpdate_(r.p,r.d,!1,r.t):n==="m"?this.onDataUpdate_(r.p,r.d,!0,r.t):n==="c"?this.onListenRevoked_(r.p,r.q):n==="ac"?this.onAuthRevoked_(r.s,r.d):n==="apc"?this.onAppCheckRevoked_(r.s,r.d):n==="sd"?this.onSecurityDebugPacket_(r):m0("Unrecognized action received from server: "+Qe(n)+`
Are you using the latest client?`)}onReady_(n,r){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(n),this.lastSessionId=r,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(n){S(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(n))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(n){n&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=Yl,this.realtime_||this.scheduleConnect_(0)),this.visible_=n}onOnline_(n){n?(this.log_("Browser went online."),this.reconnectDelay_=Yl,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>R9&&(this.reconnectDelay_=Yl),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());let n=new Date().getTime()-this.lastConnectionAttemptTime_,r=Math.max(0,this.reconnectDelay_-n);r=Math.random()*r,this.log_("Trying to reconnect in "+r+"ms"),this.scheduleConnect_(r),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*M9)}this.onConnectStatus_(!1)}establishConnection_(){return v(this,null,function*(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;let n=this.onDataMessage_.bind(this),r=this.onReady_.bind(this),i=this.onRealtimeDisconnect_.bind(this),s=this.id+":"+t.nextConnectionId_++,o=this.lastSessionId,a=!1,u=null,c=function(){u?u.close():(a=!0,i())},l=function(h){S(u,"sendRequest call when we're not connected not allowed."),u.sendRequest(h)};this.realtime_={close:c,sendRequest:l};let d=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{let[h,f]=yield Promise.all([this.authTokenProvider_.getToken(d),this.appCheckTokenProvider_.getToken(d)]);a?mt("getToken() completed but was canceled"):(mt("getToken() completed. Creating connection."),this.authToken_=h&&h.accessToken,this.appCheckToken_=f&&f.token,u=new C0(s,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,n,r,i,p=>{kt(p+" ("+this.repoInfo_.toString()+")"),this.interrupt(N9)},o))}catch(h){this.log_("Failed to get token: "+h),a||(this.repoInfo_.nodeAdmin&&kt(h),c())}}})}interrupt(n){mt("Interrupting connection for reason: "+n),this.interruptReasons_[n]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(n){mt("Resuming connection for reason: "+n),delete this.interruptReasons_[n],Pd(this.interruptReasons_)&&(this.reconnectDelay_=Yl,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(n){let r=n-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:r})}cancelSentTransactions_(){for(let n=0;n<this.outstandingPuts_.length;n++){let r=this.outstandingPuts_[n];r&&"h"in r.request&&r.queued&&(r.onComplete&&r.onComplete("disconnect"),delete this.outstandingPuts_[n],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(n,r){let i;r?i=r.map(o=>vD(o)).join("$"):i="default";let s=this.removeListen_(n,i);s&&s.onComplete&&s.onComplete("permission_denied")}removeListen_(n,r){let i=new Ee(n).toString(),s;if(this.listens.has(i)){let o=this.listens.get(i);s=o.get(r),o.delete(r),o.size===0&&this.listens.delete(i)}else s=void 0;return s}onAuthRevoked_(n,r){mt("Auth token revoked: "+n+"/"+r),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(n==="invalid_token"||n==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=e1&&(this.reconnectDelay_=JO,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(n,r){mt("App check token revoked: "+n+"/"+r),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(n==="invalid_token"||n==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=e1&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(n){this.securityDebugCallback_?this.securityDebugCallback_(n):"msg"in n&&console.log("FIREBASE: "+n.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(let n of this.listens.values())for(let r of n.values())this.sendListen_(r);for(let n=0;n<this.outstandingPuts_.length;n++)this.outstandingPuts_[n]&&this.sendPut_(n);for(;this.onDisconnectRequestQueue_.length;){let n=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(n.action,n.pathString,n.data,n.onComplete)}for(let n=0;n<this.outstandingGets_.length;n++)this.outstandingGets_[n]&&this.sendGet_(n)}sendConnectStats_(){let n={},r="js";Kn()&&(this.repoInfo_.nodeAdmin?r="admin_node":r="node"),n["sdk."+r+"."+yD.replace(/\./g,"-")]=1,Fm()?n["framework.cordova"]=1:oT()&&(n["framework.reactnative"]=1),this.reportStats(n)}shouldReconnect_(){let n=Kg.getInstance().currentlyOnline();return Pd(this.interruptReasons_)&&n}}t.nextPersistentConnectionId_=0,t.nextConnectionId_=0;return t})(),ae=class t{constructor(e,n){this.name=e,this.node=n}static Wrap(e,n){return new t(e,n)}};var pu=class{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,n){let r=new ae(Gi,e),i=new ae(Gi,n);return this.compare(r,i)!==0}minPost(){return ae.MIN}};var $g,Qg=class extends pu{static get __EMPTY_NODE(){return $g}static set __EMPTY_NODE(e){$g=e}compare(e,n){return ho(e.name,n.name)}isDefinedOn(e){throw yo("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,n){return!1}minPost(){return ae.MIN}maxPost(){return new ae(Qr,$g)}makePost(e,n){return S(typeof e=="string","KeyIndex indexValue must always be a string."),new ae(e,$g)}toString(){return".key"}},Ir=new Qg;var hu=class{constructor(e,n,r,i,s=null){this.isReverse_=i,this.resultGenerator_=s,this.nodeStack_=[];let o=1;for(;!e.isEmpty();)if(e=e,o=n?r(e.key,n):1,i&&(o*=-1),o<0)this.isReverse_?e=e.left:e=e.right;else if(o===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),n;if(this.resultGenerator_?n=this.resultGenerator_(e.key,e.value):n={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return n}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}},zn=(()=>{class t{constructor(n,r,i,s,o){this.key=n,this.value=r,this.color=i??t.RED,this.left=s??An.EMPTY_NODE,this.right=o??An.EMPTY_NODE}copy(n,r,i,s,o){return new t(n??this.key,r??this.value,i??this.color,s??this.left,o??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(n){return this.left.inorderTraversal(n)||!!n(this.key,this.value)||this.right.inorderTraversal(n)}reverseTraversal(n){return this.right.reverseTraversal(n)||n(this.key,this.value)||this.left.reverseTraversal(n)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(n,r,i){let s=this,o=i(n,s.key);return o<0?s=s.copy(null,null,null,s.left.insert(n,r,i),null):o===0?s=s.copy(null,r,null,null,null):s=s.copy(null,null,null,null,s.right.insert(n,r,i)),s.fixUp_()}removeMin_(){if(this.left.isEmpty())return An.EMPTY_NODE;let n=this;return!n.left.isRed_()&&!n.left.left.isRed_()&&(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.removeMin_(),null),n.fixUp_()}remove(n,r){let i,s;if(i=this,r(n,i.key)<0)!i.left.isEmpty()&&!i.left.isRed_()&&!i.left.left.isRed_()&&(i=i.moveRedLeft_()),i=i.copy(null,null,null,i.left.remove(n,r),null);else{if(i.left.isRed_()&&(i=i.rotateRight_()),!i.right.isEmpty()&&!i.right.isRed_()&&!i.right.left.isRed_()&&(i=i.moveRedRight_()),r(n,i.key)===0){if(i.right.isEmpty())return An.EMPTY_NODE;s=i.right.min_(),i=i.copy(s.key,s.value,null,null,i.right.removeMin_())}i=i.copy(null,null,null,null,i.right.remove(n,r))}return i.fixUp_()}isRed_(){return this.color}fixUp_(){let n=this;return n.right.isRed_()&&!n.left.isRed_()&&(n=n.rotateLeft_()),n.left.isRed_()&&n.left.left.isRed_()&&(n=n.rotateRight_()),n.left.isRed_()&&n.right.isRed_()&&(n=n.colorFlip_()),n}moveRedLeft_(){let n=this.colorFlip_();return n.right.left.isRed_()&&(n=n.copy(null,null,null,null,n.right.rotateRight_()),n=n.rotateLeft_(),n=n.colorFlip_()),n}moveRedRight_(){let n=this.colorFlip_();return n.left.left.isRed_()&&(n=n.rotateRight_(),n=n.colorFlip_()),n}rotateLeft_(){let n=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,n,null)}rotateRight_(){let n=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,n)}colorFlip_(){let n=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,n,r)}checkMaxDepth_(){let n=this.check_();return Math.pow(2,n)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");let n=this.left.check_();if(n!==this.right.check_())throw new Error("Black depths differ");return n+(this.isRed_()?0:1)}}return t.RED=!0,t.BLACK=!1,t})(),b0=class{copy(e,n,r,i,s){return this}insert(e,n,r){return new zn(e,n,null)}remove(e,n){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}},An=class t{constructor(e,n=t.EMPTY_NODE){this.comparator_=e,this.root_=n}insert(e,n){return new t(this.comparator_,this.root_.insert(e,n,this.comparator_).copy(null,null,zn.BLACK,null,null))}remove(e){return new t(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,zn.BLACK,null,null))}get(e){let n,r=this.root_;for(;!r.isEmpty();){if(n=this.comparator_(e,r.key),n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}getPredecessorKey(e){let n,r=this.root_,i=null;for(;!r.isEmpty();)if(n=this.comparator_(e,r.key),n===0){if(r.left.isEmpty())return i?i.key:null;for(r=r.left;!r.right.isEmpty();)r=r.right;return r.key}else n<0?r=r.left:n>0&&(i=r,r=r.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new hu(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,n){return new hu(this.root_,e,this.comparator_,!1,n)}getReverseIteratorFrom(e,n){return new hu(this.root_,e,this.comparator_,!0,n)}getReverseIterator(e){return new hu(this.root_,null,this.comparator_,!0,e)}};An.EMPTY_NODE=new b0;function P9(t,e){return ho(t.name,e.name)}function DD(t,e){return ho(t,e)}var S0;function k9(t){S0=t}var $1=function(t){return typeof t=="number"?"number:"+C1(t):"string:"+t},H1=function(t){if(t.isLeafNode()){let e=t.val();S(typeof e=="string"||typeof e=="number"||typeof e=="object"&&hn(e,".sv"),"Priority must be a string or number.")}else S(t===S0||t.isEmpty(),"priority of unexpected type.");S(t===S0||t.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};var t1,gu=(()=>{class t{constructor(n,r=t.__childrenNodeConstructor.EMPTY_NODE){this.value_=n,this.priorityNode_=r,this.lazyHash_=null,S(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),H1(this.priorityNode_)}static set __childrenNodeConstructor(n){t1=n}static get __childrenNodeConstructor(){return t1}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(n){return new t(this.value_,n)}getImmediateChild(n){return n===".priority"?this.priorityNode_:t.__childrenNodeConstructor.EMPTY_NODE}getChild(n){return ie(n)?this:re(n)===".priority"?this.priorityNode_:t.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(n,r){return null}updateImmediateChild(n,r){return n===".priority"?this.updatePriority(r):r.isEmpty()&&n!==".priority"?this:t.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(n,r).updatePriority(this.priorityNode_)}updateChild(n,r){let i=re(n);return i===null?r:r.isEmpty()&&i!==".priority"?this:(S(i!==".priority"||zi(n)===1,".priority must be the last token in a path"),this.updateImmediateChild(i,t.__childrenNodeConstructor.EMPTY_NODE.updateChild(Ae(n),r)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(n,r){return!1}val(n){return n&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let n="";this.priorityNode_.isEmpty()||(n+="priority:"+$1(this.priorityNode_.val())+":");let r=typeof this.value_;n+=r+":",r==="number"?n+=C1(this.value_):n+=this.value_,this.lazyHash_=w1(n)}return this.lazyHash_}getValue(){return this.value_}compareTo(n){return n===t.__childrenNodeConstructor.EMPTY_NODE?1:n instanceof t.__childrenNodeConstructor?-1:(S(n.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(n))}compareToLeafNode_(n){let r=typeof n.value_,i=typeof this.value_,s=t.VALUE_TYPE_ORDER.indexOf(r),o=t.VALUE_TYPE_ORDER.indexOf(i);return S(s>=0,"Unknown leaf type: "+r),S(o>=0,"Unknown leaf type: "+i),s===o?i==="object"?0:this.value_<n.value_?-1:this.value_===n.value_?0:1:o-s}withIndex(){return this}isIndexed(){return!0}equals(n){if(n===this)return!0;if(n.isLeafNode()){let r=n;return this.value_===r.value_&&this.priorityNode_.equals(r.priorityNode_)}else return!1}}t.VALUE_TYPE_ORDER=["object","boolean","number","string"];return t})(),q1,G1;function O9(t){q1=t}function F9(t){G1=t}var A0=class extends pu{compare(e,n){let r=e.node.getPriority(),i=n.node.getPriority(),s=r.compareTo(i);return s===0?ho(e.name,n.name):s}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,n){return!e.getPriority().equals(n.getPriority())}minPost(){return ae.MIN}maxPost(){return new ae(Qr,new gu("[PRIORITY-POST]",G1))}makePost(e,n){let r=q1(e);return new ae(n,new gu("[PRIORITY-POST]",r))}toString(){return".priority"}},Me=new A0;var V9=Math.log(2),x0=class{constructor(e){let n=s=>parseInt(Math.log(s)/V9,10),r=s=>parseInt(Array(s+1).join("1"),2);this.count=n(e+1),this.current_=this.count-1;let i=r(this.count);this.bits_=e+1&i}nextBitIsOne(){let e=!(this.bits_&1<<this.current_);return this.current_--,e}},Yg=function(t,e,n,r){t.sort(e);let i=function(u,c){let l=c-u,d,h;if(l===0)return null;if(l===1)return d=t[u],h=n?n(d):d,new zn(h,d.node,zn.BLACK,null,null);{let f=parseInt(l/2,10)+u,p=i(u,f),g=i(f+1,c);return d=t[f],h=n?n(d):d,new zn(h,d.node,zn.BLACK,p,g)}},s=function(u){let c=null,l=null,d=t.length,h=function(p,g){let _=d-p,b=d;d-=p;let P=i(_+1,b),A=t[_],H=n?n(A):A;f(new zn(H,A.node,g,null,P))},f=function(p){c?(c.left=p,c=p):(l=p,c=p)};for(let p=0;p<u.count;++p){let g=u.nextBitIsOne(),_=Math.pow(2,u.count-(p+1));g?h(_,zn.BLACK):(h(_,zn.BLACK),h(_,zn.RED))}return l},o=new x0(t.length),a=s(o);return new An(r||e,a)};var c0,lu={},mu=class t{constructor(e,n){this.indexes_=e,this.indexSet_=n}static get Default(){return S(lu&&Me,"ChildrenNode.ts has not been loaded"),c0=c0||new t({".priority":lu},{".priority":Me}),c0}get(e){let n=Zr(this.indexes_,e);if(!n)throw new Error("No index defined for "+e);return n instanceof An?n:null}hasIndex(e){return hn(this.indexSet_,e.toString())}addIndex(e,n){S(e!==Ir,"KeyIndex always exists and isn't meant to be added to the IndexMap.");let r=[],i=!1,s=n.getIterator(ae.Wrap),o=s.getNext();for(;o;)i=i||e.isDefinedOn(o.node),r.push(o),o=s.getNext();let a;i?a=Yg(r,e.getCompare()):a=lu;let u=e.toString(),c=Object.assign({},this.indexSet_);c[u]=e;let l=Object.assign({},this.indexes_);return l[u]=a,new t(l,c)}addToIndexes(e,n){let r=Au(this.indexes_,(i,s)=>{let o=Zr(this.indexSet_,s);if(S(o,"Missing index implementation for "+s),i===lu)if(o.isDefinedOn(e.node)){let a=[],u=n.getIterator(ae.Wrap),c=u.getNext();for(;c;)c.name!==e.name&&a.push(c),c=u.getNext();return a.push(e),Yg(a,o.getCompare())}else return lu;else{let a=n.get(e.name),u=i;return a&&(u=u.remove(new ae(e.name,a))),u.insert(e,e.node)}});return new t(r,this.indexSet_)}removeFromIndexes(e,n){let r=Au(this.indexes_,i=>{if(i===lu)return i;{let s=n.get(e.name);return s?i.remove(new ae(e.name,s)):i}});return new t(r,this.indexSet_)}};var Zl,X=(()=>{class t{constructor(n,r,i){this.children_=n,this.priorityNode_=r,this.indexMap_=i,this.lazyHash_=null,this.priorityNode_&&H1(this.priorityNode_),this.children_.isEmpty()&&S(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return Zl||(Zl=new t(new An(DD),null,mu.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||Zl}updatePriority(n){return this.children_.isEmpty()?this:new t(this.children_,n,this.indexMap_)}getImmediateChild(n){if(n===".priority")return this.getPriority();{let r=this.children_.get(n);return r===null?Zl:r}}getChild(n){let r=re(n);return r===null?this:this.getImmediateChild(r).getChild(Ae(n))}hasChild(n){return this.children_.get(n)!==null}updateImmediateChild(n,r){if(S(r,"We should always be passing snapshot nodes"),n===".priority")return this.updatePriority(r);{let i=new ae(n,r),s,o;r.isEmpty()?(s=this.children_.remove(n),o=this.indexMap_.removeFromIndexes(i,this.children_)):(s=this.children_.insert(n,r),o=this.indexMap_.addToIndexes(i,this.children_));let a=s.isEmpty()?Zl:this.priorityNode_;return new t(s,a,o)}}updateChild(n,r){let i=re(n);if(i===null)return r;{S(re(n)!==".priority"||zi(n)===1,".priority must be the last token in a path");let s=this.getImmediateChild(i).updateChild(Ae(n),r);return this.updateImmediateChild(i,s)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(n){if(this.isEmpty())return null;let r={},i=0,s=0,o=!0;if(this.forEachChild(Me,(a,u)=>{r[a]=u.val(n),i++,o&&t.INTEGER_REGEXP_.test(a)?s=Math.max(s,Number(a)):o=!1}),!n&&o&&s<2*i){let a=[];for(let u in r)a[u]=r[u];return a}else return n&&!this.getPriority().isEmpty()&&(r[".priority"]=this.getPriority().val()),r}hash(){if(this.lazyHash_===null){let n="";this.getPriority().isEmpty()||(n+="priority:"+$1(this.getPriority().val())+":"),this.forEachChild(Me,(r,i)=>{let s=i.hash();s!==""&&(n+=":"+r+":"+s)}),this.lazyHash_=n===""?"":w1(n)}return this.lazyHash_}getPredecessorChildName(n,r,i){let s=this.resolveIndex_(i);if(s){let o=s.getPredecessorKey(new ae(n,r));return o?o.name:null}else return this.children_.getPredecessorKey(n)}getFirstChildName(n){let r=this.resolveIndex_(n);if(r){let i=r.minKey();return i&&i.name}else return this.children_.minKey()}getFirstChild(n){let r=this.getFirstChildName(n);return r?new ae(r,this.children_.get(r)):null}getLastChildName(n){let r=this.resolveIndex_(n);if(r){let i=r.maxKey();return i&&i.name}else return this.children_.maxKey()}getLastChild(n){let r=this.getLastChildName(n);return r?new ae(r,this.children_.get(r)):null}forEachChild(n,r){let i=this.resolveIndex_(n);return i?i.inorderTraversal(s=>r(s.name,s.node)):this.children_.inorderTraversal(r)}getIterator(n){return this.getIteratorFrom(n.minPost(),n)}getIteratorFrom(n,r){let i=this.resolveIndex_(r);if(i)return i.getIteratorFrom(n,s=>s);{let s=this.children_.getIteratorFrom(n.name,ae.Wrap),o=s.peek();for(;o!=null&&r.compare(o,n)<0;)s.getNext(),o=s.peek();return s}}getReverseIterator(n){return this.getReverseIteratorFrom(n.maxPost(),n)}getReverseIteratorFrom(n,r){let i=this.resolveIndex_(r);if(i)return i.getReverseIteratorFrom(n,s=>s);{let s=this.children_.getReverseIteratorFrom(n.name,ae.Wrap),o=s.peek();for(;o!=null&&r.compare(o,n)>0;)s.getNext(),o=s.peek();return s}}compareTo(n){return this.isEmpty()?n.isEmpty()?0:-1:n.isLeafNode()||n.isEmpty()?1:n===wd?-1:0}withIndex(n){if(n===Ir||this.indexMap_.hasIndex(n))return this;{let r=this.indexMap_.addIndex(n,this.children_);return new t(this.children_,this.priorityNode_,r)}}isIndexed(n){return n===Ir||this.indexMap_.hasIndex(n)}equals(n){if(n===this)return!0;if(n.isLeafNode())return!1;{let r=n;if(this.getPriority().equals(r.getPriority()))if(this.children_.count()===r.children_.count()){let i=this.getIterator(Me),s=r.getIterator(Me),o=i.getNext(),a=s.getNext();for(;o&&a;){if(o.name!==a.name||!o.node.equals(a.node))return!1;o=i.getNext(),a=s.getNext()}return o===null&&a===null}else return!1;else return!1}}resolveIndex_(n){return n===Ir?null:this.indexMap_.get(n.toString())}}return t.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,t})(),M0=class extends X{constructor(){super(new An(DD),X.EMPTY_NODE,mu.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return X.EMPTY_NODE}isEmpty(){return!1}},wd=new M0;Object.defineProperties(ae,{MIN:{value:new ae(Gi,X.EMPTY_NODE)},MAX:{value:new ae(Qr,wd)}});Qg.__EMPTY_NODE=X.EMPTY_NODE;gu.__childrenNodeConstructor=X;k9(wd);F9(wd);var L9=!0;function je(t,e=null){if(t===null)return X.EMPTY_NODE;if(typeof t=="object"&&".priority"in t&&(e=t[".priority"]),S(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof t=="object"&&".value"in t&&t[".value"]!==null&&(t=t[".value"]),typeof t!="object"||".sv"in t){let n=t;return new gu(n,je(e))}if(!(t instanceof Array)&&L9){let n=[],r=!1;if(yt(t,(o,a)=>{if(o.substring(0,1)!=="."){let u=je(a);u.isEmpty()||(r=r||!u.getPriority().isEmpty(),n.push(new ae(o,u)))}}),n.length===0)return X.EMPTY_NODE;let s=Yg(n,P9,o=>o.name,DD);if(r){let o=Yg(n,Me.getCompare());return new X(s,je(e),new mu({".priority":o},{".priority":Me}))}else return new X(s,je(e),mu.Default)}else{let n=X.EMPTY_NODE;return yt(t,(r,i)=>{if(hn(t,r)&&r.substring(0,1)!=="."){let s=je(i);(s.isLeafNode()||!s.isEmpty())&&(n=n.updateImmediateChild(r,s))}}),n.updatePriority(je(e))}}O9(je);var od=class extends pu{constructor(e){super(),this.indexPath_=e,S(!ie(e)&&re(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,n){let r=this.extractChild(e.node),i=this.extractChild(n.node),s=r.compareTo(i);return s===0?ho(e.name,n.name):s}makePost(e,n){let r=je(e),i=X.EMPTY_NODE.updateChild(this.indexPath_,r);return new ae(n,i)}maxPost(){let e=X.EMPTY_NODE.updateChild(this.indexPath_,wd);return new ae(Qr,e)}toString(){return sd(this.indexPath_,0).join("/")}};var R0=class extends pu{compare(e,n){let r=e.node.compareTo(n.node);return r===0?ho(e.name,n.name):r}isDefinedOn(e){return!0}indexedValueChanged(e,n){return!e.equals(n)}minPost(){return ae.MIN}maxPost(){return ae.MAX}makePost(e,n){let r=je(e);return new ae(n,r)}toString(){return".value"}},TD=new R0;function z1(t){return{type:"value",snapshotNode:t}}function yu(t,e){return{type:"child_added",snapshotNode:e,childName:t}}function ad(t,e){return{type:"child_removed",snapshotNode:e,childName:t}}function ud(t,e,n){return{type:"child_changed",snapshotNode:e,childName:t,oldSnap:n}}function j9(t,e){return{type:"child_moved",snapshotNode:e,childName:t}}var cd=class{constructor(e){this.index_=e}updateChild(e,n,r,i,s,o){S(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");let a=e.getImmediateChild(n);return a.getChild(i).equals(r.getChild(i))&&a.isEmpty()===r.isEmpty()||(o!=null&&(r.isEmpty()?e.hasChild(n)?o.trackChildChange(ad(n,a)):S(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):a.isEmpty()?o.trackChildChange(yu(n,r)):o.trackChildChange(ud(n,r,a))),e.isLeafNode()&&r.isEmpty())?e:e.updateImmediateChild(n,r).withIndex(this.index_)}updateFullNode(e,n,r){return r!=null&&(e.isLeafNode()||e.forEachChild(Me,(i,s)=>{n.hasChild(i)||r.trackChildChange(ad(i,s))}),n.isLeafNode()||n.forEachChild(Me,(i,s)=>{if(e.hasChild(i)){let o=e.getImmediateChild(i);o.equals(s)||r.trackChildChange(ud(i,s,o))}else r.trackChildChange(yu(i,s))})),n.withIndex(this.index_)}updatePriority(e,n){return e.isEmpty()?X.EMPTY_NODE:e.updatePriority(n)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}};var Zg=class t{constructor(e){this.indexedFilter_=new cd(e.getIndex()),this.index_=e.getIndex(),this.startPost_=t.getStartPost_(e),this.endPost_=t.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){let n=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,r=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return n&&r}updateChild(e,n,r,i,s,o){return this.matches(new ae(n,r))||(r=X.EMPTY_NODE),this.indexedFilter_.updateChild(e,n,r,i,s,o)}updateFullNode(e,n,r){n.isLeafNode()&&(n=X.EMPTY_NODE);let i=n.withIndex(this.index_);i=i.updatePriority(X.EMPTY_NODE);let s=this;return n.forEachChild(Me,(o,a)=>{s.matches(new ae(o,a))||(i=i.updateImmediateChild(o,X.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,i,r)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){let n=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),n)}else return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){let n=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),n)}else return e.getIndex().maxPost()}};var N0=class{constructor(e){this.withinDirectionalStart=n=>this.reverse_?this.withinEndPost(n):this.withinStartPost(n),this.withinDirectionalEnd=n=>this.reverse_?this.withinStartPost(n):this.withinEndPost(n),this.withinStartPost=n=>{let r=this.index_.compare(this.rangedFilter_.getStartPost(),n);return this.startIsInclusive_?r<=0:r<0},this.withinEndPost=n=>{let r=this.index_.compare(n,this.rangedFilter_.getEndPost());return this.endIsInclusive_?r<=0:r<0},this.rangedFilter_=new Zg(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,n,r,i,s,o){return this.rangedFilter_.matches(new ae(n,r))||(r=X.EMPTY_NODE),e.getImmediateChild(n).equals(r)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,n,r,i,s,o):this.fullLimitUpdateChild_(e,n,r,s,o)}updateFullNode(e,n,r){let i;if(n.isLeafNode()||n.isEmpty())i=X.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<n.numChildren()&&n.isIndexed(this.index_)){i=X.EMPTY_NODE.withIndex(this.index_);let s;this.reverse_?s=n.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):s=n.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let o=0;for(;s.hasNext()&&o<this.limit_;){let a=s.getNext();if(this.withinDirectionalStart(a))if(this.withinDirectionalEnd(a))i=i.updateImmediateChild(a.name,a.node),o++;else break;else continue}}else{i=n.withIndex(this.index_),i=i.updatePriority(X.EMPTY_NODE);let s;this.reverse_?s=i.getReverseIterator(this.index_):s=i.getIterator(this.index_);let o=0;for(;s.hasNext();){let a=s.getNext();o<this.limit_&&this.withinDirectionalStart(a)&&this.withinDirectionalEnd(a)?o++:i=i.updateImmediateChild(a.name,X.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,i,r)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,n,r,i,s){let o;if(this.reverse_){let d=this.index_.getCompare();o=(h,f)=>d(f,h)}else o=this.index_.getCompare();let a=e;S(a.numChildren()===this.limit_,"");let u=new ae(n,r),c=this.reverse_?a.getFirstChild(this.index_):a.getLastChild(this.index_),l=this.rangedFilter_.matches(u);if(a.hasChild(n)){let d=a.getImmediateChild(n),h=i.getChildAfterChild(this.index_,c,this.reverse_);for(;h!=null&&(h.name===n||a.hasChild(h.name));)h=i.getChildAfterChild(this.index_,h,this.reverse_);let f=h==null?1:o(h,u);if(l&&!r.isEmpty()&&f>=0)return s?.trackChildChange(ud(n,r,d)),a.updateImmediateChild(n,r);{s?.trackChildChange(ad(n,d));let g=a.updateImmediateChild(n,X.EMPTY_NODE);return h!=null&&this.rangedFilter_.matches(h)?(s?.trackChildChange(yu(h.name,h.node)),g.updateImmediateChild(h.name,h.node)):g}}else return r.isEmpty()?e:l&&o(c,u)>=0?(s!=null&&(s.trackChildChange(ad(c.name,c.node)),s.trackChildChange(yu(n,r))),a.updateImmediateChild(n,r).updateImmediateChild(c.name,X.EMPTY_NODE)):e}};var ld=class t{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=Me}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return S(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return S(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:Gi}hasEnd(){return this.endSet_}getIndexEndValue(){return S(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return S(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:Qr}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return S(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===Me}copy(){let e=new t;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}};function U9(t){return t.loadsAllData()?new cd(t.getIndex()):t.hasLimit()?new N0(t):new Zg(t)}function B9(t,e){let n=t.copy();return n.limitSet_=!0,n.limit_=e,n.viewFrom_="l",n}function $9(t,e){let n=t.copy();return n.limitSet_=!0,n.limit_=e,n.viewFrom_="r",n}function P0(t,e,n){let r=t.copy();return r.startSet_=!0,e===void 0&&(e=null),r.indexStartValue_=e,n!=null?(r.startNameSet_=!0,r.indexStartName_=n):(r.startNameSet_=!1,r.indexStartName_=""),r}function H9(t,e,n){let r;return t.index_===Ir||n?r=P0(t,e,n):r=P0(t,e,Qr),r.startAfterSet_=!0,r}function k0(t,e,n){let r=t.copy();return r.endSet_=!0,e===void 0&&(e=null),r.indexEndValue_=e,n!==void 0?(r.endNameSet_=!0,r.indexEndName_=n):(r.endNameSet_=!1,r.indexEndName_=""),r}function q9(t,e,n){let r;return t.index_===Ir||n?r=k0(t,e,n):r=k0(t,e,Gi),r.endBeforeSet_=!0,r}function mm(t,e){let n=t.copy();return n.index_=e,n}function n1(t){let e={};if(t.isDefault())return e;let n;if(t.index_===Me?n="$priority":t.index_===TD?n="$value":t.index_===Ir?n="$key":(S(t.index_ instanceof od,"Unrecognized index type!"),n=t.index_.toString()),e.orderBy=Qe(n),t.startSet_){let r=t.startAfterSet_?"startAfter":"startAt";e[r]=Qe(t.indexStartValue_),t.startNameSet_&&(e[r]+=","+Qe(t.indexStartName_))}if(t.endSet_){let r=t.endBeforeSet_?"endBefore":"endAt";e[r]=Qe(t.indexEndValue_),t.endNameSet_&&(e[r]+=","+Qe(t.indexEndName_))}return t.limitSet_&&(t.isViewFromLeft()?e.limitToFirst=t.limit_:e.limitToLast=t.limit_),e}function r1(t){let e={};if(t.startSet_&&(e.sp=t.indexStartValue_,t.startNameSet_&&(e.sn=t.indexStartName_),e.sin=!t.startAfterSet_),t.endSet_&&(e.ep=t.indexEndValue_,t.endNameSet_&&(e.en=t.indexEndName_),e.ein=!t.endBeforeSet_),t.limitSet_){e.l=t.limit_;let n=t.viewFrom_;n===""&&(t.isViewFromLeft()?n="l":n="r"),e.vf=n}return t.index_!==Me&&(e.i=t.index_.toString()),e}var O0=class t extends zg{constructor(e,n,r,i){super(),this.repoInfo_=e,this.onDataUpdate_=n,this.authTokenProvider_=r,this.appCheckTokenProvider_=i,this.log_=vd("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,n){return n!==void 0?"tag$"+n:(S(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,n,r,i){let s=e._path.toString();this.log_("Listen called for "+s+" "+e._queryIdentifier);let o=t.getListenId_(e,r),a={};this.listens_[o]=a;let u=n1(e._queryParams);this.restRequest_(s+".json",u,(c,l)=>{let d=l;if(c===404&&(d=null,c=null),c===null&&this.onDataUpdate_(s,d,!1,r),Zr(this.listens_,o)===a){let h;c?c===401?h="permission_denied":h="rest_error:"+c:h="ok",i(h,null)}})}unlisten(e,n){let r=t.getListenId_(e,n);delete this.listens_[r]}get(e){let n=n1(e._queryParams),r=e._path.toString(),i=new lt;return this.restRequest_(r+".json",n,(s,o)=>{let a=o;s===404&&(a=null,s=null),s===null?(this.onDataUpdate_(r,a,!1,null),i.resolve(a)):i.reject(new Error(a))}),i.promise}refreshAuthToken(e){}restRequest_(e,n={},r){return n.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([i,s])=>{i&&i.accessToken&&(n.auth=i.accessToken),s&&s.token&&(n.ac=s.token);let o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+dT(n);this.log_("Sending REST request for "+o);let a=new XMLHttpRequest;a.onreadystatechange=()=>{if(r&&a.readyState===4){this.log_("REST Response for "+o+" received. status:",a.status,"response:",a.responseText);let u=null;if(a.status>=200&&a.status<300){try{u=Nd(a.responseText)}catch{kt("Failed to parse JSON response for "+o+": "+a.responseText)}r(null,u)}else a.status!==401&&a.status!==404&&kt("Got unsuccessful REST response for "+o+" Status: "+a.status),r(a.status);r=null}},a.open("GET",o,!0),a.send()})}};var F0=class{constructor(){this.rootNode_=X.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,n){this.rootNode_=this.rootNode_.updateChild(e,n)}};function Xg(){return{value:null,children:new Map}}function Cu(t,e,n){if(ie(e))t.value=n,t.children.clear();else if(t.value!==null)t.value=t.value.updateChild(e,n);else{let r=re(e);t.children.has(r)||t.children.set(r,Xg());let i=t.children.get(r);e=Ae(e),Cu(i,e,n)}}function V0(t,e){if(ie(e))return t.value=null,t.children.clear(),!0;if(t.value!==null){if(t.value.isLeafNode())return!1;{let n=t.value;return t.value=null,n.forEachChild(Me,(r,i)=>{Cu(t,new Ee(r),i)}),V0(t,e)}}else if(t.children.size>0){let n=re(e);return e=Ae(e),t.children.has(n)&&V0(t.children.get(n),e)&&t.children.delete(n),t.children.size===0}else return!0}function L0(t,e,n){t.value!==null?n(e,t.value):G9(t,(r,i)=>{let s=new Ee(e.toString()+"/"+r);L0(i,s,n)})}function G9(t,e){t.children.forEach((n,r)=>{e(r,n)})}var j0=class{constructor(e){this.collection_=e,this.last_=null}get(){let e=this.collection_.get(),n=Object.assign({},e);return this.last_&&yt(this.last_,(r,i)=>{n[r]=n[r]-i}),this.last_=e,n}};var i1=10*1e3,z9=30*1e3,W9=5*60*1e3,U0=class{constructor(e,n){this.server_=n,this.statsToReport_={},this.statsListener_=new j0(e);let r=i1+(z9-i1)*Math.random();Jl(this.reportStats_.bind(this),Math.floor(r))}reportStats_(){let e=this.statsListener_.get(),n={},r=!1;yt(e,(i,s)=>{s>0&&hn(this.statsToReport_,i)&&(n[i]=s,r=!0)}),r&&this.server_.reportStats(n),Jl(this.reportStats_.bind(this),Math.floor(Math.random()*2*W9))}};var Er=function(t){return t[t.OVERWRITE=0]="OVERWRITE",t[t.MERGE=1]="MERGE",t[t.ACK_USER_WRITE=2]="ACK_USER_WRITE",t[t.LISTEN_COMPLETE=3]="LISTEN_COMPLETE",t}(Er||{});function bD(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function SD(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function AD(t){return{fromUser:!1,fromServer:!0,queryId:t,tagged:!0}}var B0=class t{constructor(e,n,r){this.path=e,this.affectedTree=n,this.revert=r,this.type=Er.ACK_USER_WRITE,this.source=bD()}operationForChild(e){if(ie(this.path)){if(this.affectedTree.value!=null)return S(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{let n=this.affectedTree.subtree(new Ee(e));return new t(we(),n,this.revert)}}else return S(re(this.path)===e,"operationForChild called for unrelated child."),new t(Ae(this.path),this.affectedTree,this.revert)}};var Jg=class t{constructor(e,n){this.source=e,this.path=n,this.type=Er.LISTEN_COMPLETE}operationForChild(e){return ie(this.path)?new t(this.source,we()):new t(this.source,Ae(this.path))}};var _u=class t{constructor(e,n,r){this.source=e,this.path=n,this.snap=r,this.type=Er.OVERWRITE}operationForChild(e){return ie(this.path)?new t(this.source,we(),this.snap.getImmediateChild(e)):new t(this.source,Ae(this.path),this.snap)}};var dd=class t{constructor(e,n,r){this.source=e,this.path=n,this.children=r,this.type=Er.MERGE}operationForChild(e){if(ie(this.path)){let n=this.children.subtree(new Ee(e));return n.isEmpty()?null:n.value?new _u(this.source,we(),n.value):new t(this.source,we(),n)}else return S(re(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new t(this.source,Ae(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}};var Dr=class{constructor(e,n,r){this.node_=e,this.fullyInitialized_=n,this.filtered_=r}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(ie(e))return this.isFullyInitialized()&&!this.filtered_;let n=re(e);return this.isCompleteForChild(n)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}};var $0=class{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}};function K9(t,e,n,r){let i=[],s=[];return e.forEach(o=>{o.type==="child_changed"&&t.index_.indexedValueChanged(o.oldSnap,o.snapshotNode)&&s.push(j9(o.childName,o.snapshotNode))}),Xl(t,i,"child_removed",e,r,n),Xl(t,i,"child_added",e,r,n),Xl(t,i,"child_moved",s,r,n),Xl(t,i,"child_changed",e,r,n),Xl(t,i,"value",e,r,n),i}function Xl(t,e,n,r,i,s){let o=r.filter(a=>a.type===n);o.sort((a,u)=>Y9(t,a,u)),o.forEach(a=>{let u=Q9(t,a,s);i.forEach(c=>{c.respondsTo(a.type)&&e.push(c.createEvent(u,t.query_))})})}function Q9(t,e,n){return e.type==="value"||e.type==="child_removed"||(e.prevName=n.getPredecessorChildName(e.childName,e.snapshotNode,t.index_)),e}function Y9(t,e,n){if(e.childName==null||n.childName==null)throw yo("Should only compare child_ events.");let r=new ae(e.childName,e.snapshotNode),i=new ae(n.childName,n.snapshotNode);return t.index_.compare(r,i)}function ym(t,e){return{eventCache:t,serverCache:e}}function td(t,e,n,r){return ym(new Dr(e,n,r),t.serverCache)}function W1(t,e,n,r){return ym(t.eventCache,new Dr(e,n,r))}function em(t){return t.eventCache.isFullyInitialized()?t.eventCache.getNode():null}function lo(t){return t.serverCache.isFullyInitialized()?t.serverCache.getNode():null}var l0,Z9=()=>(l0||(l0=new An(Q3)),l0),qt=class t{constructor(e,n=Z9()){this.value=e,this.children=n}static fromObject(e){let n=new t(null);return yt(e,(r,i)=>{n=n.set(new Ee(r),i)}),n}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,n){if(this.value!=null&&n(this.value))return{path:we(),value:this.value};if(ie(e))return null;{let r=re(e),i=this.children.get(r);if(i!==null){let s=i.findRootMostMatchingPathAndValue(Ae(e),n);return s!=null?{path:Fe(new Ee(r),s.path),value:s.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(ie(e))return this;{let n=re(e),r=this.children.get(n);return r!==null?r.subtree(Ae(e)):new t(null)}}set(e,n){if(ie(e))return new t(n,this.children);{let r=re(e),s=(this.children.get(r)||new t(null)).set(Ae(e),n),o=this.children.insert(r,s);return new t(this.value,o)}}remove(e){if(ie(e))return this.children.isEmpty()?new t(null):new t(null,this.children);{let n=re(e),r=this.children.get(n);if(r){let i=r.remove(Ae(e)),s;return i.isEmpty()?s=this.children.remove(n):s=this.children.insert(n,i),this.value===null&&s.isEmpty()?new t(null):new t(this.value,s)}else return this}}get(e){if(ie(e))return this.value;{let n=re(e),r=this.children.get(n);return r?r.get(Ae(e)):null}}setTree(e,n){if(ie(e))return n;{let r=re(e),s=(this.children.get(r)||new t(null)).setTree(Ae(e),n),o;return s.isEmpty()?o=this.children.remove(r):o=this.children.insert(r,s),new t(this.value,o)}}fold(e){return this.fold_(we(),e)}fold_(e,n){let r={};return this.children.inorderTraversal((i,s)=>{r[i]=s.fold_(Fe(e,i),n)}),n(e,this.value,r)}findOnPath(e,n){return this.findOnPath_(e,we(),n)}findOnPath_(e,n,r){let i=this.value?r(n,this.value):!1;if(i)return i;if(ie(e))return null;{let s=re(e),o=this.children.get(s);return o?o.findOnPath_(Ae(e),Fe(n,s),r):null}}foreachOnPath(e,n){return this.foreachOnPath_(e,we(),n)}foreachOnPath_(e,n,r){if(ie(e))return this;{this.value&&r(n,this.value);let i=re(e),s=this.children.get(i);return s?s.foreachOnPath_(Ae(e),Fe(n,i),r):new t(null)}}foreach(e){this.foreach_(we(),e)}foreach_(e,n){this.children.inorderTraversal((r,i)=>{i.foreach_(Fe(e,r),n)}),this.value&&n(e,this.value)}foreachChild(e){this.children.inorderTraversal((n,r)=>{r.value&&e(n,r.value)})}};var Wn=class t{constructor(e){this.writeTree_=e}static empty(){return new t(new qt(null))}};function nd(t,e,n){if(ie(e))return new Wn(new qt(n));{let r=t.writeTree_.findRootMostValueAndPath(e);if(r!=null){let i=r.path,s=r.value,o=Ht(i,e);return s=s.updateChild(o,n),new Wn(t.writeTree_.set(i,s))}else{let i=new qt(n),s=t.writeTree_.setTree(e,i);return new Wn(s)}}}function H0(t,e,n){let r=t;return yt(n,(i,s)=>{r=nd(r,Fe(e,i),s)}),r}function s1(t,e){if(ie(e))return Wn.empty();{let n=t.writeTree_.setTree(e,new qt(null));return new Wn(n)}}function q0(t,e){return fo(t,e)!=null}function fo(t,e){let n=t.writeTree_.findRootMostValueAndPath(e);return n!=null?t.writeTree_.get(n.path).getChild(Ht(n.path,e)):null}function o1(t){let e=[],n=t.writeTree_.value;return n!=null?n.isLeafNode()||n.forEachChild(Me,(r,i)=>{e.push(new ae(r,i))}):t.writeTree_.children.inorderTraversal((r,i)=>{i.value!=null&&e.push(new ae(r,i.value))}),e}function Hi(t,e){if(ie(e))return t;{let n=fo(t,e);return n!=null?new Wn(new qt(n)):new Wn(t.writeTree_.subtree(e))}}function G0(t){return t.writeTree_.isEmpty()}function vu(t,e){return K1(we(),t.writeTree_,e)}function K1(t,e,n){if(e.value!=null)return n.updateChild(t,e.value);{let r=null;return e.children.inorderTraversal((i,s)=>{i===".priority"?(S(s.value!==null,"Priority writes must always be leaf nodes"),r=s.value):n=K1(Fe(t,i),s,n)}),!n.getChild(t).isEmpty()&&r!==null&&(n=n.updateChild(Fe(t,".priority"),r)),n}}function _m(t,e){return X1(e,t)}function X9(t,e,n,r,i){S(r>t.lastWriteId,"Stacking an older write on top of newer ones"),i===void 0&&(i=!0),t.allWrites.push({path:e,snap:n,writeId:r,visible:i}),i&&(t.visibleWrites=nd(t.visibleWrites,e,n)),t.lastWriteId=r}function J9(t,e,n,r){S(r>t.lastWriteId,"Stacking an older merge on top of newer ones"),t.allWrites.push({path:e,children:n,writeId:r,visible:!0}),t.visibleWrites=H0(t.visibleWrites,e,n),t.lastWriteId=r}function eW(t,e){for(let n=0;n<t.allWrites.length;n++){let r=t.allWrites[n];if(r.writeId===e)return r}return null}function tW(t,e){let n=t.allWrites.findIndex(a=>a.writeId===e);S(n>=0,"removeWrite called with nonexistent writeId.");let r=t.allWrites[n];t.allWrites.splice(n,1);let i=r.visible,s=!1,o=t.allWrites.length-1;for(;i&&o>=0;){let a=t.allWrites[o];a.visible&&(o>=n&&nW(a,r.path)?i=!1:Sn(r.path,a.path)&&(s=!0)),o--}if(i){if(s)return rW(t),!0;if(r.snap)t.visibleWrites=s1(t.visibleWrites,r.path);else{let a=r.children;yt(a,u=>{t.visibleWrites=s1(t.visibleWrites,Fe(r.path,u))})}return!0}else return!1}function nW(t,e){if(t.snap)return Sn(t.path,e);for(let n in t.children)if(t.children.hasOwnProperty(n)&&Sn(Fe(t.path,n),e))return!0;return!1}function rW(t){t.visibleWrites=Q1(t.allWrites,iW,we()),t.allWrites.length>0?t.lastWriteId=t.allWrites[t.allWrites.length-1].writeId:t.lastWriteId=-1}function iW(t){return t.visible}function Q1(t,e,n){let r=Wn.empty();for(let i=0;i<t.length;++i){let s=t[i];if(e(s)){let o=s.path,a;if(s.snap)Sn(n,o)?(a=Ht(n,o),r=nd(r,a,s.snap)):Sn(o,n)&&(a=Ht(o,n),r=nd(r,we(),s.snap.getChild(a)));else if(s.children){if(Sn(n,o))a=Ht(n,o),r=H0(r,a,s.children);else if(Sn(o,n))if(a=Ht(o,n),ie(a))r=H0(r,we(),s.children);else{let u=Zr(s.children,re(a));if(u){let c=u.getChild(Ae(a));r=nd(r,we(),c)}}}else throw yo("WriteRecord should have .snap or .children")}}return r}function Y1(t,e,n,r,i){if(!r&&!i){let s=fo(t.visibleWrites,e);if(s!=null)return s;{let o=Hi(t.visibleWrites,e);if(G0(o))return n;if(n==null&&!q0(o,we()))return null;{let a=n||X.EMPTY_NODE;return vu(o,a)}}}else{let s=Hi(t.visibleWrites,e);if(!i&&G0(s))return n;if(!i&&n==null&&!q0(s,we()))return null;{let o=function(c){return(c.visible||i)&&(!r||!~r.indexOf(c.writeId))&&(Sn(c.path,e)||Sn(e,c.path))},a=Q1(t.allWrites,o,e),u=n||X.EMPTY_NODE;return vu(a,u)}}}function sW(t,e,n){let r=X.EMPTY_NODE,i=fo(t.visibleWrites,e);if(i)return i.isLeafNode()||i.forEachChild(Me,(s,o)=>{r=r.updateImmediateChild(s,o)}),r;if(n){let s=Hi(t.visibleWrites,e);return n.forEachChild(Me,(o,a)=>{let u=vu(Hi(s,new Ee(o)),a);r=r.updateImmediateChild(o,u)}),o1(s).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}else{let s=Hi(t.visibleWrites,e);return o1(s).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}}function oW(t,e,n,r,i){S(r||i,"Either existingEventSnap or existingServerSnap must exist");let s=Fe(e,n);if(q0(t.visibleWrites,s))return null;{let o=Hi(t.visibleWrites,s);return G0(o)?i.getChild(n):vu(o,i.getChild(n))}}function aW(t,e,n,r){let i=Fe(e,n),s=fo(t.visibleWrites,i);if(s!=null)return s;if(r.isCompleteForChild(n)){let o=Hi(t.visibleWrites,i);return vu(o,r.getNode().getImmediateChild(n))}else return null}function uW(t,e){return fo(t.visibleWrites,e)}function cW(t,e,n,r,i,s,o){let a,u=Hi(t.visibleWrites,e),c=fo(u,we());if(c!=null)a=c;else if(n!=null)a=vu(u,n);else return[];if(a=a.withIndex(o),!a.isEmpty()&&!a.isLeafNode()){let l=[],d=o.getCompare(),h=s?a.getReverseIteratorFrom(r,o):a.getIteratorFrom(r,o),f=h.getNext();for(;f&&l.length<i;)d(f,r)!==0&&l.push(f),f=h.getNext();return l}else return[]}function lW(){return{visibleWrites:Wn.empty(),allWrites:[],lastWriteId:-1}}function tm(t,e,n,r){return Y1(t.writeTree,t.treePath,e,n,r)}function xD(t,e){return sW(t.writeTree,t.treePath,e)}function a1(t,e,n,r){return oW(t.writeTree,t.treePath,e,n,r)}function nm(t,e){return uW(t.writeTree,Fe(t.treePath,e))}function dW(t,e,n,r,i,s){return cW(t.writeTree,t.treePath,e,n,r,i,s)}function MD(t,e,n){return aW(t.writeTree,t.treePath,e,n)}function Z1(t,e){return X1(Fe(t.treePath,e),t.writeTree)}function X1(t,e){return{treePath:t,writeTree:e}}var z0=class{constructor(){this.changeMap=new Map}trackChildChange(e){let n=e.type,r=e.childName;S(n==="child_added"||n==="child_changed"||n==="child_removed","Only child changes supported for tracking"),S(r!==".priority","Only non-priority child changes can be tracked.");let i=this.changeMap.get(r);if(i){let s=i.type;if(n==="child_added"&&s==="child_removed")this.changeMap.set(r,ud(r,e.snapshotNode,i.snapshotNode));else if(n==="child_removed"&&s==="child_added")this.changeMap.delete(r);else if(n==="child_removed"&&s==="child_changed")this.changeMap.set(r,ad(r,i.oldSnap));else if(n==="child_changed"&&s==="child_added")this.changeMap.set(r,yu(r,e.snapshotNode));else if(n==="child_changed"&&s==="child_changed")this.changeMap.set(r,ud(r,e.snapshotNode,i.oldSnap));else throw yo("Illegal combination of changes: "+e+" occurred after "+i)}else this.changeMap.set(r,e)}getChanges(){return Array.from(this.changeMap.values())}};var W0=class{getCompleteChild(e){return null}getChildAfterChild(e,n,r){return null}},J1=new W0,hd=class{constructor(e,n,r=null){this.writes_=e,this.viewCache_=n,this.optCompleteServerCache_=r}getCompleteChild(e){let n=this.viewCache_.eventCache;if(n.isCompleteForChild(e))return n.getNode().getImmediateChild(e);{let r=this.optCompleteServerCache_!=null?new Dr(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return MD(this.writes_,e,r)}}getChildAfterChild(e,n,r){let i=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:lo(this.viewCache_),s=dW(this.writes_,i,n,1,r,e);return s.length===0?null:s[0]}};function hW(t){return{filter:t}}function fW(t,e){S(e.eventCache.getNode().isIndexed(t.filter.getIndex()),"Event snap not indexed"),S(e.serverCache.getNode().isIndexed(t.filter.getIndex()),"Server snap not indexed")}function pW(t,e,n,r,i){let s=new z0,o,a;if(n.type===Er.OVERWRITE){let c=n;c.source.fromUser?o=K0(t,e,c.path,c.snap,r,i,s):(S(c.source.fromServer,"Unknown source."),a=c.source.tagged||e.serverCache.isFiltered()&&!ie(c.path),o=rm(t,e,c.path,c.snap,r,i,a,s))}else if(n.type===Er.MERGE){let c=n;c.source.fromUser?o=mW(t,e,c.path,c.children,r,i,s):(S(c.source.fromServer,"Unknown source."),a=c.source.tagged||e.serverCache.isFiltered(),o=Q0(t,e,c.path,c.children,r,i,a,s))}else if(n.type===Er.ACK_USER_WRITE){let c=n;c.revert?o=vW(t,e,c.path,r,i,s):o=yW(t,e,c.path,c.affectedTree,r,i,s)}else if(n.type===Er.LISTEN_COMPLETE)o=_W(t,e,n.path,r,s);else throw yo("Unknown operation type: "+n.type);let u=s.getChanges();return gW(e,o,u),{viewCache:o,changes:u}}function gW(t,e,n){let r=e.eventCache;if(r.isFullyInitialized()){let i=r.getNode().isLeafNode()||r.getNode().isEmpty(),s=em(t);(n.length>0||!t.eventCache.isFullyInitialized()||i&&!r.getNode().equals(s)||!r.getNode().getPriority().equals(s.getPriority()))&&n.push(z1(em(e)))}}function eF(t,e,n,r,i,s){let o=e.eventCache;if(nm(r,n)!=null)return e;{let a,u;if(ie(n))if(S(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){let c=lo(e),l=c instanceof X?c:X.EMPTY_NODE,d=xD(r,l);a=t.filter.updateFullNode(e.eventCache.getNode(),d,s)}else{let c=tm(r,lo(e));a=t.filter.updateFullNode(e.eventCache.getNode(),c,s)}else{let c=re(n);if(c===".priority"){S(zi(n)===1,"Can't have a priority with additional path components");let l=o.getNode();u=e.serverCache.getNode();let d=a1(r,n,l,u);d!=null?a=t.filter.updatePriority(l,d):a=o.getNode()}else{let l=Ae(n),d;if(o.isCompleteForChild(c)){u=e.serverCache.getNode();let h=a1(r,n,o.getNode(),u);h!=null?d=o.getNode().getImmediateChild(c).updateChild(l,h):d=o.getNode().getImmediateChild(c)}else d=MD(r,c,e.serverCache);d!=null?a=t.filter.updateChild(o.getNode(),c,d,l,i,s):a=o.getNode()}}return td(e,a,o.isFullyInitialized()||ie(n),t.filter.filtersNodes())}}function rm(t,e,n,r,i,s,o,a){let u=e.serverCache,c,l=o?t.filter:t.filter.getIndexedFilter();if(ie(n))c=l.updateFullNode(u.getNode(),r,null);else if(l.filtersNodes()&&!u.isFiltered()){let f=u.getNode().updateChild(n,r);c=l.updateFullNode(u.getNode(),f,null)}else{let f=re(n);if(!u.isCompleteForPath(n)&&zi(n)>1)return e;let p=Ae(n),_=u.getNode().getImmediateChild(f).updateChild(p,r);f===".priority"?c=l.updatePriority(u.getNode(),_):c=l.updateChild(u.getNode(),f,_,p,J1,null)}let d=W1(e,c,u.isFullyInitialized()||ie(n),l.filtersNodes()),h=new hd(i,d,s);return eF(t,d,n,i,h,a)}function K0(t,e,n,r,i,s,o){let a=e.eventCache,u,c,l=new hd(i,e,s);if(ie(n))c=t.filter.updateFullNode(e.eventCache.getNode(),r,o),u=td(e,c,!0,t.filter.filtersNodes());else{let d=re(n);if(d===".priority")c=t.filter.updatePriority(e.eventCache.getNode(),r),u=td(e,c,a.isFullyInitialized(),a.isFiltered());else{let h=Ae(n),f=a.getNode().getImmediateChild(d),p;if(ie(h))p=r;else{let g=l.getCompleteChild(d);g!=null?ED(h)===".priority"&&g.getChild(U1(h)).isEmpty()?p=g:p=g.updateChild(h,r):p=X.EMPTY_NODE}if(f.equals(p))u=e;else{let g=t.filter.updateChild(a.getNode(),d,p,h,l,o);u=td(e,g,a.isFullyInitialized(),t.filter.filtersNodes())}}}return u}function u1(t,e){return t.eventCache.isCompleteForChild(e)}function mW(t,e,n,r,i,s,o){let a=e;return r.foreach((u,c)=>{let l=Fe(n,u);u1(e,re(l))&&(a=K0(t,a,l,c,i,s,o))}),r.foreach((u,c)=>{let l=Fe(n,u);u1(e,re(l))||(a=K0(t,a,l,c,i,s,o))}),a}function c1(t,e,n){return n.foreach((r,i)=>{e=e.updateChild(r,i)}),e}function Q0(t,e,n,r,i,s,o,a){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let u=e,c;ie(n)?c=r:c=new qt(null).setTree(n,r);let l=e.serverCache.getNode();return c.children.inorderTraversal((d,h)=>{if(l.hasChild(d)){let f=e.serverCache.getNode().getImmediateChild(d),p=c1(t,f,h);u=rm(t,u,new Ee(d),p,i,s,o,a)}}),c.children.inorderTraversal((d,h)=>{let f=!e.serverCache.isCompleteForChild(d)&&h.value===null;if(!l.hasChild(d)&&!f){let p=e.serverCache.getNode().getImmediateChild(d),g=c1(t,p,h);u=rm(t,u,new Ee(d),g,i,s,o,a)}}),u}function yW(t,e,n,r,i,s,o){if(nm(i,n)!=null)return e;let a=e.serverCache.isFiltered(),u=e.serverCache;if(r.value!=null){if(ie(n)&&u.isFullyInitialized()||u.isCompleteForPath(n))return rm(t,e,n,u.getNode().getChild(n),i,s,a,o);if(ie(n)){let c=new qt(null);return u.getNode().forEachChild(Ir,(l,d)=>{c=c.set(new Ee(l),d)}),Q0(t,e,n,c,i,s,a,o)}else return e}else{let c=new qt(null);return r.foreach((l,d)=>{let h=Fe(n,l);u.isCompleteForPath(h)&&(c=c.set(l,u.getNode().getChild(h)))}),Q0(t,e,n,c,i,s,a,o)}}function _W(t,e,n,r,i){let s=e.serverCache,o=W1(e,s.getNode(),s.isFullyInitialized()||ie(n),s.isFiltered());return eF(t,o,n,r,J1,i)}function vW(t,e,n,r,i,s){let o;if(nm(r,n)!=null)return e;{let a=new hd(r,e,i),u=e.eventCache.getNode(),c;if(ie(n)||re(n)===".priority"){let l;if(e.serverCache.isFullyInitialized())l=tm(r,lo(e));else{let d=e.serverCache.getNode();S(d instanceof X,"serverChildren would be complete if leaf node"),l=xD(r,d)}l=l,c=t.filter.updateFullNode(u,l,s)}else{let l=re(n),d=MD(r,l,e.serverCache);d==null&&e.serverCache.isCompleteForChild(l)&&(d=u.getImmediateChild(l)),d!=null?c=t.filter.updateChild(u,l,d,Ae(n),a,s):e.eventCache.getNode().hasChild(l)?c=t.filter.updateChild(u,l,X.EMPTY_NODE,Ae(n),a,s):c=u,c.isEmpty()&&e.serverCache.isFullyInitialized()&&(o=tm(r,lo(e)),o.isLeafNode()&&(c=t.filter.updateFullNode(c,o,s)))}return o=e.serverCache.isFullyInitialized()||nm(r,we())!=null,td(e,c,o,t.filter.filtersNodes())}}var Y0=class{constructor(e,n){this.query_=e,this.eventRegistrations_=[];let r=this.query_._queryParams,i=new cd(r.getIndex()),s=U9(r);this.processor_=hW(s);let o=n.serverCache,a=n.eventCache,u=i.updateFullNode(X.EMPTY_NODE,o.getNode(),null),c=s.updateFullNode(X.EMPTY_NODE,a.getNode(),null),l=new Dr(u,o.isFullyInitialized(),i.filtersNodes()),d=new Dr(c,a.isFullyInitialized(),s.filtersNodes());this.viewCache_=ym(d,l),this.eventGenerator_=new $0(this.query_)}get query(){return this.query_}};function wW(t){return t.viewCache_.serverCache.getNode()}function EW(t){return em(t.viewCache_)}function IW(t,e){let n=lo(t.viewCache_);return n&&(t.query._queryParams.loadsAllData()||!ie(e)&&!n.getImmediateChild(re(e)).isEmpty())?n.getChild(e):null}function l1(t){return t.eventRegistrations_.length===0}function CW(t,e){t.eventRegistrations_.push(e)}function d1(t,e,n){let r=[];if(n){S(e==null,"A cancel should cancel all event registrations.");let i=t.query._path;t.eventRegistrations_.forEach(s=>{let o=s.createCancelEvent(n,i);o&&r.push(o)})}if(e){let i=[];for(let s=0;s<t.eventRegistrations_.length;++s){let o=t.eventRegistrations_[s];if(!o.matches(e))i.push(o);else if(e.hasAnyCallback()){i=i.concat(t.eventRegistrations_.slice(s+1));break}}t.eventRegistrations_=i}else t.eventRegistrations_=[];return r}function h1(t,e,n,r){e.type===Er.MERGE&&e.source.queryId!==null&&(S(lo(t.viewCache_),"We should always have a full cache before handling merges"),S(em(t.viewCache_),"Missing event cache, even though we have a server cache"));let i=t.viewCache_,s=pW(t.processor_,i,e,n,r);return fW(t.processor_,s.viewCache),S(s.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),t.viewCache_=s.viewCache,tF(t,s.changes,s.viewCache.eventCache.getNode(),null)}function DW(t,e){let n=t.viewCache_.eventCache,r=[];return n.getNode().isLeafNode()||n.getNode().forEachChild(Me,(s,o)=>{r.push(yu(s,o))}),n.isFullyInitialized()&&r.push(z1(n.getNode())),tF(t,r,n.getNode(),e)}function tF(t,e,n,r){let i=r?[r]:t.eventRegistrations_;return K9(t.eventGenerator_,e,n,i)}var im,sm=class{constructor(){this.views=new Map}};function TW(t){S(!im,"__referenceConstructor has already been defined"),im=t}function bW(){return S(im,"Reference.ts has not been loaded"),im}function SW(t){return t.views.size===0}function RD(t,e,n,r){let i=e.source.queryId;if(i!==null){let s=t.views.get(i);return S(s!=null,"SyncTree gave us an op for an invalid query."),h1(s,e,n,r)}else{let s=[];for(let o of t.views.values())s=s.concat(h1(o,e,n,r));return s}}function nF(t,e,n,r,i){let s=e._queryIdentifier,o=t.views.get(s);if(!o){let a=tm(n,i?r:null),u=!1;a?u=!0:r instanceof X?(a=xD(n,r),u=!1):(a=X.EMPTY_NODE,u=!1);let c=ym(new Dr(a,u,!1),new Dr(r,i,!1));return new Y0(e,c)}return o}function AW(t,e,n,r,i,s){let o=nF(t,e,r,i,s);return t.views.has(e._queryIdentifier)||t.views.set(e._queryIdentifier,o),CW(o,n),DW(o,n)}function xW(t,e,n,r){let i=e._queryIdentifier,s=[],o=[],a=Wi(t);if(i==="default")for(let[u,c]of t.views.entries())o=o.concat(d1(c,n,r)),l1(c)&&(t.views.delete(u),c.query._queryParams.loadsAllData()||s.push(c.query));else{let u=t.views.get(i);u&&(o=o.concat(d1(u,n,r)),l1(u)&&(t.views.delete(i),u.query._queryParams.loadsAllData()||s.push(u.query)))}return a&&!Wi(t)&&s.push(new(bW())(e._repo,e._path)),{removed:s,events:o}}function rF(t){let e=[];for(let n of t.views.values())n.query._queryParams.loadsAllData()||e.push(n);return e}function qi(t,e){let n=null;for(let r of t.views.values())n=n||IW(r,e);return n}function iF(t,e){if(e._queryParams.loadsAllData())return vm(t);{let r=e._queryIdentifier;return t.views.get(r)}}function sF(t,e){return iF(t,e)!=null}function Wi(t){return vm(t)!=null}function vm(t){for(let e of t.views.values())if(e.query._queryParams.loadsAllData())return e;return null}var om;function MW(t){S(!om,"__referenceConstructor has already been defined"),om=t}function RW(){return S(om,"Reference.ts has not been loaded"),om}var NW=1,am=class{constructor(e){this.listenProvider_=e,this.syncPointTree_=new qt(null),this.pendingWriteTree_=lW(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}};function ND(t,e,n,r,i){return X9(t.pendingWriteTree_,e,n,r,i),i?Du(t,new _u(bD(),e,n)):[]}function PW(t,e,n,r){J9(t.pendingWriteTree_,e,n,r);let i=qt.fromObject(n);return Du(t,new dd(bD(),e,i))}function $i(t,e,n=!1){let r=eW(t.pendingWriteTree_,e);if(tW(t.pendingWriteTree_,e)){let s=new qt(null);return r.snap!=null?s=s.set(we(),!0):yt(r.children,o=>{s=s.set(new Ee(o),!0)}),Du(t,new B0(r.path,s,n))}else return[]}function Ed(t,e,n){return Du(t,new _u(SD(),e,n))}function kW(t,e,n){let r=qt.fromObject(n);return Du(t,new dd(SD(),e,r))}function OW(t,e){return Du(t,new Jg(SD(),e))}function FW(t,e,n){let r=PD(t,n);if(r){let i=kD(r),s=i.path,o=i.queryId,a=Ht(s,e),u=new Jg(AD(o),a);return OD(t,s,u)}else return[]}function um(t,e,n,r,i=!1){let s=e._path,o=t.syncPointTree_.get(s),a=[];if(o&&(e._queryIdentifier==="default"||sF(o,e))){let u=xW(o,e,n,r);SW(o)&&(t.syncPointTree_=t.syncPointTree_.remove(s));let c=u.removed;if(a=u.events,!i){let l=c.findIndex(h=>h._queryParams.loadsAllData())!==-1,d=t.syncPointTree_.findOnPath(s,(h,f)=>Wi(f));if(l&&!d){let h=t.syncPointTree_.subtree(s);if(!h.isEmpty()){let f=jW(h);for(let p=0;p<f.length;++p){let g=f[p],_=g.query,b=cF(t,g);t.listenProvider_.startListening(rd(_),fd(t,_),b.hashFn,b.onComplete)}}}!d&&c.length>0&&!r&&(l?t.listenProvider_.stopListening(rd(e),null):c.forEach(h=>{let f=t.queryToTagMap.get(Em(h));t.listenProvider_.stopListening(rd(h),f)}))}UW(t,c)}return a}function oF(t,e,n,r){let i=PD(t,r);if(i!=null){let s=kD(i),o=s.path,a=s.queryId,u=Ht(o,e),c=new _u(AD(a),u,n);return OD(t,o,c)}else return[]}function VW(t,e,n,r){let i=PD(t,r);if(i){let s=kD(i),o=s.path,a=s.queryId,u=Ht(o,e),c=qt.fromObject(n),l=new dd(AD(a),u,c);return OD(t,o,l)}else return[]}function Z0(t,e,n,r=!1){let i=e._path,s=null,o=!1;t.syncPointTree_.foreachOnPath(i,(h,f)=>{let p=Ht(h,i);s=s||qi(f,p),o=o||Wi(f)});let a=t.syncPointTree_.get(i);a?(o=o||Wi(a),s=s||qi(a,we())):(a=new sm,t.syncPointTree_=t.syncPointTree_.set(i,a));let u;s!=null?u=!0:(u=!1,s=X.EMPTY_NODE,t.syncPointTree_.subtree(i).foreachChild((f,p)=>{let g=qi(p,we());g&&(s=s.updateImmediateChild(f,g))}));let c=sF(a,e);if(!c&&!e._queryParams.loadsAllData()){let h=Em(e);S(!t.queryToTagMap.has(h),"View does not exist, but we have a tag");let f=BW();t.queryToTagMap.set(h,f),t.tagToQueryMap.set(f,h)}let l=_m(t.pendingWriteTree_,i),d=AW(a,e,n,l,s,u);if(!c&&!o&&!r){let h=iF(a,e);d=d.concat($W(t,e,h))}return d}function wm(t,e,n){let i=t.pendingWriteTree_,s=t.syncPointTree_.findOnPath(e,(o,a)=>{let u=Ht(o,e),c=qi(a,u);if(c)return c});return Y1(i,e,s,n,!0)}function LW(t,e){let n=e._path,r=null;t.syncPointTree_.foreachOnPath(n,(c,l)=>{let d=Ht(c,n);r=r||qi(l,d)});let i=t.syncPointTree_.get(n);i?r=r||qi(i,we()):(i=new sm,t.syncPointTree_=t.syncPointTree_.set(n,i));let s=r!=null,o=s?new Dr(r,!0,!1):null,a=_m(t.pendingWriteTree_,e._path),u=nF(i,e,a,s?o.getNode():X.EMPTY_NODE,s);return EW(u)}function Du(t,e){return aF(e,t.syncPointTree_,null,_m(t.pendingWriteTree_,we()))}function aF(t,e,n,r){if(ie(t.path))return uF(t,e,n,r);{let i=e.get(we());n==null&&i!=null&&(n=qi(i,we()));let s=[],o=re(t.path),a=t.operationForChild(o),u=e.children.get(o);if(u&&a){let c=n?n.getImmediateChild(o):null,l=Z1(r,o);s=s.concat(aF(a,u,c,l))}return i&&(s=s.concat(RD(i,t,r,n))),s}}function uF(t,e,n,r){let i=e.get(we());n==null&&i!=null&&(n=qi(i,we()));let s=[];return e.children.inorderTraversal((o,a)=>{let u=n?n.getImmediateChild(o):null,c=Z1(r,o),l=t.operationForChild(o);l&&(s=s.concat(uF(l,a,u,c)))}),i&&(s=s.concat(RD(i,t,r,n))),s}function cF(t,e){let n=e.query,r=fd(t,n);return{hashFn:()=>(wW(e)||X.EMPTY_NODE).hash(),onComplete:i=>{if(i==="ok")return r?FW(t,n._path,r):OW(t,n._path);{let s=X3(i,n);return um(t,n,null,s)}}}}function fd(t,e){let n=Em(e);return t.queryToTagMap.get(n)}function Em(t){return t._path.toString()+"$"+t._queryIdentifier}function PD(t,e){return t.tagToQueryMap.get(e)}function kD(t){let e=t.indexOf("$");return S(e!==-1&&e<t.length-1,"Bad queryKey."),{queryId:t.substr(e+1),path:new Ee(t.substr(0,e))}}function OD(t,e,n){let r=t.syncPointTree_.get(e);S(r,"Missing sync point for query tag that we're tracking");let i=_m(t.pendingWriteTree_,e);return RD(r,n,i,null)}function jW(t){return t.fold((e,n,r)=>{if(n&&Wi(n))return[vm(n)];{let i=[];return n&&(i=rF(n)),yt(r,(s,o)=>{i=i.concat(o)}),i}})}function rd(t){return t._queryParams.loadsAllData()&&!t._queryParams.isDefault()?new(RW())(t._repo,t._path):t}function UW(t,e){for(let n=0;n<e.length;++n){let r=e[n];if(!r._queryParams.loadsAllData()){let i=Em(r),s=t.queryToTagMap.get(i);t.queryToTagMap.delete(i),t.tagToQueryMap.delete(s)}}}function BW(){return NW++}function $W(t,e,n){let r=e._path,i=fd(t,e),s=cF(t,n),o=t.listenProvider_.startListening(rd(e),i,s.hashFn,s.onComplete),a=t.syncPointTree_.subtree(r);if(i)S(!Wi(a.value),"If we're adding a query, it shouldn't be shadowed");else{let u=a.fold((c,l,d)=>{if(!ie(c)&&l&&Wi(l))return[vm(l).query];{let h=[];return l&&(h=h.concat(rF(l).map(f=>f.query))),yt(d,(f,p)=>{h=h.concat(p)}),h}});for(let c=0;c<u.length;++c){let l=u[c];t.listenProvider_.stopListening(rd(l),fd(t,l))}}return o}var X0=class t{constructor(e){this.node_=e}getImmediateChild(e){let n=this.node_.getImmediateChild(e);return new t(n)}node(){return this.node_}},J0=class t{constructor(e,n){this.syncTree_=e,this.path_=n}getImmediateChild(e){let n=Fe(this.path_,e);return new t(this.syncTree_,n)}node(){return wm(this.syncTree_,this.path_)}},HW=function(t){return t=t||{},t.timestamp=t.timestamp||new Date().getTime(),t},f1=function(t,e,n){if(!t||typeof t!="object")return t;if(S(".sv"in t,"Unexpected leaf node or priority contents"),typeof t[".sv"]=="string")return qW(t[".sv"],e,n);if(typeof t[".sv"]=="object")return GW(t[".sv"],e);S(!1,"Unexpected server value: "+JSON.stringify(t,null,2))},qW=function(t,e,n){switch(t){case"timestamp":return n.timestamp;default:S(!1,"Unexpected server value: "+t)}},GW=function(t,e,n){t.hasOwnProperty("increment")||S(!1,"Unexpected server value: "+JSON.stringify(t,null,2));let r=t.increment;typeof r!="number"&&S(!1,"Unexpected increment value: "+r);let i=e.node();if(S(i!==null&&typeof i<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;let o=i.getValue();return typeof o!="number"?r:o+r},lF=function(t,e,n,r){return VD(e,new J0(n,t),r)},FD=function(t,e,n){return VD(t,new X0(e),n)};function VD(t,e,n){let r=t.getPriority().val(),i=f1(r,e.getImmediateChild(".priority"),n),s;if(t.isLeafNode()){let o=t,a=f1(o.getValue(),e,n);return a!==o.getValue()||i!==o.getPriority().val()?new gu(a,je(i)):t}else{let o=t;return s=o,i!==o.getPriority().val()&&(s=s.updatePriority(new gu(i))),o.forEachChild(Me,(a,u)=>{let c=VD(u,e.getImmediateChild(a),n);c!==u&&(s=s.updateImmediateChild(a,c))}),s}}var pd=class{constructor(e="",n=null,r={children:{},childCount:0}){this.name=e,this.parent=n,this.node=r}};function Im(t,e){let n=e instanceof Ee?e:new Ee(e),r=t,i=re(n);for(;i!==null;){let s=Zr(r.node.children,i)||{children:{},childCount:0};r=new pd(i,r,s),n=Ae(n),i=re(n)}return r}function po(t){return t.node.value}function LD(t,e){t.node.value=e,eD(t)}function dF(t){return t.node.childCount>0}function zW(t){return po(t)===void 0&&!dF(t)}function Cm(t,e){yt(t.node.children,(n,r)=>{e(new pd(n,t,r))})}function hF(t,e,n,r){n&&!r&&e(t),Cm(t,i=>{hF(i,e,!0,r)}),n&&r&&e(t)}function WW(t,e,n){let r=n?t:t.parent;for(;r!==null;){if(e(r))return!0;r=r.parent}return!1}function Id(t){return new Ee(t.parent===null?t.name:Id(t.parent)+"/"+t.name)}function eD(t){t.parent!==null&&KW(t.parent,t.name,t)}function KW(t,e,n){let r=zW(n),i=hn(t.node.children,e);r&&i?(delete t.node.children[e],t.node.childCount--,eD(t)):!r&&!i&&(t.node.children[e]=n.node,t.node.childCount++,eD(t))}var QW=/[\[\].#$\/\u0000-\u001F\u007F]/,YW=/[\[\].#$\u0000-\u001F\u007F]/,d0=10*1024*1024,Dm=function(t){return typeof t=="string"&&t.length!==0&&!QW.test(t)},fF=function(t){return typeof t=="string"&&t.length!==0&&!YW.test(t)},ZW=function(t){return t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),fF(t)},gd=function(t){return t===null||typeof t=="string"||typeof t=="number"&&!gm(t)||t&&typeof t=="object"&&hn(t,".sv")},Tr=function(t,e,n,r){r&&e===void 0||Cd(zt(t,"value"),e,n)},Cd=function(t,e,n){let r=n instanceof Ee?new D0(n,t):n;if(e===void 0)throw new Error(t+"contains undefined "+ao(r));if(typeof e=="function")throw new Error(t+"contains a function "+ao(r)+" with contents = "+e.toString());if(gm(e))throw new Error(t+"contains "+e.toString()+" "+ao(r));if(typeof e=="string"&&e.length>d0/3&&xu(e)>d0)throw new Error(t+"contains a string greater than "+d0+" utf8 bytes "+ao(r)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let i=!1,s=!1;if(yt(e,(o,a)=>{if(o===".value")i=!0;else if(o!==".priority"&&o!==".sv"&&(s=!0,!Dm(o)))throw new Error(t+" contains an invalid key ("+o+") "+ao(r)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);S9(r,o),Cd(t,a,r),A9(r)}),i&&s)throw new Error(t+' contains ".value" child '+ao(r)+" in addition to actual children.")}},XW=function(t,e){let n,r;for(n=0;n<e.length;n++){r=e[n];let s=sd(r);for(let o=0;o<s.length;o++)if(!(s[o]===".priority"&&o===s.length-1)){if(!Dm(s[o]))throw new Error(t+"contains an invalid key ("+s[o]+") in path "+r.toString()+`. Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`)}}e.sort(b9);let i=null;for(n=0;n<e.length;n++){if(r=e[n],i!==null&&Sn(i,r))throw new Error(t+"contains a path "+i.toString()+" that is ancestor of another path "+r.toString());i=r}},pF=function(t,e,n,r){if(r&&e===void 0)return;let i=zt(t,"values");if(!(e&&typeof e=="object")||Array.isArray(e))throw new Error(i+" must be an object containing the children to replace.");let s=[];yt(e,(o,a)=>{let u=new Ee(o);if(Cd(i,a,Fe(n,u)),ED(u)===".priority"&&!gd(a))throw new Error(i+"contains an invalid value for '"+u.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");s.push(u)}),XW(i,s)},jD=function(t,e,n){if(!(n&&e===void 0)){if(gm(e))throw new Error(zt(t,"priority")+"is "+e.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!gd(e))throw new Error(zt(t,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},Dd=function(t,e,n,r){if(!(r&&n===void 0)&&!Dm(n))throw new Error(zt(t,e)+'was an invalid key = "'+n+`".  Firebase keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]").`)},Tu=function(t,e,n,r){if(!(r&&n===void 0)&&!fF(n))throw new Error(zt(t,e)+'was an invalid path = "'+n+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},JW=function(t,e,n,r){n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),Tu(t,e,n,r)},an=function(t,e){if(re(e)===".info")throw new Error(t+" failed = Can't modify data under /.info/")},gF=function(t,e){let n=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!Dm(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||n.length!==0&&!ZW(n))throw new Error(zt(t,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};var tD=class{constructor(){this.eventLists_=[],this.recursionDepth_=0}};function Tm(t,e){let n=null;for(let r=0;r<e.length;r++){let i=e[r],s=i.getPath();n!==null&&!ID(s,n.path)&&(t.eventLists_.push(n),n=null),n===null&&(n={events:[],path:s}),n.events.push(i)}n&&t.eventLists_.push(n)}function mF(t,e,n){Tm(t,n),yF(t,r=>ID(r,e))}function un(t,e,n){Tm(t,n),yF(t,r=>Sn(r,e)||Sn(e,r))}function yF(t,e){t.recursionDepth_++;let n=!0;for(let r=0;r<t.eventLists_.length;r++){let i=t.eventLists_[r];if(i){let s=i.path;e(s)?(e6(t.eventLists_[r]),t.eventLists_[r]=null):n=!1}}n&&(t.eventLists_=[]),t.recursionDepth_--}function e6(t){for(let e=0;e<t.events.length;e++){let n=t.events[e];if(n!==null){t.events[e]=null;let r=n.getEventRunner();co&&mt("event: "+n.toString()),Iu(r)}}}var _F="repo_interrupt",t6=25,nD=class{constructor(e,n,r,i){this.repoInfo_=e,this.forceRestClient_=n,this.authTokenProvider_=r,this.appCheckProvider_=i,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new tD,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=Xg(),this.transactionQueueTree_=new pd,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}};function n6(t,e,n){if(t.stats_=wD(t.repoInfo_),t.forceRestClient_||n9())t.server_=new O0(t.repoInfo_,(r,i,s,o)=>{p1(t,r,i,s,o)},t.authTokenProvider_,t.appCheckProvider_),setTimeout(()=>g1(t,!0),0);else{if(typeof n<"u"&&n!==null){if(typeof n!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{Qe(n)}catch(r){throw new Error("Invalid authOverride provided: "+r)}}t.persistentConnection_=new CD(t.repoInfo_,e,(r,i,s,o)=>{p1(t,r,i,s,o)},r=>{g1(t,r)},r=>{r6(t,r)},t.authTokenProvider_,t.appCheckProvider_,n),t.server_=t.persistentConnection_}t.authTokenProvider_.addTokenChangeListener(r=>{t.server_.refreshAuthToken(r)}),t.appCheckProvider_.addTokenChangeListener(r=>{t.server_.refreshAppCheckToken(r.token)}),t.statsReporter_=i9(t.repoInfo_,()=>new U0(t.stats_,t.server_)),t.infoData_=new F0,t.infoSyncTree_=new am({startListening:(r,i,s,o)=>{let a=[],u=t.infoData_.getNode(r._path);return u.isEmpty()||(a=Ed(t.infoSyncTree_,r._path,u),setTimeout(()=>{o("ok")},0)),a},stopListening:()=>{}}),UD(t,"connected",!1),t.serverSyncTree_=new am({startListening:(r,i,s,o)=>(t.server_.listen(r,s,i,(a,u)=>{let c=o(a,u);un(t.eventQueue_,r._path,c)}),[]),stopListening:(r,i)=>{t.server_.unlisten(r,i)}})}function vF(t){let n=t.infoData_.getNode(new Ee(".info/serverTimeOffset")).val()||0;return new Date().getTime()+n}function Td(t){return HW({timestamp:vF(t)})}function p1(t,e,n,r,i){t.dataUpdateCount++;let s=new Ee(e);n=t.interceptServerDataCallback_?t.interceptServerDataCallback_(e,n):n;let o=[];if(i)if(r){let u=Au(n,c=>je(c));o=VW(t.serverSyncTree_,s,u,i)}else{let u=je(n);o=oF(t.serverSyncTree_,s,u,i)}else if(r){let u=Au(n,c=>je(c));o=kW(t.serverSyncTree_,s,u)}else{let u=je(n);o=Ed(t.serverSyncTree_,s,u)}let a=s;o.length>0&&(a=wu(t,s)),un(t.eventQueue_,a,o)}function g1(t,e){UD(t,"connected",e),e===!1&&o6(t)}function r6(t,e){yt(e,(n,r)=>{UD(t,n,r)})}function UD(t,e,n){let r=new Ee("/.info/"+e),i=je(n);t.infoData_.updateSnapshot(r,i);let s=Ed(t.infoSyncTree_,r,i);un(t.eventQueue_,r,s)}function bm(t){return t.nextWriteId_++}function i6(t,e,n){let r=LW(t.serverSyncTree_,e);return r!=null?Promise.resolve(r):t.server_.get(e).then(i=>{let s=je(i).withIndex(e._queryParams.getIndex());Z0(t.serverSyncTree_,e,n,!0);let o;if(e._queryParams.loadsAllData())o=Ed(t.serverSyncTree_,e._path,s);else{let a=fd(t.serverSyncTree_,e);o=oF(t.serverSyncTree_,e._path,s,a)}return un(t.eventQueue_,e._path,o),um(t.serverSyncTree_,e,n,null,!0),s},i=>(bu(t,"get for query "+Qe(e)+" failed: "+i),Promise.reject(new Error(i))))}function BD(t,e,n,r,i){bu(t,"set",{path:e.toString(),value:n,priority:r});let s=Td(t),o=je(n,r),a=wm(t.serverSyncTree_,e),u=FD(o,a,s),c=bm(t),l=ND(t.serverSyncTree_,e,u,c,!0);Tm(t.eventQueue_,l),t.server_.put(e.toString(),o.val(!0),(h,f)=>{let p=h==="ok";p||kt("set at "+e+" failed: "+h);let g=$i(t.serverSyncTree_,c,!p);un(t.eventQueue_,e,g),Ki(t,i,h,f)});let d=HD(t,e);wu(t,d),un(t.eventQueue_,d,[])}function s6(t,e,n,r){bu(t,"update",{path:e.toString(),value:n});let i=!0,s=Td(t),o={};if(yt(n,(a,u)=>{i=!1,o[a]=lF(Fe(e,a),je(u),t.serverSyncTree_,s)}),i)mt("update() called with empty data.  Don't do anything."),Ki(t,r,"ok",void 0);else{let a=bm(t),u=PW(t.serverSyncTree_,e,o,a);Tm(t.eventQueue_,u),t.server_.merge(e.toString(),n,(c,l)=>{let d=c==="ok";d||kt("update at "+e+" failed: "+c);let h=$i(t.serverSyncTree_,a,!d),f=h.length>0?wu(t,e):e;un(t.eventQueue_,f,h),Ki(t,r,c,l)}),yt(n,c=>{let l=HD(t,Fe(e,c));wu(t,l)}),un(t.eventQueue_,e,[])}}function o6(t){bu(t,"onDisconnectEvents");let e=Td(t),n=Xg();L0(t.onDisconnect_,we(),(i,s)=>{let o=lF(i,s,t.serverSyncTree_,e);Cu(n,i,o)});let r=[];L0(n,we(),(i,s)=>{r=r.concat(Ed(t.serverSyncTree_,i,s));let o=HD(t,i);wu(t,o)}),t.onDisconnect_=Xg(),un(t.eventQueue_,we(),r)}function a6(t,e,n){t.server_.onDisconnectCancel(e.toString(),(r,i)=>{r==="ok"&&V0(t.onDisconnect_,e),Ki(t,n,r,i)})}function m1(t,e,n,r){let i=je(n);t.server_.onDisconnectPut(e.toString(),i.val(!0),(s,o)=>{s==="ok"&&Cu(t.onDisconnect_,e,i),Ki(t,r,s,o)})}function u6(t,e,n,r,i){let s=je(n,r);t.server_.onDisconnectPut(e.toString(),s.val(!0),(o,a)=>{o==="ok"&&Cu(t.onDisconnect_,e,s),Ki(t,i,o,a)})}function c6(t,e,n,r){if(Pd(n)){mt("onDisconnect().update() called with empty data.  Don't do anything."),Ki(t,r,"ok",void 0);return}t.server_.onDisconnectMerge(e.toString(),n,(i,s)=>{i==="ok"&&yt(n,(o,a)=>{let u=je(a);Cu(t.onDisconnect_,Fe(e,o),u)}),Ki(t,r,i,s)})}function l6(t,e,n){let r;re(e._path)===".info"?r=Z0(t.infoSyncTree_,e,n):r=Z0(t.serverSyncTree_,e,n),mF(t.eventQueue_,e._path,r)}function rD(t,e,n){let r;re(e._path)===".info"?r=um(t.infoSyncTree_,e,n):r=um(t.serverSyncTree_,e,n),mF(t.eventQueue_,e._path,r)}function wF(t){t.persistentConnection_&&t.persistentConnection_.interrupt(_F)}function d6(t){t.persistentConnection_&&t.persistentConnection_.resume(_F)}function bu(t,...e){let n="";t.persistentConnection_&&(n=t.persistentConnection_.id+":"),mt(n,...e)}function Ki(t,e,n,r){e&&Iu(()=>{if(n==="ok")e(null);else{let i=(n||"error").toUpperCase(),s=i;r&&(s+=": "+r);let o=new Error(s);o.code=i,e(o)}})}function h6(t,e,n,r,i,s){bu(t,"transaction on "+e);let o={path:e,update:n,onComplete:r,status:null,order:v1(),applyLocally:s,retryCount:0,unwatcher:i,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},a=$D(t,e,void 0);o.currentInputSnapshot=a;let u=o.update(a.val());if(u===void 0)o.unwatcher(),o.currentOutputSnapshotRaw=null,o.currentOutputSnapshotResolved=null,o.onComplete&&o.onComplete(null,!1,o.currentInputSnapshot);else{Cd("transaction failed: Data returned ",u,o.path),o.status=0;let c=Im(t.transactionQueueTree_,e),l=po(c)||[];l.push(o),LD(c,l);let d;typeof u=="object"&&u!==null&&hn(u,".priority")?(d=Zr(u,".priority"),S(gd(d),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):d=(wm(t.serverSyncTree_,e)||X.EMPTY_NODE).getPriority().val();let h=Td(t),f=je(u,d),p=FD(f,a,h);o.currentOutputSnapshotRaw=f,o.currentOutputSnapshotResolved=p,o.currentWriteId=bm(t);let g=ND(t.serverSyncTree_,e,p,o.currentWriteId,o.applyLocally);un(t.eventQueue_,e,g),Sm(t,t.transactionQueueTree_)}}function $D(t,e,n){return wm(t.serverSyncTree_,e,n)||X.EMPTY_NODE}function Sm(t,e=t.transactionQueueTree_){if(e||Am(t,e),po(e)){let n=IF(t,e);S(n.length>0,"Sending zero length transaction queue"),n.every(i=>i.status===0)&&f6(t,Id(e),n)}else dF(e)&&Cm(e,n=>{Sm(t,n)})}function f6(t,e,n){let r=n.map(c=>c.currentWriteId),i=$D(t,e,r),s=i,o=i.hash();for(let c=0;c<n.length;c++){let l=n[c];S(l.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),l.status=1,l.retryCount++;let d=Ht(e,l.path);s=s.updateChild(d,l.currentOutputSnapshotRaw)}let a=s.val(!0),u=e;t.server_.put(u.toString(),a,c=>{bu(t,"transaction put response",{path:u.toString(),status:c});let l=[];if(c==="ok"){let d=[];for(let h=0;h<n.length;h++)n[h].status=2,l=l.concat($i(t.serverSyncTree_,n[h].currentWriteId)),n[h].onComplete&&d.push(()=>n[h].onComplete(null,!0,n[h].currentOutputSnapshotResolved)),n[h].unwatcher();Am(t,Im(t.transactionQueueTree_,e)),Sm(t,t.transactionQueueTree_),un(t.eventQueue_,e,l);for(let h=0;h<d.length;h++)Iu(d[h])}else{if(c==="datastale")for(let d=0;d<n.length;d++)n[d].status===3?n[d].status=4:n[d].status=0;else{kt("transaction at "+u.toString()+" failed: "+c);for(let d=0;d<n.length;d++)n[d].status=4,n[d].abortReason=c}wu(t,e)}},o)}function wu(t,e){let n=EF(t,e),r=Id(n),i=IF(t,n);return p6(t,i,r),r}function p6(t,e,n){if(e.length===0)return;let r=[],i=[],o=e.filter(a=>a.status===0).map(a=>a.currentWriteId);for(let a=0;a<e.length;a++){let u=e[a],c=Ht(n,u.path),l=!1,d;if(S(c!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),u.status===4)l=!0,d=u.abortReason,i=i.concat($i(t.serverSyncTree_,u.currentWriteId,!0));else if(u.status===0)if(u.retryCount>=t6)l=!0,d="maxretry",i=i.concat($i(t.serverSyncTree_,u.currentWriteId,!0));else{let h=$D(t,u.path,o);u.currentInputSnapshot=h;let f=e[a].update(h.val());if(f!==void 0){Cd("transaction failed: Data returned ",f,u.path);let p=je(f);typeof f=="object"&&f!=null&&hn(f,".priority")||(p=p.updatePriority(h.getPriority()));let _=u.currentWriteId,b=Td(t),P=FD(p,h,b);u.currentOutputSnapshotRaw=p,u.currentOutputSnapshotResolved=P,u.currentWriteId=bm(t),o.splice(o.indexOf(_),1),i=i.concat(ND(t.serverSyncTree_,u.path,P,u.currentWriteId,u.applyLocally)),i=i.concat($i(t.serverSyncTree_,_,!0))}else l=!0,d="nodata",i=i.concat($i(t.serverSyncTree_,u.currentWriteId,!0))}un(t.eventQueue_,n,i),i=[],l&&(e[a].status=2,function(h){setTimeout(h,Math.floor(0))}(e[a].unwatcher),e[a].onComplete&&(d==="nodata"?r.push(()=>e[a].onComplete(null,!1,e[a].currentInputSnapshot)):r.push(()=>e[a].onComplete(new Error(d),!1,null))))}Am(t,t.transactionQueueTree_);for(let a=0;a<r.length;a++)Iu(r[a]);Sm(t,t.transactionQueueTree_)}function EF(t,e){let n,r=t.transactionQueueTree_;for(n=re(e);n!==null&&po(r)===void 0;)r=Im(r,n),e=Ae(e),n=re(e);return r}function IF(t,e){let n=[];return CF(t,e,n),n.sort((r,i)=>r.order-i.order),n}function CF(t,e,n){let r=po(e);if(r)for(let i=0;i<r.length;i++)n.push(r[i]);Cm(e,i=>{CF(t,i,n)})}function Am(t,e){let n=po(e);if(n){let r=0;for(let i=0;i<n.length;i++)n[i].status!==2&&(n[r]=n[i],r++);n.length=r,LD(e,n.length>0?n:void 0)}Cm(e,r=>{Am(t,r)})}function HD(t,e){let n=Id(EF(t,e)),r=Im(t.transactionQueueTree_,e);return WW(r,i=>{h0(t,i)}),h0(t,r),hF(r,i=>{h0(t,i)}),n}function h0(t,e){let n=po(e);if(n){let r=[],i=[],s=-1;for(let o=0;o<n.length;o++)n[o].status===3||(n[o].status===1?(S(s===o-1,"All SENT items should be at beginning of queue."),s=o,n[o].status=3,n[o].abortReason="set"):(S(n[o].status===0,"Unexpected transaction status in abort"),n[o].unwatcher(),i=i.concat($i(t.serverSyncTree_,n[o].currentWriteId,!0)),n[o].onComplete&&r.push(n[o].onComplete.bind(null,new Error("set"),!1,null))));s===-1?LD(e,void 0):n.length=s+1,un(t.eventQueue_,Id(e),i);for(let o=0;o<r.length;o++)Iu(r[o])}}function g6(t){let e="",n=t.split("/");for(let r=0;r<n.length;r++)if(n[r].length>0){let i=n[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch{}e+="/"+i}return e}function m6(t){let e={};t.charAt(0)==="?"&&(t=t.substring(1));for(let n of t.split("&")){if(n.length===0)continue;let r=n.split("=");r.length===2?e[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):kt(`Invalid query segment '${n}' in query '${t}'`)}return e}var iD=function(t,e){let n=y6(t),r=n.namespace;n.domain==="firebase.com"&&Cr(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!r||r==="undefined")&&n.domain!=="localhost"&&Cr("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||W3();let i=n.scheme==="ws"||n.scheme==="wss";return{repoInfo:new qg(n.host,n.secure,r,i,e,"",r!==n.subdomain),path:new Ee(n.pathString)}},y6=function(t){let e="",n="",r="",i="",s="",o=!0,a="https",u=443;if(typeof t=="string"){let c=t.indexOf("//");c>=0&&(a=t.substring(0,c-1),t=t.substring(c+2));let l=t.indexOf("/");l===-1&&(l=t.length);let d=t.indexOf("?");d===-1&&(d=t.length),e=t.substring(0,Math.min(l,d)),l<d&&(i=g6(t.substring(l,d)));let h=m6(t.substring(Math.min(t.length,d)));c=e.indexOf(":"),c>=0?(o=a==="https"||a==="wss",u=parseInt(e.substring(c+1),10)):c=e.length;let f=e.slice(0,c);if(f.toLowerCase()==="localhost")n="localhost";else if(f.split(".").length<=2)n=f;else{let p=e.indexOf(".");r=e.substring(0,p).toLowerCase(),n=e.substring(p+1),s=r}"ns"in h&&(s=h.ns)}return{host:e,port:u,domain:n,subdomain:r,secure:o,scheme:a,pathString:i,namespace:s}};var y1="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",_6=function(){let t=0,e=[];return function(n){let r=n===t;t=n;let i,s=new Array(8);for(i=7;i>=0;i--)s[i]=y1.charAt(n%64),n=Math.floor(n/64);S(n===0,"Cannot push at time == 0");let o=s.join("");if(r){for(i=11;i>=0&&e[i]===63;i--)e[i]=0;e[i]++}else for(i=0;i<12;i++)e[i]=Math.floor(Math.random()*64);for(i=0;i<12;i++)o+=y1.charAt(e[i]);return S(o.length===20,"nextPushId: Length should be 20."),o}}();var cm=class{constructor(e,n,r,i){this.eventType=e,this.eventRegistration=n,this.snapshot=r,this.prevName=i}getPath(){let e=this.snapshot.ref;return this.eventType==="value"?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+Qe(this.snapshot.exportVal())}},lm=class{constructor(e,n,r){this.eventRegistration=e,this.error=n,this.path=r}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}};var md=class{constructor(e,n){this.snapshotCallback=e,this.cancelCallback=n}onValue(e,n){this.snapshotCallback.call(null,e,n)}onCancel(e){return S(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}};var dm=class{constructor(e,n){this._repo=e,this._path=n}cancel(){let e=new lt;return a6(this._repo,this._path,e.wrapCallback(()=>{})),e.promise}remove(){an("OnDisconnect.remove",this._path);let e=new lt;return m1(this._repo,this._path,null,e.wrapCallback(()=>{})),e.promise}set(e){an("OnDisconnect.set",this._path),Tr("OnDisconnect.set",e,this._path,!1);let n=new lt;return m1(this._repo,this._path,e,n.wrapCallback(()=>{})),n.promise}setWithPriority(e,n){an("OnDisconnect.setWithPriority",this._path),Tr("OnDisconnect.setWithPriority",e,this._path,!1),jD("OnDisconnect.setWithPriority",n,!1);let r=new lt;return u6(this._repo,this._path,e,n,r.wrapCallback(()=>{})),r.promise}update(e){an("OnDisconnect.update",this._path),pF("OnDisconnect.update",e,this._path,!1);let n=new lt;return c6(this._repo,this._path,e,n.wrapCallback(()=>{})),n.promise}};var Gt=class t{constructor(e,n,r,i){this._repo=e,this._path=n,this._queryParams=r,this._orderByCalled=i}get key(){return ie(this._path)?null:ED(this._path)}get ref(){return new cn(this._repo,this._path)}get _queryIdentifier(){let e=r1(this._queryParams),n=vD(e);return n==="{}"?"default":n}get _queryObject(){return r1(this._queryParams)}isEqual(e){if(e=ce(e),!(e instanceof t))return!1;let n=this._repo===e._repo,r=ID(this._path,e._path),i=this._queryIdentifier===e._queryIdentifier;return n&&r&&i}toJSON(){return this.toString()}toString(){return this._repo.toString()+T9(this._path)}};function xm(t,e){if(t._orderByCalled===!0)throw new Error(e+": You can't combine multiple orderBy calls.")}function Yi(t){let e=null,n=null;if(t.hasStart()&&(e=t.getIndexStartValue()),t.hasEnd()&&(n=t.getIndexEndValue()),t.getIndex()===Ir){let r="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",i="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(t.hasStart()){if(t.getIndexStartName()!==Gi)throw new Error(r);if(typeof e!="string")throw new Error(i)}if(t.hasEnd()){if(t.getIndexEndName()!==Qr)throw new Error(r);if(typeof n!="string")throw new Error(i)}}else if(t.getIndex()===Me){if(e!=null&&!gd(e)||n!=null&&!gd(n))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(S(t.getIndex()instanceof od||t.getIndex()===TD,"unknown index type."),e!=null&&typeof e=="object"||n!=null&&typeof n=="object")throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}function Mm(t){if(t.hasStart()&&t.hasEnd()&&t.hasLimit()&&!t.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")}var cn=class t extends Gt{constructor(e,n){super(e,n,new ld,!1)}get parent(){let e=U1(this._path);return e===null?null:new t(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}},Eu=class t{constructor(e,n,r){this._node=e,this.ref=n,this._index=r}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){let n=new Ee(e),r=Qi(this.ref,e);return new t(this._node.getChild(n),r,Me)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(r,i)=>e(new t(i,Qi(this.ref,r),Me)))}hasChild(e){let n=new Ee(e);return!this._node.getChild(n).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}};function qD(t,e){return t=ce(t),t._checkNotDeleted("ref"),e!==void 0?Qi(t._root,e):t._root}function GD(t,e){t=ce(t),t._checkNotDeleted("refFromURL");let n=iD(e,t._repo.repoInfo_.nodeAdmin);gF("refFromURL",n);let r=n.repoInfo;return!t._repo.repoInfo_.isCustomHost()&&r.host!==t._repo.repoInfo_.host&&Cr("refFromURL: Host name does not match the current database: (found "+r.host+" but expected "+t._repo.repoInfo_.host+")"),qD(t,n.path.toString())}function Qi(t,e){return t=ce(t),re(t._path)===null?JW("child","path",e,!1):Tu("child","path",e,!1),new cn(t._repo,Fe(t._path,e))}function DF(t,e){t=ce(t),an("push",t._path),Tr("push",e,t._path,!0);let n=vF(t._repo),r=_6(n),i=Qi(t,r),s=Qi(t,r),o;return e!=null?o=Rm(s,e).then(()=>s):o=Promise.resolve(s),i.then=o.then.bind(o),i.catch=o.then.bind(o,void 0),i}function TF(t){return an("remove",t._path),Rm(t,null)}function Rm(t,e){t=ce(t),an("set",t._path),Tr("set",e,t._path,!1);let n=new lt;return BD(t._repo,t._path,e,null,n.wrapCallback(()=>{})),n.promise}function bF(t,e){t=ce(t),an("setPriority",t._path),jD("setPriority",e,!1);let n=new lt;return BD(t._repo,Fe(t._path,".priority"),e,null,n.wrapCallback(()=>{})),n.promise}function SF(t,e,n){if(an("setWithPriority",t._path),Tr("setWithPriority",e,t._path,!1),jD("setWithPriority",n,!1),t.key===".length"||t.key===".keys")throw"setWithPriority failed: "+t.key+" is a read-only object.";let r=new lt;return BD(t._repo,t._path,e,n,r.wrapCallback(()=>{})),r.promise}function AF(t,e){pF("update",e,t._path,!1);let n=new lt;return s6(t._repo,t._path,e,n.wrapCallback(()=>{})),n.promise}function xF(t){t=ce(t);let e=new md(()=>{}),n=new yd(e);return i6(t._repo,t,n).then(r=>new Eu(r,new cn(t._repo,t._path),t._queryParams.getIndex()))}var yd=class t{constructor(e){this.callbackContext=e}respondsTo(e){return e==="value"}createEvent(e,n){let r=n._queryParams.getIndex();return new cm("value",this,new Eu(e.snapshotNode,new cn(n._repo,n._path),r))}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,n){return this.callbackContext.hasCancelCallback?new lm(this,e,n):null}matches(e){return e instanceof t?!e.callbackContext||!this.callbackContext?!0:e.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}},hm=class t{constructor(e,n){this.eventType=e,this.callbackContext=n}respondsTo(e){let n=e==="children_added"?"child_added":e;return n=n==="children_removed"?"child_removed":n,this.eventType===n}createCancelEvent(e,n){return this.callbackContext.hasCancelCallback?new lm(this,e,n):null}createEvent(e,n){S(e.childName!=null,"Child events should have a childName.");let r=Qi(new cn(n._repo,n._path),e.childName),i=n._queryParams.getIndex();return new cm(e.type,this,new Eu(e.snapshotNode,r,i),e.prevName)}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,e.prevName)}matches(e){return e instanceof t?this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext)):!1}hasAnyCallback(){return!!this.callbackContext}};function bd(t,e,n,r,i){let s;if(typeof r=="object"&&(s=void 0,i=r),typeof r=="function"&&(s=r),i&&i.onlyOnce){let u=n,c=(l,d)=>{rD(t._repo,t,a),u(l,d)};c.userCallback=n.userCallback,c.context=n.context,n=c}let o=new md(n,s||void 0),a=e==="value"?new yd(o):new hm(e,o);return l6(t._repo,t,a),()=>rD(t._repo,t,a)}function Nm(t,e,n,r){return bd(t,"value",e,n,r)}function zD(t,e,n,r){return bd(t,"child_added",e,n,r)}function WD(t,e,n,r){return bd(t,"child_changed",e,n,r)}function KD(t,e,n,r){return bd(t,"child_moved",e,n,r)}function QD(t,e,n,r){return bd(t,"child_removed",e,n,r)}function YD(t,e,n){let r=null,i=n?new md(n):null;e==="value"?r=new yd(i):e&&(r=new hm(e,i)),rD(t._repo,t,r)}var ln=class{},fm=class extends ln{constructor(e,n){super(),this._value=e,this._key=n,this.type="endAt"}_apply(e){Tr("endAt",this._value,e._path,!0);let n=k0(e._queryParams,this._value,this._key);if(Mm(n),Yi(n),e._queryParams.hasEnd())throw new Error("endAt: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new Gt(e._repo,e._path,n,e._orderByCalled)}};function MF(t,e){return Dd("endAt","key",e,!0),new fm(t,e)}var sD=class extends ln{constructor(e,n){super(),this._value=e,this._key=n,this.type="endBefore"}_apply(e){Tr("endBefore",this._value,e._path,!1);let n=q9(e._queryParams,this._value,this._key);if(Mm(n),Yi(n),e._queryParams.hasEnd())throw new Error("endBefore: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new Gt(e._repo,e._path,n,e._orderByCalled)}};function RF(t,e){return Dd("endBefore","key",e,!0),new sD(t,e)}var pm=class extends ln{constructor(e,n){super(),this._value=e,this._key=n,this.type="startAt"}_apply(e){Tr("startAt",this._value,e._path,!0);let n=P0(e._queryParams,this._value,this._key);if(Mm(n),Yi(n),e._queryParams.hasStart())throw new Error("startAt: Starting point was already set (by another call to startAt, startBefore or equalTo).");return new Gt(e._repo,e._path,n,e._orderByCalled)}};function NF(t=null,e){return Dd("startAt","key",e,!0),new pm(t,e)}var oD=class extends ln{constructor(e,n){super(),this._value=e,this._key=n,this.type="startAfter"}_apply(e){Tr("startAfter",this._value,e._path,!1);let n=H9(e._queryParams,this._value,this._key);if(Mm(n),Yi(n),e._queryParams.hasStart())throw new Error("startAfter: Starting point was already set (by another call to startAt, startAfter, or equalTo).");return new Gt(e._repo,e._path,n,e._orderByCalled)}};function PF(t,e){return Dd("startAfter","key",e,!0),new oD(t,e)}var aD=class extends ln{constructor(e){super(),this._limit=e,this.type="limitToFirst"}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToFirst: Limit was already set (by another call to limitToFirst or limitToLast).");return new Gt(e._repo,e._path,B9(e._queryParams,this._limit),e._orderByCalled)}};function kF(t){if(typeof t!="number"||Math.floor(t)!==t||t<=0)throw new Error("limitToFirst: First argument must be a positive integer.");return new aD(t)}var uD=class extends ln{constructor(e){super(),this._limit=e,this.type="limitToLast"}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new Gt(e._repo,e._path,$9(e._queryParams,this._limit),e._orderByCalled)}};function OF(t){if(typeof t!="number"||Math.floor(t)!==t||t<=0)throw new Error("limitToLast: First argument must be a positive integer.");return new uD(t)}var cD=class extends ln{constructor(e){super(),this._path=e,this.type="orderByChild"}_apply(e){xm(e,"orderByChild");let n=new Ee(this._path);if(ie(n))throw new Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");let r=new od(n),i=mm(e._queryParams,r);return Yi(i),new Gt(e._repo,e._path,i,!0)}};function FF(t){if(t==="$key")throw new Error('orderByChild: "$key" is invalid.  Use orderByKey() instead.');if(t==="$priority")throw new Error('orderByChild: "$priority" is invalid.  Use orderByPriority() instead.');if(t==="$value")throw new Error('orderByChild: "$value" is invalid.  Use orderByValue() instead.');return Tu("orderByChild","path",t,!1),new cD(t)}var lD=class extends ln{constructor(){super(...arguments),this.type="orderByKey"}_apply(e){xm(e,"orderByKey");let n=mm(e._queryParams,Ir);return Yi(n),new Gt(e._repo,e._path,n,!0)}};function VF(){return new lD}var dD=class extends ln{constructor(){super(...arguments),this.type="orderByPriority"}_apply(e){xm(e,"orderByPriority");let n=mm(e._queryParams,Me);return Yi(n),new Gt(e._repo,e._path,n,!0)}};function LF(){return new dD}var hD=class extends ln{constructor(){super(...arguments),this.type="orderByValue"}_apply(e){xm(e,"orderByValue");let n=mm(e._queryParams,TD);return Yi(n),new Gt(e._repo,e._path,n,!0)}};function jF(){return new hD}var fD=class extends ln{constructor(e,n){super(),this._value=e,this._key=n,this.type="equalTo"}_apply(e){if(Tr("equalTo",this._value,e._path,!1),e._queryParams.hasStart())throw new Error("equalTo: Starting point was already set (by another call to startAt/startAfter or equalTo).");if(e._queryParams.hasEnd())throw new Error("equalTo: Ending point was already set (by another call to endAt/endBefore or equalTo).");return new fm(this._value,this._key)._apply(new pm(this._value,this._key)._apply(e))}};function UF(t,e){return Dd("equalTo","key",e,!0),new fD(t,e)}function xn(t,...e){let n=ce(t);for(let r of e)n=r._apply(n);return n}TW(cn);MW(cn);var v6="FIREBASE_DATABASE_EMULATOR_HOST",pD={},w6=!1;function E6(t,e,n,r){t.repoInfo_=new qg(`${e}:${n}`,!1,t.repoInfo_.namespace,t.repoInfo_.webSocketOnly,t.repoInfo_.nodeAdmin,t.repoInfo_.persistenceKey,t.repoInfo_.includeNamespaceInQueryParams,!0),r&&(t.authTokenProvider_=r)}function ZD(t,e,n,r,i){let s=r||t.options.databaseURL;s===void 0&&(t.options.projectId||Cr("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),mt("Using default host for project ",t.options.projectId),s=`${t.options.projectId}-default-rtdb.firebaseio.com`);let o=iD(s,i),a=o.repoInfo,u,c;typeof process<"u"&&process.env&&(c=process.env[v6]),c?(u=!0,s=`http://${c}?ns=${a.namespace}`,o=iD(s,i),a=o.repoInfo):u=!o.repoInfo.secure;let l=i&&u?new ed(ed.OWNER):new _0(t.name,t.options,e);gF("Invalid Firebase Database URL",o),ie(o.path)||Cr("Database URL must point to the root of a Firebase Database (not including a child path).");let d=C6(a,t,l,new y0(t.name,n));return new gD(d,t)}function I6(t,e){let n=pD[e];(!n||n[t.key]!==t)&&Cr(`Database ${e}(${t.repoInfo_}) has already been deleted.`),wF(t),delete n[t.key]}function C6(t,e,n,r){let i=pD[e.name];i||(i={},pD[e.name]=i);let s=i[t.toURLString()];return s&&Cr("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),s=new nD(t,w6,n,r),i[t.toURLString()]=s,s}var gD=class{constructor(e,n){this._repoInternal=e,this.app=n,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(n6(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new cn(this._repo,we())),this._rootInternal}_delete(){return this._rootInternal!==null&&(I6(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&Cr("Cannot call "+e+" on a deleted database.")}};function BF(){j1.IS_TRANSPORT_INITIALIZED&&kt("Transport has already been initialized. Please call this function before calling ref or setting up a listener")}function $F(){BF(),id.forceDisallow()}function HF(){BF(),du.forceDisallow(),id.forceAllow()}function qF(t,e,n,r={}){t=ce(t),t._checkNotDeleted("useEmulator"),t._instanceStarted&&Cr("Cannot call useEmulator() after instance has already been initialized.");let i=t._repoInternal,s;if(i.repoInfo_.nodeAdmin)r.mockUserToken&&Cr('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),s=new ed(ed.OWNER);else if(r.mockUserToken){let o=typeof r.mockUserToken=="string"?r.mockUserToken:Md(r.mockUserToken,t.app.options.projectId);s=new ed(o)}E6(i,e,n,s)}function GF(t){t=ce(t),t._checkNotDeleted("goOffline"),wF(t._repo)}function zF(t){t=ce(t),t._checkNotDeleted("goOnline"),d6(t._repo)}function WF(t,e){E1(t,e)}function D6(t){_D(Od),Zi(new Xt("database",(e,{instanceIdentifier:n})=>{let r=e.getProvider("app").getImmediate(),i=e.getProvider("auth-internal"),s=e.getProvider("app-check-internal");return ZD(r,i,s,n)},"PUBLIC").setMultipleInstances(!0)),Mn(UO,BO,t),Mn(UO,BO,"esm2017")}var T6={".sv":"timestamp"};function KF(){return T6}function QF(t){return{".sv":{increment:t}}}var mD=class{constructor(e,n){this.committed=e,this.snapshot=n}toJSON(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}}};function YF(t,e,n){var r;if(t=ce(t),an("Reference.transaction",t._path),t.key===".length"||t.key===".keys")throw"Reference.transaction failed: "+t.key+" is a read-only object.";let i=(r=n?.applyLocally)!==null&&r!==void 0?r:!0,s=new lt,o=(u,c,l)=>{let d=null;u?s.reject(u):(d=new Eu(l,new cn(t._repo,t._path),Me),s.resolve(new mD(c,d)))},a=Nm(t,()=>{});return h6(t._repo,t._path,e,o,a,i),s.promise}CD.prototype.simpleListen=function(t,e){this.sendRequest("q",{p:t},e)};CD.prototype.echo=function(t,e){this.sendRequest("echo",{d:t},e)};D6();var b6="@firebase/database-compat",S6="1.0.3";var A6=new Xr("@firebase/database-compat"),ZF=function(t){let e="FIREBASE WARNING: "+t;A6.warn(e)};var x6=function(t,e,n,r){if(!(r&&n===void 0)&&typeof n!="boolean")throw new Error(zt(t,e)+"must be a boolean.")},M6=function(t,e,n){if(!(n&&e===void 0))switch(e){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error(zt(t,"eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}};var XD=class{constructor(e){this._delegate=e}cancel(e){q("OnDisconnect.cancel",0,1,arguments.length),at("OnDisconnect.cancel","onComplete",e,!0);let n=this._delegate.cancel();return e&&n.then(()=>e(null),r=>e(r)),n}remove(e){q("OnDisconnect.remove",0,1,arguments.length),at("OnDisconnect.remove","onComplete",e,!0);let n=this._delegate.remove();return e&&n.then(()=>e(null),r=>e(r)),n}set(e,n){q("OnDisconnect.set",1,2,arguments.length),at("OnDisconnect.set","onComplete",n,!0);let r=this._delegate.set(e);return n&&r.then(()=>n(null),i=>n(i)),r}setWithPriority(e,n,r){q("OnDisconnect.setWithPriority",2,3,arguments.length),at("OnDisconnect.setWithPriority","onComplete",r,!0);let i=this._delegate.setWithPriority(e,n);return r&&i.then(()=>r(null),s=>r(s)),i}update(e,n){if(q("OnDisconnect.update",1,2,arguments.length),Array.isArray(e)){let i={};for(let s=0;s<e.length;++s)i[""+s]=e[s];e=i,ZF("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}at("OnDisconnect.update","onComplete",n,!0);let r=this._delegate.update(e);return n&&r.then(()=>n(null),i=>n(i)),r}};var JD=class{constructor(e,n){this.committed=e,this.snapshot=n}toJSON(){return q("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}}};var go=class t{constructor(e,n){this._database=e,this._delegate=n}val(){return q("DataSnapshot.val",0,0,arguments.length),this._delegate.val()}exportVal(){return q("DataSnapshot.exportVal",0,0,arguments.length),this._delegate.exportVal()}toJSON(){return q("DataSnapshot.toJSON",0,1,arguments.length),this._delegate.toJSON()}exists(){return q("DataSnapshot.exists",0,0,arguments.length),this._delegate.exists()}child(e){return q("DataSnapshot.child",0,1,arguments.length),e=String(e),Tu("DataSnapshot.child","path",e,!1),new t(this._database,this._delegate.child(e))}hasChild(e){return q("DataSnapshot.hasChild",1,1,arguments.length),Tu("DataSnapshot.hasChild","path",e,!1),this._delegate.hasChild(e)}getPriority(){return q("DataSnapshot.getPriority",0,0,arguments.length),this._delegate.priority}forEach(e){return q("DataSnapshot.forEach",1,1,arguments.length),at("DataSnapshot.forEach","action",e,!1),this._delegate.forEach(n=>e(new t(this._database,n)))}hasChildren(){return q("DataSnapshot.hasChildren",0,0,arguments.length),this._delegate.hasChildren()}get key(){return this._delegate.key}numChildren(){return q("DataSnapshot.numChildren",0,0,arguments.length),this._delegate.size}getRef(){return q("DataSnapshot.ref",0,0,arguments.length),new Yr(this._database,this._delegate.ref)}get ref(){return this.getRef()}},Pm=class t{constructor(e,n){this.database=e,this._delegate=n}on(e,n,r,i){var s;q("Query.on",2,4,arguments.length),at("Query.on","callback",n,!1);let o=t.getCancelAndContextArgs_("Query.on",r,i),a=(c,l)=>{n.call(o.context,new go(this.database,c),l)};a.userCallback=n,a.context=o.context;let u=(s=o.cancel)===null||s===void 0?void 0:s.bind(o.context);switch(e){case"value":return Nm(this._delegate,a,u),n;case"child_added":return zD(this._delegate,a,u),n;case"child_removed":return QD(this._delegate,a,u),n;case"child_changed":return WD(this._delegate,a,u),n;case"child_moved":return KD(this._delegate,a,u),n;default:throw new Error(zt("Query.on","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}off(e,n,r){if(q("Query.off",0,3,arguments.length),M6("Query.off",e,!0),at("Query.off","callback",n,!0),jm("Query.off","context",r,!0),n){let i=()=>{};i.userCallback=n,i.context=r,YD(this._delegate,e,i)}else YD(this._delegate,e)}get(){return xF(this._delegate).then(e=>new go(this.database,e))}once(e,n,r,i){q("Query.once",1,4,arguments.length),at("Query.once","callback",n,!0);let s=t.getCancelAndContextArgs_("Query.once",r,i),o=new lt,a=(c,l)=>{let d=new go(this.database,c);n&&n.call(s.context,d,l),o.resolve(d)};a.userCallback=n,a.context=s.context;let u=c=>{s.cancel&&s.cancel.call(s.context,c),o.reject(c)};switch(e){case"value":Nm(this._delegate,a,u,{onlyOnce:!0});break;case"child_added":zD(this._delegate,a,u,{onlyOnce:!0});break;case"child_removed":QD(this._delegate,a,u,{onlyOnce:!0});break;case"child_changed":WD(this._delegate,a,u,{onlyOnce:!0});break;case"child_moved":KD(this._delegate,a,u,{onlyOnce:!0});break;default:throw new Error(zt("Query.once","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}return o.promise}limitToFirst(e){return q("Query.limitToFirst",1,1,arguments.length),new t(this.database,xn(this._delegate,kF(e)))}limitToLast(e){return q("Query.limitToLast",1,1,arguments.length),new t(this.database,xn(this._delegate,OF(e)))}orderByChild(e){return q("Query.orderByChild",1,1,arguments.length),new t(this.database,xn(this._delegate,FF(e)))}orderByKey(){return q("Query.orderByKey",0,0,arguments.length),new t(this.database,xn(this._delegate,VF()))}orderByPriority(){return q("Query.orderByPriority",0,0,arguments.length),new t(this.database,xn(this._delegate,LF()))}orderByValue(){return q("Query.orderByValue",0,0,arguments.length),new t(this.database,xn(this._delegate,jF()))}startAt(e=null,n){return q("Query.startAt",0,2,arguments.length),new t(this.database,xn(this._delegate,NF(e,n)))}startAfter(e=null,n){return q("Query.startAfter",0,2,arguments.length),new t(this.database,xn(this._delegate,PF(e,n)))}endAt(e=null,n){return q("Query.endAt",0,2,arguments.length),new t(this.database,xn(this._delegate,MF(e,n)))}endBefore(e=null,n){return q("Query.endBefore",0,2,arguments.length),new t(this.database,xn(this._delegate,RF(e,n)))}equalTo(e,n){return q("Query.equalTo",1,2,arguments.length),new t(this.database,xn(this._delegate,UF(e,n)))}toString(){return q("Query.toString",0,0,arguments.length),this._delegate.toString()}toJSON(){return q("Query.toJSON",0,1,arguments.length),this._delegate.toJSON()}isEqual(e){if(q("Query.isEqual",1,1,arguments.length),!(e instanceof t)){let n="Query.isEqual failed: First argument must be an instance of firebase.database.Query.";throw new Error(n)}return this._delegate.isEqual(e._delegate)}static getCancelAndContextArgs_(e,n,r){let i={cancel:void 0,context:void 0};if(n&&r)i.cancel=n,at(e,"cancel",i.cancel,!0),i.context=r,jm(e,"context",i.context,!0);else if(n)if(typeof n=="object"&&n!==null)i.context=n;else if(typeof n=="function")i.cancel=n;else throw new Error(zt(e,"cancelOrContext")+" must either be a cancel callback or a context object.");return i}get ref(){return new Yr(this.database,new cn(this._delegate._repo,this._delegate._path))}},Yr=class t extends Pm{constructor(e,n){super(e,new Gt(n._repo,n._path,new ld,!1)),this.database=e,this._delegate=n}getKey(){return q("Reference.key",0,0,arguments.length),this._delegate.key}child(e){return q("Reference.child",1,1,arguments.length),typeof e=="number"&&(e=String(e)),new t(this.database,Qi(this._delegate,e))}getParent(){q("Reference.parent",0,0,arguments.length);let e=this._delegate.parent;return e?new t(this.database,e):null}getRoot(){return q("Reference.root",0,0,arguments.length),new t(this.database,this._delegate.root)}set(e,n){q("Reference.set",1,2,arguments.length),at("Reference.set","onComplete",n,!0);let r=Rm(this._delegate,e);return n&&r.then(()=>n(null),i=>n(i)),r}update(e,n){if(q("Reference.update",1,2,arguments.length),Array.isArray(e)){let i={};for(let s=0;s<e.length;++s)i[""+s]=e[s];e=i,ZF("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}an("Reference.update",this._delegate._path),at("Reference.update","onComplete",n,!0);let r=AF(this._delegate,e);return n&&r.then(()=>n(null),i=>n(i)),r}setWithPriority(e,n,r){q("Reference.setWithPriority",2,3,arguments.length),at("Reference.setWithPriority","onComplete",r,!0);let i=SF(this._delegate,e,n);return r&&i.then(()=>r(null),s=>r(s)),i}remove(e){q("Reference.remove",0,1,arguments.length),at("Reference.remove","onComplete",e,!0);let n=TF(this._delegate);return e&&n.then(()=>e(null),r=>e(r)),n}transaction(e,n,r){q("Reference.transaction",1,3,arguments.length),at("Reference.transaction","transactionUpdate",e,!1),at("Reference.transaction","onComplete",n,!0),x6("Reference.transaction","applyLocally",r,!0);let i=YF(this._delegate,e,{applyLocally:r}).then(s=>new JD(s.committed,new go(this.database,s.snapshot)));return n&&i.then(s=>n(null,s.committed,s.snapshot),s=>n(s,!1,null)),i}setPriority(e,n){q("Reference.setPriority",1,2,arguments.length),at("Reference.setPriority","onComplete",n,!0);let r=bF(this._delegate,e);return n&&r.then(()=>n(null),i=>n(i)),r}push(e,n){q("Reference.push",0,2,arguments.length),at("Reference.push","onComplete",n,!0);let r=DF(this._delegate,e),i=r.then(o=>new t(this.database,o));n&&i.then(()=>n(null),o=>n(o));let s=new t(this.database,r);return s.then=i.then.bind(i),s.catch=i.catch.bind(i,void 0),s}onDisconnect(){return an("Reference.onDisconnect",this._delegate._path),new XD(new dm(this._delegate._repo,this._delegate._path))}get key(){return this.getKey()}get parent(){return this.getParent()}get root(){return this.getRoot()}};var mo=class{constructor(e,n){this._delegate=e,this.app=n,this.INTERNAL={delete:()=>this._delegate._delete(),forceWebSockets:$F,forceLongPolling:HF}}useEmulator(e,n,r={}){qF(this._delegate,e,n,r)}ref(e){if(q("database.ref",0,1,arguments.length),e instanceof Yr){let n=GD(this._delegate,e.toString());return new Yr(this,n)}else{let n=qD(this._delegate,e);return new Yr(this,n)}}refFromURL(e){q("database.refFromURL",1,1,arguments.length);let r=GD(this._delegate,e);return new Yr(this,r)}goOffline(){return q("database.goOffline",0,0,arguments.length),GF(this._delegate)}goOnline(){return q("database.goOnline",0,0,arguments.length),zF(this._delegate)}};mo.ServerValue={TIMESTAMP:KF(),increment:t=>QF(t)};function R6({app:t,url:e,version:n,customAuthImpl:r,customAppCheckImpl:i,namespace:s,nodeAdmin:o=!1}){_D(n);let a=new Um("database-standalone"),u=new kd("auth-internal",a);u.setComponent(new Xt("auth-internal",()=>r,"PRIVATE"));let c;return i&&(c=new kd("app-check-internal",a),c.setComponent(new Xt("app-check-internal",()=>i,"PRIVATE"))),{instance:new mo(ZD(t,u,c,e,o),t),namespace:s}}var N6=Object.freeze({__proto__:null,initStandalone:R6});var P6=mo.ServerValue;function k6(t){t.INTERNAL.registerComponent(new Xt("database-compat",(e,{instanceIdentifier:n})=>{let r=e.getProvider("app-compat").getImmediate(),i=e.getProvider("database").getImmediate({identifier:n});return new mo(i,r)},"PUBLIC").setServiceProps({Reference:Yr,Query:Pm,Database:mo,DataSnapshot:go,enableLogging:WF,INTERNAL:N6,ServerValue:P6}).setMultipleInstances(!0)),t.registerVersion(b6,S6)}k6(_t);function Sd(t,e,n="on",r=ns){return new ne(i=>{let s=null;return s=t[n](e,(o,a)=>{r.schedule(()=>{i.next({snapshot:o,prevKey:a})}),n==="once"&&r.schedule(()=>i.complete())},o=>{r.schedule(()=>i.error(o))}),n==="on"?{unsubscribe(){s!=null&&t.off(e,s)}}:{unsubscribe(){}}}).pipe(j(i=>{let{snapshot:s,prevKey:o}=i,a=null;return s.exists()&&(a=s.key),{type:e,payload:s,prevKey:o,key:a}}),Fu())}function O6(t){return typeof t=="string"}function F6(t){return typeof t.exportVal=="function"}function nV(t){return t==null}function rV(t){return typeof t.set=="function"}function XF(t,e){return rV(e)?e:t.ref(e)}function iV(t,e){if(O6(t))return e.stringCase();if(rV(t))return e.firebaseCase();if(F6(t))return e.snapshotCase();throw new Error(`Expects a string, snapshot, or reference. Got: ${typeof t}`)}function sV(t){return(nV(t)||t.length===0)&&(t=["child_added","child_removed","child_changed","child_moved"]),t}function oV(t,e,n){e=sV(e);let r=e.map(i=>Sd(t,i,"on",n));return Mo(...r)}function V6(t,e,n){let r=oV(t,e).pipe(Yn((i,s)=>[...i,s],[]));return j6(t,r,n)}function L6(t,e){return Sd(t,"value","on",e).pipe(j(n=>{let r;return n.payload.forEach(i=>(r=i.key,!1)),{data:n,lastKeyToLoad:r}}))}function j6(t,e,n){return L6(t,n).pipe(cy(e),j(([i,s])=>{let o=i.lastKeyToLoad,a=s.map(u=>u.key);return{actions:s,lastKeyToLoad:o,loadedKeys:a}}),ay(i=>i.loadedKeys.indexOf(i.lastKeyToLoad)===-1),j(i=>i.actions))}function JF(t,e){return function(r,i){return iV(r,{stringCase:()=>t.child(r)[e](i),firebaseCase:()=>r[e](i),snapshotCase:()=>r.ref[e](i)})}}function U6(t){return function(n){return n?iV(n,{stringCase:()=>t.child(n).remove(),firebaseCase:()=>n.remove(),snapshotCase:()=>n.ref.remove()}):t.remove()}}function B6(t,e,n){return Sd(t,"value","once",n).pipe(ke(r=>{let i=[U(r)];return e.forEach(s=>i.push(Sd(t,s,"on",n))),Mo(...i).pipe(Yn(H6,[]))}),Pu())}function aV(t,e){let n=t.length;for(let r=0;r<n;r++)if(t[r].payload.key===e)return r;return-1}function $6(t,e){if(nV(e))return 0;{let n=aV(t,e);return n===-1?t.length:n+1}}function H6(t,e){let{payload:n,prevKey:r,key:i}=e,s=aV(t,i),o=$6(t,r);switch(e.type){case"value":if(e.payload?.exists()){let a=null;e.payload.forEach(u=>{let c={payload:u,type:"value",prevKey:a,key:u.key};return a=u.key,t=[...t,c],!1})}return t;case"child_added":if(s>-1)(t[s-1]?.key||null)!==r&&(t=t.filter(u=>u.payload.key!==n.key),t.splice(o,0,e));else{if(r==null)return[e,...t];t=t.slice(),t.splice(o,0,e)}return t;case"child_removed":return t.filter(a=>a.payload.key!==n.key);case"child_changed":return t.map(a=>a.payload.key===i?e:a);case"child_moved":if(s>-1){let a=t.splice(s,1)[0];return t=t.slice(),t.splice(o,0,a),t}return t;default:return t}}function eV(t,e,n){return e=sV(e),B6(t,e,n)}function q6(t,e){let n=e.schedulers.outsideAngular,r=e.schedulers.ngZone.run(()=>t.ref);return{query:t,update:JF(r,"update"),set:JF(r,"set"),push:i=>r.push(i),remove:U6(r),snapshotChanges(i){return eV(t,i,n).pipe(Ge)},stateChanges(i){return oV(t,i,n).pipe(Ge)},auditTrail(i){return V6(t,i,n).pipe(Ge)},valueChanges(i,s){return eV(t,i,n).pipe(j(a=>a.map(u=>s&&s.idField?ue(x({},u.payload.val()),{[s.idField]:u.key}):u.payload.val())),Ge)}}}function tV(t,e){return function(){return Sd(t,"value","on",e)}}function G6(t,e){return{query:t,snapshotChanges(){return tV(t,e.schedulers.outsideAngular)().pipe(Ge)},update(n){return t.ref.update(n)},set(n){return t.ref.set(n)},remove(){return t.ref.remove()},valueChanges(){return tV(t,e.schedulers.outsideAngular)().pipe(Ge,j(r=>r.payload.exists()?r.payload.val():null))}}}var z6=new F("angularfire2.realtimeDatabaseURL"),W6=new F("angularfire2.database.use-emulator"),K6=(()=>{class t{schedulers;database;constructor(n,r,i,s,o,a,u,c,l,d,h,f,p,g,_){this.schedulers=a;let b=u,P=bs(n,o,r);c&&kc(P,o,l,h,f,p,d,g),this.database=pa(`${P.name}.database.${i}`,"AngularFireDatabase",P.name,()=>{let A=o.runOutsideAngular(()=>P.database(i||void 0));return b&&A.useEmulator(...b),A},[b])}list(n,r){let i=this.schedulers.ngZone.runOutsideAngular(()=>XF(this.database,n)),s=i;return r&&(s=r(i)),q6(s,this)}object(n){let r=this.schedulers.ngZone.runOutsideAngular(()=>XF(this.database,n));return G6(r,this)}createPushId(){return this.schedulers.ngZone.runOutsideAngular(()=>this.database.ref()).push().key}static \u0275fac=function(r){return new(r||t)(C(_i),C(vi,8),C(z6,8),C(xt),C(le),C(fa),C(W6,8),C(jf,8),C(Ac,8),C(xc,8),C(Mc,8),C(Rc,8),C(Nc,8),C(Pc,8),C(Vr,8))};static \u0275prov=V({token:t,factory:t.\u0275fac,providedIn:"any"})}return t})(),uV=(()=>{class t{constructor(){_t.registerVersion("angularfire",Ts.full,"rtdb-compat")}static \u0275fac=function(r){return new(r||t)};static \u0275mod=et({type:t});static \u0275inj=Je({providers:[K6]})}return t})();var cV={production:!1,firebaseConfig:{apiKey:"AIzaSyCxisjQ5vrskr-D5zy5bJdmrPC0Y1hjwC8",authDomain:"libros-hafm.firebaseapp.com",projectId:"libros-hafm",storageBucket:"libros-hafm.appspot.com",messagingSenderId:"406105537927",appId:"1:406105537927:web:2fb74c52245542a9406722"}};var lV=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=et({type:e,bootstrap:[jO]}),e.\u0275inj=Je({imports:[ix,VO,xO,uV,hM.initializeApp(cV.firebaseConfig)]});let t=e;return t})();rx().bootstrapModule(lV).catch(t=>console.error(t));
